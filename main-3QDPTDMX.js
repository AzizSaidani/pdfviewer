import{a as me,b as Ke,c as sp,d as vi,e as jP,f as X}from"./chunk-4IDNTCH7.js";var Hf=vi(()=>{"use strict"});var uP=vi((Bse,lP)=>{"use strict";var sH="bold|bolder|lighter|[1-9]00",oH="italic|oblique",aH="small-caps",cH="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",lH="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",cP=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,uH=new RegExp(`(${sH}) +`,"i"),dH=new RegExp(`(${oH}) +`,"i"),hH=new RegExp(`(${aH}) +`,"i"),fH=new RegExp(`(${cH}) +`,"i"),pH=new RegExp(`([\\d\\.]+)(${lH}) *((?:${cP})( *, *(?:${cP}))*)`),mb={},gH=16;lP.exports=t=>{if(mb[t])return mb[t];let e=pH.exec(t);if(!e)return;let n={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")},r,i,s,o,a=t.substring(0,e.index);switch((r=uH.exec(a))&&(n.weight=r[1]),(i=dH.exec(a))&&(n.style=i[1]),(s=hH.exec(a))&&(n.variant=s[1]),(o=fH.exec(a))&&(n.stretch=o[1]),n.unit){case"pt":n.size/=.75;break;case"pc":n.size*=16;break;case"in":n.size*=96;break;case"cm":n.size*=96/2.54;break;case"mm":n.size*=96/25.4;break;case"%":break;case"em":case"rem":n.size*=gH/.75;break;case"q":n.size*=96/25.4/4;break}return mb[t]=n}});var dP=vi(Kl=>{"use strict";var mH=uP();Kl.parseFont=mH;Kl.createCanvas=function(t,e){return Object.assign(document.createElement("canvas"),{width:t,height:e})};Kl.createImageData=function(t,e,n){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(t);case 2:return new ImageData(t,e);default:return new ImageData(t,e,n)}};Kl.loadImage=function(t,e){return new Promise(function(n,r){let i=Object.assign(document.createElement("img"),e);function s(){i.onload=null,i.onerror=null}i.onload=function(){s(),n(i)},i.onerror=function(){s(),r(new Error('Failed to load the image "'+t+'"'))},i.src=t})}});var hP=vi(()=>{"use strict"});var yb=vi(()=>{"use strict"});var vb=vi(()=>{"use strict"});var fP=vi(()=>{"use strict"});var pP=vi((exports,module)=>{"use strict";(function(e,n){typeof exports=="object"&&typeof module=="object"?module.exports=e.pdfjsLib=n():typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",[],()=>e.pdfjsLib=n()):typeof exports=="object"?exports["pdfjs-dist/build/pdf"]=e.pdfjsLib=n():e["pdfjs-dist/build/pdf"]=e.pdfjsLib=n()})(globalThis,()=>(()=>{"use strict";var __webpack_modules__=[,((t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=w,e.bytesToString=K,e.createValidAbsoluteUrl=k,e.getModificationDate=Ze,e.getUuid=Wf,e.getVerbosityLevel=pe,e.info=oe,e.isArrayBuffer=et,e.isArrayEqual=Zt,e.isNodeJS=void 0,e.normalizeUnicode=Zs,e.objectFromMap=te,e.objectSize=fe,e.setVerbosityLevel=ae,e.shadow=H,e.string32=ee,e.stringToBytes=Y,e.stringToPDFString=Ae,e.stringToUTF8String=xe,e.unreachable=x,e.utf8StringToString=Ue,e.warn=q;let n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=n;let r=[1,0,0,1,0,0];e.IDENTITY_MATRIX=r;let i=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=i;let s=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=s;let o=1.35;e.LINE_FACTOR=o;let a=.35;e.LINE_DESCENT_FACTOR=a;let c=a/o;e.BASELINE_FACTOR=c;let l={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=l;let d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=d;let h="pdfjs_internal_editor_";e.AnnotationEditorPrefix=h;let f={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=f;let p={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=p;let m={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=m;let g={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=g;let v={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=v;let E={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=E;let A={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=A;let O={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=O;let M={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=M;let C={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=C;let P={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=P;let D={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=D;let S={O:"PageOpen",C:"PageClose"};e.PageActionEventType=S;let T={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=T;let F={NONE:0,BINARY:1};e.CMapCompressionType=F;let L={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=L;let W={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=W;let U=T.WARNINGS;function ae(ue){Number.isInteger(ue)&&(U=ue)}function pe(){return U}function oe(ue){U>=T.INFOS&&console.log(`Info: ${ue}`)}function q(ue){U>=T.WARNINGS&&console.log(`Warning: ${ue}`)}function x(ue){throw new Error(ue)}function w(ue,J){ue||x(J)}function I(ue){switch(ue?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function k(ue,J=null,Z=null){if(!ue)return null;try{if(Z&&typeof ue=="string"&&(Z.addDefaultProtocol&&ue.startsWith("www.")&&ue.match(/\./g)?.length>=2&&(ue=`http://${ue}`),Z.tryConvertEncoding))try{ue=xe(ue)}catch{}let ve=J?new URL(ue,J):new URL(ue);if(I(ve))return ve}catch{}return null}function H(ue,J,Z,ve=!1){return Object.defineProperty(ue,J,{value:Z,enumerable:!ve,configurable:!0,writable:!1}),Z}let $=(function(){function J(Z,ve){this.constructor===J&&x("Cannot initialize BaseException."),this.message=Z,this.name=ve}return J.prototype=new Error,J.constructor=J,J})();e.BaseException=$;class G extends ${constructor(J,Z){super(J,"PasswordException"),this.code=Z}}e.PasswordException=G;class j extends ${constructor(J,Z){super(J,"UnknownErrorException"),this.details=Z}}e.UnknownErrorException=j;class _ extends ${constructor(J){super(J,"InvalidPDFException")}}e.InvalidPDFException=_;class R extends ${constructor(J){super(J,"MissingPDFException")}}e.MissingPDFException=R;class N extends ${constructor(J,Z){super(J,"UnexpectedResponseException"),this.status=Z}}e.UnexpectedResponseException=N;class B extends ${constructor(J){super(J,"FormatError")}}e.FormatError=B;class z extends ${constructor(J){super(J,"AbortException")}}e.AbortException=z;function K(ue){(typeof ue!="object"||ue?.length===void 0)&&x("Invalid argument for bytesToString");let J=ue.length,Z=8192;if(J<Z)return String.fromCharCode.apply(null,ue);let ve=[];for(let tt=0;tt<J;tt+=Z){let Tt=Math.min(tt+Z,J),Pt=ue.subarray(tt,Tt);ve.push(String.fromCharCode.apply(null,Pt))}return ve.join("")}function Y(ue){typeof ue!="string"&&x("Invalid argument for stringToBytes");let J=ue.length,Z=new Uint8Array(J);for(let ve=0;ve<J;++ve)Z[ve]=ue.charCodeAt(ve)&255;return Z}function ee(ue){return String.fromCharCode(ue>>24&255,ue>>16&255,ue>>8&255,ue&255)}function fe(ue){return Object.keys(ue).length}function te(ue){let J=Object.create(null);for(let[Z,ve]of ue)J[Z]=ve;return J}function re(){let ue=new Uint8Array(4);return ue[0]=1,new Uint32Array(ue.buffer,0,1)[0]===1}function ie(){try{return new Function(""),!0}catch{return!1}}class se{static get isLittleEndian(){return H(this,"isLittleEndian",re())}static get isEvalSupported(){return H(this,"isEvalSupported",ie())}static get isOffscreenCanvasSupported(){return H(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?H(this,"platform",{isWin:!1,isMac:!1}):H(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return H(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}e.FeatureTest=se;let ce=[...Array(256).keys()].map(ue=>ue.toString(16).padStart(2,"0"));class ye{static makeHexColor(J,Z,ve){return`#${ce[J]}${ce[Z]}${ce[ve]}`}static scaleMinMax(J,Z){let ve;J[0]?(J[0]<0&&(ve=Z[0],Z[0]=Z[1],Z[1]=ve),Z[0]*=J[0],Z[1]*=J[0],J[3]<0&&(ve=Z[2],Z[2]=Z[3],Z[3]=ve),Z[2]*=J[3],Z[3]*=J[3]):(ve=Z[0],Z[0]=Z[2],Z[2]=ve,ve=Z[1],Z[1]=Z[3],Z[3]=ve,J[1]<0&&(ve=Z[2],Z[2]=Z[3],Z[3]=ve),Z[2]*=J[1],Z[3]*=J[1],J[2]<0&&(ve=Z[0],Z[0]=Z[1],Z[1]=ve),Z[0]*=J[2],Z[1]*=J[2]),Z[0]+=J[4],Z[1]+=J[4],Z[2]+=J[5],Z[3]+=J[5]}static transform(J,Z){return[J[0]*Z[0]+J[2]*Z[1],J[1]*Z[0]+J[3]*Z[1],J[0]*Z[2]+J[2]*Z[3],J[1]*Z[2]+J[3]*Z[3],J[0]*Z[4]+J[2]*Z[5]+J[4],J[1]*Z[4]+J[3]*Z[5]+J[5]]}static applyTransform(J,Z){let ve=J[0]*Z[0]+J[1]*Z[2]+Z[4],tt=J[0]*Z[1]+J[1]*Z[3]+Z[5];return[ve,tt]}static applyInverseTransform(J,Z){let ve=Z[0]*Z[3]-Z[1]*Z[2],tt=(J[0]*Z[3]-J[1]*Z[2]+Z[2]*Z[5]-Z[4]*Z[3])/ve,Tt=(-J[0]*Z[1]+J[1]*Z[0]+Z[4]*Z[1]-Z[5]*Z[0])/ve;return[tt,Tt]}static getAxialAlignedBoundingBox(J,Z){let ve=this.applyTransform(J,Z),tt=this.applyTransform(J.slice(2,4),Z),Tt=this.applyTransform([J[0],J[3]],Z),Pt=this.applyTransform([J[2],J[1]],Z);return[Math.min(ve[0],tt[0],Tt[0],Pt[0]),Math.min(ve[1],tt[1],Tt[1],Pt[1]),Math.max(ve[0],tt[0],Tt[0],Pt[0]),Math.max(ve[1],tt[1],Tt[1],Pt[1])]}static inverseTransform(J){let Z=J[0]*J[3]-J[1]*J[2];return[J[3]/Z,-J[1]/Z,-J[2]/Z,J[0]/Z,(J[2]*J[5]-J[4]*J[3])/Z,(J[4]*J[1]-J[5]*J[0])/Z]}static singularValueDecompose2dScale(J){let Z=[J[0],J[2],J[1],J[3]],ve=J[0]*Z[0]+J[1]*Z[2],tt=J[0]*Z[1]+J[1]*Z[3],Tt=J[2]*Z[0]+J[3]*Z[2],Pt=J[2]*Z[1]+J[3]*Z[3],Fr=(ve+Pt)/2,Vn=Math.sqrt((ve+Pt)**2-4*(ve*Pt-Tt*tt))/2,Qn=Fr+Vn||1,Kt=Fr-Vn||1;return[Math.sqrt(Qn),Math.sqrt(Kt)]}static normalizeRect(J){let Z=J.slice(0);return J[0]>J[2]&&(Z[0]=J[2],Z[2]=J[0]),J[1]>J[3]&&(Z[1]=J[3],Z[3]=J[1]),Z}static intersect(J,Z){let ve=Math.max(Math.min(J[0],J[2]),Math.min(Z[0],Z[2])),tt=Math.min(Math.max(J[0],J[2]),Math.max(Z[0],Z[2]));if(ve>tt)return null;let Tt=Math.max(Math.min(J[1],J[3]),Math.min(Z[1],Z[3])),Pt=Math.min(Math.max(J[1],J[3]),Math.max(Z[1],Z[3]));return Tt>Pt?null:[ve,Tt,tt,Pt]}static bezierBoundingBox(J,Z,ve,tt,Tt,Pt,Fr,Vn){let Qn=[],Kt=[[],[]],yn,Zn,Lr,At,fr,es,Vt,Js;for(let ja=0;ja<2;++ja){if(ja===0?(Zn=6*J-12*ve+6*Tt,yn=-3*J+9*ve-9*Tt+3*Fr,Lr=3*ve-3*J):(Zn=6*Z-12*tt+6*Pt,yn=-3*Z+9*tt-9*Pt+3*Vn,Lr=3*tt-3*Z),Math.abs(yn)<1e-12){if(Math.abs(Zn)<1e-12)continue;At=-Lr/Zn,0<At&&At<1&&Qn.push(At);continue}Vt=Zn*Zn-4*Lr*yn,Js=Math.sqrt(Vt),!(Vt<0)&&(fr=(-Zn+Js)/(2*yn),0<fr&&fr<1&&Qn.push(fr),es=(-Zn-Js)/(2*yn),0<es&&es<1&&Qn.push(es))}let Jn=Qn.length,Ut,ts=Jn;for(;Jn--;)At=Qn[Jn],Ut=1-At,Kt[0][Jn]=Ut*Ut*Ut*J+3*Ut*Ut*At*ve+3*Ut*At*At*Tt+At*At*At*Fr,Kt[1][Jn]=Ut*Ut*Ut*Z+3*Ut*Ut*At*tt+3*Ut*At*At*Pt+At*At*At*Vn;return Kt[0][ts]=J,Kt[1][ts]=Z,Kt[0][ts+1]=Fr,Kt[1][ts+1]=Vn,Kt[0].length=Kt[1].length=ts+2,[Math.min(...Kt[0]),Math.min(...Kt[1]),Math.max(...Kt[0]),Math.max(...Kt[1])]}}e.Util=ye;let be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ae(ue){if(ue[0]>="\xEF"){let Z;if(ue[0]==="\xFE"&&ue[1]==="\xFF"?Z="utf-16be":ue[0]==="\xFF"&&ue[1]==="\xFE"?Z="utf-16le":ue[0]==="\xEF"&&ue[1]==="\xBB"&&ue[2]==="\xBF"&&(Z="utf-8"),Z)try{let ve=new TextDecoder(Z,{fatal:!0}),tt=Y(ue);return ve.decode(tt)}catch(ve){q(`stringToPDFString: "${ve}".`)}}let J=[];for(let Z=0,ve=ue.length;Z<ve;Z++){let tt=be[ue.charCodeAt(Z)];J.push(tt?String.fromCharCode(tt):ue.charAt(Z))}return J.join("")}function xe(ue){return decodeURIComponent(escape(ue))}function Ue(ue){return unescape(encodeURIComponent(ue))}function et(ue){return typeof ue=="object"&&ue?.byteLength!==void 0}function Zt(ue,J){if(ue.length!==J.length)return!1;for(let Z=0,ve=ue.length;Z<ve;Z++)if(ue[Z]!==J[Z])return!1;return!0}function Ze(ue=new Date){return[ue.getUTCFullYear().toString(),(ue.getUTCMonth()+1).toString().padStart(2,"0"),ue.getUTCDate().toString().padStart(2,"0"),ue.getUTCHours().toString().padStart(2,"0"),ue.getUTCMinutes().toString().padStart(2,"0"),ue.getUTCSeconds().toString().padStart(2,"0")].join("")}class _t{#e=!1;constructor(){this.promise=new Promise((J,Z)=>{this.resolve=ve=>{this.#e=!0,J(ve)},this.reject=ve=>{this.#e=!0,Z(ve)}})}get settled(){return this.#e}}e.PromiseCapability=_t;let Rt=null,Ln=null;function Zs(ue){return Rt||(Rt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ln=new Map([["\uFB05","\u017Ft"]])),ue.replaceAll(Rt,(J,Z,ve)=>Z?Z.normalize("NFKC"):Ln.get(ve))}function Wf(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let ue=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(ue);else for(let J=0;J<32;J++)ue[J]=Math.floor(Math.random()*255);return K(ue)}let Ji="pdfjs_internal_id_";e.AnnotationPrefix=Ji}),((__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);let DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(t){if(typeof t=="string"||t instanceof URL?t={url:t}:(0,_util.isArrayBuffer)(t)&&(t={data:t}),typeof t!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");let e=new PDFDocumentLoadingTask,{docId:n}=e,r=t.url?getUrlProp(t.url):null,i=t.data?getDataProp(t.data):null,s=t.httpHeaders||null,o=t.withCredentials===!0,a=t.password??null,c=t.range instanceof PDFDataRangeTransport?t.range:null,l=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE,d=t.worker instanceof PDFWorker?t.worker:null,h=t.verbosity,f=typeof t.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(t.docBaseUrl)?t.docBaseUrl:null,p=typeof t.cMapUrl=="string"?t.cMapUrl:null,m=t.cMapPacked!==!1,g=t.CMapReaderFactory||DefaultCMapReaderFactory,v=typeof t.standardFontDataUrl=="string"?t.standardFontDataUrl:null,E=t.StandardFontDataFactory||DefaultStandardFontDataFactory,A=t.stopAtErrors!==!0,O=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,M=t.isEvalSupported!==!1,C=typeof t.isOffscreenCanvasSupported=="boolean"?t.isOffscreenCanvasSupported:!_util.isNodeJS,P=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,D=typeof t.disableFontFace=="boolean"?t.disableFontFace:_util.isNodeJS,S=t.fontExtraProperties===!0,T=t.enableXfa===!0,F=t.ownerDocument||globalThis.document,L=t.disableRange===!0,W=t.disableStream===!0,U=t.disableAutoFetch===!0,ae=t.pdfBug===!0,pe=c?c.length:t.length??NaN,oe=typeof t.useSystemFonts=="boolean"?t.useSystemFonts:!_util.isNodeJS&&!D,q=typeof t.useWorkerFetch=="boolean"?t.useWorkerFetch:g===_display_utils.DOMCMapReaderFactory&&E===_display_utils.DOMStandardFontDataFactory&&p&&v&&(0,_display_utils.isValidFetchUrl)(p,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(v,document.baseURI),x=t.canvasFactory||new DefaultCanvasFactory({ownerDocument:F}),w=t.filterFactory||new DefaultFilterFactory({docId:n,ownerDocument:F}),I=null;(0,_util.setVerbosityLevel)(h);let k={canvasFactory:x,filterFactory:w};if(q||(k.cMapReaderFactory=new g({baseUrl:p,isCompressed:m}),k.standardFontDataFactory=new E({baseUrl:v})),!d){let G={verbosity:h,port:_worker_options.GlobalWorkerOptions.workerPort};d=G.port?PDFWorker.fromPort(G):new PDFWorker(G),e._worker=d}let H={docId:n,apiVersion:"3.11.174",data:i,password:a,disableAutoFetch:U,rangeChunkSize:l,length:pe,docBaseUrl:f,enableXfa:T,evaluatorOptions:{maxImageSize:O,disableFontFace:D,ignoreErrors:A,isEvalSupported:M,isOffscreenCanvasSupported:C,canvasMaxAreaInBytes:P,fontExtraProperties:S,useSystemFonts:oe,cMapUrl:q?p:null,standardFontDataUrl:q?v:null}},$={ignoreErrors:A,isEvalSupported:M,disableFontFace:D,fontExtraProperties:S,enableXfa:T,ownerDocument:F,disableAutoFetch:U,pdfBug:ae,styleElement:I};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");let G=_fetchDocument(d,H),j=new Promise(function(_){let R;c?R=new _transport_stream.PDFDataTransportStream({length:pe,initialData:c.initialData,progressiveDone:c.progressiveDone,contentDispositionFilename:c.contentDispositionFilename,disableRange:L,disableStream:W},c):i||(R=(B=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(B):(0,_display_utils.isValidFetchUrl)(B.url)?new _displayFetch_stream.PDFFetchStream(B):new _displayNetwork.PDFNetworkStream(B))({url:r,length:pe,httpHeaders:s,withCredentials:o,rangeChunkSize:l,disableRange:L,disableStream:W})),_(R)});return Promise.all([G,j]).then(function([_,R]){if(e.destroyed)throw new Error("Loading aborted");let N=new _message_handler.MessageHandler(n,_,d.port),B=new WorkerTransport(N,e,R,$,k);e._transport=B,N.send("Ready",null)})}).catch(e._capability.reject),e}function _fetchDocument(t,e){return X(this,null,function*(){if(t.destroyed)throw new Error("Worker was destroyed");let n=yield t.messageHandler.sendWithPromise("GetDocRequest",e,e.data?[e.data.buffer]:null);if(t.destroyed)throw new Error("Worker was destroyed");return n})}function getUrlProp(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(_util.isNodeJS&&typeof t=="string")return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(t){if(_util.isNodeJS&&typeof Buffer<"u"&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if(typeof t=="string")return(0,_util.stringToBytes)(t);if(typeof t=="object"&&!isNaN(t?.length)||(0,_util.isArrayBuffer)(t))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return X(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,n,r=!1,i=null){this.length=e,this.initialData=n,this.progressiveDone=r,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,n){for(let r of this._rangeListeners)r(e,n)}onDataProgress(e,n){this._readyCapability.promise.then(()=>{for(let r of this._progressListeners)r(e,n)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(let n of this._progressiveReadListeners)n(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,n){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,n){this._pdfInfo=e,this._transport=n,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(r=>{if(!r)return r;let i=[];for(let s in r)i.push(...r[s]);return i}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#e=null;#t=!1;constructor(e,n,r,i=!1){this._pageIndex=e,this._pageInfo=n,this._transport=r,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:n=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:n,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){let n=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,n.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return X(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:e,viewport:n,intent:r="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:c=null,pageColors:l=null,printAnnotationStorage:d=null}){this._stats?.time("Overall");let h=this._transport.getRenderingIntent(r,i,d);this.#t=!1,this.#r(),a||(a=this._transport.getOptionalContentConfig());let f=this._intentStates.get(h.cacheKey);f||(f=Object.create(null),this._intentStates.set(h.cacheKey,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);let p=!!(h.renderingIntent&_util.RenderingIntentFlag.PRINT);f.displayReadyCapability||(f.displayReadyCapability=new _util.PromiseCapability,f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));let m=E=>{f.renderTasks.delete(g),(this._maybeCleanupAfterRender||p)&&(this.#t=!0),this.#n(!p),E?(g.capability.reject(E),this._abortOperatorList({intentState:f,reason:E instanceof Error?E:new Error(E)})):g.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},g=new InternalRenderTask({callback:m,params:{canvasContext:e,viewport:n,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!p,pdfBug:this._pdfBug,pageColors:l});(f.renderTasks||=new Set).add(g);let v=g.task;return Promise.all([f.displayReadyCapability.promise,a]).then(([E,A])=>{if(this.destroyed){m();return}this._stats?.time("Rendering"),g.initializeGraphics({transparency:E,optionalContentConfig:A}),g.operatorListChanged()}).catch(m),v}getOperatorList({intent:e="display",annotationMode:n=_util.AnnotationMode.ENABLE,printAnnotationStorage:r=null}={}){function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(a))}let s=this._transport.getRenderingIntent(e,n,r,!0),o=this._intentStates.get(s.cacheKey);o||(o=Object.create(null),this._intentStates.set(s.cacheKey,o));let a;return o.opListReadCapability||(a=Object.create(null),a.operatorListChanged=i,o.opListReadCapability=new _util.PromiseCapability,(o.renderTasks||=new Set).add(a),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:n=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:n===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));let n=this.streamTextContent(e);return new Promise(function(r,i){function s(){o.read().then(function({value:c,done:l}){if(l){r(a);return}Object.assign(a.styles,c.styles),a.items.push(...c.items),s()},i)}let o=n.getReader(),a={items:[],styles:Object.create(null)};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let n of this._intentStates.values())if(this._abortOperatorList({intentState:n,reason:new Error("Page was destroyed."),force:!0}),!n.opListReadCapability)for(let r of n.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),this.#t=!1,this.#r(),Promise.all(e)}cleanup(e=!1){this.#t=!0;let n=this.#n(!1);return e&&n&&(this._stats&&=new _display_utils.StatTimer),n}#n(e=!1){if(this.#r(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(let{renderTasks:n,operatorList:r}of this._intentStates.values())if(n.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#r(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,n){let r=this._intentStates.get(n);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(e))}_renderPageChunk(e,n){for(let r=0,i=e.length;r<i;r++)n.operatorList.fnArray.push(e.fnArray[r]),n.operatorList.argsArray.push(e.argsArray[r]);n.operatorList.lastChunk=e.lastChunk,n.operatorList.separateAnnots=e.separateAnnots;for(let r of n.renderTasks)r.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:n,annotationStorageSerializable:r}){let{map:i,transfers:s}=r,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:n,annotationStorage:i},s).getReader(),c=this._intentStates.get(n);c.streamReader=a;let l=()=>{a.read().then(({value:d,done:h})=>{if(h){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,c),l())},d=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(let h of c.renderTasks)h.operatorListChanged();this.#n(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(d);else if(c.opListReadCapability)c.opListReadCapability.reject(d);else throw d}})};l()}_abortOperatorList({intentState:e,reason:n,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(n instanceof _display_utils.RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;n.extraDelay>0&&n.extraDelay<1e3&&(i+=n.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:n,force:!0})},i);return}}if(e.streamReader.cancel(new _util.AbortException(n.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#e=new Set;#t=Promise.resolve();postMessage(e,n){let r={data:structuredClone(e,n?{transfer:n}:null)};this.#t.then(()=>{for(let i of this.#e)i.call(this,r)})}addEventListener(e,n){this.#e.add(n)}removeEventListener(e,n){this.#e.delete(n)}terminate(){this.#e.clear()}}exports.LoopbackPort=LoopbackPort;let PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof sp=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){let t=document?.currentScript?.src;t&&(PDFWorkerUtil.fallbackWorkerSrc=t.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(t,e){let n;try{if(n=new URL(t),!n.origin||n.origin==="null")return!1}catch{return!1}let r=new URL(e,n);return n.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(t){let e=`importScripts("${t}");`;return URL.createObjectURL(new Blob([e]))}}class PDFWorker{static#workerPorts;constructor({name:t=null,port:e=null,verbosity:n=(0,_util.getVerbosityLevel)()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,e){if(PDFWorker.#workerPorts?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new _message_handler.MessageHandler("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:t}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,t)||(t=PDFWorkerUtil.createCDNWrapper(new URL(t,window.location).href));let e=new Worker(t),n=new _message_handler.MessageHandler("main","worker",e),r=()=>{e.removeEventListener("error",i),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||r()};e.addEventListener("error",i),n.on("test",o=>{if(e.removeEventListener("error",i),this.destroyed){r();return}o?(this._messageHandler=n,this._port=e,this._webWorker=e,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),e.terminate())}),n.on("ready",o=>{if(e.removeEventListener("error",i),this.destroyed){r();return}try{s()}catch{this._setupFakeWorker()}});let s=()=>{let o=new Uint8Array;n.send("test",o,[o.buffer])};s();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let e=new LoopbackPort;this._port=e;let n=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(n+"_worker",n,e);t.setup(r,e);let i=new _message_handler.MessageHandler(n,n+"_worker",e);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let e=this.#workerPorts?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new PDFWorker(t)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){let loader=()=>X(this,null,function*(){let mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof sp=="function"){let worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#e=new Map;#t=new Map;#n=new Map;#r=null;constructor(e,n,r,i,s){this.messageHandler=e,this.loadingTask=n,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#a(e,n=null){let r=this.#e.get(e);if(r)return r;let i=this.messageHandler.sendWithPromise(e,n);return this.#e.set(e,i),i}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,n=_util.AnnotationMode.ENABLE,r=null,i=!1){let s=_util.RenderingIntentFlag.DISPLAY,o=_annotation_storage.SerializableEmpty;switch(e){case"any":s=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":s=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(n){case _util.AnnotationMode.DISABLE:s+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:s+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:s+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,o=(s&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${n}`)}return i&&(s+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:s,cacheKey:`${s}_${o.hash}`,annotationStorageSerializable:o}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));let e=[];for(let r of this.#t.values())e.push(r._destroy());this.#t.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let n=this.messageHandler.sendWithPromise("Terminate",null);return e.push(n),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:n}=this;e.on("GetReader",(r,i)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}(0,_util.assert)(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",r=>{let i=new _util.PromiseCapability,s=this._fullReader;return s.headersReady.then(()=>{(!s.isStreamingSupported||!s.isRangeSupported)&&(this._lastProgress&&n.onProgress?.(this._lastProgress),s.onProgress=o=>{n.onProgress?.({loaded:o.loaded,total:o.total})}),i.resolve({isStreamingSupported:s.isStreamingSupported,isRangeSupported:s.isRangeSupported,contentLength:s.contentLength})},i.reject),i.promise}),e.on("GetRangeReader",(r,i)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){i.close();return}(0,_util.assert)(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,n._capability.resolve(new PDFDocumentProxy(r,this))}),e.on("DocException",function(r){let i;switch(r.name){case"PasswordException":i=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":i=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}n._capability.reject(i)}),e.on("PasswordRequest",r=>{if(this.#r=new _util.PromiseCapability,n.onPassword){let i=s=>{s instanceof Error?this.#r.reject(s):this.#r.resolve({password:s})};try{n.onPassword(i,r.code)}catch(s){this.#r.reject(s)}}else this.#r.reject(new _util.PasswordException(r.message,r.code));return this.#r.promise}),e.on("DataLoaded",r=>{n.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;this.#t.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{if(!this.destroyed&&!this.commonObjs.has(r))switch(i){case"Font":let o=this._params;if("error"in s){let l=s.error;(0,_util.warn)(`Error during font loading: ${l}`),this.commonObjs.resolve(r,l);break}let a=o.pdfBug&&globalThis.FontInspector?.enabled?(l,d)=>globalThis.FontInspector.fontAdded(l,d):null,c=new _font_loader.FontFaceObject(s,{isEvalSupported:o.isEvalSupported,disableFontFace:o.disableFontFace,ignoreErrors:o.ignoreErrors,inspectFont:a});this.fontLoader.bind(c).catch(l=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!o.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(r,c)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${i}`)}}),e.on("obj",([r,i,s,o])=>{if(this.destroyed)return;let a=this.#t.get(i);if(!a.objs.has(r))switch(s){case"Image":if(a.objs.resolve(r,o),o){let c;if(o.bitmap){let{width:l,height:d}=o;c=l*d*4}else c=o.data?.length||0;c>_util.MAX_IMAGE_SIZE_TO_CACHE&&(a._maybeCleanupAfterRender=!0)}break;case"Pattern":a.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${s}`)}}),e.on("DocProgress",r=>{this.destroyed||n.onProgress?.({loaded:r.loaded,total:r.total})}),e.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfers:n}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},n).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));let n=e-1,r=this.#n.get(n);if(r)return r;let i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");let o=new PDFPageProxy(n,s,this,this._params.pdfBug);return this.#t.set(n,o),o});return this.#n.set(n,i),i}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,n){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:n})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let e="GetMetadata",n=this.#e.get(e);if(n)return n;let r=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){return X(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let n of this.#t.values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0)}})}get loadingParams(){let{disableAutoFetch:e,enableXfa:n}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e,enableXfa:n})}}class PDFObjects{#e=Object.create(null);#t(e){return this.#e[e]||={capability:new _util.PromiseCapability,data:null}}get(e,n=null){if(n){let i=this.#t(e);return i.capability.promise.then(()=>n(i.data)),null}let r=this.#e[e];if(!r?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){return this.#e[e]?.capability.settled||!1}resolve(e,n=null){let r=this.#t(e);r.data=n,r.capability.resolve()}clear(){for(let e in this.#e){let{data:n}=this.#e[e];n?.bitmap?.close()}this.#e=Object.create(null)}}class RenderTask{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;let{annotationCanvasMap:n}=this.#e;return e.form||e.canvas&&n?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#e=new WeakSet;constructor({callback:e,params:n,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:l,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:f=null}){this.callback=e,this.params=n,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=l,this._pdfBug=h,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:n}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:r,viewport:i,transform:s,background:o}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:n},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,n=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,n))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return X(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback())))})}}let version="3.11.174";exports.version=version;let build="ce8716743";exports.build=build}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var r=n(1),i=n(4),s=n(8);let o=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=o;class a{#e=!1;#t=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(d,h){let f=this.#t.get(d);return f===void 0?h:Object.assign(h,f)}getRawValue(d){return this.#t.get(d)}remove(d){if(this.#t.delete(d),this.#t.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let h of this.#t.values())if(h instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(d,h){let f=this.#t.get(d),p=!1;if(f!==void 0)for(let[m,g]of Object.entries(h))f[m]!==g&&(p=!0,f[m]=g);else p=!0,this.#t.set(d,h);p&&this.#n(),h instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(h.constructor._type)}has(d){return this.#t.has(d)}getAll(){return this.#t.size>0?(0,r.objectFromMap)(this.#t):null}setAll(d){for(let[h,f]of Object.entries(d))this.setValue(h,f)}get size(){return this.#t.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new c(this)}get serializable(){if(this.#t.size===0)return o;let d=new Map,h=new s.MurmurHash3_64,f=[],p=Object.create(null),m=!1;for(let[g,v]of this.#t){let E=v instanceof i.AnnotationEditor?v.serialize(!1,p):v;E&&(d.set(g,E),h.update(`${g}:${JSON.stringify(E)}`),m||=!!E.bitmap)}if(m)for(let g of d.values())g.bitmap&&f.push(g.bitmap);return d.size>0?{map:d,hash:h.hexdigest(),transfers:f}:o}}e.AnnotationStorage=a;class c extends a{#e;constructor(d){super();let{map:h,hash:f,transfers:p}=d.serializable,m=structuredClone(h,p?{transfer:p}:null);this.#e={map:m,hash:f,transfers:p}}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}}e.PrintAnnotationStorage=c}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var r=n(5),i=n(1),s=n(6);class o{#e="";#t=!1;#n=null;#r=null;#a=null;#o=!1;#s=null;#c=this.focusin.bind(this);#l=this.focusout.bind(this);#i=!1;#f=!1;#d=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#h=!1;#p=o._zIndex++;static _borderLineWidth=-1;static _colorManager=new r.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(l){this.constructor===o&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=l.parent,this.id=l.id,this.width=this.height=null,this.pageIndex=l.parent.pageIndex,this.name=l.name,this.div=null,this._uiManager=l.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=l.isCentered,this._structTreeParentId=null;let{rotation:d,rawDims:{pageWidth:h,pageHeight:f,pageX:p,pageY:m}}=this.parent.viewport;this.rotation=d,this.pageRotation=(360+d-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[h,f],this.pageTranslation=[p,m];let[g,v]=this.parentDimensions;this.x=l.x/g,this.y=l.y/v,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(l){let d=new a({id:l.parent.getNextId(),parent:l.parent,uiManager:l._uiManager});d.annotationElementId=l.annotationElementId,d.deleted=!0,d._uiManager.addToAnnotationStorage(d)}static initialize(l,d=null){if(o._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(f=>[f,l.get(f)])),d?.strings)for(let f of d.strings)o._l10nPromise.set(f,l.get(f));if(o._borderLineWidth!==-1)return;let h=getComputedStyle(document.documentElement);o._borderLineWidth=parseFloat(h.getPropertyValue("--outline-width"))||0}static updateDefaultParams(l,d){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(l){return!1}static paste(l,d){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#h}set _isDraggable(l){this.#h=l,this.div?.classList.toggle("draggable",l)}center(){let[l,d]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*d/(l*2),this.y+=this.width*l/(d*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*d/(l*2),this.y-=this.width*l/(d*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(l){this._uiManager.addCommands(l)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(l){l!==null&&(this.pageIndex=l.pageIndex,this.pageDimensions=l.pageDimensions),this.parent=l}focusin(l){this._focusEventsAllowed&&(this.#i?this.#i=!1:this.parent.setSelected(this))}focusout(l){!this._focusEventsAllowed||!this.isAttachedToDOM||l.relatedTarget?.closest(`#${this.id}`)||(l.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(l,d,h,f){let[p,m]=this.parentDimensions;[h,f]=this.screenToPageTranslation(h,f),this.x=(l+h)/p,this.y=(d+f)/m,this.fixAndSetPosition()}#y([l,d],h,f){[h,f]=this.screenToPageTranslation(h,f),this.x+=h/l,this.y+=f/d,this.fixAndSetPosition()}translate(l,d){this.#y(this.parentDimensions,l,d)}translateInPage(l,d){this.#y(this.pageDimensions,l,d),this.div.scrollIntoView({block:"nearest"})}drag(l,d){let[h,f]=this.parentDimensions;if(this.x+=l/h,this.y+=d/f,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:E,y:A}=this.div.getBoundingClientRect();this.parent.findNewParent(this,E,A)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:p,y:m}=this,[g,v]=this.#m();p+=g,m+=v,this.div.style.left=`${(100*p).toFixed(2)}%`,this.div.style.top=`${(100*m).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){let[l,d]=this.parentDimensions,{_borderLineWidth:h}=o,f=h/l,p=h/d;switch(this.rotation){case 90:return[-f,p];case 180:return[f,p];case 270:return[f,-p];default:return[-f,-p]}}fixAndSetPosition(){let[l,d]=this.pageDimensions,{x:h,y:f,width:p,height:m}=this;switch(p*=l,m*=d,h*=l,f*=d,this.rotation){case 0:h=Math.max(0,Math.min(l-p,h)),f=Math.max(0,Math.min(d-m,f));break;case 90:h=Math.max(0,Math.min(l-m,h)),f=Math.min(d,Math.max(p,f));break;case 180:h=Math.min(l,Math.max(p,h)),f=Math.min(d,Math.max(m,f));break;case 270:h=Math.min(l,Math.max(m,h)),f=Math.max(0,Math.min(d-p,f));break}this.x=h/=l,this.y=f/=d;let[g,v]=this.#m();h+=g,f+=v;let{style:E}=this.div;E.left=`${(100*h).toFixed(2)}%`,E.top=`${(100*f).toFixed(2)}%`,this.moveInDOM()}static#g(l,d,h){switch(h){case 90:return[d,-l];case 180:return[-l,-d];case 270:return[-d,l];default:return[l,d]}}screenToPageTranslation(l,d){return o.#g(l,d,this.parentRotation)}pageTranslationToScreen(l,d){return o.#g(l,d,360-this.parentRotation)}#u(l){switch(l){case 90:{let[d,h]=this.pageDimensions;return[0,-d/h,h/d,0]}case 180:return[-1,0,0,-1];case 270:{let[d,h]=this.pageDimensions;return[0,d/h,-h/d,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:l,pageDimensions:[d,h]}=this,f=d*l,p=h*l;return i.FeatureTest.isCSSRoundSupported?[Math.round(f),Math.round(p)]:[f,p]}setDims(l,d){let[h,f]=this.parentDimensions;this.div.style.width=`${(100*l/h).toFixed(2)}%`,this.#o||(this.div.style.height=`${(100*d/f).toFixed(2)}%`),this.#n?.classList.toggle("small",l<o.SMALL_EDITOR_SIZE||d<o.SMALL_EDITOR_SIZE)}fixDims(){let{style:l}=this.div,{height:d,width:h}=l,f=h.endsWith("%"),p=!this.#o&&d.endsWith("%");if(f&&p)return;let[m,g]=this.parentDimensions;f||(l.width=`${(100*parseFloat(h)/m).toFixed(2)}%`),!this.#o&&!p&&(l.height=`${(100*parseFloat(d)/g).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#v(){if(this.#s)return;this.#s=document.createElement("div"),this.#s.classList.add("resizers");let l=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||l.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(let d of l){let h=document.createElement("div");this.#s.append(h),h.classList.add("resizer",d),h.addEventListener("pointerdown",this.#I.bind(this,d)),h.addEventListener("contextmenu",s.noContextMenu)}this.div.prepend(this.#s)}#I(l,d){d.preventDefault();let{isMac:h}=i.FeatureTest.platform;if(d.button!==0||d.ctrlKey&&h)return;let f=this.#w.bind(this,l),p=this._isDraggable;this._isDraggable=!1;let m={passive:!0,capture:!0};window.addEventListener("pointermove",f,m);let g=this.x,v=this.y,E=this.width,A=this.height,O=this.parent.div.style.cursor,M=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(d.target).cursor;let C=()=>{this._isDraggable=p,window.removeEventListener("pointerup",C),window.removeEventListener("blur",C),window.removeEventListener("pointermove",f,m),this.parent.div.style.cursor=O,this.div.style.cursor=M;let P=this.x,D=this.y,S=this.width,T=this.height;P===g&&D===v&&S===E&&T===A||this.addCommands({cmd:()=>{this.width=S,this.height=T,this.x=P,this.y=D;let[F,L]=this.parentDimensions;this.setDims(F*S,L*T),this.fixAndSetPosition()},undo:()=>{this.width=E,this.height=A,this.x=g,this.y=v;let[F,L]=this.parentDimensions;this.setDims(F*E,L*A),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",C),window.addEventListener("blur",C)}#w(l,d){let[h,f]=this.parentDimensions,p=this.x,m=this.y,g=this.width,v=this.height,E=o.MIN_SIZE/h,A=o.MIN_SIZE/f,O=j=>Math.round(j*1e4)/1e4,M=this.#u(this.rotation),C=(j,_)=>[M[0]*j+M[2]*_,M[1]*j+M[3]*_],P=this.#u(360-this.rotation),D=(j,_)=>[P[0]*j+P[2]*_,P[1]*j+P[3]*_],S,T,F=!1,L=!1;switch(l){case"topLeft":F=!0,S=(j,_)=>[0,0],T=(j,_)=>[j,_];break;case"topMiddle":S=(j,_)=>[j/2,0],T=(j,_)=>[j/2,_];break;case"topRight":F=!0,S=(j,_)=>[j,0],T=(j,_)=>[0,_];break;case"middleRight":L=!0,S=(j,_)=>[j,_/2],T=(j,_)=>[0,_/2];break;case"bottomRight":F=!0,S=(j,_)=>[j,_],T=(j,_)=>[0,0];break;case"bottomMiddle":S=(j,_)=>[j/2,_],T=(j,_)=>[j/2,0];break;case"bottomLeft":F=!0,S=(j,_)=>[0,_],T=(j,_)=>[j,0];break;case"middleLeft":L=!0,S=(j,_)=>[0,_/2],T=(j,_)=>[j,_/2];break}let W=S(g,v),U=T(g,v),ae=C(...U),pe=O(p+ae[0]),oe=O(m+ae[1]),q=1,x=1,[w,I]=this.screenToPageTranslation(d.movementX,d.movementY);if([w,I]=D(w/h,I/f),F){let j=Math.hypot(g,v);q=x=Math.max(Math.min(Math.hypot(U[0]-W[0]-w,U[1]-W[1]-I)/j,1/g,1/v),E/g,A/v)}else L?q=Math.max(E,Math.min(1,Math.abs(U[0]-W[0]-w)))/g:x=Math.max(A,Math.min(1,Math.abs(U[1]-W[1]-I)))/v;let k=O(g*q),H=O(v*x);ae=C(...T(k,H));let $=pe-ae[0],G=oe-ae[1];this.width=k,this.height=H,this.x=$,this.y=G,this.setDims(h*k,f*H),this.fixAndSetPosition()}addAltTextButton(){return X(this,null,function*(){if(this.#n)return;let l=this.#n=document.createElement("button");l.className="altText";let d=yield o._l10nPromise.get("editor_alt_text_button_label");l.textContent=d,l.setAttribute("aria-label",d),l.tabIndex="0",l.addEventListener("contextmenu",s.noContextMenu),l.addEventListener("pointerdown",h=>h.stopPropagation()),l.addEventListener("click",h=>{h.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),l.addEventListener("keydown",h=>{h.target===l&&h.key==="Enter"&&(h.preventDefault(),this._uiManager.editAltText(this))}),this.#S(),this.div.append(l),o.SMALL_EDITOR_SIZE||(o.SMALL_EDITOR_SIZE=Math.min(128,Math.round(l.getBoundingClientRect().width*1.4)))})}#S(){return X(this,null,function*(){let l=this.#n;if(!l)return;if(!this.#e&&!this.#t){l.classList.remove("done"),this.#r?.remove();return}o._l10nPromise.get("editor_alt_text_edit_button_label").then(h=>{l.setAttribute("aria-label",h)});let d=this.#r;if(!d){this.#r=d=document.createElement("span"),d.className="tooltip",d.setAttribute("role","tooltip");let h=d.id=`alt-text-tooltip-${this.id}`;l.setAttribute("aria-describedby",h);let f=100;l.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},f)}),l.addEventListener("mouseleave",()=>{clearTimeout(this.#a),this.#a=null,this.#r?.classList.remove("show")})}l.classList.add("done"),d.innerText=this.#t?yield o._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#e,d.parentNode||l.append(d)})}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#e,decorative:this.#t}}set altTextData({altText:l,decorative:d}){this.#e===l&&this.#t===d||(this.#e=l,this.#t=d,this.#S())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#c),this.div.addEventListener("focusout",this.#l);let[l,d]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*d/l).toFixed(2)}%`,this.div.style.maxHeight=`${(100*l/d).toFixed(2)}%`);let[h,f]=this.getInitialTranslation();return this.translate(h,f),(0,r.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(l){let{isMac:d}=i.FeatureTest.platform;if(l.button!==0||l.ctrlKey&&d){l.preventDefault();return}this.#i=!0,this.#D(l)}#D(l){if(!this._isDraggable)return;let d=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let h,f;d&&(h={passive:!0,capture:!0},f=m=>{let[g,v]=this.screenToPageTranslation(m.movementX,m.movementY);this._uiManager.dragSelectedEditors(g,v)},window.addEventListener("pointermove",f,h));let p=()=>{if(window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),d&&window.removeEventListener("pointermove",f,h),this.#i=!1,!this._uiManager.endDragSession()){let{isMac:m}=i.FeatureTest.platform;l.ctrlKey&&!m||l.shiftKey||l.metaKey&&m?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(l,d,h){l.changeParent(this),this.x=d,this.y=h,this.fixAndSetPosition()}getRect(l,d){let h=this.parentScale,[f,p]=this.pageDimensions,[m,g]=this.pageTranslation,v=l/h,E=d/h,A=this.x*f,O=this.y*p,M=this.width*f,C=this.height*p;switch(this.rotation){case 0:return[A+v+m,p-O-E-C+g,A+v+M+m,p-O-E+g];case 90:return[A+E+m,p-O+v+g,A+E+C+m,p-O+v+M+g];case 180:return[A-v-M+m,p-O+E+g,A-v+m,p-O+E+C+g];case 270:return[A-E-C+m,p-O-v-M+g,A-E+m,p-O-v+g];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(l,d){let[h,f,p,m]=l,g=p-h,v=m-f;switch(this.rotation){case 0:return[h,d-m,g,v];case 90:return[h,d-f,v,g];case 180:return[p,d-f,g,v];case 270:return[p,d-m,v,g];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#d=!0}disableEditMode(){this.#d=!1}isInEditMode(){return this.#d}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#c),this.div?.addEventListener("focusout",this.#l)}serialize(l=!1,d=null){(0,i.unreachable)("An editor must be serializable")}static deserialize(l,d,h){let f=new this.prototype.constructor({parent:d,id:d.getNextId(),uiManager:h});f.rotation=l.rotation;let[p,m]=f.pageDimensions,[g,v,E,A]=f.getRectInCurrentCoords(l.rect,m);return f.x=g/p,f.y=v/m,f.width=E/p,f.height=A/m,f}remove(){this.div.removeEventListener("focusin",this.#c),this.div.removeEventListener("focusout",this.#l),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#n?.remove(),this.#n=null,this.#r=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#v(),this.#s.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#s?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(l,d){}disableEditing(){this.#n&&(this.#n.hidden=!0)}enableEditing(){this.#n&&(this.#n.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#f}set isEditing(l){this.#f=l,this.parent&&(l?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(l,d){this.#o=!0;let h=l/d,{style:f}=this.div;f.aspectRatio=h,f.height="auto"}static get MIN_SIZE(){return 16}}e.AnnotationEditor=o;class a extends o{constructor(l){super(l),this.annotationElementId=l.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=s,e.opacityToHex=o;var r=n(1),i=n(6);function s(p,m,g){for(let v of g)m.addEventListener(v,p[v].bind(p))}function o(p){return Math.round(Math.min(255,Math.max(1,255*p))).toString(16).padStart(2,"0")}class a{#e=0;getId(){return`${r.AnnotationEditorPrefix}${this.#e++}`}}class c{#e=(0,r.getUuid)();#t=0;#n=null;static get _isSVGFittingCanvas(){let m='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',v=new OffscreenCanvas(1,3).getContext("2d"),E=new Image;E.src=m;let A=E.decode().then(()=>(v.drawImage(E,0,0,1,1,0,0,1,3),new Uint32Array(v.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,r.shadow)(this,"_isSVGFittingCanvas",A)}#r(m,g){return X(this,null,function*(){this.#n||=new Map;let v=this.#n.get(m);if(v===null)return null;if(v?.bitmap)return v.refCounter+=1,v;try{v||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let E;if(typeof g=="string"){v.url=g;let A=yield fetch(g);if(!A.ok)throw new Error(A.statusText);E=yield A.blob()}else E=v.file=g;if(E.type==="image/svg+xml"){let A=c._isSVGFittingCanvas,O=new FileReader,M=new Image,C=new Promise((P,D)=>{M.onload=()=>{v.bitmap=M,v.isSvg=!0,P()},O.onload=()=>X(this,null,function*(){let S=v.svgUrl=O.result;M.src=(yield A)?`${S}#svgView(preserveAspectRatio(none))`:S}),M.onerror=O.onerror=D});O.readAsDataURL(E),yield C}else v.bitmap=yield createImageBitmap(E);v.refCounter=1}catch(E){console.error(E),v=null}return this.#n.set(m,v),v&&this.#n.set(v.id,v),v})}getFromFile(m){return X(this,null,function*(){let{lastModified:g,name:v,size:E,type:A}=m;return this.#r(`${g}_${v}_${E}_${A}`,m)})}getFromUrl(m){return X(this,null,function*(){return this.#r(m,m)})}getFromId(m){return X(this,null,function*(){this.#n||=new Map;let g=this.#n.get(m);return g?g.bitmap?(g.refCounter+=1,g):g.file?this.getFromFile(g.file):this.getFromUrl(g.url):null})}getSvgUrl(m){let g=this.#n.get(m);return g?.isSvg?g.svgUrl:null}deleteId(m){this.#n||=new Map;let g=this.#n.get(m);g&&(g.refCounter-=1,g.refCounter===0&&(g.bitmap=null))}isValidId(m){return m.startsWith(`image_${this.#e}_`)}}class l{#e=[];#t=!1;#n;#r=-1;constructor(m=128){this.#n=m}add({cmd:m,undo:g,mustExec:v,type:E=NaN,overwriteIfSameType:A=!1,keepUndo:O=!1}){if(v&&m(),this.#t)return;let M={cmd:m,undo:g,type:E};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(M);return}if(A&&this.#e[this.#r].type===E){O&&(M.undo=this.#e[this.#r].undo),this.#e[this.#r]=M;return}let C=this.#r+1;C===this.#n?this.#e.splice(0,1):(this.#r=C,C<this.#e.length&&this.#e.splice(C)),this.#e.push(M)}undo(){this.#r!==-1&&(this.#t=!0,this.#e[this.#r].undo(),this.#t=!1,this.#r-=1)}redo(){this.#r<this.#e.length-1&&(this.#r+=1,this.#t=!0,this.#e[this.#r].cmd(),this.#t=!1)}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}destroy(){this.#e=null}}e.CommandManager=l;class d{constructor(m){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:g}=r.FeatureTest.platform;for(let[v,E,A={}]of m)for(let O of v){let M=O.startsWith("mac+");g&&M?(this.callbacks.set(O.slice(4),{callback:E,options:A}),this.allKeys.add(O.split("+").at(-1))):!g&&!M&&(this.callbacks.set(O,{callback:E,options:A}),this.allKeys.add(O.split("+").at(-1)))}}#e(m){m.altKey&&this.buffer.push("alt"),m.ctrlKey&&this.buffer.push("ctrl"),m.metaKey&&this.buffer.push("meta"),m.shiftKey&&this.buffer.push("shift"),this.buffer.push(m.key);let g=this.buffer.join("+");return this.buffer.length=0,g}exec(m,g){if(!this.allKeys.has(g.key))return;let v=this.callbacks.get(this.#e(g));if(!v)return;let{callback:E,options:{bubbles:A=!1,args:O=[],checker:M=null}}=v;M&&!M(m,g)||(E.bind(m,...O)(),A||(g.stopPropagation(),g.preventDefault()))}}e.KeyboardManager=d;class h{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let m=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(m),(0,r.shadow)(this,"_colors",m)}convert(m){let g=(0,i.getRGB)(m);if(!window.matchMedia("(forced-colors: active)").matches)return g;for(let[v,E]of this._colors)if(E.every((A,O)=>A===g[O]))return h._colorsMapping.get(v);return g}getHexCode(m){let g=this._colors.get(m);return g?r.Util.makeHexColor(...g):m}}e.ColorManager=h;let f=(()=>{class p{#e=null;#t=new Map;#n=new Map;#r=null;#a=null;#o=new l;#s=0;#c=new Set;#l=null;#i=null;#f=new Set;#d=null;#h=new a;#p=!1;#y=!1;#m=null;#g=r.AnnotationEditorType.NONE;#u=new Set;#v=null;#I=this.blur.bind(this);#w=this.focus.bind(this);#S=this.copy.bind(this);#D=this.cut.bind(this);#N=this.paste.bind(this);#O=this.keydown.bind(this);#F=this.onEditingAction.bind(this);#_=this.onPageChanging.bind(this);#k=this.onScaleChanging.bind(this);#R=this.onRotationChanging.bind(this);#P={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#E=[0,0];#C=null;#T=null;#L=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let g=p.prototype,v=O=>{let{activeElement:M}=document;return M&&O.#T.contains(M)&&O.hasSomethingToControl()},E=this.TRANSLATE_SMALL,A=this.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new d([[["ctrl+a","mac+meta+a"],g.selectAll],[["ctrl+z","mac+meta+z"],g.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],g.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],g.delete],[["Escape","mac+Escape"],g.unselectAll],[["ArrowLeft","mac+ArrowLeft"],g.translateSelectedEditors,{args:[-E,0],checker:v}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],g.translateSelectedEditors,{args:[-A,0],checker:v}],[["ArrowRight","mac+ArrowRight"],g.translateSelectedEditors,{args:[E,0],checker:v}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],g.translateSelectedEditors,{args:[A,0],checker:v}],[["ArrowUp","mac+ArrowUp"],g.translateSelectedEditors,{args:[0,-E],checker:v}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],g.translateSelectedEditors,{args:[0,-A],checker:v}],[["ArrowDown","mac+ArrowDown"],g.translateSelectedEditors,{args:[0,E],checker:v}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],g.translateSelectedEditors,{args:[0,A],checker:v}]]))}constructor(g,v,E,A,O,M){this.#T=g,this.#L=v,this.#r=E,this._eventBus=A,this._eventBus._on("editingaction",this.#F),this._eventBus._on("pagechanging",this.#_),this._eventBus._on("scalechanging",this.#k),this._eventBus._on("rotationchanging",this.#R),this.#a=O.annotationStorage,this.#d=O.filterFactory,this.#v=M,this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#x(),this.#U(),this._eventBus._off("editingaction",this.#F),this._eventBus._off("pagechanging",this.#_),this._eventBus._off("scalechanging",this.#k),this._eventBus._off("rotationchanging",this.#R);for(let g of this.#n.values())g.destroy();this.#n.clear(),this.#t.clear(),this.#f.clear(),this.#e=null,this.#u.clear(),this.#o.destroy(),this.#r.destroy()}get hcmFilter(){return(0,r.shadow)(this,"hcmFilter",this.#v?this.#d.addHCMFilter(this.#v.foreground,this.#v.background):"none")}get direction(){return(0,r.shadow)(this,"direction",getComputedStyle(this.#T).direction)}editAltText(g){this.#r?.editAltText(this,g)}onPageChanging({pageNumber:g}){this.#s=g-1}focusMainContainer(){this.#T.focus()}findParent(g,v){for(let E of this.#n.values()){let{x:A,y:O,width:M,height:C}=E.div.getBoundingClientRect();if(g>=A&&g<=A+M&&v>=O&&v<=O+C)return E}return null}disableUserSelect(g=!1){this.#L.classList.toggle("noUserSelect",g)}addShouldRescale(g){this.#f.add(g)}removeShouldRescale(g){this.#f.delete(g)}onScaleChanging({scale:g}){this.commitOrRemove(),this.viewParameters.realScale=g*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(let v of this.#f)v.onScaleChanging()}onRotationChanging({pagesRotation:g}){this.commitOrRemove(),this.viewParameters.rotation=g}addToAnnotationStorage(g){!g.isEmpty()&&this.#a&&!this.#a.has(g.id)&&this.#a.setValue(g.id,g)}#V(){window.addEventListener("focus",this.#w),window.addEventListener("blur",this.#I)}#U(){window.removeEventListener("focus",this.#w),window.removeEventListener("blur",this.#I)}blur(){if(!this.hasSelection)return;let{activeElement:g}=document;for(let v of this.#u)if(v.div.contains(g)){this.#m=[v,g],v._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;let[g,v]=this.#m;this.#m=null,v.addEventListener("focusin",()=>{g._focusEventsAllowed=!0},{once:!0}),v.focus()}#j(){window.addEventListener("keydown",this.#O,{capture:!0})}#x(){window.removeEventListener("keydown",this.#O,{capture:!0})}#M(){document.addEventListener("copy",this.#S),document.addEventListener("cut",this.#D),document.addEventListener("paste",this.#N)}#A(){document.removeEventListener("copy",this.#S),document.removeEventListener("cut",this.#D),document.removeEventListener("paste",this.#N)}addEditListeners(){this.#j(),this.#M()}removeEditListeners(){this.#x(),this.#A()}copy(g){if(g.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;let v=[];for(let E of this.#u){let A=E.serialize(!0);A&&v.push(A)}v.length!==0&&g.clipboardData.setData("application/pdfjs",JSON.stringify(v))}cut(g){this.copy(g),this.delete()}paste(g){g.preventDefault();let{clipboardData:v}=g;for(let O of v.items)for(let M of this.#i)if(M.isHandlingMimeForPasting(O.type)){M.paste(O,this.currentLayer);return}let E=v.getData("application/pdfjs");if(!E)return;try{E=JSON.parse(E)}catch(O){(0,r.warn)(`paste: "${O.message}".`);return}if(!Array.isArray(E))return;this.unselectAll();let A=this.currentLayer;try{let O=[];for(let P of E){let D=A.deserialize(P);if(!D)return;O.push(D)}let M=()=>{for(let P of O)this.#H(P);this.#z(O)},C=()=>{for(let P of O)P.remove()};this.addCommands({cmd:M,undo:C,mustExec:!0})}catch(O){(0,r.warn)(`paste: "${O.message}".`)}}keydown(g){this.getActive()?.shouldGetKeyboardEvents()||p._keyboardManager.exec(this,g)}onEditingAction(g){["undo","redo","delete","selectAll"].includes(g.name)&&this[g.name]()}#b(g){Object.entries(g).some(([E,A])=>this.#P[E]!==A)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#P,g)})}#B(g){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:g})}setEditingState(g){g?(this.#V(),this.#j(),this.#M(),this.#b({isEditing:this.#g!==r.AnnotationEditorType.NONE,isEmpty:this.#$(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#U(),this.#x(),this.#A(),this.#b({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(g){if(!this.#i){this.#i=g;for(let v of this.#i)this.#B(v.defaultPropertiesToUpdate)}}getId(){return this.#h.getId()}get currentLayer(){return this.#n.get(this.#s)}getLayer(g){return this.#n.get(g)}get currentPageIndex(){return this.#s}addLayer(g){this.#n.set(g.pageIndex,g),this.#p?g.enable():g.disable()}removeLayer(g){this.#n.delete(g.pageIndex)}updateMode(g,v=null){if(this.#g!==g){if(this.#g=g,g===r.AnnotationEditorType.NONE){this.setEditingState(!1),this.#W();return}this.setEditingState(!0),this.#q(),this.unselectAll();for(let E of this.#n.values())E.updateMode(g);if(v){for(let E of this.#t.values())if(E.annotationElementId===v){this.setSelected(E),E.enterInEditMode();break}}}}updateToolbar(g){g!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:g})}updateParams(g,v){if(this.#i){if(g===r.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(g);return}for(let E of this.#u)E.updateParams(g,v);for(let E of this.#i)E.updateDefaultParams(g,v)}}enableWaiting(g=!1){if(this.#y!==g){this.#y=g;for(let v of this.#n.values())g?v.disableClick():v.enableClick(),v.div.classList.toggle("waiting",g)}}#q(){if(!this.#p){this.#p=!0;for(let g of this.#n.values())g.enable()}}#W(){if(this.unselectAll(),this.#p){this.#p=!1;for(let g of this.#n.values())g.disable()}}getEditors(g){let v=[];for(let E of this.#t.values())E.pageIndex===g&&v.push(E);return v}getEditor(g){return this.#t.get(g)}addEditor(g){this.#t.set(g.id,g)}removeEditor(g){this.#t.delete(g.id),this.unselect(g),(!g.annotationElementId||!this.#c.has(g.annotationElementId))&&this.#a?.remove(g.id)}addDeletedAnnotationElement(g){this.#c.add(g.annotationElementId),g.deleted=!0}isDeletedAnnotationElement(g){return this.#c.has(g)}removeDeletedAnnotationElement(g){this.#c.delete(g.annotationElementId),g.deleted=!1}#H(g){let v=this.#n.get(g.pageIndex);v?v.addOrRebuild(g):this.addEditor(g)}setActiveEditor(g){this.#e!==g&&(this.#e=g,g&&this.#B(g.propertiesToUpdate))}toggleSelected(g){if(this.#u.has(g)){this.#u.delete(g),g.unselect(),this.#b({hasSelectedEditor:this.hasSelection});return}this.#u.add(g),g.select(),this.#B(g.propertiesToUpdate),this.#b({hasSelectedEditor:!0})}setSelected(g){for(let v of this.#u)v!==g&&v.unselect();this.#u.clear(),this.#u.add(g),g.select(),this.#B(g.propertiesToUpdate),this.#b({hasSelectedEditor:!0})}isSelected(g){return this.#u.has(g)}unselect(g){g.unselect(),this.#u.delete(g),this.#b({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#u.size!==0}undo(){this.#o.undo(),this.#b({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#$()})}redo(){this.#o.redo(),this.#b({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#$()})}addCommands(g){this.#o.add(g),this.#b({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#$()})}#$(){if(this.#t.size===0)return!0;if(this.#t.size===1)for(let g of this.#t.values())return g.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let g=[...this.#u],v=()=>{for(let A of g)A.remove()},E=()=>{for(let A of g)this.#H(A)};this.addCommands({cmd:v,undo:E,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#z(g){this.#u.clear();for(let v of g)v.isEmpty()||(this.#u.add(v),v.select());this.#b({hasSelectedEditor:!0})}selectAll(){for(let g of this.#u)g.commit();this.#z(this.#t.values())}unselectAll(){if(this.#e){this.#e.commitOrRemove();return}if(this.hasSelection){for(let g of this.#u)g.unselect();this.#u.clear(),this.#b({hasSelectedEditor:!1})}}translateSelectedEditors(g,v,E=!1){if(E||this.commitOrRemove(),!this.hasSelection)return;this.#E[0]+=g,this.#E[1]+=v;let[A,O]=this.#E,M=[...this.#u],C=1e3;this.#C&&clearTimeout(this.#C),this.#C=setTimeout(()=>{this.#C=null,this.#E[0]=this.#E[1]=0,this.addCommands({cmd:()=>{for(let P of M)this.#t.has(P.id)&&P.translateInPage(A,O)},undo:()=>{for(let P of M)this.#t.has(P.id)&&P.translateInPage(-A,-O)},mustExec:!1})},C);for(let P of M)P.translateInPage(g,v)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#l=new Map;for(let g of this.#u)this.#l.set(g,{savedX:g.x,savedY:g.y,savedPageIndex:g.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#l)return!1;this.disableUserSelect(!1);let g=this.#l;this.#l=null;let v=!1;for(let[{x:A,y:O,pageIndex:M},C]of g)C.newX=A,C.newY=O,C.newPageIndex=M,v||=A!==C.savedX||O!==C.savedY||M!==C.savedPageIndex;if(!v)return!1;let E=(A,O,M,C)=>{if(this.#t.has(A.id)){let P=this.#n.get(C);P?A._setParentAndPosition(P,O,M):(A.pageIndex=C,A.x=O,A.y=M)}};return this.addCommands({cmd:()=>{for(let[A,{newX:O,newY:M,newPageIndex:C}]of g)E(A,O,M,C)},undo:()=>{for(let[A,{savedX:O,savedY:M,savedPageIndex:C}]of g)E(A,O,M,C)},mustExec:!0}),!0}dragSelectedEditors(g,v){if(this.#l)for(let E of this.#l.keys())E.drag(g,v)}rebuild(g){if(g.parent===null){let v=this.getLayer(g.pageIndex);v?(v.changeParent(g),v.addOrRebuild(g)):(this.addEditor(g),this.addToAnnotationStorage(g),g.rebuild())}else g.parent.addOrRebuild(g)}isActive(g){return this.#e===g}getActive(){return this.#e}getMode(){return this.#g}get imageManager(){return(0,r.shadow)(this,"imageManager",new c)}}return p})();e.AnnotationEditorUIManager=f}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=D,e.getColorValues=W,e.getCurrentTransform=U,e.getCurrentTransformInverse=ae,e.getFilenameFromUrl=E,e.getPdfFilenameFromUrl=A,e.getRGB=L,e.getXfaPageViewport=F,e.isDataScheme=g,e.isPdfFile=v,e.isValidFetchUrl=M,e.loadScript=P,e.noContextMenu=C,e.setLayerDimensions=pe;var r=n(7),i=n(1);let s="http://www.w3.org/2000/svg";class o{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}e.PixelsPerInch=o;class a extends r.BaseFilterFactory{#e;#t;#n;#r;#a;#o;#s;#c;#l;#i;#f=0;constructor({docId:q,ownerDocument:x=globalThis.document}={}){super(),this.#n=q,this.#r=x}get#d(){return this.#e||=new Map}get#h(){if(!this.#t){let q=this.#r.createElement("div"),{style:x}=q;x.visibility="hidden",x.contain="strict",x.width=x.height=0,x.position="absolute",x.top=x.left=0,x.zIndex=-1;let w=this.#r.createElementNS(s,"svg");w.setAttribute("width",0),w.setAttribute("height",0),this.#t=this.#r.createElementNS(s,"defs"),q.append(w),w.append(this.#t),this.#r.body.append(q)}return this.#t}addFilter(q){if(!q)return"none";let x=this.#d.get(q);if(x)return x;let w,I,k,H;if(q.length===1){let _=q[0],R=new Array(256);for(let N=0;N<256;N++)R[N]=_[N]/255;H=w=I=k=R.join(",")}else{let[_,R,N]=q,B=new Array(256),z=new Array(256),K=new Array(256);for(let Y=0;Y<256;Y++)B[Y]=_[Y]/255,z[Y]=R[Y]/255,K[Y]=N[Y]/255;w=B.join(","),I=z.join(","),k=K.join(","),H=`${w}${I}${k}`}if(x=this.#d.get(H),x)return this.#d.set(q,x),x;let $=`g_${this.#n}_transfer_map_${this.#f++}`,G=`url(#${$})`;this.#d.set(q,G),this.#d.set(H,G);let j=this.#y($);return this.#g(w,I,k,j),G}addHCMFilter(q,x){let w=`${q}-${x}`;if(this.#o===w)return this.#s;if(this.#o=w,this.#s="none",this.#a?.remove(),!q||!x)return this.#s;let I=this.#u(q);q=i.Util.makeHexColor(...I);let k=this.#u(x);if(x=i.Util.makeHexColor(...k),this.#h.style.color="",q==="#000000"&&x==="#ffffff"||q===x)return this.#s;let H=new Array(256);for(let R=0;R<=255;R++){let N=R/255;H[R]=N<=.03928?N/12.92:((N+.055)/1.055)**2.4}let $=H.join(","),G=`g_${this.#n}_hcm_filter`,j=this.#c=this.#y(G);this.#g($,$,$,j),this.#p(j);let _=(R,N)=>{let B=I[R]/255,z=k[R]/255,K=new Array(N+1);for(let Y=0;Y<=N;Y++)K[Y]=B+Y/N*(z-B);return K.join(",")};return this.#g(_(0,5),_(1,5),_(2,5),j),this.#s=`url(#${G})`,this.#s}addHighlightHCMFilter(q,x,w,I){let k=`${q}-${x}-${w}-${I}`;if(this.#l===k)return this.#i;if(this.#l=k,this.#i="none",this.#c?.remove(),!q||!x)return this.#i;let[H,$]=[q,x].map(this.#u.bind(this)),G=Math.round(.2126*H[0]+.7152*H[1]+.0722*H[2]),j=Math.round(.2126*$[0]+.7152*$[1]+.0722*$[2]),[_,R]=[w,I].map(this.#u.bind(this));j<G&&([G,j,_,R]=[j,G,R,_]),this.#h.style.color="";let N=(K,Y,ee)=>{let fe=new Array(256),te=(j-G)/ee,re=K/255,ie=(Y-K)/(255*ee),se=0;for(let ce=0;ce<=ee;ce++){let ye=Math.round(G+ce*te),be=re+ce*ie;for(let Ae=se;Ae<=ye;Ae++)fe[Ae]=be;se=ye+1}for(let ce=se;ce<256;ce++)fe[ce]=fe[se-1];return fe.join(",")},B=`g_${this.#n}_hcm_highlight_filter`,z=this.#c=this.#y(B);return this.#p(z),this.#g(N(_[0],R[0],5),N(_[1],R[1],5),N(_[2],R[2],5),z),this.#i=`url(#${B})`,this.#i}destroy(q=!1){q&&(this.#s||this.#i)||(this.#t&&(this.#t.parentNode.parentNode.remove(),this.#t=null),this.#e&&(this.#e.clear(),this.#e=null),this.#f=0)}#p(q){let x=this.#r.createElementNS(s,"feColorMatrix");x.setAttribute("type","matrix"),x.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),q.append(x)}#y(q){let x=this.#r.createElementNS(s,"filter");return x.setAttribute("color-interpolation-filters","sRGB"),x.setAttribute("id",q),this.#h.append(x),x}#m(q,x,w){let I=this.#r.createElementNS(s,x);I.setAttribute("type","discrete"),I.setAttribute("tableValues",w),q.append(I)}#g(q,x,w,I){let k=this.#r.createElementNS(s,"feComponentTransfer");I.append(k),this.#m(k,"feFuncR",q),this.#m(k,"feFuncG",x),this.#m(k,"feFuncB",w)}#u(q){return this.#h.style.color=q,L(getComputedStyle(this.#h).getPropertyValue("color"))}}e.DOMFilterFactory=a;class c extends r.BaseCanvasFactory{constructor({ownerDocument:q=globalThis.document}={}){super(),this._document=q}_createCanvas(q,x){let w=this._document.createElement("canvas");return w.width=q,w.height=x,w}}e.DOMCanvasFactory=c;function l(oe,q=!1){return X(this,null,function*(){if(M(oe,document.baseURI)){let x=yield fetch(oe);if(!x.ok)throw new Error(x.statusText);return q?new Uint8Array(yield x.arrayBuffer()):(0,i.stringToBytes)(yield x.text())}return new Promise((x,w)=>{let I=new XMLHttpRequest;I.open("GET",oe,!0),q&&(I.responseType="arraybuffer"),I.onreadystatechange=()=>{if(I.readyState===XMLHttpRequest.DONE){if(I.status===200||I.status===0){let k;if(q&&I.response?k=new Uint8Array(I.response):!q&&I.responseText&&(k=(0,i.stringToBytes)(I.responseText)),k){x(k);return}}w(new Error(I.statusText))}},I.send(null)})})}class d extends r.BaseCMapReaderFactory{_fetchData(q,x){return l(q,this.isCompressed).then(w=>({cMapData:w,compressionType:x}))}}e.DOMCMapReaderFactory=d;class h extends r.BaseStandardFontDataFactory{_fetchData(q){return l(q,!0)}}e.DOMStandardFontDataFactory=h;class f extends r.BaseSVGFactory{_createSVG(q){return document.createElementNS(s,q)}}e.DOMSVGFactory=f;class p{constructor({viewBox:q,scale:x,rotation:w,offsetX:I=0,offsetY:k=0,dontFlip:H=!1}){this.viewBox=q,this.scale=x,this.rotation=w,this.offsetX=I,this.offsetY=k;let $=(q[2]+q[0])/2,G=(q[3]+q[1])/2,j,_,R,N;switch(w%=360,w<0&&(w+=360),w){case 180:j=-1,_=0,R=0,N=1;break;case 90:j=0,_=1,R=1,N=0;break;case 270:j=0,_=-1,R=-1,N=0;break;case 0:j=1,_=0,R=0,N=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}H&&(R=-R,N=-N);let B,z,K,Y;j===0?(B=Math.abs(G-q[1])*x+I,z=Math.abs($-q[0])*x+k,K=(q[3]-q[1])*x,Y=(q[2]-q[0])*x):(B=Math.abs($-q[0])*x+I,z=Math.abs(G-q[1])*x+k,K=(q[2]-q[0])*x,Y=(q[3]-q[1])*x),this.transform=[j*x,_*x,R*x,N*x,B-j*x*$-R*x*G,z-_*x*$-N*x*G],this.width=K,this.height=Y}get rawDims(){let{viewBox:q}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:q[2]-q[0],pageHeight:q[3]-q[1],pageX:q[0],pageY:q[1]})}clone({scale:q=this.scale,rotation:x=this.rotation,offsetX:w=this.offsetX,offsetY:I=this.offsetY,dontFlip:k=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:q,rotation:x,offsetX:w,offsetY:I,dontFlip:k})}convertToViewportPoint(q,x){return i.Util.applyTransform([q,x],this.transform)}convertToViewportRectangle(q){let x=i.Util.applyTransform([q[0],q[1]],this.transform),w=i.Util.applyTransform([q[2],q[3]],this.transform);return[x[0],x[1],w[0],w[1]]}convertToPdfPoint(q,x){return i.Util.applyInverseTransform([q,x],this.transform)}}e.PageViewport=p;class m extends i.BaseException{constructor(q,x=0){super(q,"RenderingCancelledException"),this.extraDelay=x}}e.RenderingCancelledException=m;function g(oe){let q=oe.length,x=0;for(;x<q&&oe[x].trim()==="";)x++;return oe.substring(x,x+5).toLowerCase()==="data:"}function v(oe){return typeof oe=="string"&&/\.pdf$/i.test(oe)}function E(oe,q=!1){return q||([oe]=oe.split(/[#?]/,1)),oe.substring(oe.lastIndexOf("/")+1)}function A(oe,q="document.pdf"){if(typeof oe!="string")return q;if(g(oe))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),q;let x=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,w=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,I=x.exec(oe),k=w.exec(I[1])||w.exec(I[2])||w.exec(I[3]);if(k&&(k=k[0],k.includes("%")))try{k=w.exec(decodeURIComponent(k))[0]}catch{}return k||q}class O{started=Object.create(null);times=[];time(q){q in this.started&&(0,i.warn)(`Timer is already running for ${q}`),this.started[q]=Date.now()}timeEnd(q){q in this.started||(0,i.warn)(`Timer has not been started for ${q}`),this.times.push({name:q,start:this.started[q],end:Date.now()}),delete this.started[q]}toString(){let q=[],x=0;for(let{name:w}of this.times)x=Math.max(w.length,x);for(let{name:w,start:I,end:k}of this.times)q.push(`${w.padEnd(x)} ${k-I}ms
`);return q.join("")}}e.StatTimer=O;function M(oe,q){try{let{protocol:x}=q?new URL(oe,q):new URL(oe);return x==="http:"||x==="https:"}catch{return!1}}function C(oe){oe.preventDefault()}function P(oe,q=!1){return new Promise((x,w)=>{let I=document.createElement("script");I.src=oe,I.onload=function(k){q&&I.remove(),x(k)},I.onerror=function(){w(new Error(`Cannot load script at: ${I.src}`))},(document.head||document.documentElement).append(I)})}function D(oe){console.log("Deprecated API usage: "+oe)}let S;class T{static toDateObject(q){if(!q||typeof q!="string")return null;S||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let x=S.exec(q);if(!x)return null;let w=parseInt(x[1],10),I=parseInt(x[2],10);I=I>=1&&I<=12?I-1:0;let k=parseInt(x[3],10);k=k>=1&&k<=31?k:1;let H=parseInt(x[4],10);H=H>=0&&H<=23?H:0;let $=parseInt(x[5],10);$=$>=0&&$<=59?$:0;let G=parseInt(x[6],10);G=G>=0&&G<=59?G:0;let j=x[7]||"Z",_=parseInt(x[8],10);_=_>=0&&_<=23?_:0;let R=parseInt(x[9],10)||0;return R=R>=0&&R<=59?R:0,j==="-"?(H+=_,$+=R):j==="+"&&(H-=_,$-=R),new Date(Date.UTC(w,I,k,H,$,G))}}e.PDFDateString=T;function F(oe,{scale:q=1,rotation:x=0}){let{width:w,height:I}=oe.attributes.style,k=[0,0,parseInt(w),parseInt(I)];return new p({viewBox:k,scale:q,rotation:x})}function L(oe){if(oe.startsWith("#")){let q=parseInt(oe.slice(1),16);return[(q&16711680)>>16,(q&65280)>>8,q&255]}return oe.startsWith("rgb(")?oe.slice(4,-1).split(",").map(q=>parseInt(q)):oe.startsWith("rgba(")?oe.slice(5,-1).split(",").map(q=>parseInt(q)).slice(0,3):((0,i.warn)(`Not a valid color format: "${oe}"`),[0,0,0])}function W(oe){let q=document.createElement("span");q.style.visibility="hidden",document.body.append(q);for(let x of oe.keys()){q.style.color=x;let w=window.getComputedStyle(q).color;oe.set(x,L(w))}q.remove()}function U(oe){let{a:q,b:x,c:w,d:I,e:k,f:H}=oe.getTransform();return[q,x,w,I,k,H]}function ae(oe){let{a:q,b:x,c:w,d:I,e:k,f:H}=oe.getTransform().invertSelf();return[q,x,w,I,k,H]}function pe(oe,q,x=!1,w=!0){if(q instanceof p){let{pageWidth:I,pageHeight:k}=q.rawDims,{style:H}=oe,$=i.FeatureTest.isCSSRoundSupported,G=`var(--scale-factor) * ${I}px`,j=`var(--scale-factor) * ${k}px`,_=$?`round(${G}, 1px)`:`calc(${G})`,R=$?`round(${j}, 1px)`:`calc(${j})`;!x||q.rotation%180===0?(H.width=_,H.height=R):(H.width=R,H.height=_)}w&&oe.setAttribute("data-main-rotation",q.rotation)}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var r=n(1);class i{constructor(){this.constructor===i&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(d){return"none"}addHCMFilter(d,h){return"none"}addHighlightHCMFilter(d,h,f,p){return"none"}destroy(d=!1){}}e.BaseFilterFactory=i;class s{constructor(){this.constructor===s&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(d,h){if(d<=0||h<=0)throw new Error("Invalid canvas size");let f=this._createCanvas(d,h);return{canvas:f,context:f.getContext("2d")}}reset(d,h,f){if(!d.canvas)throw new Error("Canvas is not specified");if(h<=0||f<=0)throw new Error("Invalid canvas size");d.canvas.width=h,d.canvas.height=f}destroy(d){if(!d.canvas)throw new Error("Canvas is not specified");d.canvas.width=0,d.canvas.height=0,d.canvas=null,d.context=null}_createCanvas(d,h){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=s;class o{constructor({baseUrl:d=null,isCompressed:h=!0}){this.constructor===o&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=d,this.isCompressed=h}fetch(h){return X(this,arguments,function*({name:d}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!d)throw new Error("CMap name must be specified.");let f=this.baseUrl+d+(this.isCompressed?".bcmap":""),p=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(f,p).catch(m=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${f}`)})})}_fetchData(d,h){(0,r.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=o;class a{constructor({baseUrl:d=null}){this.constructor===a&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=d}fetch(h){return X(this,arguments,function*({filename:d}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!d)throw new Error("Font filename must be specified.");let f=`${this.baseUrl}${d}`;return this._fetchData(f).catch(p=>{throw new Error(`Unable to load font data at: ${f}`)})})}_fetchData(d){(0,r.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=a;class c{constructor(){this.constructor===c&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(d,h,f=!1){if(d<=0||h<=0)throw new Error("Invalid SVG dimensions");let p=this._createSVG("svg:svg");return p.setAttribute("version","1.1"),f||(p.setAttribute("width",`${d}px`),p.setAttribute("height",`${h}px`)),p.setAttribute("preserveAspectRatio","none"),p.setAttribute("viewBox",`0 0 ${d} ${h}`),p}createElement(d){if(typeof d!="string")throw new Error("Invalid SVG element type");return this._createSVG(d)}_createSVG(d){(0,r.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=c}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var r=n(1);let i=3285377520,s=4294901760,o=65535;class a{constructor(l){this.h1=l?l&4294967295:i,this.h2=l?l&4294967295:i}update(l){let d,h;if(typeof l=="string"){d=new Uint8Array(l.length*2),h=0;for(let D=0,S=l.length;D<S;D++){let T=l.charCodeAt(D);T<=255?d[h++]=T:(d[h++]=T>>>8,d[h++]=T&255)}}else if((0,r.isArrayBuffer)(l))d=l.slice(),h=d.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");let f=h>>2,p=h-f*4,m=new Uint32Array(d.buffer,0,f),g=0,v=0,E=this.h1,A=this.h2,O=3432918353,M=461845907,C=O&o,P=M&o;for(let D=0;D<f;D++)D&1?(g=m[D],g=g*O&s|g*C&o,g=g<<15|g>>>17,g=g*M&s|g*P&o,E^=g,E=E<<13|E>>>19,E=E*5+3864292196):(v=m[D],v=v*O&s|v*C&o,v=v<<15|v>>>17,v=v*M&s|v*P&o,A^=v,A=A<<13|A>>>19,A=A*5+3864292196);switch(g=0,p){case 3:g^=d[f*4+2]<<16;case 2:g^=d[f*4+1]<<8;case 1:g^=d[f*4],g=g*O&s|g*C&o,g=g<<15|g>>>17,g=g*M&s|g*P&o,f&1?E^=g:A^=g}this.h1=E,this.h2=A}hexdigest(){let l=this.h1,d=this.h2;return l^=d>>>1,l=l*3981806797&s|l*36045&o,d=d*4283543511&s|((d<<16|l>>>16)*2950163797&s)>>>16,l^=d>>>1,l=l*444984403&s|l*60499&o,d=d*3301882366&s|((d<<16|l>>>16)*3120437893&s)>>>16,l^=d>>>1,(l>>>0).toString(16).padStart(8,"0")+(d>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=a}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var r=n(1);class i{#e=new Set;constructor({ownerDocument:a=globalThis.document,styleElement:c=null}){this._document=a,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(a){this.nativeFontFaces.add(a),this._document.fonts.add(a)}removeNativeFontFace(a){this.nativeFontFaces.delete(a),this._document.fonts.delete(a)}insertRule(a){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let c=this.styleElement.sheet;c.insertRule(a,c.cssRules.length)}clear(){for(let a of this.nativeFontFaces)this._document.fonts.delete(a);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(a){return X(this,null,function*(){if(!(!a||this.#e.has(a.loadedName))){if((0,r.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:c,src:l,style:d}=a,h=new FontFace(c,l,d);this.addNativeFontFace(h);try{yield h.load(),this.#e.add(c)}catch{(0,r.warn)(`Cannot load system font: ${a.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(h)}return}(0,r.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(a){return X(this,null,function*(){if(a.attached||a.missingFile&&!a.systemFontInfo)return;if(a.attached=!0,a.systemFontInfo){yield this.loadSystemFont(a.systemFontInfo);return}if(this.isFontLoadingAPISupported){let l=a.createNativeFontFace();if(l){this.addNativeFontFace(l);try{yield l.loaded}catch(d){throw(0,r.warn)(`Failed to load font '${l.family}': '${d}'.`),a.disableFontFace=!0,d}}return}let c=a.createFontFaceRule();if(c){if(this.insertRule(c),this.isSyncFontLoadingSupported)return;yield new Promise(l=>{let d=this._queueLoadingCallback(l);this._prepareFontLoadEvent(a,d)})}})}get isFontLoadingAPISupported(){let a=!!this._document?.fonts;return(0,r.shadow)(this,"isFontLoadingAPISupported",a)}get isSyncFontLoadingSupported(){let a=!1;return(r.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(a=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",a)}_queueLoadingCallback(a){function c(){for((0,r.assert)(!d.done,"completeRequest() cannot be called twice."),d.done=!0;l.length>0&&l[0].done;){let h=l.shift();setTimeout(h.callback,0)}}let{loadingRequests:l}=this,d={done:!1,complete:c,callback:a};return l.push(d),d}get _loadTestFont(){let a=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",a)}_prepareFontLoadEvent(a,c){function l(F,L){return F.charCodeAt(L)<<24|F.charCodeAt(L+1)<<16|F.charCodeAt(L+2)<<8|F.charCodeAt(L+3)&255}function d(F,L,W,U){let ae=F.substring(0,L),pe=F.substring(L+W);return ae+U+pe}let h,f,p=this._document.createElement("canvas");p.width=1,p.height=1;let m=p.getContext("2d"),g=0;function v(F,L){if(++g>30){(0,r.warn)("Load test font never loaded."),L();return}if(m.font="30px "+F,m.fillText(".",0,20),m.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(v.bind(null,F,L))}let E=`lt${Date.now()}${this.loadTestFontId++}`,A=this._loadTestFont;A=d(A,976,E.length,E);let M=16,C=1482184792,P=l(A,M);for(h=0,f=E.length-3;h<f;h+=4)P=P-C+l(E,h)|0;h<E.length&&(P=P-C+l(E+"XXX",h)|0),A=d(A,M,4,(0,r.string32)(P));let D=`url(data:font/opentype;base64,${btoa(A)});`,S=`@font-face {font-family:"${E}";src:${D}}`;this.insertRule(S);let T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(let F of[a.loadedName,E]){let L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=F,T.append(L)}this._document.body.append(T),v(E,()=>{T.remove(),c.complete()})}}e.FontLoader=i;class s{constructor(a,{isEvalSupported:c=!0,disableFontFace:l=!1,ignoreErrors:d=!1,inspectFont:h=null}){this.compiledGlyphs=Object.create(null);for(let f in a)this[f]=a[f];this.isEvalSupported=c!==!1,this.disableFontFace=l===!0,this.ignoreErrors=d===!0,this._inspectFont=h}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let a;if(!this.cssFontInfo)a=new FontFace(this.loadedName,this.data,{});else{let c={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(c.style=`oblique ${this.cssFontInfo.italicAngle}deg`),a=new FontFace(this.cssFontInfo.fontFamily,this.data,c)}return this._inspectFont?.(this),a}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let a=(0,r.bytesToString)(this.data),c=`url(data:${this.mimetype};base64,${btoa(a)});`,l;if(!this.cssFontInfo)l=`@font-face {font-family:"${this.loadedName}";src:${c}}`;else{let d=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(d+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),l=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${d}src:${c}}`}return this._inspectFont?.(this,c),l}getPathGenerator(a,c){if(this.compiledGlyphs[c]!==void 0)return this.compiledGlyphs[c];let l;try{l=a.get(this.loadedName+"_path_"+c)}catch(d){if(!this.ignoreErrors)throw d;return(0,r.warn)(`getPathGenerator - ignoring character: "${d}".`),this.compiledGlyphs[c]=function(h,f){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){let d=[];for(let h of l){let f=h.args!==void 0?h.args.join(","):"";d.push("c.",h.cmd,"(",f,`);
`)}return this.compiledGlyphs[c]=new Function("c","size",d.join(""))}return this.compiledGlyphs[c]=function(d,h){for(let f of l)f.cmd==="scale"&&(f.args=[h,-h]),d[f.cmd].apply(d,f.args)}}}e.FontFaceObject=s}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var r=n(7),i=n(1);let s=function(d){return new Promise((h,f)=>{Hf().readFile(d,(m,g)=>{if(m||!g){f(new Error(m));return}h(new Uint8Array(g))})})};class o extends r.BaseFilterFactory{}e.NodeFilterFactory=o;class a extends r.BaseCanvasFactory{_createCanvas(h,f){return dP().createCanvas(h,f)}}e.NodeCanvasFactory=a;class c extends r.BaseCMapReaderFactory{_fetchData(h,f){return s(h).then(p=>({cMapData:p,compressionType:f}))}}e.NodeCMapReaderFactory=c;class l extends r.BaseStandardFontDataFactory{_fetchData(h){return s(h)}}e.NodeStandardFontDataFactory=l}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var r=n(1),i=n(6),s=n(12),o=n(13);let a=16,c=100,l=4096,d=15,h=10,f=1e3,p=16;function m(x,w){if(x._removeMirroring)throw new Error("Context is already forwarding operations.");x.__originalSave=x.save,x.__originalRestore=x.restore,x.__originalRotate=x.rotate,x.__originalScale=x.scale,x.__originalTranslate=x.translate,x.__originalTransform=x.transform,x.__originalSetTransform=x.setTransform,x.__originalResetTransform=x.resetTransform,x.__originalClip=x.clip,x.__originalMoveTo=x.moveTo,x.__originalLineTo=x.lineTo,x.__originalBezierCurveTo=x.bezierCurveTo,x.__originalRect=x.rect,x.__originalClosePath=x.closePath,x.__originalBeginPath=x.beginPath,x._removeMirroring=()=>{x.save=x.__originalSave,x.restore=x.__originalRestore,x.rotate=x.__originalRotate,x.scale=x.__originalScale,x.translate=x.__originalTranslate,x.transform=x.__originalTransform,x.setTransform=x.__originalSetTransform,x.resetTransform=x.__originalResetTransform,x.clip=x.__originalClip,x.moveTo=x.__originalMoveTo,x.lineTo=x.__originalLineTo,x.bezierCurveTo=x.__originalBezierCurveTo,x.rect=x.__originalRect,x.closePath=x.__originalClosePath,x.beginPath=x.__originalBeginPath,delete x._removeMirroring},x.save=function(){w.save(),this.__originalSave()},x.restore=function(){w.restore(),this.__originalRestore()},x.translate=function(k,H){w.translate(k,H),this.__originalTranslate(k,H)},x.scale=function(k,H){w.scale(k,H),this.__originalScale(k,H)},x.transform=function(k,H,$,G,j,_){w.transform(k,H,$,G,j,_),this.__originalTransform(k,H,$,G,j,_)},x.setTransform=function(k,H,$,G,j,_){w.setTransform(k,H,$,G,j,_),this.__originalSetTransform(k,H,$,G,j,_)},x.resetTransform=function(){w.resetTransform(),this.__originalResetTransform()},x.rotate=function(k){w.rotate(k),this.__originalRotate(k)},x.clip=function(k){w.clip(k),this.__originalClip(k)},x.moveTo=function(I,k){w.moveTo(I,k),this.__originalMoveTo(I,k)},x.lineTo=function(I,k){w.lineTo(I,k),this.__originalLineTo(I,k)},x.bezierCurveTo=function(I,k,H,$,G,j){w.bezierCurveTo(I,k,H,$,G,j),this.__originalBezierCurveTo(I,k,H,$,G,j)},x.rect=function(I,k,H,$){w.rect(I,k,H,$),this.__originalRect(I,k,H,$)},x.closePath=function(){w.closePath(),this.__originalClosePath()},x.beginPath=function(){w.beginPath(),this.__originalBeginPath()}}class g{constructor(w){this.canvasFactory=w,this.cache=Object.create(null)}getCanvas(w,I,k){let H;return this.cache[w]!==void 0?(H=this.cache[w],this.canvasFactory.reset(H,I,k)):(H=this.canvasFactory.create(I,k),this.cache[w]=H),H}delete(w){delete this.cache[w]}clear(){for(let w in this.cache){let I=this.cache[w];this.canvasFactory.destroy(I),delete this.cache[w]}}}function v(x,w,I,k,H,$,G,j,_,R){let[N,B,z,K,Y,ee]=(0,i.getCurrentTransform)(x);if(B===0&&z===0){let re=G*N+Y,ie=Math.round(re),se=j*K+ee,ce=Math.round(se),ye=(G+_)*N+Y,be=Math.abs(Math.round(ye)-ie)||1,Ae=(j+R)*K+ee,xe=Math.abs(Math.round(Ae)-ce)||1;return x.setTransform(Math.sign(N),0,0,Math.sign(K),ie,ce),x.drawImage(w,I,k,H,$,0,0,be,xe),x.setTransform(N,B,z,K,Y,ee),[be,xe]}if(N===0&&K===0){let re=j*z+Y,ie=Math.round(re),se=G*B+ee,ce=Math.round(se),ye=(j+R)*z+Y,be=Math.abs(Math.round(ye)-ie)||1,Ae=(G+_)*B+ee,xe=Math.abs(Math.round(Ae)-ce)||1;return x.setTransform(0,Math.sign(B),Math.sign(z),0,ie,ce),x.drawImage(w,I,k,H,$,0,0,xe,be),x.setTransform(N,B,z,K,Y,ee),[xe,be]}x.drawImage(w,I,k,H,$,G,j,_,R);let fe=Math.hypot(N,B),te=Math.hypot(z,K);return[fe*_,te*R]}function E(x){let{width:w,height:I}=x;if(w>f||I>f)return null;let k=1e3,H=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),$=w+1,G=new Uint8Array($*(I+1)),j,_,R,N=w+7&-8,B=new Uint8Array(N*I),z=0;for(let te of x.data){let re=128;for(;re>0;)B[z++]=te&re?0:255,re>>=1}let K=0;for(z=0,B[z]!==0&&(G[0]=1,++K),_=1;_<w;_++)B[z]!==B[z+1]&&(G[_]=B[z]?2:1,++K),z++;for(B[z]!==0&&(G[_]=2,++K),j=1;j<I;j++){z=j*N,R=j*$,B[z-N]!==B[z]&&(G[R]=B[z]?1:8,++K);let te=(B[z]?4:0)+(B[z-N]?8:0);for(_=1;_<w;_++)te=(te>>2)+(B[z+1]?4:0)+(B[z-N+1]?8:0),H[te]&&(G[R+_]=H[te],++K),z++;if(B[z-N]!==B[z]&&(G[R+_]=B[z]?2:4,++K),K>k)return null}for(z=N*(I-1),R=j*$,B[z]!==0&&(G[R]=8,++K),_=1;_<w;_++)B[z]!==B[z+1]&&(G[R+_]=B[z]?4:8,++K),z++;if(B[z]!==0&&(G[R+_]=4,++K),K>k)return null;let Y=new Int32Array([0,$,-1,0,-$,0,0,0,1]),ee=new Path2D;for(j=0;K&&j<=I;j++){let te=j*$,re=te+w;for(;te<re&&!G[te];)te++;if(te===re)continue;ee.moveTo(te%$,j);let ie=te,se=G[te];do{let ce=Y[se];do te+=ce;while(!G[te]);let ye=G[te];ye!==5&&ye!==10?(se=ye,G[te]=0):(se=ye&51*se>>4,G[te]&=se>>2|se<<2),ee.lineTo(te%$,te/$|0),G[te]||--K}while(ie!==te);--j}return B=null,G=null,function(te){te.save(),te.scale(1/w,-1/I),te.translate(0,-I),te.fill(ee),te.beginPath(),te.restore()}}class A{constructor(w,I){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,w,I])}clone(){let w=Object.create(this);return w.clipBox=this.clipBox.slice(),w}setCurrentPoint(w,I){this.x=w,this.y=I}updatePathMinMax(w,I,k){[I,k]=r.Util.applyTransform([I,k],w),this.minX=Math.min(this.minX,I),this.minY=Math.min(this.minY,k),this.maxX=Math.max(this.maxX,I),this.maxY=Math.max(this.maxY,k)}updateRectMinMax(w,I){let k=r.Util.applyTransform(I,w),H=r.Util.applyTransform(I.slice(2),w);this.minX=Math.min(this.minX,k[0],H[0]),this.minY=Math.min(this.minY,k[1],H[1]),this.maxX=Math.max(this.maxX,k[0],H[0]),this.maxY=Math.max(this.maxY,k[1],H[1])}updateScalingPathMinMax(w,I){r.Util.scaleMinMax(w,I),this.minX=Math.min(this.minX,I[0]),this.maxX=Math.max(this.maxX,I[1]),this.minY=Math.min(this.minY,I[2]),this.maxY=Math.max(this.maxY,I[3])}updateCurvePathMinMax(w,I,k,H,$,G,j,_,R,N){let B=r.Util.bezierBoundingBox(I,k,H,$,G,j,_,R);if(N){N[0]=Math.min(N[0],B[0],B[2]),N[1]=Math.max(N[1],B[0],B[2]),N[2]=Math.min(N[2],B[1],B[3]),N[3]=Math.max(N[3],B[1],B[3]);return}this.updateRectMinMax(w,B)}getPathBoundingBox(w=s.PathType.FILL,I=null){let k=[this.minX,this.minY,this.maxX,this.maxY];if(w===s.PathType.STROKE){I||(0,r.unreachable)("Stroke bounding box must include transform.");let H=r.Util.singularValueDecompose2dScale(I),$=H[0]*this.lineWidth/2,G=H[1]*this.lineWidth/2;k[0]-=$,k[1]-=G,k[2]+=$,k[3]+=G}return k}updateClipFromPath(){let w=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(w||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(w){this.clipBox=w,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(w=s.PathType.FILL,I=null){return r.Util.intersect(this.clipBox,this.getPathBoundingBox(w,I))}}function O(x,w){if(typeof ImageData<"u"&&w instanceof ImageData){x.putImageData(w,0,0);return}let I=w.height,k=w.width,H=I%p,$=(I-H)/p,G=H===0?$:$+1,j=x.createImageData(k,p),_=0,R,N=w.data,B=j.data,z,K,Y,ee;if(w.kind===r.ImageKind.GRAYSCALE_1BPP){let fe=N.byteLength,te=new Uint32Array(B.buffer,0,B.byteLength>>2),re=te.length,ie=k+7>>3,se=4294967295,ce=r.FeatureTest.isLittleEndian?4278190080:255;for(z=0;z<G;z++){for(Y=z<$?p:H,R=0,K=0;K<Y;K++){let ye=fe-_,be=0,Ae=ye>ie?k:ye*8-7,xe=Ae&-8,Ue=0,et=0;for(;be<xe;be+=8)et=N[_++],te[R++]=et&128?se:ce,te[R++]=et&64?se:ce,te[R++]=et&32?se:ce,te[R++]=et&16?se:ce,te[R++]=et&8?se:ce,te[R++]=et&4?se:ce,te[R++]=et&2?se:ce,te[R++]=et&1?se:ce;for(;be<Ae;be++)Ue===0&&(et=N[_++],Ue=128),te[R++]=et&Ue?se:ce,Ue>>=1}for(;R<re;)te[R++]=0;x.putImageData(j,0,z*p)}}else if(w.kind===r.ImageKind.RGBA_32BPP){for(K=0,ee=k*p*4,z=0;z<$;z++)B.set(N.subarray(_,_+ee)),_+=ee,x.putImageData(j,0,K),K+=p;z<G&&(ee=k*H*4,B.set(N.subarray(_,_+ee)),x.putImageData(j,0,K))}else if(w.kind===r.ImageKind.RGB_24BPP)for(Y=p,ee=k*Y,z=0;z<G;z++){for(z>=$&&(Y=H,ee=k*Y),R=0,K=ee;K--;)B[R++]=N[_++],B[R++]=N[_++],B[R++]=N[_++],B[R++]=255;x.putImageData(j,0,z*p)}else throw new Error(`bad image kind: ${w.kind}`)}function M(x,w){if(w.bitmap){x.drawImage(w.bitmap,0,0);return}let I=w.height,k=w.width,H=I%p,$=(I-H)/p,G=H===0?$:$+1,j=x.createImageData(k,p),_=0,R=w.data,N=j.data;for(let B=0;B<G;B++){let z=B<$?p:H;({srcPos:_}=(0,o.convertBlackAndWhiteToRGBA)({src:R,srcPos:_,dest:N,width:k,height:z,nonBlackColor:0})),x.putImageData(j,0,B*p)}}function C(x,w){let I=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let k of I)x[k]!==void 0&&(w[k]=x[k]);x.setLineDash!==void 0&&(w.setLineDash(x.getLineDash()),w.lineDashOffset=x.lineDashOffset)}function P(x){if(x.strokeStyle=x.fillStyle="#000000",x.fillRule="nonzero",x.globalAlpha=1,x.lineWidth=1,x.lineCap="butt",x.lineJoin="miter",x.miterLimit=10,x.globalCompositeOperation="source-over",x.font="10px sans-serif",x.setLineDash!==void 0&&(x.setLineDash([]),x.lineDashOffset=0),!r.isNodeJS){let{filter:w}=x;w!=="none"&&w!==""&&(x.filter="none")}}function D(x,w,I,k){let H=x.length;for(let $=3;$<H;$+=4){let G=x[$];if(G===0)x[$-3]=w,x[$-2]=I,x[$-1]=k;else if(G<255){let j=255-G;x[$-3]=x[$-3]*G+w*j>>8,x[$-2]=x[$-2]*G+I*j>>8,x[$-1]=x[$-1]*G+k*j>>8}}}function S(x,w,I){let k=x.length,H=1/255;for(let $=3;$<k;$+=4){let G=I?I[x[$]]:x[$];w[$]=w[$]*G*H|0}}function T(x,w,I){let k=x.length;for(let H=3;H<k;H+=4){let $=x[H-3]*77+x[H-2]*152+x[H-1]*28;w[H]=I?w[H]*I[$>>8]>>8:w[H]*$>>16}}function F(x,w,I,k,H,$,G,j,_,R,N){let B=!!$,z=B?$[0]:0,K=B?$[1]:0,Y=B?$[2]:0,ee=H==="Luminosity"?T:S,te=Math.min(k,Math.ceil(1048576/I));for(let re=0;re<k;re+=te){let ie=Math.min(te,k-re),se=x.getImageData(j-R,re+(_-N),I,ie),ce=w.getImageData(j,re+_,I,ie);B&&D(se.data,z,K,Y),ee(se.data,ce.data,G),w.putImageData(ce,j,re+_)}}function L(x,w,I,k){let H=k[0],$=k[1],G=k[2]-H,j=k[3]-$;G===0||j===0||(F(w.context,I,G,j,w.subtype,w.backdrop,w.transferMap,H,$,w.offsetX,w.offsetY),x.save(),x.globalAlpha=1,x.globalCompositeOperation="source-over",x.setTransform(1,0,0,1,0,0),x.drawImage(I.canvas,0,0),x.restore())}function W(x,w){let I=r.Util.singularValueDecompose2dScale(x);I[0]=Math.fround(I[0]),I[1]=Math.fround(I[1]);let k=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return w!==void 0?w:I[0]<=k||I[1]<=k}let U=["butt","round","square"],ae=["miter","round","bevel"],pe={},oe={};class q{constructor(w,I,k,H,$,{optionalContentConfig:G,markedContentStack:j=null},_,R){this.ctx=w,this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=I,this.objs=k,this.canvasFactory=H,this.filterFactory=$,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=j||[],this.optionalContentConfig=G,this.cachedCanvases=new g(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=_,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=R,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(w,I=null){return typeof w=="string"?w.startsWith("g_")?this.commonObjs.get(w):this.objs.get(w):I}beginDrawing({transform:w,viewport:I,transparency:k=!1,background:H=null}){let $=this.ctx.canvas.width,G=this.ctx.canvas.height,j=this.ctx.fillStyle;if(this.ctx.fillStyle=H||"#ffffff",this.ctx.fillRect(0,0,$,G),this.ctx.fillStyle=j,k){let _=this.cachedCanvases.getCanvas("transparent",$,G);this.compositeCtx=this.ctx,this.transparentCanvas=_.canvas,this.ctx=_.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),P(this.ctx),w&&(this.ctx.transform(...w),this.outputScaleX=w[0],this.outputScaleY=w[0]),this.ctx.transform(...I.transform),this.viewportScale=I.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(w,I,k,H){let $=w.argsArray,G=w.fnArray,j=I||0,_=$.length;if(_===j)return j;let R=_-j>h&&typeof k=="function",N=R?Date.now()+d:0,B=0,z=this.commonObjs,K=this.objs,Y;for(;;){if(H!==void 0&&j===H.nextBreakPoint)return H.breakIt(j,k),j;if(Y=G[j],Y!==r.OPS.dependency)this[Y].apply(this,$[j]);else for(let ee of $[j]){let fe=ee.startsWith("g_")?z:K;if(!fe.has(ee))return fe.get(ee,k),j}if(j++,j===_)return j;if(R&&++B>h){if(Date.now()>N)return k(),j;B=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let w of this._cachedBitmapsMap.values()){for(let I of w.values())typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement&&(I.width=I.height=0);w.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){let w=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(w!=="none"){let I=this.ctx.filter;this.ctx.filter=w,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=I}}}_scaleImage(w,I){let k=w.width,H=w.height,$=Math.max(Math.hypot(I[0],I[1]),1),G=Math.max(Math.hypot(I[2],I[3]),1),j=k,_=H,R="prescale1",N,B;for(;$>2&&j>1||G>2&&_>1;){let z=j,K=_;$>2&&j>1&&(z=j>=16384?Math.floor(j/2)-1||1:Math.ceil(j/2),$/=j/z),G>2&&_>1&&(K=_>=16384?Math.floor(_/2)-1||1:Math.ceil(_)/2,G/=_/K),N=this.cachedCanvases.getCanvas(R,z,K),B=N.context,B.clearRect(0,0,z,K),B.drawImage(w,0,0,j,_,0,0,z,K),w=N.canvas,j=z,_=K,R=R==="prescale1"?"prescale2":"prescale1"}return{img:w,paintWidth:j,paintHeight:_}}_createMaskCanvas(w){let I=this.ctx,{width:k,height:H}=w,$=this.current.fillColor,G=this.current.patternFill,j=(0,i.getCurrentTransform)(I),_,R,N,B;if((w.bitmap||w.data)&&w.count>1){let be=w.bitmap||w.data.buffer;R=JSON.stringify(G?j:[j.slice(0,4),$]),_=this._cachedBitmapsMap.get(be),_||(_=new Map,this._cachedBitmapsMap.set(be,_));let Ae=_.get(R);if(Ae&&!G){let xe=Math.round(Math.min(j[0],j[2])+j[4]),Ue=Math.round(Math.min(j[1],j[3])+j[5]);return{canvas:Ae,offsetX:xe,offsetY:Ue}}N=Ae}N||(B=this.cachedCanvases.getCanvas("maskCanvas",k,H),M(B.context,w));let z=r.Util.transform(j,[1/k,0,0,-1/H,0,0]);z=r.Util.transform(z,[1,0,0,1,0,-H]);let K=r.Util.applyTransform([0,0],z),Y=r.Util.applyTransform([k,H],z),ee=r.Util.normalizeRect([K[0],K[1],Y[0],Y[1]]),fe=Math.round(ee[2]-ee[0])||1,te=Math.round(ee[3]-ee[1])||1,re=this.cachedCanvases.getCanvas("fillCanvas",fe,te),ie=re.context,se=Math.min(K[0],Y[0]),ce=Math.min(K[1],Y[1]);ie.translate(-se,-ce),ie.transform(...z),N||(N=this._scaleImage(B.canvas,(0,i.getCurrentTransformInverse)(ie)),N=N.img,_&&G&&_.set(R,N)),ie.imageSmoothingEnabled=W((0,i.getCurrentTransform)(ie),w.interpolate),v(ie,N,0,0,N.width,N.height,0,0,k,H),ie.globalCompositeOperation="source-in";let ye=r.Util.transform((0,i.getCurrentTransformInverse)(ie),[1,0,0,1,-se,-ce]);return ie.fillStyle=G?$.getPattern(I,this,ye,s.PathType.FILL):$,ie.fillRect(0,0,k,H),_&&!G&&(this.cachedCanvases.delete("fillCanvas"),_.set(R,re.canvas)),{canvas:re.canvas,offsetX:Math.round(se),offsetY:Math.round(ce)}}setLineWidth(w){w!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=w,this.ctx.lineWidth=w}setLineCap(w){this.ctx.lineCap=U[w]}setLineJoin(w){this.ctx.lineJoin=ae[w]}setMiterLimit(w){this.ctx.miterLimit=w}setDash(w,I){let k=this.ctx;k.setLineDash!==void 0&&(k.setLineDash(w),k.lineDashOffset=I)}setRenderingIntent(w){}setFlatness(w){}setGState(w){for(let[I,k]of w)switch(I){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k[0],k[1]);break;case"CA":this.current.strokeAlpha=k;break;case"ca":this.current.fillAlpha=k,this.ctx.globalAlpha=k;break;case"BM":this.ctx.globalCompositeOperation=k;break;case"SMask":this.current.activeSMask=k?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(k);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let w=this.inSMaskMode;this.current.activeSMask&&!w?this.beginSMaskMode():!this.current.activeSMask&&w&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let w=this.ctx.canvas.width,I=this.ctx.canvas.height,k="smaskGroupAt"+this.groupLevel,H=this.cachedCanvases.getCanvas(k,w,I);this.suspendedCtx=this.ctx,this.ctx=H.context;let $=this.ctx;$.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),C(this.suspendedCtx,$),m($,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),C(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(w){if(!this.current.activeSMask)return;w?(w[0]=Math.floor(w[0]),w[1]=Math.floor(w[1]),w[2]=Math.ceil(w[2]),w[3]=Math.ceil(w[3])):w=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let I=this.current.activeSMask,k=this.suspendedCtx;L(k,I,this.ctx,w),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(C(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let w=this.current;this.stateStack.push(w),this.current=w.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),C(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(w,I,k,H,$,G){this.ctx.transform(w,I,k,H,$,G),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(w,I,k){let H=this.ctx,$=this.current,G=$.x,j=$.y,_,R,N=(0,i.getCurrentTransform)(H),B=N[0]===0&&N[3]===0||N[1]===0&&N[2]===0,z=B?k.slice(0):null;for(let K=0,Y=0,ee=w.length;K<ee;K++)switch(w[K]|0){case r.OPS.rectangle:G=I[Y++],j=I[Y++];let fe=I[Y++],te=I[Y++],re=G+fe,ie=j+te;H.moveTo(G,j),fe===0||te===0?H.lineTo(re,ie):(H.lineTo(re,j),H.lineTo(re,ie),H.lineTo(G,ie)),B||$.updateRectMinMax(N,[G,j,re,ie]),H.closePath();break;case r.OPS.moveTo:G=I[Y++],j=I[Y++],H.moveTo(G,j),B||$.updatePathMinMax(N,G,j);break;case r.OPS.lineTo:G=I[Y++],j=I[Y++],H.lineTo(G,j),B||$.updatePathMinMax(N,G,j);break;case r.OPS.curveTo:_=G,R=j,G=I[Y+4],j=I[Y+5],H.bezierCurveTo(I[Y],I[Y+1],I[Y+2],I[Y+3],G,j),$.updateCurvePathMinMax(N,_,R,I[Y],I[Y+1],I[Y+2],I[Y+3],G,j,z),Y+=6;break;case r.OPS.curveTo2:_=G,R=j,H.bezierCurveTo(G,j,I[Y],I[Y+1],I[Y+2],I[Y+3]),$.updateCurvePathMinMax(N,_,R,G,j,I[Y],I[Y+1],I[Y+2],I[Y+3],z),G=I[Y+2],j=I[Y+3],Y+=4;break;case r.OPS.curveTo3:_=G,R=j,G=I[Y+2],j=I[Y+3],H.bezierCurveTo(I[Y],I[Y+1],G,j,G,j),$.updateCurvePathMinMax(N,_,R,I[Y],I[Y+1],G,j,G,j,z),Y+=4;break;case r.OPS.closePath:H.closePath();break}B&&$.updateScalingPathMinMax(N,z),$.setCurrentPoint(G,j)}closePath(){this.ctx.closePath()}stroke(w=!0){let I=this.ctx,k=this.current.strokeColor;I.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof k=="object"&&k?.getPattern?(I.save(),I.strokeStyle=k.getPattern(I,this,(0,i.getCurrentTransformInverse)(I),s.PathType.STROKE),this.rescaleAndStroke(!1),I.restore()):this.rescaleAndStroke(!0)),w&&this.consumePath(this.current.getClippedPathBoundingBox()),I.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(w=!0){let I=this.ctx,k=this.current.fillColor,H=this.current.patternFill,$=!1;H&&(I.save(),I.fillStyle=k.getPattern(I,this,(0,i.getCurrentTransformInverse)(I),s.PathType.FILL),$=!0);let G=this.current.getClippedPathBoundingBox();this.contentVisible&&G!==null&&(this.pendingEOFill?(I.fill("evenodd"),this.pendingEOFill=!1):I.fill()),$&&I.restore(),w&&this.consumePath(G)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=pe}eoClip(){this.pendingClip=oe}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let w=this.pendingTextPaths,I=this.ctx;if(w===void 0){I.beginPath();return}I.save(),I.beginPath();for(let k of w)I.setTransform(...k.transform),I.translate(k.x,k.y),k.addToPath(I,k.fontSize);I.restore(),I.clip(),I.beginPath(),delete this.pendingTextPaths}setCharSpacing(w){this.current.charSpacing=w}setWordSpacing(w){this.current.wordSpacing=w}setHScale(w){this.current.textHScale=w/100}setLeading(w){this.current.leading=-w}setFont(w,I){let k=this.commonObjs.get(w),H=this.current;if(!k)throw new Error(`Can't find font for ${w}`);if(H.fontMatrix=k.fontMatrix||r.FONT_IDENTITY_MATRIX,(H.fontMatrix[0]===0||H.fontMatrix[3]===0)&&(0,r.warn)("Invalid font matrix for font "+w),I<0?(I=-I,H.fontDirection=-1):H.fontDirection=1,this.current.font=k,this.current.fontSize=I,k.isType3Font)return;let $=k.loadedName||"sans-serif",G=k.systemFontInfo?.css||`"${$}", ${k.fallbackName}`,j="normal";k.black?j="900":k.bold&&(j="bold");let _=k.italic?"italic":"normal",R=I;I<a?R=a:I>c&&(R=c),this.current.fontSizeScale=I/R,this.ctx.font=`${_} ${j} ${R}px ${G}`}setTextRenderingMode(w){this.current.textRenderingMode=w}setTextRise(w){this.current.textRise=w}moveText(w,I){this.current.x=this.current.lineX+=w,this.current.y=this.current.lineY+=I}setLeadingMoveText(w,I){this.setLeading(-I),this.moveText(w,I)}setTextMatrix(w,I,k,H,$,G){this.current.textMatrix=[w,I,k,H,$,G],this.current.textMatrixScale=Math.hypot(w,I),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(w,I,k,H){let $=this.ctx,G=this.current,j=G.font,_=G.textRenderingMode,R=G.fontSize/G.fontSizeScale,N=_&r.TextRenderingMode.FILL_STROKE_MASK,B=!!(_&r.TextRenderingMode.ADD_TO_PATH_FLAG),z=G.patternFill&&!j.missingFile,K;(j.disableFontFace||B||z)&&(K=j.getPathGenerator(this.commonObjs,w)),j.disableFontFace||z?($.save(),$.translate(I,k),$.beginPath(),K($,R),H&&$.setTransform(...H),(N===r.TextRenderingMode.FILL||N===r.TextRenderingMode.FILL_STROKE)&&$.fill(),(N===r.TextRenderingMode.STROKE||N===r.TextRenderingMode.FILL_STROKE)&&$.stroke(),$.restore()):((N===r.TextRenderingMode.FILL||N===r.TextRenderingMode.FILL_STROKE)&&$.fillText(w,I,k),(N===r.TextRenderingMode.STROKE||N===r.TextRenderingMode.FILL_STROKE)&&$.strokeText(w,I,k)),B&&(this.pendingTextPaths||=[]).push({transform:(0,i.getCurrentTransform)($),x:I,y:k,fontSize:R,addToPath:K})}get isFontSubpixelAAEnabled(){let{context:w}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);w.scale(1.5,1),w.fillText("I",0,10);let I=w.getImageData(0,0,10,10).data,k=!1;for(let H=3;H<I.length;H+=4)if(I[H]>0&&I[H]<255){k=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",k)}showText(w){let I=this.current,k=I.font;if(k.isType3Font)return this.showType3Text(w);let H=I.fontSize;if(H===0)return;let $=this.ctx,G=I.fontSizeScale,j=I.charSpacing,_=I.wordSpacing,R=I.fontDirection,N=I.textHScale*R,B=w.length,z=k.vertical,K=z?1:-1,Y=k.defaultVMetrics,ee=H*I.fontMatrix[0],fe=I.textRenderingMode===r.TextRenderingMode.FILL&&!k.disableFontFace&&!I.patternFill;$.save(),$.transform(...I.textMatrix),$.translate(I.x,I.y+I.textRise),R>0?$.scale(N,-1):$.scale(N,1);let te;if(I.patternFill){$.save();let ye=I.fillColor.getPattern($,this,(0,i.getCurrentTransformInverse)($),s.PathType.FILL);te=(0,i.getCurrentTransform)($),$.restore(),$.fillStyle=ye}let re=I.lineWidth,ie=I.textMatrixScale;if(ie===0||re===0){let ye=I.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;(ye===r.TextRenderingMode.STROKE||ye===r.TextRenderingMode.FILL_STROKE)&&(re=this.getSinglePixelWidth())}else re/=ie;if(G!==1&&($.scale(G,G),re/=G),$.lineWidth=re,k.isInvalidPDFjsFont){let ye=[],be=0;for(let Ae of w)ye.push(Ae.unicode),be+=Ae.width;$.fillText(ye.join(""),0,0),I.x+=be*ee*N,$.restore(),this.compose();return}let se=0,ce;for(ce=0;ce<B;++ce){let ye=w[ce];if(typeof ye=="number"){se+=K*ye*H/1e3;continue}let be=!1,Ae=(ye.isSpace?_:0)+j,xe=ye.fontChar,Ue=ye.accent,et,Zt,Ze=ye.width;if(z){let Rt=ye.vmetric||Y,Ln=-(ye.vmetric?Rt[1]:Ze*.5)*ee,Zs=Rt[2]*ee;Ze=Rt?-Rt[0]:Ze,et=Ln/G,Zt=(se+Zs)/G}else et=se/G,Zt=0;if(k.remeasure&&Ze>0){let Rt=$.measureText(xe).width*1e3/H*G;if(Ze<Rt&&this.isFontSubpixelAAEnabled){let Ln=Ze/Rt;be=!0,$.save(),$.scale(Ln,1),et/=Ln}else Ze!==Rt&&(et+=(Ze-Rt)/2e3*H/G)}if(this.contentVisible&&(ye.isInFont||k.missingFile)){if(fe&&!Ue)$.fillText(xe,et,Zt);else if(this.paintChar(xe,et,Zt,te),Ue){let Rt=et+H*Ue.offset.x/G,Ln=Zt-H*Ue.offset.y/G;this.paintChar(Ue.fontChar,Rt,Ln,te)}}let _t=z?Ze*ee-Ae*R:Ze*ee+Ae*R;se+=_t,be&&$.restore()}z?I.y-=se:I.x+=se*N,$.restore(),this.compose()}showType3Text(w){let I=this.ctx,k=this.current,H=k.font,$=k.fontSize,G=k.fontDirection,j=H.vertical?1:-1,_=k.charSpacing,R=k.wordSpacing,N=k.textHScale*G,B=k.fontMatrix||r.FONT_IDENTITY_MATRIX,z=w.length,K=k.textRenderingMode===r.TextRenderingMode.INVISIBLE,Y,ee,fe,te;if(!(K||$===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,I.save(),I.transform(...k.textMatrix),I.translate(k.x,k.y),I.scale(N,G),Y=0;Y<z;++Y){if(ee=w[Y],typeof ee=="number"){te=j*ee*$/1e3,this.ctx.translate(te,0),k.x+=te*N;continue}let re=(ee.isSpace?R:0)+_,ie=H.charProcOperatorList[ee.operatorListId];if(!ie){(0,r.warn)(`Type3 character "${ee.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ee,this.save(),I.scale($,$),I.transform(...B),this.executeOperatorList(ie),this.restore()),fe=r.Util.applyTransform([ee.width,0],B)[0]*$+re,I.translate(fe,0),k.x+=fe*N}I.restore(),this.processingType3=null}}setCharWidth(w,I){}setCharWidthAndBounds(w,I,k,H,$,G){this.ctx.rect(k,H,$-k,G-H),this.ctx.clip(),this.endPath()}getColorN_Pattern(w){let I;if(w[0]==="TilingPattern"){let k=w[1],H=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),$={createCanvasGraphics:G=>new q(G,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};I=new s.TilingPattern(w,k,this.ctx,$,H)}else I=this._getPattern(w[1],w[2]);return I}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(w,I,k){let H=r.Util.makeHexColor(w,I,k);this.ctx.strokeStyle=H,this.current.strokeColor=H}setFillRGBColor(w,I,k){let H=r.Util.makeHexColor(w,I,k);this.ctx.fillStyle=H,this.current.fillColor=H,this.current.patternFill=!1}_getPattern(w,I=null){let k;return this.cachedPatterns.has(w)?k=this.cachedPatterns.get(w):(k=(0,s.getShadingPattern)(this.getObject(w)),this.cachedPatterns.set(w,k)),I&&(k.matrix=I),k}shadingFill(w){if(!this.contentVisible)return;let I=this.ctx;this.save();let k=this._getPattern(w);I.fillStyle=k.getPattern(I,this,(0,i.getCurrentTransformInverse)(I),s.PathType.SHADING);let H=(0,i.getCurrentTransformInverse)(I);if(H){let{width:$,height:G}=I.canvas,[j,_,R,N]=r.Util.getAxialAlignedBoundingBox([0,0,$,G],H);this.ctx.fillRect(j,_,R-j,N-_)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(w,I){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(w)&&w.length===6&&this.transform(...w),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),I)){let k=I[2]-I[0],H=I[3]-I[1];this.ctx.rect(I[0],I[1],k,H),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),I),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(w){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let I=this.ctx;w.isolated||(0,r.info)("TODO: Support non-isolated groups."),w.knockout&&(0,r.warn)("Knockout groups not supported.");let k=(0,i.getCurrentTransform)(I);if(w.matrix&&I.transform(...w.matrix),!w.bbox)throw new Error("Bounding box is required.");let H=r.Util.getAxialAlignedBoundingBox(w.bbox,(0,i.getCurrentTransform)(I)),$=[0,0,I.canvas.width,I.canvas.height];H=r.Util.intersect(H,$)||[0,0,0,0];let G=Math.floor(H[0]),j=Math.floor(H[1]),_=Math.max(Math.ceil(H[2])-G,1),R=Math.max(Math.ceil(H[3])-j,1),N=1,B=1;_>l&&(N=_/l,_=l),R>l&&(B=R/l,R=l),this.current.startNewPathAndClipBox([0,0,_,R]);let z="groupAt"+this.groupLevel;w.smask&&(z+="_smask_"+this.smaskCounter++%2);let K=this.cachedCanvases.getCanvas(z,_,R),Y=K.context;Y.scale(1/N,1/B),Y.translate(-G,-j),Y.transform(...k),w.smask?this.smaskStack.push({canvas:K.canvas,context:Y,offsetX:G,offsetY:j,scaleX:N,scaleY:B,subtype:w.smask.subtype,backdrop:w.smask.backdrop,transferMap:w.smask.transferMap||null,startTransformInverse:null}):(I.setTransform(1,0,0,1,0,0),I.translate(G,j),I.scale(N,B),I.save()),C(I,Y),this.ctx=Y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(I),this.groupLevel++}endGroup(w){if(!this.contentVisible)return;this.groupLevel--;let I=this.ctx,k=this.groupStack.pop();if(this.ctx=k,this.ctx.imageSmoothingEnabled=!1,w.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let H=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...H);let $=r.Util.getAxialAlignedBoundingBox([0,0,I.canvas.width,I.canvas.height],H);this.ctx.drawImage(I.canvas,0,0),this.ctx.restore(),this.compose($)}}beginAnnotation(w,I,k,H,$){if(this.#e(),P(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(I)&&I.length===4){let G=I[2]-I[0],j=I[3]-I[1];if($&&this.annotationCanvasMap){k=k.slice(),k[4]-=I[0],k[5]-=I[1],I=I.slice(),I[0]=I[1]=0,I[2]=G,I[3]=j;let[_,R]=r.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:N}=this,B=Math.ceil(G*this.outputScaleX*N),z=Math.ceil(j*this.outputScaleY*N);this.annotationCanvas=this.canvasFactory.create(B,z);let{canvas:K,context:Y}=this.annotationCanvas;this.annotationCanvasMap.set(w,K),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Y,this.ctx.save(),this.ctx.setTransform(_,0,0,-R,0,j*R),P(this.ctx)}else P(this.ctx),this.ctx.rect(I[0],I[1],G,j),this.ctx.clip(),this.endPath()}this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...k),this.transform(...H)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(w){if(!this.contentVisible)return;let I=w.count;w=this.getObject(w.data,w),w.count=I;let k=this.ctx,H=this.processingType3;if(H&&(H.compiled===void 0&&(H.compiled=E(w)),H.compiled)){H.compiled(k);return}let $=this._createMaskCanvas(w),G=$.canvas;k.save(),k.setTransform(1,0,0,1,0,0),k.drawImage(G,$.offsetX,$.offsetY),k.restore(),this.compose()}paintImageMaskXObjectRepeat(w,I,k=0,H=0,$,G){if(!this.contentVisible)return;w=this.getObject(w.data,w);let j=this.ctx;j.save();let _=(0,i.getCurrentTransform)(j);j.transform(I,k,H,$,0,0);let R=this._createMaskCanvas(w);j.setTransform(1,0,0,1,R.offsetX-_[4],R.offsetY-_[5]);for(let N=0,B=G.length;N<B;N+=2){let z=r.Util.transform(_,[I,k,H,$,G[N],G[N+1]]),[K,Y]=r.Util.applyTransform([0,0],z);j.drawImage(R.canvas,K,Y)}j.restore(),this.compose()}paintImageMaskXObjectGroup(w){if(!this.contentVisible)return;let I=this.ctx,k=this.current.fillColor,H=this.current.patternFill;for(let $ of w){let{data:G,width:j,height:_,transform:R}=$,N=this.cachedCanvases.getCanvas("maskCanvas",j,_),B=N.context;B.save();let z=this.getObject(G,$);M(B,z),B.globalCompositeOperation="source-in",B.fillStyle=H?k.getPattern(B,this,(0,i.getCurrentTransformInverse)(I),s.PathType.FILL):k,B.fillRect(0,0,j,_),B.restore(),I.save(),I.transform(...R),I.scale(1,-1),v(I,N.canvas,0,0,j,_,0,-1,1,1),I.restore()}this.compose()}paintImageXObject(w){if(!this.contentVisible)return;let I=this.getObject(w);if(!I){(0,r.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(I)}paintImageXObjectRepeat(w,I,k,H){if(!this.contentVisible)return;let $=this.getObject(w);if(!$){(0,r.warn)("Dependent image isn't ready yet");return}let G=$.width,j=$.height,_=[];for(let R=0,N=H.length;R<N;R+=2)_.push({transform:[I,0,0,k,H[R],H[R+1]],x:0,y:0,w:G,h:j});this.paintInlineImageXObjectGroup($,_)}applyTransferMapsToCanvas(w){return this.current.transferMaps!=="none"&&(w.filter=this.current.transferMaps,w.drawImage(w.canvas,0,0),w.filter="none"),w.canvas}applyTransferMapsToBitmap(w){if(this.current.transferMaps==="none")return w.bitmap;let{bitmap:I,width:k,height:H}=w,$=this.cachedCanvases.getCanvas("inlineImage",k,H),G=$.context;return G.filter=this.current.transferMaps,G.drawImage(I,0,0),G.filter="none",$.canvas}paintInlineImageXObject(w){if(!this.contentVisible)return;let I=w.width,k=w.height,H=this.ctx;if(this.save(),!r.isNodeJS){let{filter:j}=H;j!=="none"&&j!==""&&(H.filter="none")}H.scale(1/I,-1/k);let $;if(w.bitmap)$=this.applyTransferMapsToBitmap(w);else if(typeof HTMLElement=="function"&&w instanceof HTMLElement||!w.data)$=w;else{let _=this.cachedCanvases.getCanvas("inlineImage",I,k).context;O(_,w),$=this.applyTransferMapsToCanvas(_)}let G=this._scaleImage($,(0,i.getCurrentTransformInverse)(H));H.imageSmoothingEnabled=W((0,i.getCurrentTransform)(H),w.interpolate),v(H,G.img,0,0,G.paintWidth,G.paintHeight,0,-k,I,k),this.compose(),this.restore()}paintInlineImageXObjectGroup(w,I){if(!this.contentVisible)return;let k=this.ctx,H;if(w.bitmap)H=w.bitmap;else{let $=w.width,G=w.height,_=this.cachedCanvases.getCanvas("inlineImage",$,G).context;O(_,w),H=this.applyTransferMapsToCanvas(_)}for(let $ of I)k.save(),k.transform(...$.transform),k.scale(1,-1),v(k,H,$.x,$.y,$.w,$.h,0,-1,1,1),k.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(w){}markPointProps(w,I){}beginMarkedContent(w){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(w,I){w==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(I)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(w){let I=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(w);let k=this.ctx;this.pendingClip&&(I||(this.pendingClip===oe?k.clip("evenodd"):k.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),k.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let w=(0,i.getCurrentTransform)(this.ctx);if(w[1]===0&&w[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(w[0]),Math.abs(w[3]));else{let I=Math.abs(w[0]*w[3]-w[2]*w[1]),k=Math.hypot(w[0],w[2]),H=Math.hypot(w[1],w[3]);this._cachedGetSinglePixelWidth=Math.max(k,H)/I}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:w}=this.current,{a:I,b:k,c:H,d:$}=this.ctx.getTransform(),G,j;if(k===0&&H===0){let _=Math.abs(I),R=Math.abs($);if(_===R)if(w===0)G=j=1/_;else{let N=_*w;G=j=N<1?1/N:1}else if(w===0)G=1/_,j=1/R;else{let N=_*w,B=R*w;G=N<1?1/N:1,j=B<1?1/B:1}}else{let _=Math.abs(I*$-k*H),R=Math.hypot(I,k),N=Math.hypot(H,$);if(w===0)G=N/_,j=R/_;else{let B=w*_;G=N>B?N/B:1,j=R>B?R/B:1}}this._cachedScaleForStroking[0]=G,this._cachedScaleForStroking[1]=j}return this._cachedScaleForStroking}rescaleAndStroke(w){let{ctx:I}=this,{lineWidth:k}=this.current,[H,$]=this.getScaleForStroking();if(I.lineWidth=k||1,H===1&&$===1){I.stroke();return}let G=I.getLineDash();if(w&&I.save(),I.scale(H,$),G.length>0){let j=Math.max(H,$);I.setLineDash(G.map(_=>_/j)),I.lineDashOffset/=j}I.stroke(),w&&I.restore()}isContentVisible(){for(let w=this.markedContentStack.length-1;w>=0;w--)if(!this.markedContentStack[w].visible)return!1;return!0}}e.CanvasGraphics=q;for(let x in r.OPS)q.prototype[x]!==void 0&&(q.prototype[r.OPS[x]]=q.prototype[x])}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=p;var r=n(1),i=n(6);let s={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=s;function o(v,E){if(!E)return;let A=E[2]-E[0],O=E[3]-E[1],M=new Path2D;M.rect(E[0],E[1],A,O),v.clip(M)}class a{constructor(){this.constructor===a&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class c extends a{constructor(E){super(),this._type=E[1],this._bbox=E[2],this._colorStops=E[3],this._p0=E[4],this._p1=E[5],this._r0=E[6],this._r1=E[7],this.matrix=null}_createGradient(E){let A;this._type==="axial"?A=E.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(A=E.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let O of this._colorStops)A.addColorStop(O[0],O[1]);return A}getPattern(E,A,O,M){let C;if(M===s.STROKE||M===s.FILL){let P=A.current.getClippedPathBoundingBox(M,(0,i.getCurrentTransform)(E))||[0,0,0,0],D=Math.ceil(P[2]-P[0])||1,S=Math.ceil(P[3]-P[1])||1,T=A.cachedCanvases.getCanvas("pattern",D,S,!0),F=T.context;F.clearRect(0,0,F.canvas.width,F.canvas.height),F.beginPath(),F.rect(0,0,F.canvas.width,F.canvas.height),F.translate(-P[0],-P[1]),O=r.Util.transform(O,[1,0,0,1,P[0],P[1]]),F.transform(...A.baseTransform),this.matrix&&F.transform(...this.matrix),o(F,this._bbox),F.fillStyle=this._createGradient(F),F.fill(),C=E.createPattern(T.canvas,"no-repeat");let L=new DOMMatrix(O);C.setTransform(L)}else o(E,this._bbox),C=this._createGradient(E);return C}}function l(v,E,A,O,M,C,P,D){let S=E.coords,T=E.colors,F=v.data,L=v.width*4,W;S[A+1]>S[O+1]&&(W=A,A=O,O=W,W=C,C=P,P=W),S[O+1]>S[M+1]&&(W=O,O=M,M=W,W=P,P=D,D=W),S[A+1]>S[O+1]&&(W=A,A=O,O=W,W=C,C=P,P=W);let U=(S[A]+E.offsetX)*E.scaleX,ae=(S[A+1]+E.offsetY)*E.scaleY,pe=(S[O]+E.offsetX)*E.scaleX,oe=(S[O+1]+E.offsetY)*E.scaleY,q=(S[M]+E.offsetX)*E.scaleX,x=(S[M+1]+E.offsetY)*E.scaleY;if(ae>=x)return;let w=T[C],I=T[C+1],k=T[C+2],H=T[P],$=T[P+1],G=T[P+2],j=T[D],_=T[D+1],R=T[D+2],N=Math.round(ae),B=Math.round(x),z,K,Y,ee,fe,te,re,ie;for(let se=N;se<=B;se++){if(se<oe){let xe=se<ae?0:(ae-se)/(ae-oe);z=U-(U-pe)*xe,K=w-(w-H)*xe,Y=I-(I-$)*xe,ee=k-(k-G)*xe}else{let xe;se>x?xe=1:oe===x?xe=0:xe=(oe-se)/(oe-x),z=pe-(pe-q)*xe,K=H-(H-j)*xe,Y=$-($-_)*xe,ee=G-(G-R)*xe}let ce;se<ae?ce=0:se>x?ce=1:ce=(ae-se)/(ae-x),fe=U-(U-q)*ce,te=w-(w-j)*ce,re=I-(I-_)*ce,ie=k-(k-R)*ce;let ye=Math.round(Math.min(z,fe)),be=Math.round(Math.max(z,fe)),Ae=L*se+ye*4;for(let xe=ye;xe<=be;xe++)ce=(z-xe)/(z-fe),ce<0?ce=0:ce>1&&(ce=1),F[Ae++]=K-(K-te)*ce|0,F[Ae++]=Y-(Y-re)*ce|0,F[Ae++]=ee-(ee-ie)*ce|0,F[Ae++]=255}}function d(v,E,A){let O=E.coords,M=E.colors,C,P;switch(E.type){case"lattice":let D=E.verticesPerRow,S=Math.floor(O.length/D)-1,T=D-1;for(C=0;C<S;C++){let F=C*D;for(let L=0;L<T;L++,F++)l(v,A,O[F],O[F+1],O[F+D],M[F],M[F+1],M[F+D]),l(v,A,O[F+D+1],O[F+1],O[F+D],M[F+D+1],M[F+1],M[F+D])}break;case"triangles":for(C=0,P=O.length;C<P;C+=3)l(v,A,O[C],O[C+1],O[C+2],M[C],M[C+1],M[C+2]);break;default:throw new Error("illegal figure")}}class h extends a{constructor(E){super(),this._coords=E[2],this._colors=E[3],this._figures=E[4],this._bounds=E[5],this._bbox=E[7],this._background=E[8],this.matrix=null}_createMeshCanvas(E,A,O){let D=Math.floor(this._bounds[0]),S=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-D,F=Math.ceil(this._bounds[3])-S,L=Math.min(Math.ceil(Math.abs(T*E[0]*1.1)),3e3),W=Math.min(Math.ceil(Math.abs(F*E[1]*1.1)),3e3),U=T/L,ae=F/W,pe={coords:this._coords,colors:this._colors,offsetX:-D,offsetY:-S,scaleX:1/U,scaleY:1/ae},oe=L+4,q=W+4,x=O.getCanvas("mesh",oe,q,!1),w=x.context,I=w.createImageData(L,W);if(A){let H=I.data;for(let $=0,G=H.length;$<G;$+=4)H[$]=A[0],H[$+1]=A[1],H[$+2]=A[2],H[$+3]=255}for(let H of this._figures)d(I,H,pe);return w.putImageData(I,2,2),{canvas:x.canvas,offsetX:D-2*U,offsetY:S-2*ae,scaleX:U,scaleY:ae}}getPattern(E,A,O,M){o(E,this._bbox);let C;if(M===s.SHADING)C=r.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(E));else if(C=r.Util.singularValueDecompose2dScale(A.baseTransform),this.matrix){let D=r.Util.singularValueDecompose2dScale(this.matrix);C=[C[0]*D[0],C[1]*D[1]]}let P=this._createMeshCanvas(C,M===s.SHADING?null:this._background,A.cachedCanvases);return M!==s.SHADING&&(E.setTransform(...A.baseTransform),this.matrix&&E.transform(...this.matrix)),E.translate(P.offsetX,P.offsetY),E.scale(P.scaleX,P.scaleY),E.createPattern(P.canvas,"no-repeat")}}class f extends a{getPattern(){return"hotpink"}}function p(v){switch(v[0]){case"RadialAxial":return new c(v);case"Mesh":return new h(v);case"Dummy":return new f}throw new Error(`Unknown IR type: ${v[0]}`)}let m={COLORED:1,UNCOLORED:2},g=(()=>{class v{static MAX_PATTERN_SIZE=3e3;constructor(A,O,M,C,P){this.operatorList=A[2],this.matrix=A[3]||[1,0,0,1,0,0],this.bbox=A[4],this.xstep=A[5],this.ystep=A[6],this.paintType=A[7],this.tilingType=A[8],this.color=O,this.ctx=M,this.canvasGraphicsFactory=C,this.baseTransform=P}createPatternCanvas(A){let O=this.operatorList,M=this.bbox,C=this.xstep,P=this.ystep,D=this.paintType,S=this.tilingType,T=this.color,F=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+S);let L=M[0],W=M[1],U=M[2],ae=M[3],pe=r.Util.singularValueDecompose2dScale(this.matrix),oe=r.Util.singularValueDecompose2dScale(this.baseTransform),q=[pe[0]*oe[0],pe[1]*oe[1]],x=this.getSizeAndScale(C,this.ctx.canvas.width,q[0]),w=this.getSizeAndScale(P,this.ctx.canvas.height,q[1]),I=A.cachedCanvases.getCanvas("pattern",x.size,w.size,!0),k=I.context,H=F.createCanvasGraphics(k);H.groupLevel=A.groupLevel,this.setFillAndStrokeStyleToContext(H,D,T);let $=L,G=W,j=U,_=ae;return L<0&&($=0,j+=Math.abs(L)),W<0&&(G=0,_+=Math.abs(W)),k.translate(-(x.scale*$),-(w.scale*G)),H.transform(x.scale,0,0,w.scale,0,0),k.save(),this.clipBbox(H,$,G,j,_),H.baseTransform=(0,i.getCurrentTransform)(H.ctx),H.executeOperatorList(O),H.endDrawing(),{canvas:I.canvas,scaleX:x.scale,scaleY:w.scale,offsetX:$,offsetY:G}}getSizeAndScale(A,O,M){A=Math.abs(A);let C=Math.max(v.MAX_PATTERN_SIZE,O),P=Math.ceil(A*M);return P>=C?P=C:M=P/A,{scale:M,size:P}}clipBbox(A,O,M,C,P){let D=C-O,S=P-M;A.ctx.rect(O,M,D,S),A.current.updateRectMinMax((0,i.getCurrentTransform)(A.ctx),[O,M,C,P]),A.clip(),A.endPath()}setFillAndStrokeStyleToContext(A,O,M){let C=A.ctx,P=A.current;switch(O){case m.COLORED:let D=this.ctx;C.fillStyle=D.fillStyle,C.strokeStyle=D.strokeStyle,P.fillColor=D.fillStyle,P.strokeColor=D.strokeStyle;break;case m.UNCOLORED:let S=r.Util.makeHexColor(M[0],M[1],M[2]);C.fillStyle=S,C.strokeStyle=S,P.fillColor=S,P.strokeColor=S;break;default:throw new r.FormatError(`Unsupported paint type: ${O}`)}}getPattern(A,O,M,C){let P=M;C!==s.SHADING&&(P=r.Util.transform(P,O.baseTransform),this.matrix&&(P=r.Util.transform(P,this.matrix)));let D=this.createPatternCanvas(O),S=new DOMMatrix(P);S=S.translate(D.offsetX,D.offsetY),S=S.scale(1/D.scaleX,1/D.scaleY);let T=A.createPattern(D.canvas,"repeat");return T.setTransform(S),T}}return v})();e.TilingPattern=g}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=s,e.convertToRGBA=i,e.grayToRGBA=a;var r=n(1);function i(c){switch(c.kind){case r.ImageKind.GRAYSCALE_1BPP:return s(c);case r.ImageKind.RGB_24BPP:return o(c)}return null}function s({src:c,srcPos:l=0,dest:d,width:h,height:f,nonBlackColor:p=4294967295,inverseDecode:m=!1}){let g=r.FeatureTest.isLittleEndian?4278190080:255,[v,E]=m?[p,g]:[g,p],A=h>>3,O=h&7,M=c.length;d=new Uint32Array(d.buffer);let C=0;for(let P=0;P<f;P++){for(let S=l+A;l<S;l++){let T=l<M?c[l]:255;d[C++]=T&128?E:v,d[C++]=T&64?E:v,d[C++]=T&32?E:v,d[C++]=T&16?E:v,d[C++]=T&8?E:v,d[C++]=T&4?E:v,d[C++]=T&2?E:v,d[C++]=T&1?E:v}if(O===0)continue;let D=l<M?c[l++]:255;for(let S=0;S<O;S++)d[C++]=D&1<<7-S?E:v}return{srcPos:l,destPos:C}}function o({src:c,srcPos:l=0,dest:d,destPos:h=0,width:f,height:p}){let m=0,g=c.length>>2,v=new Uint32Array(c.buffer,l,g);if(r.FeatureTest.isLittleEndian){for(;m<g-2;m+=3,h+=4){let E=v[m],A=v[m+1],O=v[m+2];d[h]=E|4278190080,d[h+1]=E>>>24|A<<8|4278190080,d[h+2]=A>>>16|O<<16|4278190080,d[h+3]=O>>>8|4278190080}for(let E=m*4,A=c.length;E<A;E+=3)d[h++]=c[E]|c[E+1]<<8|c[E+2]<<16|4278190080}else{for(;m<g-2;m+=3,h+=4){let E=v[m],A=v[m+1],O=v[m+2];d[h]=E|255,d[h+1]=E<<24|A>>>8|255,d[h+2]=A<<16|O>>>16|255,d[h+3]=O<<8|255}for(let E=m*4,A=c.length;E<A;E+=3)d[h++]=c[E]<<24|c[E+1]<<16|c[E+2]<<8|255}return{srcPos:l,destPos:h}}function a(c,l){if(r.FeatureTest.isLittleEndian)for(let d=0,h=c.length;d<h;d++)l[d]=c[d]*65793|4278190080;else for(let d=0,h=c.length;d<h;d++)l[d]=c[d]*16843008|255}}),((t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;let n=Object.create(null);e.GlobalWorkerOptions=n,n.workerPort=null,n.workerSrc=""}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var r=n(1);let i={UNKNOWN:0,DATA:1,ERROR:2},s={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function o(c){switch(c instanceof Error||typeof c=="object"&&c!==null||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),c.name){case"AbortException":return new r.AbortException(c.message);case"MissingPDFException":return new r.MissingPDFException(c.message);case"PasswordException":return new r.PasswordException(c.message,c.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(c.message,c.status);case"UnknownErrorException":return new r.UnknownErrorException(c.message,c.details);default:return new r.UnknownErrorException(c.message,c.toString())}}class a{constructor(l,d,h){this.sourceName=l,this.targetName=d,this.comObj=h,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{let p=f.data;if(p.targetName!==this.sourceName)return;if(p.stream){this.#t(p);return}if(p.callback){let g=p.callbackId,v=this.callbackCapabilities[g];if(!v)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],p.callback===i.DATA)v.resolve(p.data);else if(p.callback===i.ERROR)v.reject(o(p.reason));else throw new Error("Unexpected callback case");return}let m=this.actionHandler[p.action];if(!m)throw new Error(`Unknown action from worker: ${p.action}`);if(p.callbackId){let g=this.sourceName,v=p.sourceName;new Promise(function(E){E(m(p.data))}).then(function(E){h.postMessage({sourceName:g,targetName:v,callback:i.DATA,callbackId:p.callbackId,data:E})},function(E){h.postMessage({sourceName:g,targetName:v,callback:i.ERROR,callbackId:p.callbackId,reason:o(E)})});return}if(p.streamId){this.#e(p);return}m(p.data)},h.addEventListener("message",this._onComObjOnMessage)}on(l,d){let h=this.actionHandler;if(h[l])throw new Error(`There is already an actionName called "${l}"`);h[l]=d}send(l,d,h){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:l,data:d},h)}sendWithPromise(l,d,h){let f=this.callbackId++,p=new r.PromiseCapability;this.callbackCapabilities[f]=p;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:l,callbackId:f,data:d},h)}catch(m){p.reject(m)}return p.promise}sendWithStream(l,d,h,f){let p=this.streamId++,m=this.sourceName,g=this.targetName,v=this.comObj;return new ReadableStream({start:E=>{let A=new r.PromiseCapability;return this.streamControllers[p]={controller:E,startCall:A,pullCall:null,cancelCall:null,isClosed:!1},v.postMessage({sourceName:m,targetName:g,action:l,streamId:p,data:d,desiredSize:E.desiredSize},f),A.promise},pull:E=>{let A=new r.PromiseCapability;return this.streamControllers[p].pullCall=A,v.postMessage({sourceName:m,targetName:g,stream:s.PULL,streamId:p,desiredSize:E.desiredSize}),A.promise},cancel:E=>{(0,r.assert)(E instanceof Error,"cancel must have a valid reason");let A=new r.PromiseCapability;return this.streamControllers[p].cancelCall=A,this.streamControllers[p].isClosed=!0,v.postMessage({sourceName:m,targetName:g,stream:s.CANCEL,streamId:p,reason:o(E)}),A.promise}},h)}#e(l){let d=l.streamId,h=this.sourceName,f=l.sourceName,p=this.comObj,m=this,g=this.actionHandler[l.action],v={enqueue(E,A=1,O){if(this.isCancelled)return;let M=this.desiredSize;this.desiredSize-=A,M>0&&this.desiredSize<=0&&(this.sinkCapability=new r.PromiseCapability,this.ready=this.sinkCapability.promise),p.postMessage({sourceName:h,targetName:f,stream:s.ENQUEUE,streamId:d,chunk:E},O)},close(){this.isCancelled||(this.isCancelled=!0,p.postMessage({sourceName:h,targetName:f,stream:s.CLOSE,streamId:d}),delete m.streamSinks[d])},error(E){(0,r.assert)(E instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,p.postMessage({sourceName:h,targetName:f,stream:s.ERROR,streamId:d,reason:o(E)}))},sinkCapability:new r.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:l.desiredSize,ready:null};v.sinkCapability.resolve(),v.ready=v.sinkCapability.promise,this.streamSinks[d]=v,new Promise(function(E){E(g(l.data,v))}).then(function(){p.postMessage({sourceName:h,targetName:f,stream:s.START_COMPLETE,streamId:d,success:!0})},function(E){p.postMessage({sourceName:h,targetName:f,stream:s.START_COMPLETE,streamId:d,reason:o(E)})})}#t(l){let d=l.streamId,h=this.sourceName,f=l.sourceName,p=this.comObj,m=this.streamControllers[d],g=this.streamSinks[d];switch(l.stream){case s.START_COMPLETE:l.success?m.startCall.resolve():m.startCall.reject(o(l.reason));break;case s.PULL_COMPLETE:l.success?m.pullCall.resolve():m.pullCall.reject(o(l.reason));break;case s.PULL:if(!g){p.postMessage({sourceName:h,targetName:f,stream:s.PULL_COMPLETE,streamId:d,success:!0});break}g.desiredSize<=0&&l.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=l.desiredSize,new Promise(function(v){v(g.onPull?.())}).then(function(){p.postMessage({sourceName:h,targetName:f,stream:s.PULL_COMPLETE,streamId:d,success:!0})},function(v){p.postMessage({sourceName:h,targetName:f,stream:s.PULL_COMPLETE,streamId:d,reason:o(v)})});break;case s.ENQUEUE:if((0,r.assert)(m,"enqueue should have stream controller"),m.isClosed)break;m.controller.enqueue(l.chunk);break;case s.CLOSE:if((0,r.assert)(m,"close should have stream controller"),m.isClosed)break;m.isClosed=!0,m.controller.close(),this.#n(m,d);break;case s.ERROR:(0,r.assert)(m,"error should have stream controller"),m.controller.error(o(l.reason)),this.#n(m,d);break;case s.CANCEL_COMPLETE:l.success?m.cancelCall.resolve():m.cancelCall.reject(o(l.reason)),this.#n(m,d);break;case s.CANCEL:if(!g)break;new Promise(function(v){v(g.onCancel?.(o(l.reason)))}).then(function(){p.postMessage({sourceName:h,targetName:f,stream:s.CANCEL_COMPLETE,streamId:d,success:!0})},function(v){p.postMessage({sourceName:h,targetName:f,stream:s.CANCEL_COMPLETE,streamId:d,reason:o(v)})}),g.sinkCapability.reject(o(l.reason)),g.isCancelled=!0,delete this.streamSinks[d];break;default:throw new Error("Unexpected stream case")}}#n(l,d){return X(this,null,function*(){yield Promise.allSettled([l.startCall?.promise,l.pullCall?.promise,l.cancelCall?.promise]),delete this.streamControllers[d]})}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}e.MessageHandler=a}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var r=n(1);class i{#e;#t;constructor({parsedData:o,rawData:a}){this.#e=o,this.#t=a}getRaw(){return this.#t}get(o){return this.#e.get(o)??null}getAll(){return(0,r.objectFromMap)(this.#e)}has(o){return this.#e.has(o)}}e.Metadata=i}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var r=n(1),i=n(8);let s=Symbol("INTERNAL");class o{#e=!0;constructor(l,d){this.name=l,this.intent=d}get visible(){return this.#e}_setVisible(l,d){l!==s&&(0,r.unreachable)("Internal method `_setVisible` called."),this.#e=d}}class a{#e=null;#t=new Map;#n=null;#r=null;constructor(l){if(this.name=null,this.creator=null,l!==null){this.name=l.name,this.creator=l.creator,this.#r=l.order;for(let d of l.groups)this.#t.set(d.id,new o(d.name,d.intent));if(l.baseState==="OFF")for(let d of this.#t.values())d._setVisible(s,!1);for(let d of l.on)this.#t.get(d)._setVisible(s,!0);for(let d of l.off)this.#t.get(d)._setVisible(s,!1);this.#n=this.getHash()}}#a(l){let d=l.length;if(d<2)return!0;let h=l[0];for(let f=1;f<d;f++){let p=l[f],m;if(Array.isArray(p))m=this.#a(p);else if(this.#t.has(p))m=this.#t.get(p).visible;else return(0,r.warn)(`Optional content group not found: ${p}`),!0;switch(h){case"And":if(!m)return!1;break;case"Or":if(m)return!0;break;case"Not":return!m;default:return!0}}return h==="And"}isVisible(l){if(this.#t.size===0)return!0;if(!l)return(0,r.warn)("Optional content group not defined."),!0;if(l.type==="OCG")return this.#t.has(l.id)?this.#t.get(l.id).visible:((0,r.warn)(`Optional content group not found: ${l.id}`),!0);if(l.type==="OCMD"){if(l.expression)return this.#a(l.expression);if(!l.policy||l.policy==="AnyOn"){for(let d of l.ids){if(!this.#t.has(d))return(0,r.warn)(`Optional content group not found: ${d}`),!0;if(this.#t.get(d).visible)return!0}return!1}else if(l.policy==="AllOn"){for(let d of l.ids){if(!this.#t.has(d))return(0,r.warn)(`Optional content group not found: ${d}`),!0;if(!this.#t.get(d).visible)return!1}return!0}else if(l.policy==="AnyOff"){for(let d of l.ids){if(!this.#t.has(d))return(0,r.warn)(`Optional content group not found: ${d}`),!0;if(!this.#t.get(d).visible)return!0}return!1}else if(l.policy==="AllOff"){for(let d of l.ids){if(!this.#t.has(d))return(0,r.warn)(`Optional content group not found: ${d}`),!0;if(this.#t.get(d).visible)return!1}return!0}return(0,r.warn)(`Unknown optional content policy ${l.policy}.`),!0}return(0,r.warn)(`Unknown group type ${l.type}.`),!0}setVisibility(l,d=!0){if(!this.#t.has(l)){(0,r.warn)(`Optional content group not found: ${l}`);return}this.#t.get(l)._setVisible(s,!!d),this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?(0,r.objectFromMap)(this.#t):null}getGroup(l){return this.#t.get(l)||null}getHash(){if(this.#e!==null)return this.#e;let l=new i.MurmurHash3_64;for(let[d,h]of this.#t)l.update(`${d}:${h.visible}`);return this.#e=l.hexdigest()}}e.OptionalContentConfig=a}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var r=n(1),i=n(6);class s{constructor({length:l,initialData:d,progressiveDone:h=!1,contentDispositionFilename:f=null,disableRange:p=!1,disableStream:m=!1},g){if((0,r.assert)(g,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=h,this._contentDispositionFilename=f,d?.length>0){let v=d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength?d.buffer:new Uint8Array(d).buffer;this._queuedChunks.push(v)}this._pdfDataRangeTransport=g,this._isStreamingSupported=!m,this._isRangeSupported=!p,this._contentLength=l,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((v,E)=>{this._onReceiveData({begin:v,chunk:E})}),this._pdfDataRangeTransport.addProgressListener((v,E)=>{this._onProgress({loaded:v,total:E})}),this._pdfDataRangeTransport.addProgressiveReadListener(v=>{this._onReceiveData({chunk:v})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:l,chunk:d}){let h=d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength?d.buffer:new Uint8Array(d).buffer;if(l===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(h):this._queuedChunks.push(h);else{let f=this._rangeReaders.some(function(p){return p._begin!==l?!1:(p._enqueue(h),!0)});(0,r.assert)(f,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(l){l.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:l.loaded}):this._fullRequestReader?.onProgress?.({loaded:l.loaded,total:l.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(l){let d=this._rangeReaders.indexOf(l);d>=0&&this._rangeReaders.splice(d,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let l=this._queuedChunks;return this._queuedChunks=null,new o(this,l,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(l,d){if(d<=this._progressiveDataLength)return null;let h=new a(this,l,d);return this._pdfDataRangeTransport.requestDataRange(l,d),this._rangeReaders.push(h),h}cancelAllRequests(l){this._fullRequestReader?.cancel(l);for(let d of this._rangeReaders.slice(0))d.cancel(l);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=s;class o{constructor(l,d,h=!1,f=null){this._stream=l,this._done=h||!1,this._filename=(0,i.isPdfFile)(f)?f:null,this._queuedChunks=d||[],this._loaded=0;for(let p of this._queuedChunks)this._loaded+=p.byteLength;this._requests=[],this._headersReady=Promise.resolve(),l._fullRequestReader=this,this.onProgress=null}_enqueue(l){this._done||(this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunks.push(l),this._loaded+=l.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return X(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let l=new r.PromiseCapability;return this._requests.push(l),l.promise})}cancel(l){this._done=!0;for(let d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class a{constructor(l,d,h){this._stream=l,this._begin=d,this._end=h,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(l){if(!this._done){if(this._requests.length===0)this._queuedChunk=l;else{this._requests.shift().resolve({value:l,done:!1});for(let h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return X(this,null,function*(){if(this._queuedChunk){let d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};let l=new r.PromiseCapability;return this._requests.push(l),l.promise})}cancel(l){this._done=!0;for(let d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var r=n(1),i=n(20);function s(h,f,p){return{method:"GET",headers:h,signal:p.signal,mode:"cors",credentials:f?"include":"same-origin",redirect:"follow"}}function o(h){let f=new Headers;for(let p in h){let m=h[p];m!==void 0&&f.append(p,m)}return f}function a(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:((0,r.warn)(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class c{constructor(f){this.source=f,this.isHttp=/^https?:/i.test(f.url),this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(f,p){if(p<=this._progressiveDataLength)return null;let m=new d(this,f,p);return this._rangeRequestReaders.push(m),m}cancelAllRequests(f){this._fullRequestReader?.cancel(f);for(let p of this._rangeRequestReaders.slice(0))p.cancel(f)}}e.PDFFetchStream=c;class l{constructor(f){this._stream=f,this._reader=null,this._loaded=0,this._filename=null;let p=f.source;this._withCredentials=p.withCredentials||!1,this._contentLength=p.length,this._headersCapability=new r.PromiseCapability,this._disableRange=p.disableRange||!1,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!p.disableStream,this._isRangeSupported=!p.disableRange,this._headers=o(this._stream.httpHeaders);let m=p.url;fetch(m,s(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,i.validateResponseStatus)(g.status))throw(0,i.createResponseStatusError)(g.status,m);this._reader=g.body.getReader(),this._headersCapability.resolve();let v=O=>g.headers.get(O),{allowRangeRequests:E,suggestedLength:A}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=E,this._contentLength=A||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(v),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return X(this,null,function*(){yield this._headersCapability.promise;let{value:f,done:p}=yield this._reader.read();return p?{value:f,done:p}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:a(f),done:!1})})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}class d{constructor(f,p,m){this._stream=f,this._reader=null,this._loaded=0;let g=f.source;this._withCredentials=g.withCredentials||!1,this._readCapability=new r.PromiseCapability,this._isStreamingSupported=!g.disableStream,this._abortController=new AbortController,this._headers=o(this._stream.httpHeaders),this._headers.append("Range",`bytes=${p}-${m-1}`);let v=g.url;fetch(v,s(this._headers,this._withCredentials,this._abortController)).then(E=>{if(!(0,i.validateResponseStatus)(E.status))throw(0,i.createResponseStatusError)(E.status,v);this._readCapability.resolve(),this._reader=E.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return X(this,null,function*(){yield this._readCapability.promise;let{value:f,done:p}=yield this._reader.read();return p?{value:f,done:p}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded}),{value:a(f),done:!1})})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=c,e.extractFilenameFromHeader=a,e.validateRangeRequestCapabilities=o,e.validateResponseStatus=l;var r=n(1),i=n(21),s=n(6);function o({getResponseHeader:d,isHttp:h,rangeChunkSize:f,disableRange:p}){let m={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(d("Content-Length"),10);return!Number.isInteger(g)||(m.suggestedLength=g,g<=2*f)||p||!h||d("Accept-Ranges")!=="bytes"||(d("Content-Encoding")||"identity")!=="identity"||(m.allowRangeRequests=!0),m}function a(d){let h=d("Content-Disposition");if(h){let f=(0,i.getFilenameFromContentDispositionHeader)(h);if(f.includes("%"))try{f=decodeURIComponent(f)}catch{}if((0,s.isPdfFile)(f))return f}return null}function c(d,h){return d===404||d===0&&h.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+h+'".'):new r.UnexpectedResponseException(`Unexpected server response (${d}) while retrieving PDF "${h}".`,d)}function l(d){return d===200||d===206}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=i;var r=n(1);function i(s){let o=!0,a=c("filename\\*","i").exec(s);if(a){a=a[1];let g=f(a);return g=unescape(g),g=p(g),g=m(g),d(g)}if(a=h(s),a){let g=m(a);return d(g)}if(a=c("filename","i").exec(s),a){a=a[1];let g=f(a);return g=m(g),d(g)}function c(g,v){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function l(g,v){if(g){if(!/^[\x00-\xFF]+$/.test(v))return v;try{let E=new TextDecoder(g,{fatal:!0}),A=(0,r.stringToBytes)(v);v=E.decode(A),o=!1}catch{}}return v}function d(g){return o&&/[\x80-\xff]/.test(g)&&(g=l("utf-8",g),o&&(g=l("iso-8859-1",g))),g}function h(g){let v=[],E,A=c("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(E=A.exec(g))!==null;){let[,M,C,P]=E;if(M=parseInt(M,10),M in v){if(M===0)break;continue}v[M]=[C,P]}let O=[];for(let M=0;M<v.length&&M in v;++M){let[C,P]=v[M];P=f(P),C&&(P=unescape(P),M===0&&(P=p(P))),O.push(P)}return O.join("")}function f(g){if(g.startsWith('"')){let v=g.slice(1).split('\\"');for(let E=0;E<v.length;++E){let A=v[E].indexOf('"');A!==-1&&(v[E]=v[E].slice(0,A),v.length=E+1),v[E]=v[E].replaceAll(/\\(.)/g,"$1")}g=v.join('"')}return g}function p(g){let v=g.indexOf("'");if(v===-1)return g;let E=g.slice(0,v),O=g.slice(v+1).replace(/^[^']*'/,"");return l(E,O)}function m(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,E,A,O){if(A==="q"||A==="Q")return O=O.replaceAll("_"," "),O=O.replaceAll(/=([0-9a-fA-F]{2})/g,function(M,C){return String.fromCharCode(parseInt(C,16))}),l(E,O);try{O=atob(O)}catch{}return l(E,O)})}return""}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var r=n(1),i=n(20);let s=200,o=206;function a(f){let p=f.response;return typeof p!="string"?p:(0,r.stringToBytes)(p).buffer}class c{constructor(p,m={}){this.url=p,this.isHttp=/^https?:/i.test(p),this.httpHeaders=this.isHttp&&m.httpHeaders||Object.create(null),this.withCredentials=m.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(p,m,g){let v={begin:p,end:m};for(let E in g)v[E]=g[E];return this.request(v)}requestFull(p){return this.request(p)}request(p){let m=new XMLHttpRequest,g=this.currXhrId++,v=this.pendingRequests[g]={xhr:m};m.open("GET",this.url),m.withCredentials=this.withCredentials;for(let E in this.httpHeaders){let A=this.httpHeaders[E];A!==void 0&&m.setRequestHeader(E,A)}return this.isHttp&&"begin"in p&&"end"in p?(m.setRequestHeader("Range",`bytes=${p.begin}-${p.end-1}`),v.expectedStatus=o):v.expectedStatus=s,m.responseType="arraybuffer",p.onError&&(m.onerror=function(E){p.onError(m.status)}),m.onreadystatechange=this.onStateChange.bind(this,g),m.onprogress=this.onProgress.bind(this,g),v.onHeadersReceived=p.onHeadersReceived,v.onDone=p.onDone,v.onError=p.onError,v.onProgress=p.onProgress,m.send(null),g}onProgress(p,m){let g=this.pendingRequests[p];g&&g.onProgress?.(m)}onStateChange(p,m){let g=this.pendingRequests[p];if(!g)return;let v=g.xhr;if(v.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),v.readyState!==4||!(p in this.pendingRequests))return;if(delete this.pendingRequests[p],v.status===0&&this.isHttp){g.onError?.(v.status);return}let E=v.status||s;if(!(E===s&&g.expectedStatus===o)&&E!==g.expectedStatus){g.onError?.(v.status);return}let O=a(v);if(E===o){let M=v.getResponseHeader("Content-Range"),C=/bytes (\d+)-(\d+)\/(\d+)/.exec(M);g.onDone({begin:parseInt(C[1],10),chunk:O})}else O?g.onDone({begin:0,chunk:O}):g.onError?.(v.status)}getRequestXhr(p){return this.pendingRequests[p].xhr}isPendingRequest(p){return p in this.pendingRequests}abortRequest(p){let m=this.pendingRequests[p].xhr;delete this.pendingRequests[p],m.abort()}}class l{constructor(p){this._source=p,this._manager=new c(p.url,{httpHeaders:p.httpHeaders,withCredentials:p.withCredentials}),this._rangeChunkSize=p.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(p){let m=this._rangeRequestReaders.indexOf(p);m>=0&&this._rangeRequestReaders.splice(m,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new d(this._manager,this._source),this._fullRequestReader}getRangeReader(p,m){let g=new h(this._manager,p,m);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(p){this._fullRequestReader?.cancel(p);for(let m of this._rangeRequestReaders.slice(0))m.cancel(p)}}e.PDFNetworkStream=l;class d{constructor(p,m){this._manager=p;let g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._fullRequestId=p.requestFull(g),this._headersReceivedCapability=new r.PromiseCapability,this._disableRange=m.disableRange||!1,this._contentLength=m.length,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let p=this._fullRequestId,m=this._manager.getRequestXhr(p),g=A=>m.getResponseHeader(A),{allowRangeRequests:v,suggestedLength:E}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});v&&(this._isRangeSupported=!0),this._contentLength=E||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(p),this._headersReceivedCapability.resolve()}_onDone(p){if(p&&(this._requests.length>0?this._requests.shift().resolve({value:p.chunk,done:!1}):this._cachedChunks.push(p.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(p){this._storedError=(0,i.createResponseStatusError)(p,this._url),this._headersReceivedCapability.reject(this._storedError);for(let m of this._requests)m.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(p){this.onProgress?.({loaded:p.loaded,total:p.lengthComputable?p.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){return X(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let p=new r.PromiseCapability;return this._requests.push(p),p.promise})}cancel(p){this._done=!0,this._headersReceivedCapability.reject(p);for(let m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class h{constructor(p,m,g){this._manager=p;let v={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._requestId=p.requestRange(m,g,v),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(p){let m=p.chunk;this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunk=m,this._done=!0;for(let g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(p){this._storedError=(0,i.createResponseStatusError)(p,this._url);for(let m of this._requests)m.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(p){this.isStreamingSupported||this.onProgress?.({loaded:p.loaded})}get isStreamingSupported(){return!1}read(){return X(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};let p=new r.PromiseCapability;return this._requests.push(p),p.promise})}cancel(p){this._done=!0;for(let m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var r=n(1),i=n(20);let s=/^file:\/\/\/[a-zA-Z]:\//;function o(g){let v=hP(),E=v.parse(g);return E.protocol==="file:"||E.host?E:/^[a-z]:[/\\]/i.test(g)?v.parse(`file:///${g}`):(E.host||(E.protocol="file:"),E)}class a{constructor(v){this.source=v,this.url=o(v.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new h(this),this._fullRequestReader}getRangeReader(v,E){if(E<=this._progressiveDataLength)return null;let A=this.isFsUrl?new m(this,v,E):new f(this,v,E);return this._rangeRequestReaders.push(A),A}cancelAllRequests(v){this._fullRequestReader?.cancel(v);for(let E of this._rangeRequestReaders.slice(0))E.cancel(v)}}e.PDFNodeStream=a;class c{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null;let E=v.source;this._contentLength=E.length,this._loaded=0,this._filename=null,this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._readableStream=null,this._readCapability=new r.PromiseCapability,this._headersCapability=new r.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return X(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let v=this._readableStream.read();return v===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",E=>{this._error(E)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class l{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new r.PromiseCapability;let E=v.source;this._isStreamingSupported=!E.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return X(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let v=this._readableStream.read();return v===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",E=>{this._error(E)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function d(g,v){return{protocol:g.protocol,auth:g.auth,host:g.hostname,port:g.port,path:g.path,method:"GET",headers:v}}class h extends c{constructor(v){super(v);let E=A=>{if(A.statusCode===404){let P=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=P,this._headersCapability.reject(P);return}this._headersCapability.resolve(),this._setReadableStream(A);let O=P=>this._readableStream.headers[P.toLowerCase()],{allowRangeRequests:M,suggestedLength:C}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:O,isHttp:v.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=M,this._contentLength=C||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(O)};if(this._request=null,this._url.protocol==="http:"){let A=yb();this._request=A.request(d(this._url,v.httpHeaders),E)}else{let A=vb();this._request=A.request(d(this._url,v.httpHeaders),E)}this._request.on("error",A=>{this._storedError=A,this._headersCapability.reject(A)}),this._request.end()}}class f extends l{constructor(v,E,A){super(v),this._httpHeaders={};for(let M in v.httpHeaders){let C=v.httpHeaders[M];C!==void 0&&(this._httpHeaders[M]=C)}this._httpHeaders.Range=`bytes=${E}-${A-1}`;let O=M=>{if(M.statusCode===404){let C=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=C;return}this._setReadableStream(M)};if(this._request=null,this._url.protocol==="http:"){let M=yb();this._request=M.request(d(this._url,this._httpHeaders),O)}else{let M=vb();this._request=M.request(d(this._url,this._httpHeaders),O)}this._request.on("error",M=>{this._storedError=M}),this._request.end()}}class p extends c{constructor(v){super(v);let E=decodeURIComponent(this._url.path);s.test(this._url.href)&&(E=E.replace(/^\//,""));let A=Hf();A.lstat(E,(O,M)=>{if(O){O.code==="ENOENT"&&(O=new r.MissingPDFException(`Missing PDF "${E}".`)),this._storedError=O,this._headersCapability.reject(O);return}this._contentLength=M.size,this._setReadableStream(A.createReadStream(E)),this._headersCapability.resolve()})}}class m extends l{constructor(v,E,A){super(v);let O=decodeURIComponent(this._url.path);s.test(this._url.href)&&(O=O.replace(/^\//,""));let M=Hf();this._setReadableStream(M.createReadStream(O,{start:E,end:A-1}))}}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var r=n(6),i=n(1);let s={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},o="http://www.w3.org/XML/1998/namespace",a="http://www.w3.org/1999/xlink",c=["butt","round","square"],l=["miter","round","bevel"],d=function(M,C="",P=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!P)return URL.createObjectURL(new Blob([M],{type:C}));let D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",S=`data:${C};base64,`;for(let T=0,F=M.length;T<F;T+=3){let L=M[T]&255,W=M[T+1]&255,U=M[T+2]&255,ae=L>>2,pe=(L&3)<<4|W>>4,oe=T+1<F?(W&15)<<2|U>>6:64,q=T+2<F?U&63:64;S+=D[ae]+D[pe]+D[oe]+D[q]}return S},h=(function(){let M=new Uint8Array([137,80,78,71,13,10,26,10]),C=12,P=new Int32Array(256);for(let U=0;U<256;U++){let ae=U;for(let pe=0;pe<8;pe++)ae=ae&1?3988292384^ae>>1&2147483647:ae>>1&2147483647;P[U]=ae}function D(U,ae,pe){let oe=-1;for(let q=ae;q<pe;q++){let x=(oe^U[q])&255,w=P[x];oe=oe>>>8^w}return oe^-1}function S(U,ae,pe,oe){let q=oe,x=ae.length;pe[q]=x>>24&255,pe[q+1]=x>>16&255,pe[q+2]=x>>8&255,pe[q+3]=x&255,q+=4,pe[q]=U.charCodeAt(0)&255,pe[q+1]=U.charCodeAt(1)&255,pe[q+2]=U.charCodeAt(2)&255,pe[q+3]=U.charCodeAt(3)&255,q+=4,pe.set(ae,q),q+=ae.length;let w=D(pe,oe+4,q);pe[q]=w>>24&255,pe[q+1]=w>>16&255,pe[q+2]=w>>8&255,pe[q+3]=w&255}function T(U,ae,pe){let oe=1,q=0;for(let x=ae;x<pe;++x)oe=(oe+(U[x]&255))%65521,q=(q+oe)%65521;return q<<16|oe}function F(U){if(!i.isNodeJS)return L(U);try{let ae=parseInt(process.versions.node)>=8?U:Buffer.from(U),pe=fP().deflateSync(ae,{level:9});return pe instanceof Uint8Array?pe:new Uint8Array(pe)}catch(ae){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+ae)}return L(U)}function L(U){let ae=U.length,pe=65535,oe=Math.ceil(ae/pe),q=new Uint8Array(2+ae+oe*5+4),x=0;q[x++]=120,q[x++]=156;let w=0;for(;ae>pe;)q[x++]=0,q[x++]=255,q[x++]=255,q[x++]=0,q[x++]=0,q.set(U.subarray(w,w+pe),x),x+=pe,w+=pe,ae-=pe;q[x++]=1,q[x++]=ae&255,q[x++]=ae>>8&255,q[x++]=~ae&65535&255,q[x++]=(~ae&65535)>>8&255,q.set(U.subarray(w),x),x+=U.length-w;let I=T(U,0,U.length);return q[x++]=I>>24&255,q[x++]=I>>16&255,q[x++]=I>>8&255,q[x++]=I&255,q}function W(U,ae,pe,oe){let q=U.width,x=U.height,w,I,k,H=U.data;switch(ae){case i.ImageKind.GRAYSCALE_1BPP:I=0,w=1,k=q+7>>3;break;case i.ImageKind.RGB_24BPP:I=2,w=8,k=q*3;break;case i.ImageKind.RGBA_32BPP:I=6,w=8,k=q*4;break;default:throw new Error("invalid format")}let $=new Uint8Array((1+k)*x),G=0,j=0;for(let K=0;K<x;++K)$[G++]=0,$.set(H.subarray(j,j+k),G),j+=k,G+=k;if(ae===i.ImageKind.GRAYSCALE_1BPP&&oe){G=0;for(let K=0;K<x;K++){G++;for(let Y=0;Y<k;Y++)$[G++]^=255}}let _=new Uint8Array([q>>24&255,q>>16&255,q>>8&255,q&255,x>>24&255,x>>16&255,x>>8&255,x&255,w,I,0,0,0]),R=F($),N=M.length+C*3+_.length+R.length,B=new Uint8Array(N),z=0;return B.set(M,z),z+=M.length,S("IHDR",_,B,z),z+=C+_.length,S("IDATA",R,B,z),z+=C+R.length,S("IEND",new Uint8Array(0),B,z),d(B,"image/png",pe)}return function(ae,pe,oe){let q=ae.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:ae.kind;return W(ae,q,pe,oe)}})();class f{constructor(){this.fontSizeScale=1,this.fontWeight=s.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=s.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(C,P){this.x=C,this.y=P}}function p(M){let C=[],P=[];for(let D of M){if(D.fn==="save"){C.push({fnId:92,fn:"group",items:[]}),P.push(C),C=C.at(-1).items;continue}D.fn==="restore"?C=P.pop():C.push(D)}return C}function m(M){if(Number.isInteger(M))return M.toString();let C=M.toFixed(10),P=C.length-1;if(C[P]!=="0")return C;do P--;while(C[P]==="0");return C.substring(0,C[P]==="."?P:P+1)}function g(M){if(M[4]===0&&M[5]===0){if(M[1]===0&&M[2]===0)return M[0]===1&&M[3]===1?"":`scale(${m(M[0])} ${m(M[3])})`;if(M[0]===M[3]&&M[1]===-M[2]){let C=Math.acos(M[0])*180/Math.PI;return`rotate(${m(C)})`}}else if(M[0]===1&&M[1]===0&&M[2]===0&&M[3]===1)return`translate(${m(M[4])} ${m(M[5])})`;return`matrix(${m(M[0])} ${m(M[1])} ${m(M[2])} ${m(M[3])} ${m(M[4])} ${m(M[5])})`}let v=0,E=0,A=0;class O{constructor(C,P,D=!1){(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new f,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=C,this.objs=P,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!D,this._operatorIdMapping=[];for(let S in i.OPS)this._operatorIdMapping[i.OPS[S]]=S}getObject(C,P=null){return typeof C=="string"?C.startsWith("g_")?this.commonObjs.get(C):this.objs.get(C):P}save(){this.transformStack.push(this.transformMatrix);let C=this.current;this.extraStack.push(C),this.current=C.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(C){this.save(),this.executeOpTree(C),this.restore()}loadDependencies(C){let P=C.fnArray,D=C.argsArray;for(let S=0,T=P.length;S<T;S++)if(P[S]===i.OPS.dependency)for(let F of D[S]){let L=F.startsWith("g_")?this.commonObjs:this.objs,W=new Promise(U=>{L.get(F,U)});this.current.dependencies.push(W)}return Promise.all(this.current.dependencies)}transform(C,P,D,S,T,F){let L=[C,P,D,S,T,F];this.transformMatrix=i.Util.transform(this.transformMatrix,L),this.tgrp=null}getSVG(C,P){this.viewport=P;let D=this._initialize(P);return this.loadDependencies(C).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(C)),D))}convertOpList(C){let P=this._operatorIdMapping,D=C.argsArray,S=C.fnArray,T=[];for(let F=0,L=S.length;F<L;F++){let W=S[F];T.push({fnId:W,fn:P[W],args:D[F]})}return p(T)}executeOpTree(C){for(let P of C){let D=P.fn,S=P.fnId,T=P.args;switch(S|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(T);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case i.OPS.setFont:this.setFont(T);break;case i.OPS.showText:this.showText(T[0]);break;case i.OPS.showSpacedText:this.showText(T[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(T[0],T[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case i.OPS.setHScale:this.setHScale(T[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case i.OPS.setTextRise:this.setTextRise(T[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case i.OPS.setLineWidth:this.setLineWidth(T[0]);break;case i.OPS.setLineJoin:this.setLineJoin(T[0]);break;case i.OPS.setLineCap:this.setLineCap(T[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case i.OPS.setFillColorN:this.setFillColorN(T);break;case i.OPS.shadingFill:this.shadingFill(T[0]);break;case i.OPS.setDash:this.setDash(T[0],T[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case i.OPS.setFlatness:this.setFlatness(T[0]);break;case i.OPS.setGState:this.setGState(T[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case i.OPS.constructPath:this.constructPath(T[0],T[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(P.items);break;default:(0,i.warn)(`Unimplemented operator ${D}`);break}}}setWordSpacing(C){this.current.wordSpacing=C}setCharSpacing(C){this.current.charSpacing=C}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(C,P,D,S,T,F){let L=this.current;L.textMatrix=L.lineMatrix=[C,P,D,S,T,F],L.textMatrixScale=Math.hypot(C,P),L.x=L.lineX=0,L.y=L.lineY=0,L.xcoords=[],L.ycoords=[],L.tspan=this.svgFactory.createElement("svg:tspan"),L.tspan.setAttributeNS(null,"font-family",L.fontFamily),L.tspan.setAttributeNS(null,"font-size",`${m(L.fontSize)}px`),L.tspan.setAttributeNS(null,"y",m(-L.y)),L.txtElement=this.svgFactory.createElement("svg:text"),L.txtElement.append(L.tspan)}beginText(){let C=this.current;C.x=C.lineX=0,C.y=C.lineY=0,C.textMatrix=i.IDENTITY_MATRIX,C.lineMatrix=i.IDENTITY_MATRIX,C.textMatrixScale=1,C.tspan=this.svgFactory.createElement("svg:tspan"),C.txtElement=this.svgFactory.createElement("svg:text"),C.txtgrp=this.svgFactory.createElement("svg:g"),C.xcoords=[],C.ycoords=[]}moveText(C,P){let D=this.current;D.x=D.lineX+=C,D.y=D.lineY+=P,D.xcoords=[],D.ycoords=[],D.tspan=this.svgFactory.createElement("svg:tspan"),D.tspan.setAttributeNS(null,"font-family",D.fontFamily),D.tspan.setAttributeNS(null,"font-size",`${m(D.fontSize)}px`),D.tspan.setAttributeNS(null,"y",m(-D.y))}showText(C){let P=this.current,D=P.font,S=P.fontSize;if(S===0)return;let T=P.fontSizeScale,F=P.charSpacing,L=P.wordSpacing,W=P.fontDirection,U=P.textHScale*W,ae=D.vertical,pe=ae?1:-1,oe=D.defaultVMetrics,q=S*P.fontMatrix[0],x=0;for(let k of C){if(k===null){x+=W*L;continue}else if(typeof k=="number"){x+=pe*k*S/1e3;continue}let H=(k.isSpace?L:0)+F,$=k.fontChar,G,j,_=k.width;if(ae){let N,B=k.vmetric||oe;N=k.vmetric?B[1]:_*.5,N=-N*q;let z=B[2]*q;_=B?-B[0]:_,G=N/T,j=(x+z)/T}else G=x/T,j=0;(k.isInFont||D.missingFile)&&(P.xcoords.push(P.x+G),ae&&P.ycoords.push(-P.y+j),P.tspan.textContent+=$);let R=ae?_*q-H*W:_*q+H*W;x+=R}P.tspan.setAttributeNS(null,"x",P.xcoords.map(m).join(" ")),ae?P.tspan.setAttributeNS(null,"y",P.ycoords.map(m).join(" ")):P.tspan.setAttributeNS(null,"y",m(-P.y)),ae?P.y-=x:P.x+=x*U,P.tspan.setAttributeNS(null,"font-family",P.fontFamily),P.tspan.setAttributeNS(null,"font-size",`${m(P.fontSize)}px`),P.fontStyle!==s.fontStyle&&P.tspan.setAttributeNS(null,"font-style",P.fontStyle),P.fontWeight!==s.fontWeight&&P.tspan.setAttributeNS(null,"font-weight",P.fontWeight);let w=P.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(w===i.TextRenderingMode.FILL||w===i.TextRenderingMode.FILL_STROKE?(P.fillColor!==s.fillColor&&P.tspan.setAttributeNS(null,"fill",P.fillColor),P.fillAlpha<1&&P.tspan.setAttributeNS(null,"fill-opacity",P.fillAlpha)):P.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?P.tspan.setAttributeNS(null,"fill","transparent"):P.tspan.setAttributeNS(null,"fill","none"),w===i.TextRenderingMode.STROKE||w===i.TextRenderingMode.FILL_STROKE){let k=1/(P.textMatrixScale||1);this._setStrokeAttributes(P.tspan,k)}let I=P.textMatrix;P.textRise!==0&&(I=I.slice(),I[5]+=P.textRise),P.txtElement.setAttributeNS(null,"transform",`${g(I)} scale(${m(U)}, -1)`),P.txtElement.setAttributeNS(o,"xml:space","preserve"),P.txtElement.append(P.tspan),P.txtgrp.append(P.txtElement),this._ensureTransformGroup().append(P.txtElement)}setLeadingMoveText(C,P){this.setLeading(-P),this.moveText(C,P)}addFontStyle(C){if(!C.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));let P=d(C.data,C.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${C.loadedName}"; src: url(${P}); }
`}setFont(C){let P=this.current,D=this.commonObjs.get(C[0]),S=C[1];P.font=D,this.embedFonts&&!D.missingFile&&!this.embeddedFonts[D.loadedName]&&(this.addFontStyle(D),this.embeddedFonts[D.loadedName]=D),P.fontMatrix=D.fontMatrix||i.FONT_IDENTITY_MATRIX;let T="normal";D.black?T="900":D.bold&&(T="bold");let F=D.italic?"italic":"normal";S<0?(S=-S,P.fontDirection=-1):P.fontDirection=1,P.fontSize=S,P.fontFamily=D.loadedName,P.fontWeight=T,P.fontStyle=F,P.tspan=this.svgFactory.createElement("svg:tspan"),P.tspan.setAttributeNS(null,"y",m(-P.y)),P.xcoords=[],P.ycoords=[]}endText(){let C=this.current;C.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&C.txtElement?.hasChildNodes()&&(C.element=C.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(C){C>0&&(this.current.lineWidth=C)}setLineCap(C){this.current.lineCap=c[C]}setLineJoin(C){this.current.lineJoin=l[C]}setMiterLimit(C){this.current.miterLimit=C}setStrokeAlpha(C){this.current.strokeAlpha=C}setStrokeRGBColor(C,P,D){this.current.strokeColor=i.Util.makeHexColor(C,P,D)}setFillAlpha(C){this.current.fillAlpha=C}setFillRGBColor(C,P,D){this.current.fillColor=i.Util.makeHexColor(C,P,D),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(C){this.current.strokeColor=this._makeColorN_Pattern(C)}setFillColorN(C){this.current.fillColor=this._makeColorN_Pattern(C)}shadingFill(C){let{width:P,height:D}=this.viewport,S=i.Util.inverseTransform(this.transformMatrix),[T,F,L,W]=i.Util.getAxialAlignedBoundingBox([0,0,P,D],S),U=this.svgFactory.createElement("svg:rect");U.setAttributeNS(null,"x",T),U.setAttributeNS(null,"y",F),U.setAttributeNS(null,"width",L-T),U.setAttributeNS(null,"height",W-F),U.setAttributeNS(null,"fill",this._makeShadingPattern(C)),this.current.fillAlpha<1&&U.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(U)}_makeColorN_Pattern(C){return C[0]==="TilingPattern"?this._makeTilingPattern(C):this._makeShadingPattern(C)}_makeTilingPattern(C){let P=C[1],D=C[2],S=C[3]||i.IDENTITY_MATRIX,[T,F,L,W]=C[4],U=C[5],ae=C[6],pe=C[7],oe=`shading${A++}`,[q,x,w,I]=i.Util.normalizeRect([...i.Util.applyTransform([T,F],S),...i.Util.applyTransform([L,W],S)]),[k,H]=i.Util.singularValueDecompose2dScale(S),$=U*k,G=ae*H,j=this.svgFactory.createElement("svg:pattern");j.setAttributeNS(null,"id",oe),j.setAttributeNS(null,"patternUnits","userSpaceOnUse"),j.setAttributeNS(null,"width",$),j.setAttributeNS(null,"height",G),j.setAttributeNS(null,"x",`${q}`),j.setAttributeNS(null,"y",`${x}`);let _=this.svg,R=this.transformMatrix,N=this.current.fillColor,B=this.current.strokeColor,z=this.svgFactory.create(w-q,I-x);if(this.svg=z,this.transformMatrix=S,pe===2){let K=i.Util.makeHexColor(...P);this.current.fillColor=K,this.current.strokeColor=K}return this.executeOpTree(this.convertOpList(D)),this.svg=_,this.transformMatrix=R,this.current.fillColor=N,this.current.strokeColor=B,j.append(z.childNodes[0]),this.defs.append(j),`url(#${oe})`}_makeShadingPattern(C){switch(typeof C=="string"&&(C=this.objs.get(C)),C[0]){case"RadialAxial":let P=`shading${A++}`,D=C[3],S;switch(C[1]){case"axial":let T=C[4],F=C[5];S=this.svgFactory.createElement("svg:linearGradient"),S.setAttributeNS(null,"id",P),S.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),S.setAttributeNS(null,"x1",T[0]),S.setAttributeNS(null,"y1",T[1]),S.setAttributeNS(null,"x2",F[0]),S.setAttributeNS(null,"y2",F[1]);break;case"radial":let L=C[4],W=C[5],U=C[6],ae=C[7];S=this.svgFactory.createElement("svg:radialGradient"),S.setAttributeNS(null,"id",P),S.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),S.setAttributeNS(null,"cx",W[0]),S.setAttributeNS(null,"cy",W[1]),S.setAttributeNS(null,"r",ae),S.setAttributeNS(null,"fx",L[0]),S.setAttributeNS(null,"fy",L[1]),S.setAttributeNS(null,"fr",U);break;default:throw new Error(`Unknown RadialAxial type: ${C[1]}`)}for(let T of D){let F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",T[0]),F.setAttributeNS(null,"stop-color",T[1]),S.append(F)}return this.defs.append(S),`url(#${P})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${C[0]}`)}}setDash(C,P){this.current.dashArray=C,this.current.dashPhase=P}constructPath(C,P){let D=this.current,S=D.x,T=D.y,F=[],L=0;for(let W of C)switch(W|0){case i.OPS.rectangle:S=P[L++],T=P[L++];let U=P[L++],ae=P[L++],pe=S+U,oe=T+ae;F.push("M",m(S),m(T),"L",m(pe),m(T),"L",m(pe),m(oe),"L",m(S),m(oe),"Z");break;case i.OPS.moveTo:S=P[L++],T=P[L++],F.push("M",m(S),m(T));break;case i.OPS.lineTo:S=P[L++],T=P[L++],F.push("L",m(S),m(T));break;case i.OPS.curveTo:S=P[L+4],T=P[L+5],F.push("C",m(P[L]),m(P[L+1]),m(P[L+2]),m(P[L+3]),m(S),m(T)),L+=6;break;case i.OPS.curveTo2:F.push("C",m(S),m(T),m(P[L]),m(P[L+1]),m(P[L+2]),m(P[L+3])),S=P[L+2],T=P[L+3],L+=4;break;case i.OPS.curveTo3:S=P[L+2],T=P[L+3],F.push("C",m(P[L]),m(P[L+1]),m(S),m(T),m(S),m(T)),L+=4;break;case i.OPS.closePath:F.push("Z");break}F=F.join(" "),D.path&&C.length>0&&C[0]!==i.OPS.rectangle&&C[0]!==i.OPS.moveTo?F=D.path.getAttributeNS(null,"d")+F:(D.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(D.path)),D.path.setAttributeNS(null,"d",F),D.path.setAttributeNS(null,"fill","none"),D.element=D.path,D.setCurrentPoint(S,T)}endPath(){let C=this.current;if(C.path=null,!this.pendingClip)return;if(!C.element){this.pendingClip=null;return}let P=`clippath${v++}`,D=this.svgFactory.createElement("svg:clipPath");D.setAttributeNS(null,"id",P),D.setAttributeNS(null,"transform",g(this.transformMatrix));let S=C.element.cloneNode(!0);if(this.pendingClip==="evenodd"?S.setAttributeNS(null,"clip-rule","evenodd"):S.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,D.append(S),this.defs.append(D),C.activeClipUrl){C.clipGroup=null;for(let T of this.extraStack)T.clipGroup=null;D.setAttributeNS(null,"clip-path",C.activeClipUrl)}C.activeClipUrl=`url(#${P})`,this.tgrp=null}clip(C){this.pendingClip=C}closePath(){let C=this.current;if(C.path){let P=`${C.path.getAttributeNS(null,"d")}Z`;C.path.setAttributeNS(null,"d",P)}}setLeading(C){this.current.leading=-C}setTextRise(C){this.current.textRise=C}setTextRenderingMode(C){this.current.textRenderingMode=C}setHScale(C){this.current.textHScale=C/100}setRenderingIntent(C){}setFlatness(C){}setGState(C){for(let[P,D]of C)switch(P){case"LW":this.setLineWidth(D);break;case"LC":this.setLineCap(D);break;case"LJ":this.setLineJoin(D);break;case"ML":this.setMiterLimit(D);break;case"D":this.setDash(D[0],D[1]);break;case"RI":this.setRenderingIntent(D);break;case"FL":this.setFlatness(D);break;case"Font":this.setFont(D);break;case"CA":this.setStrokeAlpha(D);break;case"ca":this.setFillAlpha(D);break;default:(0,i.warn)(`Unimplemented graphic state operator ${P}`);break}}fill(){let C=this.current;C.element&&(C.element.setAttributeNS(null,"fill",C.fillColor),C.element.setAttributeNS(null,"fill-opacity",C.fillAlpha),this.endPath())}stroke(){let C=this.current;C.element&&(this._setStrokeAttributes(C.element),C.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(C,P=1){let D=this.current,S=D.dashArray;P!==1&&S.length>0&&(S=S.map(function(T){return P*T})),C.setAttributeNS(null,"stroke",D.strokeColor),C.setAttributeNS(null,"stroke-opacity",D.strokeAlpha),C.setAttributeNS(null,"stroke-miterlimit",m(D.miterLimit)),C.setAttributeNS(null,"stroke-linecap",D.lineCap),C.setAttributeNS(null,"stroke-linejoin",D.lineJoin),C.setAttributeNS(null,"stroke-width",m(P*D.lineWidth)+"px"),C.setAttributeNS(null,"stroke-dasharray",S.map(m).join(" ")),C.setAttributeNS(null,"stroke-dashoffset",m(P*D.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){let C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x","0"),C.setAttributeNS(null,"y","0"),C.setAttributeNS(null,"width","1px"),C.setAttributeNS(null,"height","1px"),C.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(C)}paintImageXObject(C){let P=this.getObject(C);if(!P){(0,i.warn)(`Dependent image with object ID ${C} is not ready yet`);return}this.paintInlineImageXObject(P)}paintInlineImageXObject(C,P){let D=C.width,S=C.height,T=h(C,this.forceDataSchema,!!P),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",m(D)),F.setAttributeNS(null,"height",m(S)),this.current.element=F,this.clip("nonzero");let L=this.svgFactory.createElement("svg:image");L.setAttributeNS(a,"xlink:href",T),L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y",m(-S)),L.setAttributeNS(null,"width",m(D)+"px"),L.setAttributeNS(null,"height",m(S)+"px"),L.setAttributeNS(null,"transform",`scale(${m(1/D)} ${m(-1/S)})`),P?P.append(L):this._ensureTransformGroup().append(L)}paintImageMaskXObject(C){let P=this.getObject(C.data,C);if(P.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}let D=this.current,S=P.width,T=P.height,F=D.fillColor;D.maskId=`mask${E++}`;let L=this.svgFactory.createElement("svg:mask");L.setAttributeNS(null,"id",D.maskId);let W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",m(S)),W.setAttributeNS(null,"height",m(T)),W.setAttributeNS(null,"fill",F),W.setAttributeNS(null,"mask",`url(#${D.maskId})`),this.defs.append(L),this._ensureTransformGroup().append(W),this.paintInlineImageXObject(P,L)}paintFormXObjectBegin(C,P){if(Array.isArray(C)&&C.length===6&&this.transform(C[0],C[1],C[2],C[3],C[4],C[5]),P){let D=P[2]-P[0],S=P[3]-P[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",P[0]),T.setAttributeNS(null,"y",P[1]),T.setAttributeNS(null,"width",m(D)),T.setAttributeNS(null,"height",m(S)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(C){let P=this.svgFactory.create(C.width,C.height),D=this.svgFactory.createElement("svg:defs");P.append(D),this.defs=D;let S=this.svgFactory.createElement("svg:g");return S.setAttributeNS(null,"transform",g(C.transform)),P.append(S),this.svg=S,P}_ensureClipGroup(){if(!this.current.clipGroup){let C=this.svgFactory.createElement("svg:g");C.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(C),this.current.clipGroup=C}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",g(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=O}),((t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class n{static textContent(i){let s=[],o={items:s,styles:Object.create(null)};function a(c){if(!c)return;let l=null,d=c.name;if(d==="#text")l=c.value;else if(n.shouldBuildText(d))c?.attributes?.textContent?l=c.attributes.textContent:c.value&&(l=c.value);else return;if(l!==null&&s.push({str:l}),!!c.children)for(let h of c.children)a(h)}return a(i),o}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}e.XfaText=n}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=g,e.updateTextLayer=v;var r=n(1),i=n(6);let s=1e5,o=30,a=.8,c=new Map;function l(E,A){let O;if(A&&r.FeatureTest.isOffscreenCanvasSupported)O=new OffscreenCanvas(E,E).getContext("2d",{alpha:!1});else{let M=document.createElement("canvas");M.width=M.height=E,O=M.getContext("2d",{alpha:!1})}return O}function d(E,A){let O=c.get(E);if(O)return O;let M=l(o,A);M.font=`${o}px ${E}`;let C=M.measureText(""),P=C.fontBoundingBoxAscent,D=Math.abs(C.fontBoundingBoxDescent);if(P){let T=P/(P+D);return c.set(E,T),M.canvas.width=M.canvas.height=0,T}M.strokeStyle="red",M.clearRect(0,0,o,o),M.strokeText("g",0,0);let S=M.getImageData(0,0,o,o).data;D=0;for(let T=S.length-1-3;T>=0;T-=4)if(S[T]>0){D=Math.ceil(T/4/o);break}M.clearRect(0,0,o,o),M.strokeText("A",0,o),S=M.getImageData(0,0,o,o).data,P=0;for(let T=0,F=S.length;T<F;T+=4)if(S[T]>0){P=o-Math.floor(T/4/o);break}if(M.canvas.width=M.canvas.height=0,P){let T=P/(P+D);return c.set(E,T),T}return c.set(E,a),a}function h(E,A,O){let M=document.createElement("span"),C={angle:0,canvasWidth:0,hasText:A.str!=="",hasEOL:A.hasEOL,fontSize:0};E._textDivs.push(M);let P=r.Util.transform(E._transform,A.transform),D=Math.atan2(P[1],P[0]),S=O[A.fontName];S.vertical&&(D+=Math.PI/2);let T=Math.hypot(P[2],P[3]),F=T*d(S.fontFamily,E._isOffscreenCanvasSupported),L,W;D===0?(L=P[4],W=P[5]-F):(L=P[4]+F*Math.sin(D),W=P[5]-F*Math.cos(D));let U="calc(var(--scale-factor)*",ae=M.style;E._container===E._rootContainer?(ae.left=`${(100*L/E._pageWidth).toFixed(2)}%`,ae.top=`${(100*W/E._pageHeight).toFixed(2)}%`):(ae.left=`${U}${L.toFixed(2)}px)`,ae.top=`${U}${W.toFixed(2)}px)`),ae.fontSize=`${U}${T.toFixed(2)}px)`,ae.fontFamily=S.fontFamily,C.fontSize=T,M.setAttribute("role","presentation"),M.textContent=A.str,M.dir=A.dir,E._fontInspectorEnabled&&(M.dataset.fontName=A.fontName),D!==0&&(C.angle=D*(180/Math.PI));let pe=!1;if(A.str.length>1)pe=!0;else if(A.str!==" "&&A.transform[0]!==A.transform[3]){let oe=Math.abs(A.transform[0]),q=Math.abs(A.transform[3]);oe!==q&&Math.max(oe,q)/Math.min(oe,q)>1.5&&(pe=!0)}pe&&(C.canvasWidth=S.vertical?A.height:A.width),E._textDivProperties.set(M,C),E._isReadableStream&&E._layoutText(M)}function f(E){let{div:A,scale:O,properties:M,ctx:C,prevFontSize:P,prevFontFamily:D}=E,{style:S}=A,T="";if(M.canvasWidth!==0&&M.hasText){let{fontFamily:F}=S,{canvasWidth:L,fontSize:W}=M;(P!==W||D!==F)&&(C.font=`${W*O}px ${F}`,E.prevFontSize=W,E.prevFontFamily=F);let{width:U}=C.measureText(A.textContent);U>0&&(T=`scaleX(${L*O/U})`)}M.angle!==0&&(T=`rotate(${M.angle}deg) ${T}`),T.length>0&&(S.transform=T)}function p(E){if(E._canceled)return;let A=E._textDivs,O=E._capability;if(A.length>s){O.resolve();return}if(!E._isReadableStream)for(let C of A)E._layoutText(C);O.resolve()}class m{constructor({textContentSource:A,container:O,viewport:M,textDivs:C,textDivProperties:P,textContentItemsStr:D,isOffscreenCanvasSupported:S}){this._textContentSource=A,this._isReadableStream=A instanceof ReadableStream,this._container=this._rootContainer=O,this._textDivs=C||[],this._textContentItemsStr=D||[],this._isOffscreenCanvasSupported=S,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=P||new WeakMap,this._canceled=!1,this._capability=new r.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:M.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l(0,S)};let{pageWidth:T,pageHeight:F,pageX:L,pageY:W}=M.rawDims;this._transform=[1,0,0,-1,-L,W+F],this._pageWidth=T,this._pageHeight=F,(0,i.setLayerDimensions)(O,M),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(A,O){for(let M of A){if(M.str===void 0){if(M.type==="beginMarkedContentProps"||M.type==="beginMarkedContent"){let C=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),M.id!==null&&this._container.setAttribute("id",`${M.id}`),C.append(this._container)}else M.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(M.str),h(this,M,O)}}_layoutText(A){let O=this._layoutTextParams.properties=this._textDivProperties.get(A);if(this._layoutTextParams.div=A,f(this._layoutTextParams),O.hasText&&this._container.append(A),O.hasEOL){let M=document.createElement("br");M.setAttribute("role","presentation"),this._container.append(M)}}_render(){let A=new r.PromiseCapability,O=Object.create(null);if(this._isReadableStream){let M=()=>{this._reader.read().then(({value:C,done:P})=>{if(P){A.resolve();return}Object.assign(O,C.styles),this._processItems(C.items,O),M()},A.reject)};this._reader=this._textContentSource.getReader(),M()}else if(this._textContentSource){let{items:M,styles:C}=this._textContentSource;this._processItems(M,C),A.resolve()}else throw new Error('No "textContentSource" parameter specified.');A.promise.then(()=>{O=null,p(this)},this._capability.reject)}}e.TextLayerRenderTask=m;function g(E){!E.textContentSource&&(E.textContent||E.textContentStream)&&((0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),E.textContentSource=E.textContent||E.textContentStream);let{container:A,viewport:O}=E,M=getComputedStyle(A),C=M.getPropertyValue("visibility"),P=parseFloat(M.getPropertyValue("--scale-factor"));C==="visible"&&(!P||Math.abs(P-O.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");let D=new m(E);return D._render(),D}function v({container:E,viewport:A,textDivs:O,textDivProperties:M,isOffscreenCanvasSupported:C,mustRotate:P=!0,mustRescale:D=!0}){if(P&&(0,i.setLayerDimensions)(E,{rotation:A.rotation}),D){let S=l(0,C),F={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:S};for(let L of O)F.properties=M.get(L),F.div=L,f(F)}}}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var r=n(1),i=n(4),s=n(28),o=n(33),a=n(6),c=n(34);let l=(()=>{class d{#e;#t=!1;#n=null;#r=this.pointerup.bind(this);#a=this.pointerdown.bind(this);#o=new Map;#s=!1;#c=!1;#l=!1;#i;static _initialized=!1;constructor({uiManager:f,pageIndex:p,div:m,accessibilityManager:g,annotationLayer:v,viewport:E,l10n:A}){let O=[s.FreeTextEditor,o.InkEditor,c.StampEditor];if(!d._initialized){d._initialized=!0;for(let M of O)M.initialize(A)}f.registerEditorTypes(O),this.#i=f,this.pageIndex=p,this.div=m,this.#e=g,this.#n=v,this.viewport=E,this.#i.addLayer(this)}get isEmpty(){return this.#o.size===0}updateToolbar(f){this.#i.updateToolbar(f)}updateMode(f=this.#i.getMode()){this.#p(),f===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),f!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",f===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",f===r.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",f===r.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(f){if(!f&&this.#i.getMode()!==r.AnnotationEditorType.INK)return;if(!f){for(let m of this.#o.values())if(m.isEmpty()){m.setInBackground();return}}this.#d({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(f){this.#i.setEditingState(f)}addCommands(f){this.#i.addCommands(f)}enable(){this.div.style.pointerEvents="auto";let f=new Set;for(let m of this.#o.values())m.enableEditing(),m.annotationElementId&&f.add(m.annotationElementId);if(!this.#n)return;let p=this.#n.getEditableAnnotations();for(let m of p){if(m.hide(),this.#i.isDeletedAnnotationElement(m.data.id)||f.has(m.data.id))continue;let g=this.deserialize(m);g&&(this.addOrRebuild(g),g.enableEditing())}}disable(){this.#l=!0,this.div.style.pointerEvents="none";let f=new Set;for(let p of this.#o.values()){if(p.disableEditing(),!p.annotationElementId||p.serialize()!==null){f.add(p.annotationElementId);continue}this.getEditableAnnotation(p.annotationElementId)?.show(),p.remove()}if(this.#n){let p=this.#n.getEditableAnnotations();for(let m of p){let{id:g}=m.data;f.has(g)||this.#i.isDeletedAnnotationElement(g)||m.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#l=!1}getEditableAnnotation(f){return this.#n?.getEditableAnnotation(f)||null}setActiveEditor(f){this.#i.getActive()!==f&&this.#i.setActiveEditor(f)}enableClick(){this.div.addEventListener("pointerdown",this.#a),this.div.addEventListener("pointerup",this.#r)}disableClick(){this.div.removeEventListener("pointerdown",this.#a),this.div.removeEventListener("pointerup",this.#r)}attach(f){this.#o.set(f.id,f);let{annotationElementId:p}=f;p&&this.#i.isDeletedAnnotationElement(p)&&this.#i.removeDeletedAnnotationElement(f)}detach(f){this.#o.delete(f.id),this.#e?.removePointerInTextLayer(f.contentDiv),!this.#l&&f.annotationElementId&&this.#i.addDeletedAnnotationElement(f)}remove(f){this.detach(f),this.#i.removeEditor(f),f.div.contains(document.activeElement)&&setTimeout(()=>{this.#i.focusMainContainer()},0),f.div.remove(),f.isAttachedToDOM=!1,this.#c||this.addInkEditorIfNeeded(!1)}changeParent(f){f.parent!==this&&(f.annotationElementId&&(this.#i.addDeletedAnnotationElement(f.annotationElementId),i.AnnotationEditor.deleteAnnotationElement(f),f.annotationElementId=null),this.attach(f),f.parent?.detach(f),f.setParent(this),f.div&&f.isAttachedToDOM&&(f.div.remove(),this.div.append(f.div)))}add(f){if(this.changeParent(f),this.#i.addEditor(f),this.attach(f),!f.isAttachedToDOM){let p=f.render();this.div.append(p),f.isAttachedToDOM=!0}f.fixAndSetPosition(),f.onceAdded(),this.#i.addToAnnotationStorage(f)}moveEditorInDOM(f){if(!f.isAttachedToDOM)return;let{activeElement:p}=document;f.div.contains(p)&&(f._focusEventsAllowed=!1,setTimeout(()=>{f.div.contains(document.activeElement)?f._focusEventsAllowed=!0:(f.div.addEventListener("focusin",()=>{f._focusEventsAllowed=!0},{once:!0}),p.focus())},0)),f._structTreeParentId=this.#e?.moveElementInDOM(this.div,f.div,f.contentDiv,!0)}addOrRebuild(f){f.needsToBeRebuilt()?f.rebuild():this.add(f)}addUndoableEditor(f){let p=()=>f._uiManager.rebuild(f),m=()=>{f.remove()};this.addCommands({cmd:p,undo:m,mustExec:!1})}getNextId(){return this.#i.getId()}#f(f){switch(this.#i.getMode()){case r.AnnotationEditorType.FREETEXT:return new s.FreeTextEditor(f);case r.AnnotationEditorType.INK:return new o.InkEditor(f);case r.AnnotationEditorType.STAMP:return new c.StampEditor(f)}return null}pasteEditor(f,p){this.#i.updateToolbar(f),this.#i.updateMode(f);let{offsetX:m,offsetY:g}=this.#h(),v=this.getNextId(),E=this.#f(me({parent:this,id:v,x:m,y:g,uiManager:this.#i,isCentered:!0},p));E&&this.add(E)}deserialize(f){switch(f.annotationType??f.annotationEditorType){case r.AnnotationEditorType.FREETEXT:return s.FreeTextEditor.deserialize(f,this,this.#i);case r.AnnotationEditorType.INK:return o.InkEditor.deserialize(f,this,this.#i);case r.AnnotationEditorType.STAMP:return c.StampEditor.deserialize(f,this,this.#i)}return null}#d(f,p){let m=this.getNextId(),g=this.#f({parent:this,id:m,x:f.offsetX,y:f.offsetY,uiManager:this.#i,isCentered:p});return g&&this.add(g),g}#h(){let{x:f,y:p,width:m,height:g}=this.div.getBoundingClientRect(),v=Math.max(0,f),E=Math.max(0,p),A=Math.min(window.innerWidth,f+m),O=Math.min(window.innerHeight,p+g),M=(v+A)/2-f,C=(E+O)/2-p,[P,D]=this.viewport.rotation%180===0?[M,C]:[C,M];return{offsetX:P,offsetY:D}}addNewEditor(){this.#d(this.#h(),!0)}setSelected(f){this.#i.setSelected(f)}toggleSelected(f){this.#i.toggleSelected(f)}isSelected(f){return this.#i.isSelected(f)}unselect(f){this.#i.unselect(f)}pointerup(f){let{isMac:p}=r.FeatureTest.platform;if(!(f.button!==0||f.ctrlKey&&p)&&f.target===this.div&&this.#s){if(this.#s=!1,!this.#t){this.#t=!0;return}if(this.#i.getMode()===r.AnnotationEditorType.STAMP){this.#i.unselectAll();return}this.#d(f,!1)}}pointerdown(f){if(this.#s){this.#s=!1;return}let{isMac:p}=r.FeatureTest.platform;if(f.button!==0||f.ctrlKey&&p||f.target!==this.div)return;this.#s=!0;let m=this.#i.getActive();this.#t=!m||m.isEmpty()}findNewParent(f,p,m){let g=this.#i.findParent(p,m);return g===null||g===this?!1:(g.changeParent(f),!0)}destroy(){this.#i.getActive()?.parent===this&&(this.#i.commitOrRemove(),this.#i.setActiveEditor(null));for(let f of this.#o.values())this.#e?.removePointerInTextLayer(f.contentDiv),f.setParent(null),f.isAttachedToDOM=!1,f.div.remove();this.div=null,this.#o.clear(),this.#i.removeLayer(this)}#p(){this.#c=!0;for(let f of this.#o.values())f.isEmpty()&&f.remove();this.#c=!1}render({viewport:f}){this.viewport=f,(0,a.setLayerDimensions)(this.div,f);for(let p of this.#i.getEditors(this.pageIndex))this.add(p);this.updateMode()}update({viewport:f}){this.#i.commitOrRemove(),this.viewport=f,(0,a.setLayerDimensions)(this.div,{rotation:f.rotation}),this.updateMode()}get pageDimensions(){let{pageWidth:f,pageHeight:p}=this.viewport.rawDims;return[f,p]}}return d})();e.AnnotationEditorLayer=l}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var r=n(1),i=n(5),s=n(4),o=n(29);let a=(()=>{class c extends s.AnnotationEditor{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#r=this.editorDivKeydown.bind(this);#a;#o="";#s=`${this.id}-editor`;#c;#l=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let d=c.prototype,h=m=>m.isEmpty(),f=i.AnnotationEditorUIManager.TRANSLATE_SMALL,p=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],d.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],d.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],d._translateEmpty,{args:[-f,0],checker:h}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],d._translateEmpty,{args:[-p,0],checker:h}],[["ArrowRight","mac+ArrowRight"],d._translateEmpty,{args:[f,0],checker:h}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],d._translateEmpty,{args:[p,0],checker:h}],[["ArrowUp","mac+ArrowUp"],d._translateEmpty,{args:[0,-f],checker:h}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],d._translateEmpty,{args:[0,-p],checker:h}],[["ArrowDown","mac+ArrowDown"],d._translateEmpty,{args:[0,f],checker:h}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],d._translateEmpty,{args:[0,p],checker:h}]]))}static _type="freetext";constructor(d){super(Ke(me({},d),{name:"freeTextEditor"})),this.#a=d.color||c._defaultColor||s.AnnotationEditor._defaultLineColor,this.#c=d.fontSize||c._defaultFontSize}static initialize(d){s.AnnotationEditor.initialize(d,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});let h=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(h.getPropertyValue("--freetext-padding"))}static updateDefaultParams(d,h){switch(d){case r.AnnotationEditorParamsType.FREETEXT_SIZE:c._defaultFontSize=h;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:c._defaultColor=h;break}}updateParams(d,h){switch(d){case r.AnnotationEditorParamsType.FREETEXT_SIZE:this.#i(h);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:this.#f(h);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,c._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,c._defaultColor||s.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,this.#c],[r.AnnotationEditorParamsType.FREETEXT_COLOR,this.#a]]}#i(d){let h=p=>{this.editorDiv.style.fontSize=`calc(${p}px * var(--scale-factor))`,this.translate(0,-(p-this.#c)*this.parentScale),this.#c=p,this.#h()},f=this.#c;this.addCommands({cmd:()=>{h(d)},undo:()=>{h(f)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#f(d){let h=this.#a;this.addCommands({cmd:()=>{this.#a=this.editorDiv.style.color=d},undo:()=>{this.#a=this.editorDiv.style.color=h},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(d,h){this._uiManager.translateSelectedEditors(d,h,!0)}getInitialTranslation(){let d=this.parentScale;return[-c._internalPadding*d,-(c._internalPadding+this.#c)*d]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#r),this.editorDiv.addEventListener("focus",this.#t),this.editorDiv.addEventListener("blur",this.#e),this.editorDiv.addEventListener("input",this.#n))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#r),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#n),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(d){this._focusEventsAllowed&&(super.focusin(d),d.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#d(){let d=this.editorDiv.getElementsByTagName("div");if(d.length===0)return this.editorDiv.innerText;let h=[];for(let f of d)h.push(f.innerText.replace(/\r\n?|\n/,""));return h.join(`
`)}#h(){let[d,h]=this.parentDimensions,f;if(this.isAttachedToDOM)f=this.div.getBoundingClientRect();else{let{currentLayer:p,div:m}=this,g=m.style.display;m.style.display="hidden",p.div.append(this.div),f=m.getBoundingClientRect(),m.remove(),m.style.display=g}this.rotation%180===this.parentRotation%180?(this.width=f.width/d,this.height=f.height/h):(this.width=f.height/d,this.height=f.width/h),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let d=this.#o,h=this.#o=this.#d().trimEnd();if(d===h)return;let f=p=>{if(this.#o=p,!p){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#h()};this.addCommands({cmd:()=>{f(h)},undo:()=>{f(d)},mustExec:!1}),this.#h()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(d){this.enterInEditMode()}keydown(d){d.target===this.div&&d.key==="Enter"&&(this.enterInEditMode(),d.preventDefault())}editorDivKeydown(d){c._keyboardManager.exec(this,d)}editorDivFocus(d){this.isEditing=!0}editorDivBlur(d){this.isEditing=!1}editorDivInput(d){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let d,h;this.width&&(d=this.x,h=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.enableEditing(),s.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(p=>this.editorDiv?.setAttribute("aria-label",p)),s.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(p=>this.editorDiv?.setAttribute("default-content",p)),this.editorDiv.contentEditable=!0;let{style:f}=this.editorDiv;if(f.fontSize=`calc(${this.#c}px * var(--scale-factor))`,f.color=this.#a,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){let[p,m]=this.parentDimensions;if(this.annotationElementId){let{position:g}=this.#l,[v,E]=this.getInitialTranslation();[v,E]=this.pageTranslationToScreen(v,E);let[A,O]=this.pageDimensions,[M,C]=this.pageTranslation,P,D;switch(this.rotation){case 0:P=d+(g[0]-M)/A,D=h+this.height-(g[1]-C)/O;break;case 90:P=d+(g[0]-M)/A,D=h-(g[1]-C)/O,[v,E]=[E,-v];break;case 180:P=d-this.width+(g[0]-M)/A,D=h-(g[1]-C)/O,[v,E]=[-v,-E];break;case 270:P=d+(g[0]-M-this.height*O)/A,D=h+(g[1]-C-this.width*A)/O,[v,E]=[-E,v];break}this.setAt(P*p,D*m,v,E)}else this.setAt(d*p,h*m,this.width*p,this.height*m);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#o)for(let d of this.#o.split(`
`)){let h=document.createElement("div");h.append(d?document.createTextNode(d):document.createElement("br")),this.editorDiv.append(h)}}get contentDiv(){return this.editorDiv}static deserialize(d,h,f){let p=null;if(d instanceof o.FreeTextAnnotationElement){let{data:{defaultAppearanceData:{fontSize:g,fontColor:v},rect:E,rotation:A,id:O},textContent:M,textPosition:C,parent:{page:{pageNumber:P}}}=d;if(!M||M.length===0)return null;p=d={annotationType:r.AnnotationEditorType.FREETEXT,color:Array.from(v),fontSize:g,value:M.join(`
`),position:C,pageIndex:P-1,rect:E,rotation:A,id:O,deleted:!1}}let m=super.deserialize(d,h,f);return m.#c=d.fontSize,m.#a=r.Util.makeHexColor(...d.color),m.#o=d.value,m.annotationElementId=d.id||null,m.#l=p,m}serialize(d=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};let h=c._internalPadding*this.parentScale,f=this.getRect(h,h),p=s.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#a),m={annotationType:r.AnnotationEditorType.FREETEXT,color:p,fontSize:this.#c,value:this.#o,pageIndex:this.pageIndex,rect:f,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return d?m:this.annotationElementId&&!this.#y(m)?null:(m.id=this.annotationElementId,m)}#y(d){let{value:h,fontSize:f,color:p,rect:m,pageIndex:g}=this.#l;return d.value!==h||d.fontSize!==f||d.rect.some((v,E)=>Math.abs(v-m[E])>=1)||d.color.some((v,E)=>v!==p[E])||d.pageIndex!==g}#m(d=!1){if(!this.annotationElementId)return;if(this.#h(),!d&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}let h=c._internalPadding*this.parentScale;this.#l.rect=this.getRect(h,h)}}return c})();e.FreeTextEditor=a}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var r=n(1),i=n(6),s=n(3),o=n(30),a=n(31),c=n(32);let l=1e3,d=9,h=new WeakSet;function f(j){return{width:j[2]-j[0],height:j[3]-j[1]}}class p{static create(_){switch(_.data.annotationType){case r.AnnotationType.LINK:return new g(_);case r.AnnotationType.TEXT:return new v(_);case r.AnnotationType.WIDGET:switch(_.data.fieldType){case"Tx":return new A(_);case"Btn":return _.data.radioButton?new C(_):_.data.checkBox?new M(_):new P(_);case"Ch":return new D(_);case"Sig":return new O(_)}return new E(_);case r.AnnotationType.POPUP:return new S(_);case r.AnnotationType.FREETEXT:return new F(_);case r.AnnotationType.LINE:return new L(_);case r.AnnotationType.SQUARE:return new W(_);case r.AnnotationType.CIRCLE:return new U(_);case r.AnnotationType.POLYLINE:return new ae(_);case r.AnnotationType.CARET:return new oe(_);case r.AnnotationType.INK:return new q(_);case r.AnnotationType.POLYGON:return new pe(_);case r.AnnotationType.HIGHLIGHT:return new x(_);case r.AnnotationType.UNDERLINE:return new w(_);case r.AnnotationType.SQUIGGLY:return new I(_);case r.AnnotationType.STRIKEOUT:return new k(_);case r.AnnotationType.STAMP:return new H(_);case r.AnnotationType.FILEATTACHMENT:return new $(_);default:return new m(_)}}}class m{#e=!1;constructor(_,{isRenderable:R=!1,ignoreBorder:N=!1,createQuadrilaterals:B=!1}={}){this.isRenderable=R,this.data=_.data,this.layer=_.layer,this.linkService=_.linkService,this.downloadManager=_.downloadManager,this.imageResourcesPath=_.imageResourcesPath,this.renderForms=_.renderForms,this.svgFactory=_.svgFactory,this.annotationStorage=_.annotationStorage,this.enableScripting=_.enableScripting,this.hasJSActions=_.hasJSActions,this._fieldObjects=_.fieldObjects,this.parent=_.parent,R&&(this.container=this._createContainer(N)),B&&this._createQuadrilaterals()}static _hasPopupData({titleObj:_,contentsObj:R,richText:N}){return!!(_?.str||R?.str||N?.str)}get hasPopupData(){return m._hasPopupData(this.data)}_createContainer(_){let{data:R,parent:{page:N,viewport:B}}=this,z=document.createElement("section");z.setAttribute("data-annotation-id",R.id),this instanceof E||(z.tabIndex=l),z.style.zIndex=this.parent.zIndex++,this.data.popupRef&&z.setAttribute("aria-haspopup","dialog"),R.noRotate&&z.classList.add("norotate");let{pageWidth:K,pageHeight:Y,pageX:ee,pageY:fe}=B.rawDims;if(!R.rect||this instanceof S){let{rotation:ce}=R;return!R.hasOwnCanvas&&ce!==0&&this.setRotation(ce,z),z}let{width:te,height:re}=f(R.rect),ie=r.Util.normalizeRect([R.rect[0],N.view[3]-R.rect[1]+N.view[1],R.rect[2],N.view[3]-R.rect[3]+N.view[1]]);if(!_&&R.borderStyle.width>0){z.style.borderWidth=`${R.borderStyle.width}px`;let ce=R.borderStyle.horizontalCornerRadius,ye=R.borderStyle.verticalCornerRadius;if(ce>0||ye>0){let Ae=`calc(${ce}px * var(--scale-factor)) / calc(${ye}px * var(--scale-factor))`;z.style.borderRadius=Ae}else if(this instanceof C){let Ae=`calc(${te}px * var(--scale-factor)) / calc(${re}px * var(--scale-factor))`;z.style.borderRadius=Ae}switch(R.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:z.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:z.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:z.style.borderBottomStyle="solid";break;default:break}let be=R.borderColor||null;be?(this.#e=!0,z.style.borderColor=r.Util.makeHexColor(be[0]|0,be[1]|0,be[2]|0)):z.style.borderWidth=0}z.style.left=`${100*(ie[0]-ee)/K}%`,z.style.top=`${100*(ie[1]-fe)/Y}%`;let{rotation:se}=R;return R.hasOwnCanvas||se===0?(z.style.width=`${100*te/K}%`,z.style.height=`${100*re/Y}%`):this.setRotation(se,z),z}setRotation(_,R=this.container){if(!this.data.rect)return;let{pageWidth:N,pageHeight:B}=this.parent.viewport.rawDims,{width:z,height:K}=f(this.data.rect),Y,ee;_%180===0?(Y=100*z/N,ee=100*K/B):(Y=100*K/N,ee=100*z/B),R.style.width=`${Y}%`,R.style.height=`${ee}%`,R.setAttribute("data-main-rotation",(360-_)%360)}get _commonActions(){let _=(R,N,B)=>{let z=B.detail[R],K=z[0],Y=z.slice(1);B.target.style[N]=o.ColorConverters[`${K}_HTML`](Y),this.annotationStorage.setValue(this.data.id,{[N]:o.ColorConverters[`${K}_rgb`](Y)})};return(0,r.shadow)(this,"_commonActions",{display:R=>{let{display:N}=R.detail,B=N%2===1;this.container.style.visibility=B?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:B,noPrint:N===1||N===2})},print:R=>{this.annotationStorage.setValue(this.data.id,{noPrint:!R.detail.print})},hidden:R=>{let{hidden:N}=R.detail;this.container.style.visibility=N?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:N,noView:N})},focus:R=>{setTimeout(()=>R.target.focus({preventScroll:!1}),0)},userName:R=>{R.target.title=R.detail.userName},readonly:R=>{R.target.disabled=R.detail.readonly},required:R=>{this._setRequired(R.target,R.detail.required)},bgColor:R=>{_("bgColor","backgroundColor",R)},fillColor:R=>{_("fillColor","backgroundColor",R)},fgColor:R=>{_("fgColor","color",R)},textColor:R=>{_("textColor","color",R)},borderColor:R=>{_("borderColor","borderColor",R)},strokeColor:R=>{_("strokeColor","borderColor",R)},rotation:R=>{let N=R.detail.rotation;this.setRotation(N),this.annotationStorage.setValue(this.data.id,{rotation:N})}})}_dispatchEventFromSandbox(_,R){let N=this._commonActions;for(let B of Object.keys(R.detail))(_[B]||N[B])?.(R)}_setDefaultPropertiesFromJS(_){if(!this.enableScripting)return;let R=this.annotationStorage.getRawValue(this.data.id);if(!R)return;let N=this._commonActions;for(let[B,z]of Object.entries(R)){let K=N[B];if(K){let Y={detail:{[B]:z},target:_};K(Y),delete R[B]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:_}=this.data;if(!_)return;let[R,N,B,z]=this.data.rect;if(_.length===1){let[,{x:ye,y:be},{x:Ae,y:xe}]=_[0];if(B===ye&&z===be&&R===Ae&&N===xe)return}let{style:K}=this.container,Y;if(this.#e){let{borderColor:ye,borderWidth:be}=K;K.borderWidth=0,Y=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${ye}" stroke-width="${be}">`],this.container.classList.add("hasBorder")}let ee=B-R,fe=z-N,{svgFactory:te}=this,re=te.createElement("svg");re.classList.add("quadrilateralsContainer"),re.setAttribute("width",0),re.setAttribute("height",0);let ie=te.createElement("defs");re.append(ie);let se=te.createElement("clipPath"),ce=`clippath_${this.data.id}`;se.setAttribute("id",ce),se.setAttribute("clipPathUnits","objectBoundingBox"),ie.append(se);for(let[,{x:ye,y:be},{x:Ae,y:xe}]of _){let Ue=te.createElement("rect"),et=(Ae-R)/ee,Zt=(z-be)/fe,Ze=(ye-Ae)/ee,_t=(be-xe)/fe;Ue.setAttribute("x",et),Ue.setAttribute("y",Zt),Ue.setAttribute("width",Ze),Ue.setAttribute("height",_t),se.append(Ue),Y?.push(`<rect vector-effect="non-scaling-stroke" x="${et}" y="${Zt}" width="${Ze}" height="${_t}"/>`)}this.#e&&(Y.push("</g></svg>')"),K.backgroundImage=Y.join("")),this.container.append(re),this.container.style.clipPath=`url(#${ce})`}_createPopup(){let{container:_,data:R}=this;_.setAttribute("aria-haspopup","dialog");let N=new S({data:{color:R.color,titleObj:R.titleObj,modificationDate:R.modificationDate,contentsObj:R.contentsObj,richText:R.richText,parentRect:R.rect,borderStyle:0,id:`popup_${R.id}`,rotation:R.rotation},parent:this.parent,elements:[this]});this.parent.div.append(N.render())}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(_,R=null){let N=[];if(this._fieldObjects){let B=this._fieldObjects[_];if(B)for(let{page:z,id:K,exportValues:Y}of B){if(z===-1||K===R)continue;let ee=typeof Y=="string"?Y:null,fe=document.querySelector(`[data-element-id="${K}"]`);if(fe&&!h.has(fe)){(0,r.warn)(`_getElementsByName - element not allowed: ${K}`);continue}N.push({id:K,exportValue:ee,domElement:fe})}return N}for(let B of document.getElementsByName(_)){let{exportValue:z}=B,K=B.getAttribute("data-element-id");K!==R&&h.has(B)&&N.push({id:K,exportValue:z,domElement:B})}return N}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let _=this.getElementsToTriggerPopup();if(Array.isArray(_))for(let R of _)R.classList.add("highlightArea");else _.classList.add("highlightArea")}_editOnDoubleClick(){let{annotationEditorType:_,data:{id:R}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:_,editId:R})})}}class g extends m{constructor(_,R=null){super(_,{isRenderable:!0,ignoreBorder:!!R?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=_.data.isTooltipOnly}render(){let{data:_,linkService:R}=this,N=document.createElement("a");N.setAttribute("data-element-id",_.id);let B=!1;return _.url?(R.addLinkAttributes(N,_.url,_.newWindow),B=!0):_.action?(this._bindNamedAction(N,_.action),B=!0):_.attachment?(this._bindAttachment(N,_.attachment),B=!0):_.setOCGState?(this.#t(N,_.setOCGState),B=!0):_.dest?(this._bindLink(N,_.dest),B=!0):(_.actions&&(_.actions.Action||_.actions["Mouse Up"]||_.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(N,_),B=!0),_.resetForm?(this._bindResetFormAction(N,_.resetForm),B=!0):this.isTooltipOnly&&!B&&(this._bindLink(N,""),B=!0)),this.container.classList.add("linkAnnotation"),B&&this.container.append(N),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(_,R){_.href=this.linkService.getDestinationHash(R),_.onclick=()=>(R&&this.linkService.goToDestination(R),!1),(R||R==="")&&this.#e()}_bindNamedAction(_,R){_.href=this.linkService.getAnchorUrl(""),_.onclick=()=>(this.linkService.executeNamedAction(R),!1),this.#e()}_bindAttachment(_,R){_.href=this.linkService.getAnchorUrl(""),_.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,R.content,R.filename),!1),this.#e()}#t(_,R){_.href=this.linkService.getAnchorUrl(""),_.onclick=()=>(this.linkService.executeSetOCGState(R),!1),this.#e()}_bindJSAction(_,R){_.href=this.linkService.getAnchorUrl("");let N=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let B of Object.keys(R.actions)){let z=N.get(B);z&&(_[z]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:R.id,name:B}}),!1))}_.onclick||(_.onclick=()=>!1),this.#e()}_bindResetFormAction(_,R){let N=_.onclick;if(N||(_.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),N||(_.onclick=()=>!1);return}_.onclick=()=>{N?.();let{fields:B,refs:z,include:K}=R,Y=[];if(B.length!==0||z.length!==0){let te=new Set(z);for(let re of B){let ie=this._fieldObjects[re]||[];for(let{id:se}of ie)te.add(se)}for(let re of Object.values(this._fieldObjects))for(let ie of re)te.has(ie.id)===K&&Y.push(ie)}else for(let te of Object.values(this._fieldObjects))Y.push(...te);let ee=this.annotationStorage,fe=[];for(let te of Y){let{id:re}=te;switch(fe.push(re),te.type){case"text":{let se=te.defaultValue||"";ee.setValue(re,{value:se});break}case"checkbox":case"radiobutton":{let se=te.defaultValue===te.exportValues;ee.setValue(re,{value:se});break}case"combobox":case"listbox":{let se=te.defaultValue||"";ee.setValue(re,{value:se});break}default:continue}let ie=document.querySelector(`[data-element-id="${re}"]`);if(ie){if(!h.has(ie)){(0,r.warn)(`_bindResetFormAction - element not allowed: ${re}`);continue}}else continue;ie.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:fe,name:"ResetForm"}}),!1}}}class v extends m{constructor(_){super(_,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let _=document.createElement("img");return _.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",_.alt="[{{type}} Annotation]",_.dataset.l10nId="text_annotation_type",_.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(_),this.container}}class E extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(_){this.data.hasOwnCanvas&&(_.previousSibling?.nodeName==="CANVAS"&&(_.previousSibling.hidden=!0),_.hidden=!1)}_getKeyModifier(_){let{isWin:R,isMac:N}=r.FeatureTest.platform;return R&&_.ctrlKey||N&&_.metaKey}_setEventListener(_,R,N,B,z){N.includes("mouse")?_.addEventListener(N,K=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:z(K),shift:K.shiftKey,modifier:this._getKeyModifier(K)}})}):_.addEventListener(N,K=>{if(N==="blur"){if(!R.focused||!K.relatedTarget)return;R.focused=!1}else if(N==="focus"){if(R.focused)return;R.focused=!0}z&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:z(K)}})})}_setEventListeners(_,R,N,B){for(let[z,K]of N)(K==="Action"||this.data.actions?.[K])&&((K==="Focus"||K==="Blur")&&(R||={focused:!1}),this._setEventListener(_,R,z,K,B),K==="Focus"&&!this.data.actions?.Blur?this._setEventListener(_,R,"blur","Blur",null):K==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(_,R,"focus","Focus",null))}_setBackgroundColor(_){let R=this.data.backgroundColor||null;_.style.backgroundColor=R===null?"transparent":r.Util.makeHexColor(R[0],R[1],R[2])}_setTextStyle(_){let R=["left","center","right"],{fontColor:N}=this.data.defaultAppearanceData,B=this.data.defaultAppearanceData.fontSize||d,z=_.style,K,Y=2,ee=fe=>Math.round(10*fe)/10;if(this.data.multiLine){let fe=Math.abs(this.data.rect[3]-this.data.rect[1]-Y),te=Math.round(fe/(r.LINE_FACTOR*B))||1,re=fe/te;K=Math.min(B,ee(re/r.LINE_FACTOR))}else{let fe=Math.abs(this.data.rect[3]-this.data.rect[1]-Y);K=Math.min(B,ee(fe/r.LINE_FACTOR))}z.fontSize=`calc(${K}px * var(--scale-factor))`,z.color=r.Util.makeHexColor(N[0],N[1],N[2]),this.data.textAlignment!==null&&(z.textAlign=R[this.data.textAlignment])}_setRequired(_,R){R?_.setAttribute("required",!0):_.removeAttribute("required"),_.setAttribute("aria-required",R)}}class A extends E{constructor(_){let R=_.renderForms||!_.data.hasAppearance&&!!_.data.fieldValue;super(_,{isRenderable:R})}setPropertyOnSiblings(_,R,N,B){let z=this.annotationStorage;for(let K of this._getElementsByName(_.name,_.id))K.domElement&&(K.domElement[R]=N),z.setValue(K.id,{[B]:N})}render(){let _=this.annotationStorage,R=this.data.id;this.container.classList.add("textWidgetAnnotation");let N=null;if(this.renderForms){let B=_.getValue(R,{value:this.data.fieldValue}),z=B.value||"",K=_.getValue(R,{charLimit:this.data.maxLen}).charLimit;K&&z.length>K&&(z=z.slice(0,K));let Y=B.formattedValue||this.data.textContent?.join(`
`)||null;Y&&this.data.comb&&(Y=Y.replaceAll(/\s+/g,""));let ee={userValue:z,formattedValue:Y,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(N=document.createElement("textarea"),N.textContent=Y??z,this.data.doNotScroll&&(N.style.overflowY="hidden")):(N=document.createElement("input"),N.type="text",N.setAttribute("value",Y??z),this.data.doNotScroll&&(N.style.overflowX="hidden")),this.data.hasOwnCanvas&&(N.hidden=!0),h.add(N),N.setAttribute("data-element-id",R),N.disabled=this.data.readOnly,N.name=this.data.fieldName,N.tabIndex=l,this._setRequired(N,this.data.required),K&&(N.maxLength=K),N.addEventListener("input",te=>{_.setValue(R,{value:te.target.value}),this.setPropertyOnSiblings(N,"value",te.target.value,"value"),ee.formattedValue=null}),N.addEventListener("resetform",te=>{let re=this.data.defaultFieldValue??"";N.value=ee.userValue=re,ee.formattedValue=null});let fe=te=>{let{formattedValue:re}=ee;re!=null&&(te.target.value=re),te.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){N.addEventListener("focus",re=>{if(ee.focused)return;let{target:ie}=re;ee.userValue&&(ie.value=ee.userValue),ee.lastCommittedValue=ie.value,ee.commitKey=1,ee.focused=!0}),N.addEventListener("updatefromsandbox",re=>{this.showElementAndHideCanvas(re.target);let ie={value(se){ee.userValue=se.detail.value??"",_.setValue(R,{value:ee.userValue.toString()}),se.target.value=ee.userValue},formattedValue(se){let{formattedValue:ce}=se.detail;ee.formattedValue=ce,ce!=null&&se.target!==document.activeElement&&(se.target.value=ce),_.setValue(R,{formattedValue:ce})},selRange(se){se.target.setSelectionRange(...se.detail.selRange)},charLimit:se=>{let{charLimit:ce}=se.detail,{target:ye}=se;if(ce===0){ye.removeAttribute("maxLength");return}ye.setAttribute("maxLength",ce);let be=ee.userValue;!be||be.length<=ce||(be=be.slice(0,ce),ye.value=ee.userValue=be,_.setValue(R,{value:be}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:R,name:"Keystroke",value:be,willCommit:!0,commitKey:1,selStart:ye.selectionStart,selEnd:ye.selectionEnd}}))}};this._dispatchEventFromSandbox(ie,re)}),N.addEventListener("keydown",re=>{ee.commitKey=1;let ie=-1;if(re.key==="Escape"?ie=0:re.key==="Enter"&&!this.data.multiLine?ie=2:re.key==="Tab"&&(ee.commitKey=3),ie===-1)return;let{value:se}=re.target;ee.lastCommittedValue!==se&&(ee.lastCommittedValue=se,ee.userValue=se,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:R,name:"Keystroke",value:se,willCommit:!0,commitKey:ie,selStart:re.target.selectionStart,selEnd:re.target.selectionEnd}}))});let te=fe;fe=null,N.addEventListener("blur",re=>{if(!ee.focused||!re.relatedTarget)return;ee.focused=!1;let{value:ie}=re.target;ee.userValue=ie,ee.lastCommittedValue!==ie&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:R,name:"Keystroke",value:ie,willCommit:!0,commitKey:ee.commitKey,selStart:re.target.selectionStart,selEnd:re.target.selectionEnd}}),te(re)}),this.data.actions?.Keystroke&&N.addEventListener("beforeinput",re=>{ee.lastCommittedValue=null;let{data:ie,target:se}=re,{value:ce,selectionStart:ye,selectionEnd:be}=se,Ae=ye,xe=be;switch(re.inputType){case"deleteWordBackward":{let Ue=ce.substring(0,ye).match(/\w*[^\w]*$/);Ue&&(Ae-=Ue[0].length);break}case"deleteWordForward":{let Ue=ce.substring(ye).match(/^[^\w]*\w*/);Ue&&(xe+=Ue[0].length);break}case"deleteContentBackward":ye===be&&(Ae-=1);break;case"deleteContentForward":ye===be&&(xe+=1);break}re.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:R,name:"Keystroke",value:ce,change:ie||"",willCommit:!1,selStart:Ae,selEnd:xe}})}),this._setEventListeners(N,ee,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],re=>re.target.value)}if(fe&&N.addEventListener("blur",fe),this.data.comb){let re=(this.data.rect[2]-this.data.rect[0])/K;N.classList.add("comb"),N.style.letterSpacing=`calc(${re}px * var(--scale-factor) - 1ch)`}}else N=document.createElement("div"),N.textContent=this.data.fieldValue,N.style.verticalAlign="middle",N.style.display="table-cell";return this._setTextStyle(N),this._setBackgroundColor(N),this._setDefaultPropertiesFromJS(N),this.container.append(N),this.container}}class O extends E{constructor(_){super(_,{isRenderable:!!_.data.hasOwnCanvas})}}class M extends E{constructor(_){super(_,{isRenderable:_.renderForms})}render(){let _=this.annotationStorage,R=this.data,N=R.id,B=_.getValue(N,{value:R.exportValue===R.fieldValue}).value;typeof B=="string"&&(B=B!=="Off",_.setValue(N,{value:B})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let z=document.createElement("input");return h.add(z),z.setAttribute("data-element-id",N),z.disabled=R.readOnly,this._setRequired(z,this.data.required),z.type="checkbox",z.name=R.fieldName,B&&z.setAttribute("checked",!0),z.setAttribute("exportValue",R.exportValue),z.tabIndex=l,z.addEventListener("change",K=>{let{name:Y,checked:ee}=K.target;for(let fe of this._getElementsByName(Y,N)){let te=ee&&fe.exportValue===R.exportValue;fe.domElement&&(fe.domElement.checked=te),_.setValue(fe.id,{value:te})}_.setValue(N,{value:ee})}),z.addEventListener("resetform",K=>{let Y=R.defaultFieldValue||"Off";K.target.checked=Y===R.exportValue}),this.enableScripting&&this.hasJSActions&&(z.addEventListener("updatefromsandbox",K=>{let Y={value(ee){ee.target.checked=ee.detail.value!=="Off",_.setValue(N,{value:ee.target.checked})}};this._dispatchEventFromSandbox(Y,K)}),this._setEventListeners(z,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],K=>K.target.checked)),this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class C extends E{constructor(_){super(_,{isRenderable:_.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let _=this.annotationStorage,R=this.data,N=R.id,B=_.getValue(N,{value:R.fieldValue===R.buttonValue}).value;typeof B=="string"&&(B=B!==R.buttonValue,_.setValue(N,{value:B}));let z=document.createElement("input");if(h.add(z),z.setAttribute("data-element-id",N),z.disabled=R.readOnly,this._setRequired(z,this.data.required),z.type="radio",z.name=R.fieldName,B&&z.setAttribute("checked",!0),z.tabIndex=l,z.addEventListener("change",K=>{let{name:Y,checked:ee}=K.target;for(let fe of this._getElementsByName(Y,N))_.setValue(fe.id,{value:!1});_.setValue(N,{value:ee})}),z.addEventListener("resetform",K=>{let Y=R.defaultFieldValue;K.target.checked=Y!=null&&Y===R.buttonValue}),this.enableScripting&&this.hasJSActions){let K=R.buttonValue;z.addEventListener("updatefromsandbox",Y=>{let ee={value:fe=>{let te=K===fe.detail.value;for(let re of this._getElementsByName(fe.target.name)){let ie=te&&re.id===N;re.domElement&&(re.domElement.checked=ie),_.setValue(re.id,{value:ie})}}};this._dispatchEventFromSandbox(ee,Y)}),this._setEventListeners(z,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Y=>Y.target.checked)}return this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class P extends g{constructor(_){super(_,{ignoreBorder:_.data.hasAppearance})}render(){let _=super.render();_.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(_.title=this.data.alternativeText);let R=_.lastChild;return this.enableScripting&&this.hasJSActions&&R&&(this._setDefaultPropertiesFromJS(R),R.addEventListener("updatefromsandbox",N=>{this._dispatchEventFromSandbox({},N)})),_}}class D extends E{constructor(_){super(_,{isRenderable:_.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let _=this.annotationStorage,R=this.data.id,N=_.getValue(R,{value:this.data.fieldValue}),B=document.createElement("select");h.add(B),B.setAttribute("data-element-id",R),B.disabled=this.data.readOnly,this._setRequired(B,this.data.required),B.name=this.data.fieldName,B.tabIndex=l;let z=this.data.combo&&this.data.options.length>0;this.data.combo||(B.size=this.data.options.length,this.data.multiSelect&&(B.multiple=!0)),B.addEventListener("resetform",te=>{let re=this.data.defaultFieldValue;for(let ie of B.options)ie.selected=ie.value===re});for(let te of this.data.options){let re=document.createElement("option");re.textContent=te.displayValue,re.value=te.exportValue,N.value.includes(te.exportValue)&&(re.setAttribute("selected",!0),z=!1),B.append(re)}let K=null;if(z){let te=document.createElement("option");te.value=" ",te.setAttribute("hidden",!0),te.setAttribute("selected",!0),B.prepend(te),K=()=>{te.remove(),B.removeEventListener("input",K),K=null},B.addEventListener("input",K)}let Y=te=>{let re=te?"value":"textContent",{options:ie,multiple:se}=B;return se?Array.prototype.filter.call(ie,ce=>ce.selected).map(ce=>ce[re]):ie.selectedIndex===-1?null:ie[ie.selectedIndex][re]},ee=Y(!1),fe=te=>{let re=te.target.options;return Array.prototype.map.call(re,ie=>({displayValue:ie.textContent,exportValue:ie.value}))};return this.enableScripting&&this.hasJSActions?(B.addEventListener("updatefromsandbox",te=>{let re={value(ie){K?.();let se=ie.detail.value,ce=new Set(Array.isArray(se)?se:[se]);for(let ye of B.options)ye.selected=ce.has(ye.value);_.setValue(R,{value:Y(!0)}),ee=Y(!1)},multipleSelection(ie){B.multiple=!0},remove(ie){let se=B.options,ce=ie.detail.remove;se[ce].selected=!1,B.remove(ce),se.length>0&&Array.prototype.findIndex.call(se,be=>be.selected)===-1&&(se[0].selected=!0),_.setValue(R,{value:Y(!0),items:fe(ie)}),ee=Y(!1)},clear(ie){for(;B.length!==0;)B.remove(0);_.setValue(R,{value:null,items:[]}),ee=Y(!1)},insert(ie){let{index:se,displayValue:ce,exportValue:ye}=ie.detail.insert,be=B.children[se],Ae=document.createElement("option");Ae.textContent=ce,Ae.value=ye,be?be.before(Ae):B.append(Ae),_.setValue(R,{value:Y(!0),items:fe(ie)}),ee=Y(!1)},items(ie){let{items:se}=ie.detail;for(;B.length!==0;)B.remove(0);for(let ce of se){let{displayValue:ye,exportValue:be}=ce,Ae=document.createElement("option");Ae.textContent=ye,Ae.value=be,B.append(Ae)}B.options.length>0&&(B.options[0].selected=!0),_.setValue(R,{value:Y(!0),items:fe(ie)}),ee=Y(!1)},indices(ie){let se=new Set(ie.detail.indices);for(let ce of ie.target.options)ce.selected=se.has(ce.index);_.setValue(R,{value:Y(!0)}),ee=Y(!1)},editable(ie){ie.target.disabled=!ie.detail.editable}};this._dispatchEventFromSandbox(re,te)}),B.addEventListener("input",te=>{let re=Y(!0);_.setValue(R,{value:re}),te.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:R,name:"Keystroke",value:ee,changeEx:re,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(B,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],te=>te.target.value)):B.addEventListener("input",function(te){_.setValue(R,{value:Y(!0)})}),this.data.combo&&this._setTextStyle(B),this._setBackgroundColor(B),this._setDefaultPropertiesFromJS(B),this.container.append(B),this.container}}class S extends m{constructor(_){let{data:R,elements:N}=_;super(_,{isRenderable:m._hasPopupData(R)}),this.elements=N}render(){this.container.classList.add("popupAnnotation");let _=new T({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),R=[];for(let N of this.elements)N.popup=_,R.push(N.data.id),N.addHighlightArea();return this.container.setAttribute("aria-controls",R.map(N=>`${r.AnnotationPrefix}${N}`).join(",")),this.container}}class T{#e=null;#t=this.#u.bind(this);#n=this.#w.bind(this);#r=this.#I.bind(this);#a=this.#v.bind(this);#o=null;#s=null;#c=null;#l=null;#i=null;#f=null;#d=!1;#h=null;#p=null;#y=null;#m=null;#g=!1;constructor({container:_,color:R,elements:N,titleObj:B,modificationDate:z,contentsObj:K,richText:Y,parent:ee,rect:fe,parentRect:te,open:re}){this.#s=_,this.#m=B,this.#c=K,this.#y=Y,this.#i=ee,this.#o=R,this.#p=fe,this.#f=te,this.#l=N;let ie=i.PDFDateString.toDateObject(z);ie&&(this.#e=ee.l10n.get("annotation_date_string",{date:ie.toLocaleDateString(),time:ie.toLocaleTimeString()})),this.trigger=N.flatMap(se=>se.getElementsToTriggerPopup());for(let se of this.trigger)se.addEventListener("click",this.#a),se.addEventListener("mouseenter",this.#r),se.addEventListener("mouseleave",this.#n),se.classList.add("popupTriggerArea");for(let se of N)se.container?.addEventListener("keydown",this.#t);this.#s.hidden=!0,re&&this.#v()}render(){if(this.#h)return;let{page:{view:_},viewport:{rawDims:{pageWidth:R,pageHeight:N,pageX:B,pageY:z}}}=this.#i,K=this.#h=document.createElement("div");if(K.className="popup",this.#o){let Ue=K.style.outlineColor=r.Util.makeHexColor(...this.#o);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?K.style.backgroundColor=`color-mix(in srgb, ${Ue} 30%, white)`:K.style.backgroundColor=r.Util.makeHexColor(...this.#o.map(Zt=>Math.floor(.7*(255-Zt)+Zt)))}let Y=document.createElement("span");Y.className="header";let ee=document.createElement("h1");if(Y.append(ee),{dir:ee.dir,str:ee.textContent}=this.#m,K.append(Y),this.#e){let Ue=document.createElement("span");Ue.classList.add("popupDate"),this.#e.then(et=>{Ue.textContent=et}),Y.append(Ue)}let fe=this.#c,te=this.#y;if(te?.str&&(!fe?.str||fe.str===te.str))c.XfaLayer.render({xfaHtml:te.html,intent:"richText",div:K}),K.lastChild.classList.add("richText","popupContent");else{let Ue=this._formatContents(fe);K.append(Ue)}let re=!!this.#f,ie=re?this.#f:this.#p;for(let Ue of this.#l)if(!ie||r.Util.intersect(Ue.data.rect,ie)!==null){ie=Ue.data.rect,re=!0;break}let se=r.Util.normalizeRect([ie[0],_[3]-ie[1]+_[1],ie[2],_[3]-ie[3]+_[1]]),ye=re?ie[2]-ie[0]+5:0,be=se[0]+ye,Ae=se[1],{style:xe}=this.#s;xe.left=`${100*(be-B)/R}%`,xe.top=`${100*(Ae-z)/N}%`,this.#s.append(K)}_formatContents({str:_,dir:R}){let N=document.createElement("p");N.classList.add("popupContent"),N.dir=R;let B=_.split(/(?:\r\n?|\n)/);for(let z=0,K=B.length;z<K;++z){let Y=B[z];N.append(document.createTextNode(Y)),z<K-1&&N.append(document.createElement("br"))}return N}#u(_){_.altKey||_.shiftKey||_.ctrlKey||_.metaKey||(_.key==="Enter"||_.key==="Escape"&&this.#d)&&this.#v()}#v(){this.#d=!this.#d,this.#d?(this.#I(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#t)):(this.#w(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#t))}#I(){this.#h||this.render(),this.isVisible?this.#d&&this.#s.classList.add("focused"):(this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#w(){this.#s.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#s.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class F extends m{constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0}),this.textContent=_.data.textContent,this.textPosition=_.data.textPosition,this.annotationEditorType=r.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let _=document.createElement("div");_.classList.add("annotationTextContent"),_.setAttribute("role","comment");for(let R of this.textContent){let N=document.createElement("span");N.textContent=R,_.append(N)}this.container.append(_)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=F;class L extends m{#e=null;constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let _=this.data,{width:R,height:N}=f(_.rect),B=this.svgFactory.create(R,N,!0),z=this.#e=this.svgFactory.createElement("svg:line");return z.setAttribute("x1",_.rect[2]-_.lineCoordinates[0]),z.setAttribute("y1",_.rect[3]-_.lineCoordinates[1]),z.setAttribute("x2",_.rect[2]-_.lineCoordinates[2]),z.setAttribute("y2",_.rect[3]-_.lineCoordinates[3]),z.setAttribute("stroke-width",_.borderStyle.width||1),z.setAttribute("stroke","transparent"),z.setAttribute("fill","transparent"),B.append(z),this.container.append(B),!_.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class W extends m{#e=null;constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let _=this.data,{width:R,height:N}=f(_.rect),B=this.svgFactory.create(R,N,!0),z=_.borderStyle.width,K=this.#e=this.svgFactory.createElement("svg:rect");return K.setAttribute("x",z/2),K.setAttribute("y",z/2),K.setAttribute("width",R-z),K.setAttribute("height",N-z),K.setAttribute("stroke-width",z||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),B.append(K),this.container.append(B),!_.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class U extends m{#e=null;constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let _=this.data,{width:R,height:N}=f(_.rect),B=this.svgFactory.create(R,N,!0),z=_.borderStyle.width,K=this.#e=this.svgFactory.createElement("svg:ellipse");return K.setAttribute("cx",R/2),K.setAttribute("cy",N/2),K.setAttribute("rx",R/2-z/2),K.setAttribute("ry",N/2-z/2),K.setAttribute("stroke-width",z||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),B.append(K),this.container.append(B),!_.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ae extends m{#e=null;constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let _=this.data,{width:R,height:N}=f(_.rect),B=this.svgFactory.create(R,N,!0),z=[];for(let Y of _.vertices){let ee=Y.x-_.rect[0],fe=_.rect[3]-Y.y;z.push(ee+","+fe)}z=z.join(" ");let K=this.#e=this.svgFactory.createElement(this.svgElementName);return K.setAttribute("points",z),K.setAttribute("stroke-width",_.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),B.append(K),this.container.append(B),!_.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class pe extends ae{constructor(_){super(_),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class oe extends m{constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class q extends m{#e=[];constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=r.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);let _=this.data,{width:R,height:N}=f(_.rect),B=this.svgFactory.create(R,N,!0);for(let z of _.inkLists){let K=[];for(let ee of z){let fe=ee.x-_.rect[0],te=_.rect[3]-ee.y;K.push(`${fe},${te}`)}K=K.join(" ");let Y=this.svgFactory.createElement(this.svgElementName);this.#e.push(Y),Y.setAttribute("points",K),Y.setAttribute("stroke-width",_.borderStyle.width||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","transparent"),!_.popupRef&&this.hasPopupData&&this._createPopup(),B.append(Y)}return this.container.append(B),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}e.InkAnnotationElement=q;class x extends m{constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class w extends m{constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class I extends m{constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class k extends m{constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class H extends m{constructor(_){super(_,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=H;class $ extends m{#e=null;constructor(_){super(_,{isRenderable:!0});let{filename:R,content:N}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(R,!0),this.content=N,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:R,content:N})}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:_,data:R}=this,N;R.hasAppearance||R.fillAlpha===0?N=document.createElement("div"):(N=document.createElement("img"),N.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(R.name)?"paperclip":"pushpin"}.svg`,R.fillAlpha&&R.fillAlpha<1&&(N.style=`filter: opacity(${Math.round(R.fillAlpha*100)}%);`)),N.addEventListener("dblclick",this.#t.bind(this)),this.#e=N;let{isMac:B}=r.FeatureTest.platform;return _.addEventListener("keydown",z=>{z.key==="Enter"&&(B?z.metaKey:z.ctrlKey)&&this.#t()}),!R.popupRef&&this.hasPopupData?this._createPopup():N.classList.add("popupTriggerArea"),_.append(N),_}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class G{#e=null;#t=null;#n=new Map;constructor({div:_,accessibilityManager:R,annotationCanvasMap:N,l10n:B,page:z,viewport:K}){this.div=_,this.#e=R,this.#t=N,this.l10n=B,this.page=z,this.viewport=K,this.zIndex=0,this.l10n||=a.NullL10n}#r(_,R){let N=_.firstChild||_;N.id=`${r.AnnotationPrefix}${R}`,this.div.append(_),this.#e?.moveElementInDOM(this.div,_,N,!1)}render(_){return X(this,null,function*(){let{annotations:R}=_,N=this.div;(0,i.setLayerDimensions)(N,this.viewport);let B=new Map,z={data:null,layer:N,linkService:_.linkService,downloadManager:_.downloadManager,imageResourcesPath:_.imageResourcesPath||"",renderForms:_.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:_.annotationStorage||new s.AnnotationStorage,enableScripting:_.enableScripting===!0,hasJSActions:_.hasJSActions,fieldObjects:_.fieldObjects,parent:this,elements:null};for(let K of R){if(K.noHTML)continue;let Y=K.annotationType===r.AnnotationType.POPUP;if(Y){let te=B.get(K.id);if(!te)continue;z.elements=te}else{let{width:te,height:re}=f(K.rect);if(te<=0||re<=0)continue}z.data=K;let ee=p.create(z);if(!ee.isRenderable)continue;if(!Y&&K.popupRef){let te=B.get(K.popupRef);te?te.push(ee):B.set(K.popupRef,[ee])}ee.annotationEditorType>0&&this.#n.set(ee.data.id,ee);let fe=ee.render();K.hidden&&(fe.style.visibility="hidden"),this.#r(fe,K.id)}this.#a(),yield this.l10n.translate(N)})}update({viewport:_}){let R=this.div;this.viewport=_,(0,i.setLayerDimensions)(R,{rotation:_.rotation}),this.#a(),R.hidden=!1}#a(){if(!this.#t)return;let _=this.div;for(let[R,N]of this.#t){let B=_.querySelector(`[data-annotation-id="${R}"]`);if(!B)continue;let{firstChild:z}=B;z?z.nodeName==="CANVAS"?z.replaceWith(N):z.before(N):B.append(N)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(_){return this.#n.get(_)}}e.AnnotationLayer=G}),((t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function n(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function r(s){return Math.max(0,Math.min(255,255*s))}class i{static CMYK_G([o,a,c,l]){return["G",1-Math.min(1,.3*o+.59*c+.11*a+l)]}static G_CMYK([o]){return["CMYK",0,0,0,1-o]}static G_RGB([o]){return["RGB",o,o,o]}static G_rgb([o]){return o=r(o),[o,o,o]}static G_HTML([o]){let a=n(o);return`#${a}${a}${a}`}static RGB_G([o,a,c]){return["G",.3*o+.59*a+.11*c]}static RGB_rgb(o){return o.map(r)}static RGB_HTML(o){return`#${o.map(n).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([o,a,c,l]){return["RGB",1-Math.min(1,o+l),1-Math.min(1,c+l),1-Math.min(1,a+l)]}static CMYK_rgb([o,a,c,l]){return[r(1-Math.min(1,o+l)),r(1-Math.min(1,c+l)),r(1-Math.min(1,a+l))]}static CMYK_HTML(o){let a=this.CMYK_RGB(o).slice(1);return this.RGB_HTML(a)}static RGB_CMYK([o,a,c]){let l=1-o,d=1-a,h=1-c,f=Math.min(l,d,h);return["CMYK",l,d,h,f]}}e.ColorConverters=i}),((t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=r;let n={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} \xD7 {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} \xD7 {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing\u2026",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};n.print_progress_percent="{{progress}}%";function r(a,c){switch(a){case"find_match_count":a=`find_match_count[${c.total===1?"one":"other"}]`;break;case"find_match_count_limit":a=`find_match_count_limit[${c.limit===1?"one":"other"}]`;break}return n[a]||""}function i(a,c){return c?a.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(l,d)=>d in c?c[d]:"{{"+d+"}}"):a}let s={getLanguage(){return X(this,null,function*(){return"en-us"})},getDirection(){return X(this,null,function*(){return"ltr"})},get(d){return X(this,arguments,function*(a,c=null,l=r(a,c)){return i(l,c)})},translate(a){return X(this,null,function*(){})}};e.NullL10n=s}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var r=n(25);class i{static setupStorage(o,a,c,l,d){let h=l.getValue(a,{value:null});switch(c.name){case"textarea":if(h.value!==null&&(o.textContent=h.value),d==="print")break;o.addEventListener("input",f=>{l.setValue(a,{value:f.target.value})});break;case"input":if(c.attributes.type==="radio"||c.attributes.type==="checkbox"){if(h.value===c.attributes.xfaOn?o.setAttribute("checked",!0):h.value===c.attributes.xfaOff&&o.removeAttribute("checked"),d==="print")break;o.addEventListener("change",f=>{l.setValue(a,{value:f.target.checked?f.target.getAttribute("xfaOn"):f.target.getAttribute("xfaOff")})})}else{if(h.value!==null&&o.setAttribute("value",h.value),d==="print")break;o.addEventListener("input",f=>{l.setValue(a,{value:f.target.value})})}break;case"select":if(h.value!==null){o.setAttribute("value",h.value);for(let f of c.children)f.attributes.value===h.value?f.attributes.selected=!0:f.attributes.hasOwnProperty("selected")&&delete f.attributes.selected}o.addEventListener("input",f=>{let p=f.target.options,m=p.selectedIndex===-1?"":p[p.selectedIndex].value;l.setValue(a,{value:m})});break}}static setAttributes({html:o,element:a,storage:c=null,intent:l,linkService:d}){let{attributes:h}=a,f=o instanceof HTMLAnchorElement;h.type==="radio"&&(h.name=`${h.name}-${l}`);for(let[p,m]of Object.entries(h))if(m!=null)switch(p){case"class":m.length&&o.setAttribute(p,m.join(" "));break;case"dataId":break;case"id":o.setAttribute("data-element-id",m);break;case"style":Object.assign(o.style,m);break;case"textContent":o.textContent=m;break;default:(!f||p!=="href"&&p!=="newWindow")&&o.setAttribute(p,m)}f&&d.addLinkAttributes(o,h.href,h.newWindow),c&&h.dataId&&this.setupStorage(o,h.dataId,a,c)}static render(o){let a=o.annotationStorage,c=o.linkService,l=o.xfaHtml,d=o.intent||"display",h=document.createElement(l.name);l.attributes&&this.setAttributes({html:h,element:l,intent:d,linkService:c});let f=[[l,-1,h]],p=o.div;if(p.append(h),o.viewport){let g=`matrix(${o.viewport.transform.join(",")})`;p.style.transform=g}d!=="richText"&&p.setAttribute("class","xfaLayer xfaFont");let m=[];for(;f.length>0;){let[g,v,E]=f.at(-1);if(v+1===g.children.length){f.pop();continue}let A=g.children[++f.at(-1)[1]];if(A===null)continue;let{name:O}=A;if(O==="#text"){let C=document.createTextNode(A.value);m.push(C),E.append(C);continue}let M=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,O):document.createElement(O);if(E.append(M),A.attributes&&this.setAttributes({html:M,element:A,storage:a,intent:d,linkService:c}),A.children&&A.children.length>0)f.push([A,-1,M]);else if(A.value){let C=document.createTextNode(A.value);r.XfaText.shouldBuildText(O)&&m.push(C),M.append(C)}}for(let g of p.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:m}}static update(o){let a=`matrix(${o.viewport.transform.join(",")})`;o.div.style.transform=a,o.div.hidden=!1}}e.XfaLayer=i}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var r=n(1),i=n(4),s=n(29),o=n(6),a=n(5);let c=(()=>{class l extends i.AnnotationEditor{#e=0;#t=0;#n=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#a=this.canvasPointerup.bind(this);#o=this.canvasPointerdown.bind(this);#s=new Path2D;#c=!1;#l=!1;#i=!1;#f=null;#d=0;#h=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(h){super(Ke(me({},h),{name:"inkEditor"})),this.color=h.color||null,this.thickness=h.thickness||null,this.opacity=h.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(h){i.AnnotationEditor.initialize(h,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(h,f){switch(h){case r.AnnotationEditorParamsType.INK_THICKNESS:l._defaultThickness=f;break;case r.AnnotationEditorParamsType.INK_COLOR:l._defaultColor=f;break;case r.AnnotationEditorParamsType.INK_OPACITY:l._defaultOpacity=f/100;break}}updateParams(h,f){switch(h){case r.AnnotationEditorParamsType.INK_THICKNESS:this.#y(f);break;case r.AnnotationEditorParamsType.INK_COLOR:this.#m(f);break;case r.AnnotationEditorParamsType.INK_OPACITY:this.#g(f);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,l._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,l._defaultColor||i.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(l._defaultOpacity*100)]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||l._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||l._defaultColor||i.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??l._defaultOpacity))]]}#y(h){let f=this.thickness;this.addCommands({cmd:()=>{this.thickness=h,this.#A()},undo:()=>{this.thickness=f,this.#A()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(h){let f=this.color;this.addCommands({cmd:()=>{this.color=h,this.#_()},undo:()=>{this.color=f,this.#_()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(h){h/=100;let f=this.opacity;this.addCommands({cmd:()=>{this.opacity=h,this.#_()},undo:()=>{this.opacity=f,this.#_()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#R(),this.#P()),this.isAttachedToDOM||(this.parent.add(this),this.#E()),this.#A()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#f.disconnect(),this.#f=null,super.remove())}setParent(h){!this.parent&&h?this._uiManager.removeShouldRescale(this):this.parent&&h===null&&this._uiManager.addShouldRescale(this),super.setParent(h)}onScaleChanging(){let[h,f]=this.parentDimensions,p=this.width*h,m=this.height*f;this.setDimensions(p,m)}enableEditMode(){this.#c||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#o))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#o))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#u(){let{parentRotation:h,parentDimensions:[f,p]}=this;switch(h){case 90:return[0,p,p,f];case 180:return[f,p,f,p];case 270:return[f,0,p,f];default:return[0,0,f,p]}}#v(){let{ctx:h,color:f,opacity:p,thickness:m,parentScale:g,scaleFactor:v}=this;h.lineWidth=m*g/v,h.lineCap="round",h.lineJoin="round",h.miterLimit=10,h.strokeStyle=`${f}${(0,a.opacityToHex)(p)}`}#I(h,f){this.canvas.addEventListener("contextmenu",o.noContextMenu),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#n),this.canvas.addEventListener("pointerup",this.#a),this.canvas.removeEventListener("pointerdown",this.#o),this.isEditing=!0,this.#i||(this.#i=!0,this.#E(),this.thickness||=l._defaultThickness,this.color||=l._defaultColor||i.AnnotationEditor._defaultLineColor,this.opacity??=l._defaultOpacity),this.currentPath.push([h,f]),this.#l=!1,this.#v(),this.#p=()=>{this.#N(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#w(h,f){let[p,m]=this.currentPath.at(-1);if(this.currentPath.length>1&&h===p&&f===m)return;let g=this.currentPath,v=this.#s;if(g.push([h,f]),this.#l=!0,g.length<=2){v.moveTo(...g[0]),v.lineTo(h,f);return}g.length===3&&(this.#s=v=new Path2D,v.moveTo(...g[0])),this.#O(v,...g.at(-3),...g.at(-2),h,f)}#S(){if(this.currentPath.length===0)return;let h=this.currentPath.at(-1);this.#s.lineTo(...h)}#D(h,f){this.#p=null,h=Math.min(Math.max(h,0),this.canvas.width),f=Math.min(Math.max(f,0),this.canvas.height),this.#w(h,f),this.#S();let p;if(this.currentPath.length!==1)p=this.#F();else{let A=[h,f];p=[[A,A.slice(),A.slice(),A]]}let m=this.#s,g=this.currentPath;this.currentPath=[],this.#s=new Path2D;let v=()=>{this.allRawPaths.push(g),this.paths.push(p),this.bezierPath2D.push(m),this.rebuild()},E=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#R(),this.#P()),this.#A())};this.addCommands({cmd:v,undo:E,mustExec:!0})}#N(){if(!this.#l)return;this.#l=!1;let h=Math.ceil(this.thickness*this.parentScale),f=this.currentPath.slice(-3),p=f.map(M=>M[0]),m=f.map(M=>M[1]),g=Math.min(...p)-h,v=Math.max(...p)+h,E=Math.min(...m)-h,A=Math.max(...m)+h,{ctx:O}=this;O.save(),O.clearRect(0,0,this.canvas.width,this.canvas.height);for(let M of this.bezierPath2D)O.stroke(M);O.stroke(this.#s),O.restore()}#O(h,f,p,m,g,v,E){let A=(f+m)/2,O=(p+g)/2,M=(m+v)/2,C=(g+E)/2;h.bezierCurveTo(A+2*(m-A)/3,O+2*(g-O)/3,M+2*(m-M)/3,C+2*(g-C)/3,M,C)}#F(){let h=this.currentPath;if(h.length<=2)return[[h[0],h[0],h.at(-1),h.at(-1)]];let f=[],p,[m,g]=h[0];for(p=1;p<h.length-2;p++){let[P,D]=h[p],[S,T]=h[p+1],F=(P+S)/2,L=(D+T)/2,W=[m+2*(P-m)/3,g+2*(D-g)/3],U=[F+2*(P-F)/3,L+2*(D-L)/3];f.push([[m,g],W,U,[F,L]]),[m,g]=[F,L]}let[v,E]=h[p],[A,O]=h[p+1],M=[m+2*(v-m)/3,g+2*(E-g)/3],C=[A+2*(v-A)/3,O+2*(E-O)/3];return f.push([[m,g],M,C,[A,O]]),f}#_(){if(this.isEmpty()){this.#T();return}this.#v();let{canvas:h,ctx:f}=this;f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,h.width,h.height),this.#T();for(let p of this.bezierPath2D)f.stroke(p)}commit(){this.#c||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#c=!0,this.div.classList.add("disabled"),this.#A(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(h){this._focusEventsAllowed&&(super.focusin(h),this.enableEditMode())}canvasPointerdown(h){h.button!==0||!this.isInEditMode()||this.#c||(this.setInForeground(),h.preventDefault(),h.type!=="mouse"&&this.div.focus(),this.#I(h.offsetX,h.offsetY))}canvasPointermove(h){h.preventDefault(),this.#w(h.offsetX,h.offsetY)}canvasPointerup(h){h.preventDefault(),this.#k(h)}canvasPointerleave(h){this.#k(h)}#k(h){this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#n),this.canvas.removeEventListener("pointerup",this.#a),this.canvas.addEventListener("pointerdown",this.#o),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",o.noContextMenu)},10),this.#D(h.offsetX,h.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#R(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(h=>this.canvas?.setAttribute("aria-label",h)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#P(){this.#f=new ResizeObserver(h=>{let f=h[0].contentRect;f.width&&f.height&&this.setDimensions(f.width,f.height)}),this.#f.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#c}render(){if(this.div)return this.div;let h,f;this.width&&(h=this.x,f=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(E=>this.div?.setAttribute("aria-label",E));let[p,m,g,v]=this.#u();if(this.setAt(p,m,0,0),this.setDims(g,v),this.#R(),this.width){let[E,A]=this.parentDimensions;this.setAspectRatio(this.width*E,this.height*A),this.setAt(h*E,f*A,this.width*E,this.height*A),this.#i=!0,this.#E(),this.setDims(this.width*E,this.height*A),this.#_(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#P(),this.div}#E(){if(!this.#i)return;let[h,f]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*h),this.canvas.height=Math.ceil(this.height*f),this.#T()}setDimensions(h,f){let p=Math.round(h),m=Math.round(f);if(this.#d===p&&this.#h===m)return;this.#d=p,this.#h=m,this.canvas.style.visibility="hidden";let[g,v]=this.parentDimensions;this.width=h/g,this.height=f/v,this.fixAndSetPosition(),this.#c&&this.#C(h,f),this.#E(),this.#_(),this.canvas.style.visibility="visible",this.fixDims()}#C(h,f){let p=this.#M(),m=(h-p)/this.#t,g=(f-p)/this.#e;this.scaleFactor=Math.min(m,g)}#T(){let h=this.#M()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+h,this.translationY*this.scaleFactor+h)}static#L(h){let f=new Path2D;for(let p=0,m=h.length;p<m;p++){let[g,v,E,A]=h[p];p===0&&f.moveTo(...g),f.bezierCurveTo(v[0],v[1],E[0],E[1],A[0],A[1])}return f}static#V(h,f,p){let[m,g,v,E]=f;switch(p){case 0:for(let A=0,O=h.length;A<O;A+=2)h[A]+=m,h[A+1]=E-h[A+1];break;case 90:for(let A=0,O=h.length;A<O;A+=2){let M=h[A];h[A]=h[A+1]+m,h[A+1]=M+g}break;case 180:for(let A=0,O=h.length;A<O;A+=2)h[A]=v-h[A],h[A+1]+=g;break;case 270:for(let A=0,O=h.length;A<O;A+=2){let M=h[A];h[A]=v-h[A+1],h[A+1]=E-M}break;default:throw new Error("Invalid rotation")}return h}static#U(h,f,p){let[m,g,v,E]=f;switch(p){case 0:for(let A=0,O=h.length;A<O;A+=2)h[A]-=m,h[A+1]=E-h[A+1];break;case 90:for(let A=0,O=h.length;A<O;A+=2){let M=h[A];h[A]=h[A+1]-g,h[A+1]=M-m}break;case 180:for(let A=0,O=h.length;A<O;A+=2)h[A]=v-h[A],h[A+1]-=g;break;case 270:for(let A=0,O=h.length;A<O;A+=2){let M=h[A];h[A]=E-h[A+1],h[A+1]=v-M}break;default:throw new Error("Invalid rotation")}return h}#j(h,f,p,m){let g=[],v=this.thickness/2,E=h*f+v,A=h*p+v;for(let O of this.paths){let M=[],C=[];for(let P=0,D=O.length;P<D;P++){let[S,T,F,L]=O[P],W=h*S[0]+E,U=h*S[1]+A,ae=h*T[0]+E,pe=h*T[1]+A,oe=h*F[0]+E,q=h*F[1]+A,x=h*L[0]+E,w=h*L[1]+A;P===0&&(M.push(W,U),C.push(W,U)),M.push(ae,pe,oe,q,x,w),C.push(ae,pe),P===D-1&&C.push(x,w)}g.push({bezier:l.#V(M,m,this.rotation),points:l.#V(C,m,this.rotation)})}return g}#x(){let h=1/0,f=-1/0,p=1/0,m=-1/0;for(let g of this.paths)for(let[v,E,A,O]of g){let M=r.Util.bezierBoundingBox(...v,...E,...A,...O);h=Math.min(h,M[0]),p=Math.min(p,M[1]),f=Math.max(f,M[2]),m=Math.max(m,M[3])}return[h,p,f,m]}#M(){return this.#c?Math.ceil(this.thickness*this.parentScale):0}#A(h=!1){if(this.isEmpty())return;if(!this.#c){this.#_();return}let f=this.#x(),p=this.#M();this.#t=Math.max(i.AnnotationEditor.MIN_SIZE,f[2]-f[0]),this.#e=Math.max(i.AnnotationEditor.MIN_SIZE,f[3]-f[1]);let m=Math.ceil(p+this.#t*this.scaleFactor),g=Math.ceil(p+this.#e*this.scaleFactor),[v,E]=this.parentDimensions;this.width=m/v,this.height=g/E,this.setAspectRatio(m,g);let A=this.translationX,O=this.translationY;this.translationX=-f[0],this.translationY=-f[1],this.#E(),this.#_(),this.#d=m,this.#h=g,this.setDims(m,g);let M=h?p/this.scaleFactor/2:0;this.translate(A-this.translationX-M,O-this.translationY-M)}static deserialize(h,f,p){if(h instanceof s.InkAnnotationElement)return null;let m=super.deserialize(h,f,p);m.thickness=h.thickness,m.color=r.Util.makeHexColor(...h.color),m.opacity=h.opacity;let[g,v]=m.pageDimensions,E=m.width*g,A=m.height*v,O=m.parentScale,M=h.thickness/2;m.#c=!0,m.#d=Math.round(E),m.#h=Math.round(A);let{paths:C,rect:P,rotation:D}=h;for(let{bezier:T}of C){T=l.#U(T,P,D);let F=[];m.paths.push(F);let L=O*(T[0]-M),W=O*(T[1]-M);for(let ae=2,pe=T.length;ae<pe;ae+=6){let oe=O*(T[ae]-M),q=O*(T[ae+1]-M),x=O*(T[ae+2]-M),w=O*(T[ae+3]-M),I=O*(T[ae+4]-M),k=O*(T[ae+5]-M);F.push([[L,W],[oe,q],[x,w],[I,k]]),L=I,W=k}let U=this.#L(F);m.bezierPath2D.push(U)}let S=m.#x();return m.#t=Math.max(i.AnnotationEditor.MIN_SIZE,S[2]-S[0]),m.#e=Math.max(i.AnnotationEditor.MIN_SIZE,S[3]-S[1]),m.#C(E,A),m}serialize(){if(this.isEmpty())return null;let h=this.getRect(0,0),f=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:f,thickness:this.thickness,opacity:this.opacity,paths:this.#j(this.scaleFactor/this.parentScale,this.translationX,this.translationY,h),pageIndex:this.pageIndex,rect:h,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}return l})();e.InkEditor=c}),((t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var r=n(1),i=n(4),s=n(6),o=n(29);let a=(()=>{class c extends i.AnnotationEditor{#e=null;#t=null;#n=null;#r=null;#a=null;#o=null;#s=null;#c=null;#l=!1;#i=!1;static _type="stamp";constructor(d){super(Ke(me({},d),{name:"stampEditor"})),this.#r=d.bitmapUrl,this.#a=d.bitmapFile}static initialize(d){i.AnnotationEditor.initialize(d)}static get supportedTypes(){let d=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,r.shadow)(this,"supportedTypes",d.map(h=>`image/${h}`))}static get supportedTypesStr(){return(0,r.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(d){return this.supportedTypes.includes(d)}static paste(d,h){h.pasteEditor(r.AnnotationEditorType.STAMP,{bitmapFile:d.getAsFile()})}#f(d,h=!1){if(!d){this.remove();return}this.#e=d.bitmap,h||(this.#t=d.id,this.#l=d.isSvg),this.#p()}#d(){this.#n=null,this._uiManager.enableWaiting(!1),this.#o&&this.div.focus()}#h(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(h=>this.#f(h,!0)).finally(()=>this.#d());return}if(this.#r){let h=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(h).then(f=>this.#f(f)).finally(()=>this.#d());return}if(this.#a){let h=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(h).then(f=>this.#f(f)).finally(()=>this.#d());return}let d=document.createElement("input");d.type="file",d.accept=c.supportedTypesStr,this.#n=new Promise(h=>{d.addEventListener("change",()=>X(this,null,function*(){if(!d.files||d.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let f=yield this._uiManager.imageManager.getFromFile(d.files[0]);this.#f(f)}h()})),d.addEventListener("cancel",()=>{this.remove(),h()})}).finally(()=>this.#d()),d.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#o?.remove(),this.#o=null,this.#s?.disconnect(),this.#s=null),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#h();return}super.rebuild(),this.div!==null&&(this.#t&&this.#h(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#r||this.#a)}get isResizable(){return!0}render(){if(this.div)return this.div;let d,h;if(this.width&&(d=this.x,h=this.y),super.render(),this.div.hidden=!0,this.#e?this.#p():this.#h(),this.width){let[f,p]=this.parentDimensions;this.setAt(d*f,h*p,this.width*f,this.height*p)}return this.div}#p(){let{div:d}=this,{width:h,height:f}=this.#e,[p,m]=this.pageDimensions,g=.75;if(this.width)h=this.width*p,f=this.height*m;else if(h>g*p||f>g*m){let O=Math.min(g*p/h,g*m/f);h*=O,f*=O}let[v,E]=this.parentDimensions;this.setDims(h*v/p,f*E/m),this._uiManager.enableWaiting(!1);let A=this.#o=document.createElement("canvas");d.append(A),d.hidden=!1,this.#g(h,f),this.#v(),this.#i||(this.parent.addUndoableEditor(this),this.#i=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#y(d,h){let[f,p]=this.parentDimensions;this.width=d/f,this.height=h/p,this.setDims(d,h),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#c!==null&&clearTimeout(this.#c);let m=200;this.#c=setTimeout(()=>{this.#c=null,this.#g(d,h)},m)}#m(d,h){let{width:f,height:p}=this.#e,m=f,g=p,v=this.#e;for(;m>2*d||g>2*h;){let E=m,A=g;m>2*d&&(m=m>=16384?Math.floor(m/2)-1:Math.ceil(m/2)),g>2*h&&(g=g>=16384?Math.floor(g/2)-1:Math.ceil(g/2));let O=new OffscreenCanvas(m,g);O.getContext("2d").drawImage(v,0,0,E,A,0,0,m,g),v=O.transferToImageBitmap()}return v}#g(d,h){d=Math.ceil(d),h=Math.ceil(h);let f=this.#o;if(!f||f.width===d&&f.height===h)return;f.width=d,f.height=h;let p=this.#l?this.#e:this.#m(d,h),m=f.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(p,0,0,p.width,p.height,0,0,d,h)}#u(d){if(d){if(this.#l){let p=this._uiManager.imageManager.getSvgUrl(this.#t);if(p)return p}let h=document.createElement("canvas");return{width:h.width,height:h.height}=this.#e,h.getContext("2d").drawImage(this.#e,0,0),h.toDataURL()}if(this.#l){let[h,f]=this.pageDimensions,p=Math.round(this.width*h*s.PixelsPerInch.PDF_TO_CSS_UNITS),m=Math.round(this.height*f*s.PixelsPerInch.PDF_TO_CSS_UNITS),g=new OffscreenCanvas(p,m);return g.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,p,m),g.transferToImageBitmap()}return structuredClone(this.#e)}#v(){this.#s=new ResizeObserver(d=>{let h=d[0].contentRect;h.width&&h.height&&this.#y(h.width,h.height)}),this.#s.observe(this.div)}static deserialize(d,h,f){if(d instanceof o.StampAnnotationElement)return null;let p=super.deserialize(d,h,f),{rect:m,bitmapUrl:g,bitmapId:v,isSvg:E,accessibilityData:A}=d;v&&f.imageManager.isValidId(v)?p.#t=v:p.#r=g,p.#l=E;let[O,M]=p.pageDimensions;return p.width=(m[2]-m[0])/O,p.height=(m[3]-m[1])/M,A&&(p.altTextData=A),p}serialize(d=!1,h=null){if(this.isEmpty())return null;let f={annotationType:r.AnnotationEditorType.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#l,structTreeParentId:this._structTreeParentId};if(d)return f.bitmapUrl=this.#u(!0),f.accessibilityData=this.altTextData,f;let{decorative:p,altText:m}=this.altTextData;if(!p&&m&&(f.accessibilityData={type:"Figure",alt:m}),h===null)return f;h.stamps||=new Map;let g=this.#l?(f.rect[2]-f.rect[0])*(f.rect[3]-f.rect[1]):null;if(!h.stamps.has(this.#t))h.stamps.set(this.#t,{area:g,serialized:f}),f.bitmap=this.#u(!1);else if(this.#l){let v=h.stamps.get(this.#t);g>v.area&&(v.area=g,v.serialized.bitmap.close(),v.serialized.bitmap=this.#u(!1))}return f}}return c})();e.StampEditor=a})],__webpack_module_cache__={};function __w_pdfjs_require__(t){var e=__webpack_module_cache__[t];if(e!==void 0)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__w_pdfjs_require__),n.exports}var __webpack_exports__={};return(()=>{var t=__webpack_exports__;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(t,"AnnotationEditorLayer",{enumerable:!0,get:function(){return s.AnnotationEditorLayer}}),Object.defineProperty(t,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(t,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(t,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return o.AnnotationEditorUIManager}}),Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return a.AnnotationLayer}}),Object.defineProperty(t,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(t,"DOMSVGFactory",{enumerable:!0,get:function(){return r.DOMSVGFactory}}),Object.defineProperty(t,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return c.GlobalWorkerOptions}}),Object.defineProperty(t,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return n.PDFDataRangeTransport}}),Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return n.PDFWorker}}),Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(t,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(t,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(t,"SVGGraphics",{enumerable:!0,get:function(){return n.SVGGraphics}}),Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(t,"XfaLayer",{enumerable:!0,get:function(){return l.XfaLayer}}),Object.defineProperty(t,"build",{enumerable:!0,get:function(){return n.build}}),Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return n.getDocument}}),Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(t,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(t,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(t,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(t,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(t,"noContextMenu",{enumerable:!0,get:function(){return r.noContextMenu}}),Object.defineProperty(t,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}}),Object.defineProperty(t,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(t,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return n.version}});var e=__w_pdfjs_require__(1),n=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),i=__w_pdfjs_require__(26),s=__w_pdfjs_require__(27),o=__w_pdfjs_require__(5),a=__w_pdfjs_require__(29),c=__w_pdfjs_require__(14),l=__w_pdfjs_require__(32);let d="3.11.174",h="ce8716743"})(),__webpack_exports__})())});var op;function cu(){return op}function pr(t){let e=op;return op=t,e}var iw=Symbol("NotFound");function io(t){return t===iw||t?.name==="\u0275NotFound"}var an=null,lu=!1,ap=1,BP=null,vn=Symbol("SIGNAL");function je(t){let e=an;return an=t,e}function du(){return an}var Xa={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Qa(t){if(lu)throw new Error("");if(an===null)return;an.consumerOnSignalRead(t);let e=an.producersTail;if(e!==void 0&&e.producer===t)return;let n,r=an.recomputing;if(r&&(n=e!==void 0?e.nextProducer:an.producers,n!==void 0&&n.producer===t)){an.producersTail=n,n.lastReadVersion=t.version;return}let i=t.consumersTail;if(i!==void 0&&i.consumer===an&&(!r||HP(i,an)))return;let s=so(an),o={producer:t,consumer:an,nextProducer:n,prevConsumer:i,lastReadVersion:t.version,nextConsumer:void 0};an.producersTail=o,e!==void 0?e.nextProducer=o:an.producers=o,s&&cw(t,o)}function sw(){ap++}function cp(t){if(!(so(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===ap)){if(!t.producerMustRecompute(t)&&!Ja(t)){uu(t);return}t.producerRecomputeValue(t),uu(t)}}function lp(t){if(t.consumers===void 0)return;let e=lu;lu=!0;try{for(let n=t.consumers;n!==void 0;n=n.nextConsumer){let r=n.consumer;r.dirty||$P(r)}}finally{lu=e}}function up(){return an?.consumerAllowSignalWrites!==!1}function $P(t){t.dirty=!0,lp(t),t.consumerMarkedDirty?.(t)}function uu(t){t.dirty=!1,t.lastCleanEpoch=ap}function Za(t){return t&&ow(t),je(t)}function ow(t){t.producersTail=void 0,t.recomputing=!0}function hu(t,e){je(e),t&&aw(t)}function aw(t){t.recomputing=!1;let e=t.producersTail,n=e!==void 0?e.nextProducer:t.producers;if(n!==void 0){if(so(t))do n=dp(n);while(n!==void 0);e!==void 0?e.nextProducer=void 0:t.producers=void 0}}function Ja(t){for(let e=t.producers;e!==void 0;e=e.nextProducer){let n=e.producer,r=e.lastReadVersion;if(r!==n.version||(cp(n),r!==n.version))return!0}return!1}function ec(t){if(so(t)){let e=t.producers;for(;e!==void 0;)e=dp(e)}t.producers=void 0,t.producersTail=void 0,t.consumers=void 0,t.consumersTail=void 0}function cw(t,e){let n=t.consumersTail,r=so(t);if(n!==void 0?(e.nextConsumer=n.nextConsumer,n.nextConsumer=e):(e.nextConsumer=void 0,t.consumers=e),e.prevConsumer=n,t.consumersTail=e,!r)for(let i=t.producers;i!==void 0;i=i.nextProducer)cw(i.producer,i)}function dp(t){let e=t.producer,n=t.nextProducer,r=t.nextConsumer,i=t.prevConsumer;if(t.nextConsumer=void 0,t.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!so(e)){let s=e.producers;for(;s!==void 0;)s=dp(s)}return n}function so(t){return t.consumerIsAlwaysLive||t.consumers!==void 0}function hp(t){BP?.(t)}function HP(t,e){let n=e.producersTail;if(n!==void 0){let r=e.producers;do{if(r===t)return!0;if(r===n)break;r=r.nextProducer}while(r!==void 0)}return!1}function fp(t,e){return Object.is(t,e)}function zP(){throw new Error}var lw=zP;function uw(t){lw(t)}function pp(t){lw=t}var qP=null;function gp(t,e){let n=Object.create(fu);n.value=t,e!==void 0&&(n.equal=e);let r=()=>dw(n);return r[vn]=n,hp(n),[r,o=>oo(n,o),o=>mp(n,o)]}function dw(t){return Qa(t),t.value}function oo(t,e){up()||uw(t),t.equal(t.value,e)||(t.value=e,WP(t))}function mp(t,e){up()||uw(t),oo(t,e(t.value))}var fu=Ke(me({},Xa),{equal:fp,value:void 0,kind:"signal"});function WP(t){t.version++,sw(),lp(t),qP?.(t)}function Fe(t){return typeof t=="function"}function ao(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var pu=ao(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function ss(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var yt=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(Fe(r))try{r()}catch(s){e=s instanceof pu?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{hw(s)}catch(o){e=e??[],o instanceof pu?e=[...e,...o.errors]:e.push(o)}}if(e)throw new pu(e)}}add(e){var n;if(e&&e!==this)if(this.closed)hw(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ss(n,e)}remove(e){let{_finalizers:n}=this;n&&ss(n,e),e instanceof t&&e._removeParent(this)}};yt.EMPTY=(()=>{let t=new yt;return t.closed=!0,t})();var yp=yt.EMPTY;function gu(t){return t instanceof yt||t&&"closed"in t&&Fe(t.remove)&&Fe(t.add)&&Fe(t.unsubscribe)}function hw(t){Fe(t)?t():t.unsubscribe()}var tr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var co={setTimeout(t,e,...n){let{delegate:r}=co;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=co;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function mu(t){co.setTimeout(()=>{let{onUnhandledError:e}=tr;if(e)e(t);else throw t})}function os(){}var fw=vp("C",void 0,void 0);function pw(t){return vp("E",void 0,t)}function gw(t){return vp("N",t,void 0)}function vp(t,e,n){return{kind:t,value:e,error:n}}var as=null;function lo(t){if(tr.useDeprecatedSynchronousErrorHandling){let e=!as;if(e&&(as={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=as;if(as=null,n)throw r}}else t()}function mw(t){tr.useDeprecatedSynchronousErrorHandling&&as&&(as.errorThrown=!0,as.error=t)}var cs=class extends yt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,gu(e)&&e.add(this)):this.destination=YP}static create(e,n,r){return new uo(e,n,r)}next(e){this.isStopped?Ep(gw(e),this):this._next(e)}error(e){this.isStopped?Ep(pw(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ep(fw,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},GP=Function.prototype.bind;function _p(t,e){return GP.call(t,e)}var bp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){yu(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){yu(r)}else yu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){yu(n)}}},uo=class extends cs{constructor(e,n,r){super();let i;if(Fe(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&tr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&_p(e.next,s),error:e.error&&_p(e.error,s),complete:e.complete&&_p(e.complete,s)}):i=e}this.destination=new bp(i)}};function yu(t){tr.useDeprecatedSynchronousErrorHandling?mw(t):mu(t)}function KP(t){throw t}function Ep(t,e){let{onStoppedNotification:n}=tr;n&&co.setTimeout(()=>n(t,e))}var YP={closed:!0,next:os,error:KP,complete:os};var ho=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Rn(t){return t}function wp(...t){return Ip(t)}function Ip(t){return t.length===0?Rn:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var Re=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=QP(n)?n:new uo(n,r,i);return lo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=yw(r),new r((i,s)=>{let o=new uo({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[ho](){return this}pipe(...n){return Ip(n)(this)}toPromise(n){return n=yw(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function yw(t){var e;return(e=t??tr.Promise)!==null&&e!==void 0?e:Promise}function XP(t){return t&&Fe(t.next)&&Fe(t.error)&&Fe(t.complete)}function QP(t){return t&&t instanceof cs||XP(t)&&gu(t)}function Tp(t){return Fe(t?.lift)}function Ye(t){return e=>{if(Tp(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ze(t,e,n,r,i){return new Ap(t,e,n,r,i)}var Ap=class extends cs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function fo(){return Ye((t,e)=>{let n=null;t._refCount++;let r=ze(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var po=class extends Re{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Tp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new yt;let n=this.getSubject();e.add(this.source.subscribe(ze(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=yt.EMPTY)}return e}refCount(){return fo()(this)}};var vw=ao(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var bt=(()=>{class t extends Re{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new vu(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new vw}next(n){lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?yp:(this.currentObservers=null,s.push(n),new yt(()=>{this.currentObservers=null,ss(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new Re;return n.source=this,n}}return t.create=(e,n)=>new vu(e,n),t})(),vu=class extends bt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:yp}};var St=class extends bt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Sp={now(){return(Sp.delegate||Date).now()},delegate:void 0};var _u=class extends yt{constructor(e,n){super()}schedule(e,n=0){return this}};var tc={setInterval(t,e,...n){let{delegate:r}=tc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=tc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var go=class extends _u{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return tc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&tc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ss(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var mo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};mo.now=Sp.now;var yo=class extends mo{constructor(e,n=mo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Cp=new yo(go);var Eu=class extends go{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var bu=class extends yo{};var Dp=new bu(Eu);var _n=new Re(t=>t.complete());function _w(t){return t&&Fe(t.schedule)}function Ew(t){return t[t.length-1]}function wu(t){return Fe(Ew(t))?t.pop():void 0}function _i(t){return _w(Ew(t))?t.pop():void 0}function Rp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function ww(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function bw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ls(t){return this instanceof ls?(this.v=t,this):new ls(t)}function Iw(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(p){return function(m){return Promise.resolve(m).then(p,h)}}function a(p,m){r[p]&&(i[p]=function(g){return new Promise(function(v,E){s.push([p,g,v,E])>1||c(p,g)})},m&&(i[p]=m(i[p])))}function c(p,m){try{l(r[p](m))}catch(g){f(s[0][3],g)}}function l(p){p.value instanceof ls?Promise.resolve(p.value.v).then(d,h):f(s[0][2],p)}function d(p){c("next",p)}function h(p){c("throw",p)}function f(p,m){p(m),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Tw(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof bw=="function"?bw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Iu=t=>t&&typeof t.length=="number"&&typeof t!="function";function Tu(t){return Fe(t?.then)}function Au(t){return Fe(t[ho])}function Su(t){return Symbol.asyncIterator&&Fe(t?.[Symbol.asyncIterator])}function Cu(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function ZP(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Du=ZP();function Ru(t){return Fe(t?.[Du])}function Pu(t){return Iw(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield ls(n.read());if(i)return yield ls(void 0);yield yield ls(r)}}finally{n.releaseLock()}})}function xu(t){return Fe(t?.getReader)}function xt(t){if(t instanceof Re)return t;if(t!=null){if(Au(t))return JP(t);if(Iu(t))return ex(t);if(Tu(t))return tx(t);if(Su(t))return Aw(t);if(Ru(t))return nx(t);if(xu(t))return rx(t)}throw Cu(t)}function JP(t){return new Re(e=>{let n=t[ho]();if(Fe(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ex(t){return new Re(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function tx(t){return new Re(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,mu)})}function nx(t){return new Re(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function Aw(t){return new Re(e=>{ix(t,e).catch(n=>e.error(n))})}function rx(t){return Aw(Pu(t))}function ix(t,e){var n,r,i,s;return ww(this,void 0,void 0,function*(){try{for(n=Tw(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function En(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Ei(t,e=0){return Ye((n,r)=>{n.subscribe(ze(r,i=>En(r,t,()=>r.next(i),e),()=>En(r,t,()=>r.complete(),e),i=>En(r,t,()=>r.error(i),e)))})}function bi(t,e=0){return Ye((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Sw(t,e){return xt(t).pipe(bi(e),Ei(e))}function Cw(t,e){return xt(t).pipe(bi(e),Ei(e))}function Dw(t,e){return new Re(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Rw(t,e){return new Re(n=>{let r;return En(n,e,()=>{r=t[Du](),En(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>Fe(r?.return)&&r.return()})}function Mu(t,e){if(!t)throw new Error("Iterable cannot be null");return new Re(n=>{En(n,e,()=>{let r=t[Symbol.asyncIterator]();En(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function Pw(t,e){return Mu(Pu(t),e)}function xw(t,e){if(t!=null){if(Au(t))return Sw(t,e);if(Iu(t))return Dw(t,e);if(Tu(t))return Cw(t,e);if(Su(t))return Mu(t,e);if(Ru(t))return Rw(t,e);if(xu(t))return Pw(t,e)}throw Cu(t)}function lt(t,e){return e?xw(t,e):xt(t)}function Se(...t){let e=_i(t);return lt(t,e)}function jr(t,e){let n=Fe(t)?t:()=>t,r=i=>i.error(n());return new Re(e?i=>e.schedule(r,0,i):r)}function Pp(t){return!!t&&(t instanceof Re||Fe(t.lift)&&Fe(t.subscribe))}var Br=ao(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Me(t,e){return Ye((n,r)=>{let i=0;n.subscribe(ze(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:sx}=Array;function ox(t,e){return sx(e)?t(...e):t(e)}function ku(t){return Me(e=>ox(t,e))}var{isArray:ax}=Array,{getPrototypeOf:cx,prototype:lx,keys:ux}=Object;function Nu(t){if(t.length===1){let e=t[0];if(ax(e))return{args:e,keys:null};if(dx(e)){let n=ux(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function dx(t){return t&&typeof t=="object"&&cx(t)===lx}function Ou(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Fu(...t){let e=_i(t),n=wu(t),{args:r,keys:i}=Nu(t);if(r.length===0)return lt([],e);let s=new Re(hx(r,e,i?o=>Ou(i,o):Rn));return n?s.pipe(ku(n)):s}function hx(t,e,n=Rn){return r=>{Mw(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)Mw(e,()=>{let l=lt(t[c],e),d=!1;l.subscribe(ze(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function Mw(t,e,n){t?En(n,t,e):e()}function kw(t,e,n,r,i,s,o,a){let c=[],l=0,d=0,h=!1,f=()=>{h&&!c.length&&!l&&e.complete()},p=g=>l<r?m(g):c.push(g),m=g=>{s&&e.next(g),l++;let v=!1;xt(n(g,d++)).subscribe(ze(e,E=>{i?.(E),s?p(E):e.next(E)},()=>{v=!0},void 0,()=>{if(v)try{for(l--;c.length&&l<r;){let E=c.shift();o?En(e,o,()=>m(E)):m(E)}f()}catch(E){e.error(E)}}))};return t.subscribe(ze(e,p,()=>{h=!0,f()})),()=>{a?.()}}function jt(t,e,n=1/0){return Fe(e)?jt((r,i)=>Me((s,o)=>e(r,s,i,o))(xt(t(r,i))),n):(typeof e=="number"&&(n=e),Ye((r,i)=>kw(r,i,t,n)))}function Nw(t=1/0){return jt(Rn,t)}function Ow(){return Nw(1)}function vo(...t){return Ow()(lt(t,_i(t)))}function nc(t){return new Re(e=>{xt(t()).subscribe(e)})}function xp(...t){let e=wu(t),{args:n,keys:r}=Nu(t),i=new Re(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let d=0;d<o;d++){let h=!1;xt(n[d]).subscribe(ze(s,f=>{h||(h=!0,l--),a[d]=f},()=>c--,void 0,()=>{(!c||!h)&&(l||s.next(r?Ou(r,a):a),s.complete())}))}});return e?i.pipe(ku(e)):i}var $r=new Re(os);function dn(t,e){return Ye((n,r)=>{let i=0;n.subscribe(ze(r,s=>t.call(e,s,i++)&&r.next(s)))})}function hn(t){return Ye((e,n)=>{let r=null,i=!1,s;r=e.subscribe(ze(n,void 0,void 0,o=>{s=xt(t(o,hn(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function Fw(t,e,n,r,i){return(s,o)=>{let a=n,c=e,l=0;s.subscribe(ze(o,d=>{let h=l++;c=a?t(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function _o(t,e){return Fe(e)?jt(t,e,1):jt(t,1)}function wi(t){return Ye((e,n)=>{let r=!1;e.subscribe(ze(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function fn(t){return t<=0?()=>_n:Ye((e,n)=>{let r=0;e.subscribe(ze(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Lu(t=fx){return Ye((e,n)=>{let r=!1;e.subscribe(ze(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function fx(){return new Br}function rc(t){return Ye((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Hr(t,e){let n=arguments.length>=2;return r=>r.pipe(t?dn((i,s)=>t(i,s,r)):Rn,fn(1),n?wi(e):Lu(()=>new Br))}function Eo(t){return t<=0?()=>_n:Ye((e,n)=>{let r=[];e.subscribe(ze(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Mp(t,e){let n=arguments.length>=2;return r=>r.pipe(t?dn((i,s)=>t(i,s,r)):Rn,Eo(1),n?wi(e):Lu(()=>new Br))}function kp(t,e){return Ye(Fw(t,e,arguments.length>=2,!0))}function Np(...t){let e=_i(t);return Ye((n,r)=>{(e?vo(t,n,e):vo(t,n)).subscribe(r)})}function mt(t,e){return Ye((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(ze(r,c=>{i?.unsubscribe();let l=0,d=s++;xt(t(c,d)).subscribe(i=ze(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Vu(t){return Ye((e,n)=>{xt(t).subscribe(ze(n,()=>n.complete(),os)),!n.closed&&e.subscribe(n)})}function Mt(t,e,n){let r=Fe(t)||e||n?{next:t,error:e,complete:n}:t;return r?Ye((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ze(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Rn}function Lw(t){let e=je(null);try{return t()}finally{je(e)}}var wo=class{full;major;minor;patch;constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},Gp=new wo("20.3.15");var Hu="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Ee=class extends Error{code;constructor(e,n){super(Ai(e,n)),this.code=e}};function px(t){return`NG0${Math.abs(t)}`}function Ai(t,e){return`${px(t)}${e?": "+e:""}`}function it(t){for(let e in t)if(t[e]===it)return e;throw Error("")}function qr(t){if(typeof t=="string")return t;if(Array.isArray(t))return`[${t.map(qr).join(", ")}]`;if(t==null)return""+t;let e=t.overriddenName||t.name;if(e)return`${e}`;let n=t.toString();if(n==null)return""+n;let r=n.indexOf(`
`);return r>=0?n.slice(0,r):n}function Kp(t,e){return t?e?`${t} ${e}`:t:e||""}var gx=it({__forward_ref__:it});function zu(t){return t.__forward_ref__=zu,t.toString=function(){return qr(this())},t}function bn(t){return Yp(t)?t():t}function Yp(t){return typeof t=="function"&&t.hasOwnProperty(gx)&&t.__forward_ref__===zu}function we(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ps(t){return{providers:t.providers||[],imports:t.imports||[]}}function ac(t){return mx(t,qu)}function Xp(t){return ac(t)!==null}function mx(t,e){return t.hasOwnProperty(e)&&t[e]||null}function yx(t){let e=t?.[qu]??null;return e||null}function Fp(t){return t&&t.hasOwnProperty(ju)?t[ju]:null}var qu=it({\u0275prov:it}),ju=it({\u0275inj:it}),Te=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,n){this._desc=e,this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=we({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Qp(t){return t&&!!t.\u0275providers}var Zp=it({\u0275cmp:it}),Jp=it({\u0275dir:it}),eg=it({\u0275pipe:it}),tg=it({\u0275mod:it}),sc=it({\u0275fac:it}),gs=it({__NG_ELEMENT_ID__:it}),Uw=it({__NG_ENV_ID__:it});function Io(t){return typeof t=="string"?t:t==null?"":String(t)}function Bw(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Io(t)}var $w=it({ngErrorCode:it}),vx=it({ngErrorMessage:it}),_x=it({ngTokenPath:it});function ng(t,e){return Hw("",-200,e)}function Wu(t,e){throw new Ee(-201,!1)}function Hw(t,e,n){let r=new Ee(e,t);return r[$w]=e,r[vx]=t,n&&(r[_x]=n),r}function Ex(t){return t[$w]}var Lp;function zw(){return Lp}function Pn(t){let e=Lp;return Lp=t,e}function rg(t,e,n){let r=ac(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&8)return null;if(e!==void 0)return e;Wu(t,"Injector")}var bx={},us=bx,Vp="__NG_DI_FLAG__",Up=class{injector;constructor(e){this.injector=e}retrieve(e,n){let r=ds(n)||0;try{return this.injector.get(e,r&8?null:us,r)}catch(i){if(io(i))return i;throw i}}};function wx(t,e=0){let n=cu();if(n===void 0)throw new Ee(-203,!1);if(n===null)return rg(t,void 0,e);{let r=Ix(e),i=n.retrieve(t,r);if(io(i)){if(r.optional)return null;throw i}return i}}function Pe(t,e=0){return(zw()||wx)(bn(t),e)}function he(t,e){return Pe(t,ds(e))}function ds(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Ix(t){return{optional:!!(t&8),host:!!(t&1),self:!!(t&2),skipSelf:!!(t&4)}}function jp(t){let e=[];for(let n=0;n<t.length;n++){let r=bn(t[n]);if(Array.isArray(r)){if(r.length===0)throw new Ee(900,!1);let i,s=0;for(let o=0;o<r.length;o++){let a=r[o],c=Tx(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(Pe(i,s))}else e.push(Pe(r))}return e}function qw(t,e){return t[Vp]=e,t.prototype[Vp]=e,t}function Tx(t){return t[Vp]}function hs(t,e){let n=t.hasOwnProperty(sc);return n?t[sc]:null}function Ww(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}function Gw(t){return t.flat(Number.POSITIVE_INFINITY)}function Gu(t,e){t.forEach(n=>Array.isArray(n)?Gu(n,e):e(n))}function ig(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function cc(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Kw(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function Yw(t,e,n){let r=To(t,e);return r>=0?t[r|1]=n:(r=~r,Kw(t,r,e,n)),r}function Ku(t,e){let n=To(t,e);if(n>=0)return t[n|1]}function To(t,e){return Ax(t,e,1)}function Ax(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var ms={},Un=[],Si=new Te(""),sg=new Te("",-1),og=new Te(""),oc=class{get(e,n=us){if(n===us){let i=Hw("",-201);throw i.name="\u0275NotFound",i}return n}};function ag(t){return t[tg]||null}function Ci(t){return t[Zp]||null}function cg(t){return t[Jp]||null}function Xw(t){return t[eg]||null}function wn(t){return{\u0275providers:t}}function Qw(...t){return{\u0275providers:lg(!0,t),\u0275fromNgModule:!0}}function lg(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Gu(e,o=>{let a=o;Bu(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&Zw(i,s),n}function Zw(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];ug(i,s=>{e(s,r)})}}function Bu(t,e,n,r){if(t=bn(t),!t)return!1;let i=null,s=Fp(t),o=!s&&Ci(t);if(!s&&!o){let c=t.ngModule;if(s=Fp(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Bu(l,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Gu(s.imports,d=>{Bu(d,e,n,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&Zw(l,e)}if(!a){let l=hs(i)||(()=>new i);e({provide:i,useFactory:l,deps:Un},i),e({provide:og,useValue:i,multi:!0},i),e({provide:Si,useValue:()=>Pe(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=t;ug(c,d=>{e(d,l)})}}else return!1;return i!==t&&t.providers!==void 0}function ug(t,e){for(let n of t)Qp(n)&&(n=n.\u0275providers),Array.isArray(n)?ug(n,e):e(n)}var Sx=it({provide:String,useValue:it});function Jw(t){return t!==null&&typeof t=="object"&&Sx in t}function Cx(t){return!!(t&&t.useExisting)}function Dx(t){return!!(t&&t.useFactory)}function $u(t){return typeof t=="function"}var lc=new Te(""),Uu={},jw={},Op;function uc(){return Op===void 0&&(Op=new oc),Op}var Bt=class{},fs=class extends Bt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,$p(e,o=>this.processProvider(o)),this.records.set(sg,bo(void 0,this)),i.has("environment")&&this.records.set(Bt,bo(void 0,this));let s=this.records.get(lc);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(og,Un,{self:!0}))}retrieve(e,n){let r=ds(n)||0;try{return this.get(e,us,r)}catch(i){if(io(i))return i;throw i}}destroy(){ic(this),this._destroyed=!0;let e=je(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),je(e)}}onDestroy(e){return ic(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){ic(this);let n=pr(this),r=Pn(void 0),i;try{return e()}finally{pr(n),Pn(r)}}get(e,n=us,r){if(ic(this),e.hasOwnProperty(Uw))return e[Uw](this);let i=ds(r),s,o=pr(this),a=Pn(void 0);try{if(!(i&4)){let l=this.records.get(e);if(l===void 0){let d=kx(e)&&ac(e);d&&this.injectableDefInScope(d)?l=bo(Bp(e),Uu):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,i)}let c=i&2?uc():this.parent;return n=i&8&&n===us?null:n,c.get(e,n)}catch(c){let l=Ex(c);throw l===-200||l===-201?new Ee(l,null):c}finally{Pn(a),pr(o)}}resolveInjectorInitializers(){let e=je(null),n=pr(this),r=Pn(void 0),i;try{let s=this.get(Si,Un,{self:!0});for(let o of s)o()}finally{pr(n),Pn(r),je(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(qr(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=bn(e);let n=$u(e)?e:bn(e&&e.provide),r=Px(e);if(!$u(e)&&e.multi===!0){let i=this.records.get(n);i||(i=bo(void 0,Uu,!0),i.factory=()=>jp(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n,r){let i=je(null);try{if(n.value===jw)throw ng(qr(e));return n.value===Uu&&(n.value=jw,n.value=n.factory(void 0,r)),typeof n.value=="object"&&n.value&&Mx(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{je(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=bn(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Bp(t){let e=ac(t),n=e!==null?e.factory:hs(t);if(n!==null)return n;if(t instanceof Te)throw new Ee(204,!1);if(t instanceof Function)return Rx(t);throw new Ee(204,!1)}function Rx(t){if(t.length>0)throw new Ee(204,!1);let n=yx(t);return n!==null?()=>n.factory(t):()=>new t}function Px(t){if(Jw(t))return bo(void 0,t.useValue);{let e=eI(t);return bo(e,Uu)}}function eI(t,e,n){let r;if($u(t)){let i=bn(t);return hs(i)||Bp(i)}else if(Jw(t))r=()=>bn(t.useValue);else if(Dx(t))r=()=>t.useFactory(...jp(t.deps||[]));else if(Cx(t))r=(i,s)=>Pe(bn(t.useExisting),s!==void 0&&s&8?8:void 0);else{let i=bn(t&&(t.useClass||t.provide));if(xx(t))r=()=>new i(...jp(t.deps));else return hs(i)||Bp(i)}return r}function ic(t){if(t.destroyed)throw new Ee(205,!1)}function bo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function xx(t){return!!t.deps}function Mx(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function kx(t){return typeof t=="function"||typeof t=="object"&&t.ngMetadataName==="InjectionToken"}function $p(t,e){for(let n of t)Array.isArray(n)?$p(n,e):n&&Qp(n)?$p(n.\u0275providers,e):e(n)}function $t(t,e){let n;t instanceof fs?(ic(t),n=t):n=new Up(t);let r,i=pr(n),s=Pn(void 0);try{return e()}finally{pr(i),Pn(s)}}function tI(){return zw()!==void 0||cu()!=null}var nr=0,ke=1,Ne=2,Yt=3,jn=4,Bn=5,dc=6,Ao=7,cn=8,Di=9,mr=10,Ht=11,So=12,dg=13,ys=14,$n=15,Ri=16,vs=17,yr=18,hc=19,hg=20,zr=21,Yu=22,fc=23,xn=24,Xu=25,pc=26,In=27,nI=1;var Pi=7,gc=8,_s=9,pn=10;function Wr(t){return Array.isArray(t)&&typeof t[nI]=="object"}function rr(t){return Array.isArray(t)&&t[nI]===!0}function fg(t){return(t.flags&4)!==0}function xi(t){return t.componentOffset>-1}function Co(t){return(t.flags&1)===1}function Es(t){return!!t.template}function Do(t){return(t[Ne]&512)!==0}function bs(t){return(t[Ne]&256)===256}var rI="svg",iI="math";function Hn(t){for(;Array.isArray(t);)t=t[nr];return t}function pg(t,e){return Hn(e[t])}function vr(t,e){return Hn(e[t.index])}function Qu(t,e){return t.data[e]}function ir(t,e){let n=e[t];return Wr(n)?n:n[nr]}function sI(t){return(t[Ne]&4)===4}function Zu(t){return(t[Ne]&128)===128}function oI(t){return rr(t[Yt])}function mc(t,e){return e==null?null:t[e]}function gg(t){t[vs]=0}function mg(t){t[Ne]&1024||(t[Ne]|=1024,Zu(t)&&vc(t))}function aI(t,e){for(;t>0;)e=e[ys],t--;return e}function yc(t){return!!(t[Ne]&9216||t[xn]?.dirty)}function Ju(t){t[mr].changeDetectionScheduler?.notify(8),t[Ne]&64&&(t[Ne]|=1024),yc(t)&&vc(t)}function vc(t){t[mr].changeDetectionScheduler?.notify(0);let e=Ii(t);for(;e!==null&&!(e[Ne]&8192||(e[Ne]|=8192,!Zu(e)));)e=Ii(e)}function yg(t,e){if(bs(t))throw new Ee(911,!1);t[zr]===null&&(t[zr]=[]),t[zr].push(e)}function cI(t,e){if(t[zr]===null)return;let n=t[zr].indexOf(e);n!==-1&&t[zr].splice(n,1)}function Ii(t){let e=t[Yt];return rr(e)?e[Yt]:e}function vg(t){return t[Ao]??=[]}function _g(t){return t.cleanup??=[]}function lI(t,e,n,r){let i=vg(e);i.push(n),t.firstCreatePass&&_g(t).push(r,i.length-1)}var $e={lFrame:AI(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Hp=!1;function uI(){return $e.lFrame.elementDepthCount}function dI(){$e.lFrame.elementDepthCount++}function hI(){$e.lFrame.elementDepthCount--}function ed(){return $e.bindingsEnabled}function fI(){return $e.skipHydrationRootTNode!==null}function pI(t){return $e.skipHydrationRootTNode===t}function gI(){$e.skipHydrationRootTNode=null}function ft(){return $e.lFrame.lView}function sr(){return $e.lFrame.tView}function zt(t){return $e.lFrame.contextLView=t,t[cn]}function qt(t){return $e.lFrame.contextLView=null,t}function zn(){let t=Eg();for(;t!==null&&t.type===64;)t=t.parent;return t}function Eg(){return $e.lFrame.currentTNode}function mI(){let t=$e.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Ro(t,e){let n=$e.lFrame;n.currentTNode=t,n.isParent=e}function bg(){return $e.lFrame.isParent}function yI(){$e.lFrame.isParent=!1}function wg(){return Hp}function Ig(t){let e=Hp;return Hp=t,e}function vI(){return $e.lFrame.bindingIndex}function _I(t){return $e.lFrame.bindingIndex=t}function Tg(){return $e.lFrame.bindingIndex++}function Ag(t){let e=$e.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function EI(){return $e.lFrame.inI18n}function bI(t,e){let n=$e.lFrame;n.bindingIndex=n.bindingRootIndex=t,td(e)}function wI(){return $e.lFrame.currentDirectiveIndex}function td(t){$e.lFrame.currentDirectiveIndex=t}function II(t){let e=$e.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function Sg(){return $e.lFrame.currentQueryIndex}function nd(t){$e.lFrame.currentQueryIndex=t}function Nx(t){let e=t[ke];return e.type===2?e.declTNode:e.type===1?t[Bn]:null}function Cg(t,e,n){if(n&4){let i=e,s=t;for(;i=i.parent,i===null&&!(n&1);)if(i=Nx(s),i===null||(s=s[ys],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=$e.lFrame=TI();return r.currentTNode=e,r.lView=t,!0}function rd(t){let e=TI(),n=t[ke];$e.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function TI(){let t=$e.lFrame,e=t===null?null:t.child;return e===null?AI(t):e}function AI(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function SI(){let t=$e.lFrame;return $e.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var Dg=SI;function id(){let t=SI();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function CI(t){return($e.lFrame.contextLView=aI(t,$e.lFrame.contextLView))[cn]}function Mi(){return $e.lFrame.selectedIndex}function ki(t){$e.lFrame.selectedIndex=t}function DI(){let t=$e.lFrame;return Qu(t.tView,t.selectedIndex)}function RI(){return $e.lFrame.currentNamespace}var PI=!0;function sd(){return PI}function _c(t){PI=t}function zp(t,e=null,n=null,r){let i=Rg(t,e,n,r);return i.resolveInjectorInitializers(),i}function Rg(t,e=null,n=null,r,i=new Set){let s=[n||Un,Qw(t)];return r=r||(typeof t=="object"?void 0:qr(t)),new fs(s,e||uc(),r||null,i)}var kt=class t{static THROW_IF_NOT_FOUND=us;static NULL=new oc;static create(e,n){if(Array.isArray(e))return zp({name:""},n,e,"");{let r=e.name??"";return zp({name:r},e.parent,e.providers,r)}}static \u0275prov=we({token:t,providedIn:"any",factory:()=>Pe(sg)});static __NG_ELEMENT_ID__=-1},en=new Te(""),ws=(()=>{class t{static __NG_ELEMENT_ID__=Ox;static __NG_ENV_ID__=n=>n}return t})(),qp=class extends ws{_lView;constructor(e){super(),this._lView=e}get destroyed(){return bs(this._lView)}onDestroy(e){let n=this._lView;return yg(n,e),()=>cI(n,e)}};function Ox(){return new qp(ft())}var gr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},Mn=new Te("",{providedIn:"root",factory:()=>{let t=he(Bt),e;return n=>{t.destroyed&&!e?setTimeout(()=>{throw n}):(e??=t.get(gr),e.handleError(n))}}}),xI={provide:Si,useValue:()=>void he(gr),multi:!0};function Po(t,e){let[n,r,i]=gp(t,e?.equal),s=n,o=s[vn];return s.set=r,s.update=i,s.asReadonly=MI.bind(s),s}function MI(){let t=this[vn];if(t.readonlyFn===void 0){let e=()=>this();e[vn]=t,t.readonlyFn=e}return t.readonlyFn}var Ti=class{},Ec=new Te("",{providedIn:"root",factory:()=>!1});var Pg=new Te(""),xg=new Te(""),_r=(()=>{class t{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new St(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Re(n=>{n.next(!1),n.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=we({token:t,providedIn:"root",factory:()=>new t})}return t})(),xo=(()=>{class t{internalPendingTasks=he(_r);scheduler=he(Ti);errorHandler=he(Mn);add(){let n=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(n)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(n))}}run(n){let r=this.add();n().catch(this.errorHandler).finally(r)}static \u0275prov=we({token:t,providedIn:"root",factory:()=>new t})}return t})();function bc(...t){}var Mg=(()=>{class t{static \u0275prov=we({token:t,providedIn:"root",factory:()=>new Wp})}return t})(),Wp=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let n=e.zone,r=this.queues.get(n);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let n=e.zone;this.queues.has(n)||this.queues.set(n,new Set);let r=this.queues.get(n);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[n,r]of this.queues)n===null?e||=this.flushQueue(r):e||=n.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let n=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,n=!0,r.run());return n}};function Vo(t){return{toString:t}.toString()}var od="__parameters__";function Wx(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function Gx(t,e,n){return Vo(()=>{let r=Wx(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(od)?c[od]:Object.defineProperty(c,od,{value:[]})[od];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var Tn=qw(Gx("Optional"),8);function Kx(t){return typeof t=="function"}var hd=class{previousValue;currentValue;firstChange;constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function dT(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}var Cd=(()=>{let t=()=>hT;return t.ngInherit=!0,t})();function hT(t){return t.type.prototype.ngOnChanges&&(t.setInput=Xx),Yx}function Yx(){let t=pT(this),e=t?.current;if(e){let n=t.previous;if(n===ms)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function Xx(t,e,n,r,i){let s=this.declaredInputs[r],o=pT(t)||Qx(t,{previous:ms,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new hd(l&&l.currentValue,n,c===ms),dT(t,e,i,n)}var fT="__ngSimpleChanges__";function pT(t){return t[fT]||null}function Qx(t,e){return t[fT]=e}var kI=[];var ut=function(t,e=null,n){for(let r=0;r<kI.length;r++){let i=kI[r];i(t,e,n)}};function Zx(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=hT(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function gT(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),d!=null&&(t.destroyHooks??=[]).push(n,d)}}function cd(t,e,n){mT(t,e,3,n)}function ld(t,e,n,r){(t[Ne]&3)===n&&mT(t,e,n,r)}function kg(t,e){let n=t[Ne];(n&3)===e&&(n&=16383,n+=1,t[Ne]=n)}function mT(t,e,n,r){let i=r!==void 0?t[vs]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[vs]+=65536),(a<s||s==-1)&&(Jx(t,n,e,c),t[vs]=(t[vs]&4294901760)+c+2),c++}function NI(t,e){ut(4,t,e);let n=je(null);try{e.call(t)}finally{je(n),ut(5,t,e)}}function Jx(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[Ne]>>14<t[vs]>>16&&(t[Ne]&3)===e&&(t[Ne]+=16384,NI(a,s)):NI(a,s)}var ko=-1,Tc=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,n,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=n,this.injectImpl=r}};function eM(t){return(t.flags&8)!==0}function tM(t){return(t.flags&16)!==0}function nM(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];iM(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function rM(t){return t===3||t===4||t===6}function iM(t){return t.charCodeAt(0)===64}function cm(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?OI(t,n,i,null,e[++r]):OI(t,n,i,null,null))}}return t}function OI(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){i!==null&&(t[s+1]=i);return}s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),i!==null&&t.splice(s++,0,i)}function yT(t){return t!==ko}function fd(t){return t&32767}function sM(t){return t>>16}function pd(t,e){let n=sM(t),r=e;for(;n>0;)r=r[ys],n--;return r}var jg=!0;function FI(t){let e=jg;return jg=t,e}var oM=256,vT=oM-1,_T=5,aM=0,Er={};function cM(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(gs)&&(r=n[gs]),r==null&&(r=n[gs]=aM++);let i=r&vT,s=1<<i;e.data[t+(i>>_T)]|=s}function ET(t,e){let n=bT(t,e);if(n!==-1)return n;let r=e[ke];r.firstCreatePass&&(t.injectorIndex=e.length,Ng(r.data,t),Ng(e,null),Ng(r.blueprint,null));let i=lm(t,e),s=t.injectorIndex;if(yT(i)){let o=fd(i),a=pd(i,e),c=a[ke].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Ng(t,e){t.push(0,0,0,0,0,0,0,0,e)}function bT(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function lm(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=ST(i),r===null)return ko;if(n++,i=i[ys],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return ko}function lM(t,e,n){cM(t,e,n)}function wT(t,e,n){if(n&8||t!==void 0)return t;Wu(e,"NodeInjector")}function IT(t,e,n,r){if(n&8&&r===void 0&&(r=null),(n&3)===0){let i=t[Di],s=Pn(void 0);try{return i?i.get(e,r,n&8):rg(e,r,n&8)}finally{Pn(s)}}return wT(r,e,n)}function TT(t,e,n,r=0,i){if(t!==null){if(e[Ne]&2048&&!(r&2)){let o=fM(t,e,n,r,Er);if(o!==Er)return o}let s=AT(t,e,n,r,Er);if(s!==Er)return s}return IT(e,n,r,i)}function AT(t,e,n,r,i){let s=dM(n);if(typeof s=="function"){if(!Cg(e,t,r))return r&1?wT(i,n,r):IT(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&8))Wu(n);else return o}finally{Dg()}}else if(typeof s=="number"){let o=null,a=bT(t,e),c=ko,l=r&1?e[$n][Bn]:null;for((a===-1||r&4)&&(c=a===-1?lm(t,e):e[a+8],c===ko||!VI(r,!1)?a=-1:(o=e[ke],a=fd(c),e=pd(c,e)));a!==-1;){let d=e[ke];if(LI(s,a,d.data)){let h=uM(a,e,n,o,r,l);if(h!==Er)return h}c=e[a+8],c!==ko&&VI(r,e[ke].data[a+8]===l)&&LI(s,a,e)?(o=d,a=fd(c),e=pd(c,e)):a=-1}}return i}function uM(t,e,n,r,i,s){let o=e[ke],a=o.data[t+8],c=r==null?xi(a)&&jg:r!=o&&(a.type&3)!==0,l=i&1&&s===a,d=ud(a,o,n,c,l);return d!==null?gd(e,o,d,a,i):Er}function ud(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,l=t.directiveEnd,d=s>>20,h=r?a:a+d,f=i?a+d:l;for(let p=h;p<f;p++){let m=o[p];if(p<c&&n===m||p>=c&&m.type===n)return p}if(i){let p=o[c];if(p&&Es(p)&&p.type===n)return c}return null}function gd(t,e,n,r,i){let s=t[n],o=e.data;if(s instanceof Tc){let a=s;if(a.resolving){let p=Bw(o[n]);throw ng(p)}let c=FI(a.canSeeViewProviders);a.resolving=!0;let l=o[n].type||o[n],d,h=a.injectImpl?Pn(a.injectImpl):null,f=Cg(t,r,0);try{s=t[n]=a.factory(void 0,i,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&Zx(n,o[n],e)}finally{h!==null&&Pn(h),FI(c),a.resolving=!1,Dg()}}return s}function dM(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(gs)?t[gs]:void 0;return typeof e=="number"?e>=0?e&vT:hM:e}function LI(t,e,n){let r=1<<t;return!!(n[e+(t>>_T)]&r)}function VI(t,e){return!(t&2)&&!(t&1&&e)}var Is=class{_tNode;_lView;constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return TT(this._tNode,this._lView,e,ds(r),n)}};function hM(){return new Is(zn(),ft())}function Dd(t){return Vo(()=>{let e=t.prototype.constructor,n=e[sc]||Bg(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[sc]||Bg(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Bg(t){return Yp(t)?()=>{let e=Bg(bn(t));return e&&e()}:hs(t)}function fM(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[Ne]&2048&&!Do(o);){let a=AT(s,o,n,r|2,Er);if(a!==Er)return a;let c=s.parent;if(!c){let l=o[hg];if(l){let d=l.get(n,Er,r);if(d!==Er)return d}c=ST(o),o=o[ys]}s=c}return i}function ST(t){let e=t[ke],n=e.type;return n===2?e.declTNode:n===1?t[Bn]:null}function pM(){return Uo(zn(),ft())}function Uo(t,e){return new jo(vr(t,e))}var jo=(()=>{class t{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=pM}return t})();function gM(t){return t instanceof jo?t.nativeElement:t}function mM(){return this._results[Symbol.iterator]()}var md=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new bt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;let r=Gw(e);(this._changesDetected=!Ww(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=mM};function CT(t){return(t.flags&128)===128}var um=(function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t})(um||{}),DT=new Map,yM=0;function vM(){return yM++}function _M(t){DT.set(t[hc],t)}function $g(t){DT.delete(t[hc])}var UI="__ngContext__";function No(t,e){Wr(e)?(t[UI]=e[hc],_M(e)):t[UI]=e}function RT(t){return xT(t[So])}function PT(t){return xT(t[jn])}function xT(t){for(;t!==null&&!rr(t);)t=t[jn];return t}var Hg;function dm(t){Hg=t}function MT(){if(Hg!==void 0)return Hg;if(typeof document<"u")return document;throw new Ee(210,!1)}var Rd=new Te("",{providedIn:"root",factory:()=>EM}),EM="ng",Pd=new Te(""),Cs=new Te("",{providedIn:"platform",factory:()=>"unknown"});var xd=new Te("",{providedIn:"root",factory:()=>MT().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var bM="h",wM="b";var kT=!1,NT=new Te("",{providedIn:"root",factory:()=>kT});var IM=(t,e,n,r)=>{};function TM(t,e,n,r){IM(t,e,n,r)}function hm(t){return(t.flags&32)===32}var AM=()=>null;function OT(t,e,n=!1){return AM(t,e,n)}function FT(t,e){let n=t.contentQueries;if(n!==null){let r=je(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];nd(s),a.contentQueries(2,e[o],o)}}}finally{je(r)}}}function zg(t,e,n){nd(0);let r=je(null);try{e(t,n)}finally{je(r)}}function fm(t,e,n){if(fg(e)){let r=je(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{je(r)}}}var Gr=(function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t})(Gr||{});var yd=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Hu})`}};function pm(t){return t instanceof yd?t.changingThisBreaksApplicationSecurity:t}function LT(t,e){let n=VT(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${Hu})`)}return n===e}function VT(t){return t instanceof yd&&t.getTypeName()||null}var SM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function UT(t){return t=String(t),t.match(SM)?t:"unsafe:"+t}var CM=/^>|^->|<!--|-->|--!>|<!-$/g,DM=/(<|>)/g,RM="\u200B$1\u200B";function PM(t){return t.replace(CM,e=>e.replace(DM,RM))}function xM(t,e){return t.createText(e)}function MM(t,e,n){t.setValue(e,n)}function kM(t,e){return t.createComment(PM(e))}function jT(t,e,n){return t.createElement(e,n)}function vd(t,e,n,r,i){t.insertBefore(e,n,r,i)}function BT(t,e,n){t.appendChild(e,n)}function jI(t,e,n,r,i){r!==null?vd(t,e,n,r,i):BT(t,e,n)}function NM(t,e,n,r){t.removeChild(null,e,n,r)}function OM(t,e,n){t.setAttribute(e,"style",n)}function FM(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function $T(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&nM(t,e,r),i!==null&&FM(t,e,i),s!==null&&OM(t,e,s)}var gm=(function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t})(gm||{});function mm(t){let e=LM();return e?e.sanitize(gm.URL,t)||"":LT(t,"URL")?pm(t):UT(Io(t))}function LM(){let t=ft();return t&&t[mr].sanitizer}function HT(t){return t instanceof Function?t():t}function VM(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}var zT="ng-template";function UM(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&VM(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(ym(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function ym(t){return t.type===4&&t.value!==zT}function jM(t,e,n){let r=t.type===4&&!n?zT:t.value;return e===r}function BM(t,e,n){let r=4,i=t.attrs,s=i!==null?zM(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!or(r)&&!or(c))return!1;if(o&&or(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!jM(t,c,n)||c===""&&e.length===1){if(or(r))return!1;o=!0}}else if(r&8){if(i===null||!UM(t,i,c,n)){if(or(r))return!1;o=!0}}else{let l=e[++a],d=$M(c,i,ym(t),n);if(d===-1){if(or(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(or(r))return!1;o=!0}}}}return or(r)||o}function or(t){return(t&1)===0}function $M(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return qM(e,t)}function HM(t,e,n=!1){for(let r=0;r<e.length;r++)if(BM(t,e[r],n))return!0;return!1}function zM(t){for(let e=0;e<t.length;e++){let n=t[e];if(rM(n))return e}return t.length}function qM(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function BI(t,e){return t?":not("+e.trim()+")":e}function WM(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!or(o)&&(e+=BI(s,i),i=""),r=o,s=s||!or(r);n++}return i!==""&&(e+=BI(s,i)),e}function GM(t){return t.map(WM).join(",")}function KM(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!or(i))break;i=s}r++}return n.length&&e.push(1,...n),e}var wr={};function vm(t,e,n,r,i,s,o,a,c,l,d){let h=In+r,f=h+i,p=YM(h,f),m=typeof l=="function"?l():l;return p[ke]={type:t,blueprint:p,template:n,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:m,incompleteFirstPass:!1,ssrId:d}}function YM(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:wr);return n}function XM(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=vm(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function _m(t,e,n,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[nr]=i,h[Ne]=r|4|128|8|64|1024,(l!==null||t&&t[Ne]&2048)&&(h[Ne]|=2048),gg(h),h[Yt]=h[ys]=t,h[cn]=n,h[mr]=o||t&&t[mr],h[Ht]=a||t&&t[Ht],h[Di]=c||t&&t[Di]||null,h[Bn]=s,h[hc]=vM(),h[dc]=d,h[hg]=l,h[$n]=e.type==2?t[$n]:h,h}function QM(t,e,n){let r=vr(e,t),i=XM(n),s=t[mr].rendererFactory,o=Em(t,_m(t,i,null,qT(n),r,e,null,s.createRenderer(r,n),null,null,null));return t[e.index]=o}function qT(t){let e=16;return t.signals?e=4096:t.onPush&&(e=64),e}function WT(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Em(t,e){return t[So]?t[dg][jn]=e:t[So]=e,t[dg]=e,e}function Xe(t=1){GT(sr(),ft(),Mi()+t,!1)}function GT(t,e,n,r){if(!r)if((e[Ne]&3)===3){let s=t.preOrderCheckHooks;s!==null&&cd(e,s,n)}else{let s=t.preOrderHooks;s!==null&&ld(e,s,0,n)}ki(n)}var Md=(function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t})(Md||{});function qg(t,e,n,r){let i=je(null);try{let[s,o,a]=t.inputs[n],c=null;(o&Md.SignalBased)!==0&&(c=e[s][vn]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),t.setInput!==null?t.setInput(e,c,r,n,s):dT(e,c,s,r)}finally{je(i)}}var br=(function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t})(br||{}),ZM;function bm(t,e){return ZM(t,e)}var Oo=new Set,wm=(function(t){return t[t.CHANGE_DETECTION=0]="CHANGE_DETECTION",t[t.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",t})(wm||{}),Rc=new Te(""),$I=new Set;function kd(t){$I.has(t)||($I.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var KT=!1,Wg=class extends bt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,tI()&&(this.destroyRef=he(ws,{optional:!0})??void 0,this.pendingTasks=he(_r,{optional:!0})??void 0)}emit(e){let n=je(null);try{super.next(e)}finally{je(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof yt&&e.add(a),a}wrapInTimeout(e){return n=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(n)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},gn=Wg;function YT(t){let e,n;function r(){t=bc;try{n!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(n),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{t(),r()}),typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(()=>{t(),r()})),()=>r()}function HI(t){return queueMicrotask(()=>t()),()=>{t=bc}}var Im="isAngularZone",_d=Im+"_ID",JM=0,nt=class t{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new gn(!1);onMicrotaskEmpty=new gn(!1);onStable=new gn(!1);onError=new gn(!1);constructor(e){let{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=KT}=e;if(typeof Zone>"u")throw new Ee(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,nk(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Im)===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new Ee(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new Ee(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,ek,bc,bc);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},ek={};function Tm(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function tk(t){if(t.isCheckStableRunning||t.callbackScheduled)return;t.callbackScheduled=!0;function e(){YT(()=>{t.callbackScheduled=!1,Gg(t),t.isCheckStableRunning=!0,Tm(t),t.isCheckStableRunning=!1})}t.scheduleInRootZone?Zone.root.run(()=>{e()}):t._outer.run(()=>{e()}),Gg(t)}function nk(t){let e=()=>{tk(t)},n=JM++;t._inner=t._inner.fork({name:"angular",properties:{[Im]:!0,[_d]:n,[_d+n]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(rk(c))return r.invokeTask(s,o,a,c);try{return zI(t),r.invokeTask(s,o,a,c)}finally{(t.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),qI(t)}},onInvoke:(r,i,s,o,a,c,l)=>{try{return zI(t),r.invoke(s,o,a,c,l)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!ik(c)&&e(),qI(t)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(t._hasPendingMicrotasks=o.microTask,Gg(t),Tm(t)):o.change=="macroTask"&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}function Gg(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.callbackScheduled===!0?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function zI(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function qI(t){t._nesting--,Tm(t)}var Ed=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new gn;onMicrotaskEmpty=new gn;onStable=new gn;onError=new gn;run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function rk(t){return XT(t,"__ignore_ng_zone__")}function ik(t){return XT(t,"__scheduler_tick__")}function XT(t,e){return!Array.isArray(t)||t.length!==1?!1:t[0]?.data?.[e]===!0}var QT=(()=>{class t{impl=null;execute(){this.impl?.execute()}static \u0275prov=we({token:t,providedIn:"root",factory:()=>new t})}return t})();var sk=new Te("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function ZT(t,e,n){let r=t.get(sk);if(Array.isArray(e))for(let i of e)r.queue.add(i),n?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),n?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(t)}function ok(t,e){for(let[n,r]of e)ZT(t,r.animateFns)}function WI(t,e,n,r){let i=t?.[pc]?.enter;e!==null&&i&&i.has(n.index)&&ok(r,i)}function Mo(t,e,n,r,i,s,o,a){if(i!=null){let c,l=!1;rr(i)?c=i:Wr(i)&&(l=!0,i=i[nr]);let d=Hn(i);t===0&&r!==null?(WI(a,r,s,n),o==null?BT(e,r,d):vd(e,r,d,o||null,!0)):t===1&&r!==null?(WI(a,r,s,n),vd(e,r,d,o||null,!0)):t===2?GI(a,s,n,h=>{NM(e,d,l,h)}):t===3&&GI(a,s,n,()=>{e.destroyNode(d)}),c!=null&&_k(e,t,n,c,s,r,o)}}function ak(t,e){JT(t,e),e[nr]=null,e[Bn]=null}function ck(t,e,n,r,i,s){r[nr]=i,r[Bn]=e,Nd(t,r,n,1,i,s)}function JT(t,e){e[mr].changeDetectionScheduler?.notify(9),Nd(t,e,e[Ht],2,null,null)}function lk(t){let e=t[So];if(!e)return Og(t[ke],t);for(;e;){let n=null;if(Wr(e))n=e[So];else{let r=e[pn];r&&(n=r)}if(!n){for(;e&&!e[jn]&&e!==t;)Wr(e)&&Og(e[ke],e),e=e[Yt];e===null&&(e=t),Wr(e)&&Og(e[ke],e),n=e&&e[jn]}e=n}}function Am(t,e){let n=t[_s],r=n.indexOf(e);n.splice(r,1)}function e0(t,e){if(bs(e))return;let n=e[Ht];n.destroyNode&&Nd(t,e,n,3,null,null),lk(e)}function Og(t,e){if(bs(e))return;let n=je(null);try{e[Ne]&=-129,e[Ne]|=256,e[xn]&&ec(e[xn]),hk(t,e),dk(t,e),e[ke].type===1&&e[Ht].destroy();let r=e[Ri];if(r!==null&&rr(e[Yt])){r!==e[Yt]&&Am(r,e);let i=e[yr];i!==null&&i.detachView(t)}$g(e)}finally{je(n)}}function GI(t,e,n,r){let i=t?.[pc];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);t&&Oo.add(t),ZT(n,()=>{if(i.leave&&i.leave.has(e.index)){let o=i.leave.get(e.index),a=[];if(o){for(let c=0;c<o.animateFns.length;c++){let l=o.animateFns[c],{promise:d}=l();a.push(d)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(a),uk(t,r)}else t&&Oo.delete(t),r(!1)},i)}function uk(t,e){let n=t[pc]?.running;if(n){n.then(()=>{t[pc].running=void 0,Oo.delete(t),e(!0)});return}e(!1)}function dk(t,e){let n=t.cleanup,r=e[Ao];if(n!==null)for(let o=0;o<n.length-1;o+=2)if(typeof n[o]=="string"){let a=n[o+3];a>=0?r[a]():r[-a].unsubscribe(),o+=2}else{let a=r[n[o+1]];n[o].call(a)}r!==null&&(e[Ao]=null);let i=e[zr];if(i!==null){e[zr]=null;for(let o=0;o<i.length;o++){let a=i[o];a()}}let s=e[fc];if(s!==null){e[fc]=null;for(let o of s)o.destroy()}}function hk(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Tc)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];ut(4,a,c);try{c.call(a)}finally{ut(5,a,c)}}else{ut(4,i,s);try{s.call(i)}finally{ut(5,i,s)}}}}}function fk(t,e,n){return pk(t,e.parent,n)}function pk(t,e,n){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return n[nr];if(xi(r)){let{encapsulation:i}=t.data[r.directiveStart+r.componentOffset];if(i===Gr.None||i===Gr.Emulated)return null}return vr(r,n)}function gk(t,e,n){return yk(t,e,n)}function mk(t,e,n){return t.type&40?vr(t,n):null}var yk=mk,KI;function Sm(t,e,n,r){let i=fk(t,r,e),s=e[Ht],o=r.parent||e[Bn],a=gk(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)jI(s,i,n[c],a,!1);else jI(s,i,n,a,!1);KI!==void 0&&KI(s,r,e,n,i)}function wc(t,e){if(e!==null){let n=e.type;if(n&3)return vr(e,t);if(n&4)return Kg(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return wc(t,r);{let i=t[e.index];return rr(i)?Kg(-1,i):Hn(i)}}else{if(n&128)return wc(t,e.next);if(n&32)return bm(e,t)()||Hn(t[e.index]);{let r=t0(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Ii(t[$n]);return wc(i,r)}else return wc(t,e.next)}}}return null}function t0(t,e){if(e!==null){let r=t[$n][Bn],i=e.projection;return r.projection[i]}return null}function Kg(t,e){let n=pn+t+1;if(n<e.length){let r=e[n],i=r[ke].firstChild;if(i!==null)return wc(r,i)}return e[Pi]}function Cm(t,e,n,r,i,s,o){for(;n!=null;){let a=r[Di];if(n.type===128){n=n.next;continue}let c=r[n.index],l=n.type;if(o&&e===0&&(c&&No(Hn(c),r),n.flags|=2),!hm(n))if(l&8)Cm(t,e,n.child,r,i,s,!1),Mo(e,t,a,i,c,n,s,r);else if(l&32){let d=bm(n,r),h;for(;h=d();)Mo(e,t,a,i,h,n,s,r);Mo(e,t,a,i,c,n,s,r)}else l&16?vk(t,e,r,n,i,s):Mo(e,t,a,i,c,n,s,r);n=o?n.projectionNext:n.next}}function Nd(t,e,n,r,i,s){Cm(n,r,t.firstChild,e,i,s,!1)}function vk(t,e,n,r,i,s){let o=n[$n],c=o[Bn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];Mo(e,t,n[Di],i,d,r,s,n)}else{let l=c,d=o[Yt];CT(r)&&(l.flags|=128),Cm(t,e,l,d,i,s,!0)}}function _k(t,e,n,r,i,s,o){let a=r[Pi],c=Hn(r);a!==c&&Mo(e,t,n,s,a,i,o);for(let l=pn;l<r.length;l++){let d=r[l];Nd(d[ke],d,t,e,s,a)}}function Ek(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:br.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=br.Important),t.setStyle(n,r,i,s))}}function n0(t,e,n,r,i){let s=Mi(),o=r&2;try{ki(-1),o&&e.length>In&&GT(t,e,In,!1),ut(o?2:0,i,n),n(r,i)}finally{ki(s),ut(o?3:1,i,n)}}function Od(t,e,n){Dk(t,e,n),(n.flags&64)===64&&Rk(t,e,n)}function Dm(t,e,n=vr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function bk(t,e,n,r){let s=r.get(NT,kT)||n===Gr.ShadowDom,o=t.selectRootElement(e,s);return wk(o),o}function wk(t){Ik(t)}var Ik=()=>null;function Tk(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function Ak(t,e,n,r,i,s){let o=e[ke];if(Pm(t,o,e,n,r)){xi(t)&&Ck(e,t.index);return}t.type&3&&(n=Tk(n)),Sk(t,e,n,r,i,s)}function Sk(t,e,n,r,i,s){if(t.type&3){let o=vr(t,e);r=s!=null?s(r,t.value||"",n):r,i.setProperty(o,n,r)}else t.type&12}function Ck(t,e){let n=ir(e,t);n[Ne]&16||(n[Ne]|=64)}function Dk(t,e,n){let r=n.directiveStart,i=n.directiveEnd;xi(n)&&QM(e,n,t.data[r+n.componentOffset]),t.firstCreatePass||ET(n,e);let s=n.initialInputs;for(let o=r;o<i;o++){let a=t.data[o],c=gd(e,t,o,n);if(No(c,e),s!==null&&xk(e,o-r,c,a,n,s),Es(a)){let l=ir(n.index,e);l[cn]=gd(e,t,o,n)}}}function Rk(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=wI();try{ki(s);for(let a=r;a<i;a++){let c=t.data[a],l=e[a];td(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Pk(c,l)}}finally{ki(-1),td(o)}}function Pk(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function Rm(t,e){let n=t.directiveRegistry,r=null;if(n)for(let i=0;i<n.length;i++){let s=n[i];HM(e,s.selectors,!1)&&(r??=[],Es(s)?r.unshift(s):r.push(s))}return r}function xk(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;a+=2){let c=o[a],l=o[a+1];qg(r,n,c,l)}}function r0(t,e,n,r,i){let s=In+n,o=e[ke],a=i(o,e,t,r,n);e[s]=a,Ro(t,!0);let c=t.type===2;return c?($T(e[Ht],a,t),(uI()===0||Co(t))&&No(a,e),dI()):No(a,e),sd()&&(!c||!hm(t))&&Sm(o,e,a,t),t}function i0(t){let e=t;return bg()?yI():(e=e.parent,Ro(e,!1)),e}function Mk(t,e){let n=t[Di];if(!n)return;let r;try{r=n.get(Mn,null)}catch{r=null}r?.(e)}function Pm(t,e,n,r,i){let s=t.inputs?.[r],o=t.hostDirectiveInputs?.[r],a=!1;if(o)for(let c=0;c<o.length;c+=2){let l=o[c],d=o[c+1],h=e.data[l];qg(h,n[l],d,i),a=!0}if(s)for(let c of s){let l=n[c],d=e.data[c];qg(d,l,r,i),a=!0}return a}function kk(t,e){let n=ir(e,t),r=n[ke];Nk(r,n);let i=n[nr];i!==null&&n[dc]===null&&(n[dc]=OT(i,n[Di])),ut(18),xm(r,n,n[cn]),ut(19,n[cn])}function Nk(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function xm(t,e,n){rd(e);try{let r=t.viewQuery;r!==null&&zg(1,r,n);let i=t.template;i!==null&&n0(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[yr]?.finishViewCreation(t),t.staticContentQueries&&FT(t,e),t.staticViewQueries&&zg(2,t.viewQuery,n);let s=t.components;s!==null&&Ok(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[Ne]&=-5,id()}}function Ok(t,e){for(let n=0;n<e.length;n++)kk(t,e[n])}function Fk(t,e,n,r){let i=je(null);try{let s=e.tView,a=t[Ne]&4096?4096:16,c=_m(t,s,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=t[e.index];c[Ri]=l;let d=t[yr];return d!==null&&(c[yr]=d.createEmbeddedView(s)),xm(s,c,n),c}finally{je(i)}}function YI(t,e){return!e||e.firstChild===null||CT(t)}function Ac(t,e,n,r,i=!1){for(;n!==null;){if(n.type===128){n=i?n.projectionNext:n.next;continue}let s=e[n.index];s!==null&&r.push(Hn(s)),rr(s)&&s0(s,r);let o=n.type;if(o&8)Ac(t,e,n.child,r);else if(o&32){let a=bm(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=t0(e,n);if(Array.isArray(a))r.push(...a);else{let c=Ii(e[$n]);Ac(c[ke],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function s0(t,e){for(let n=pn;n<t.length;n++){let r=t[n],i=r[ke].firstChild;i!==null&&Ac(r[ke],r,i,e)}t[Pi]!==t[nr]&&e.push(t[Pi])}function o0(t){if(t[Xu]!==null){for(let e of t[Xu])e.impl.addSequence(e);t[Xu].length=0}}var a0=[];function Lk(t){return t[xn]??Vk(t)}function Vk(t){let e=a0.pop()??Object.create(jk);return e.lView=t,e}function Uk(t){t.lView[xn]!==t&&(t.lView=null,a0.push(t))}var jk=Ke(me({},Xa),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{vc(t.lView)},consumerOnSignalRead(){this.lView[xn]=this}});function Bk(t){let e=t[xn]??Object.create($k);return e.lView=t,e}var $k=Ke(me({},Xa),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{let e=Ii(t.lView);for(;e&&!c0(e[ke]);)e=Ii(e);e&&mg(e)},consumerOnSignalRead(){this.lView[xn]=this}});function c0(t){return t.type!==2}function l0(t){if(t[fc]===null)return;let e=!0;for(;e;){let n=!1;for(let r of t[fc])r.dirty&&(n=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=n&&!!(t[Ne]&8192)}}var Hk=100;function u0(t,e=0){let r=t[mr].rendererFactory,i=!1;i||r.begin?.();try{zk(t,e)}finally{i||r.end?.()}}function zk(t,e){let n=wg();try{Ig(!0),Yg(t,e);let r=0;for(;yc(t);){if(r===Hk)throw new Ee(103,!1);r++,Yg(t,1)}}finally{Ig(n)}}function qk(t,e,n,r){if(bs(e))return;let i=e[Ne],s=!1,o=!1;rd(e);let a=!0,c=null,l=null;s||(c0(t)?(l=Lk(e),c=Za(l)):du()===null?(a=!1,l=Bk(e),c=Za(l)):e[xn]&&(ec(e[xn]),e[xn]=null));try{gg(e),_I(t.bindingStartIndex),n!==null&&n0(t,e,n,2,r);let d=(i&3)===3;if(!s)if(d){let p=t.preOrderCheckHooks;p!==null&&cd(e,p,null)}else{let p=t.preOrderHooks;p!==null&&ld(e,p,0,null),kg(e,0)}if(o||Wk(e),l0(e),d0(e,0),t.contentQueries!==null&&FT(t,e),!s)if(d){let p=t.contentCheckHooks;p!==null&&cd(e,p)}else{let p=t.contentHooks;p!==null&&ld(e,p,1),kg(e,1)}Kk(t,e);let h=t.components;h!==null&&f0(e,h,0);let f=t.viewQuery;if(f!==null&&zg(2,f,r),!s)if(d){let p=t.viewCheckHooks;p!==null&&cd(e,p)}else{let p=t.viewHooks;p!==null&&ld(e,p,2),kg(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Yu]){for(let p of e[Yu])p();e[Yu]=null}s||(o0(e),e[Ne]&=-73)}catch(d){throw s||vc(e),d}finally{l!==null&&(hu(l,c),a&&Uk(l)),id()}}function d0(t,e){for(let n=RT(t);n!==null;n=PT(n))for(let r=pn;r<n.length;r++){let i=n[r];h0(i,e)}}function Wk(t){for(let e=RT(t);e!==null;e=PT(e)){if(!(e[Ne]&2))continue;let n=e[_s];for(let r=0;r<n.length;r++){let i=n[r];mg(i)}}}function Gk(t,e,n){ut(18);let r=ir(e,t);h0(r,n),ut(19,r[cn])}function h0(t,e){Zu(t)&&Yg(t,e)}function Yg(t,e){let r=t[ke],i=t[Ne],s=t[xn],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Ja(s)),o||=!1,s&&(s.dirty=!1),t[Ne]&=-9217,o)qk(r,t,r.template,t[cn]);else if(i&8192){let a=je(null);try{l0(t),d0(t,1);let c=r.components;c!==null&&f0(t,c,1),o0(t)}finally{je(a)}}}function f0(t,e,n){for(let r=0;r<e.length;r++)Gk(t,e[r],n)}function Kk(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)ki(~i);else{let s=i,o=n[++r],a=n[++r];bI(o,s);let c=e[s];ut(24,c),a(2,c),ut(25,c)}}}finally{ki(-1)}}function Mm(t,e){let n=wg()?64:1088;for(t[mr].changeDetectionScheduler?.notify(e);t;){t[Ne]|=n;let r=Ii(t);if(Do(t)&&!r)return t;t=r}return null}function p0(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Yk(t,e,n,r=!0){let i=e[ke];if(Xk(i,e,t,n),r){let o=Kg(n,t),a=e[Ht],c=a.parentNode(t[Pi]);c!==null&&ck(i,t[Bn],a,e,c,o)}let s=e[dc];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Xg(t,e){if(t.length<=pn)return;let n=pn+e,r=t[n];if(r){let i=r[Ri];i!==null&&i!==t&&Am(i,r),e>0&&(t[n-1][jn]=r[jn]);let s=cc(t,pn+e);ak(r[ke],r);let o=s[yr];o!==null&&o.detachView(s[ke]),r[Yt]=null,r[jn]=null,r[Ne]&=-129}return r}function Xk(t,e,n,r){let i=pn+r,s=n.length;r>0&&(n[i-1][jn]=e),r<s-pn?(e[jn]=n[i],ig(n,pn+r,e)):(n.push(e),e[jn]=null),e[Yt]=n;let o=e[Ri];o!==null&&n!==o&&g0(o,e);let a=e[yr];a!==null&&a.insertView(t),Ju(e),e[Ne]|=128}function g0(t,e){let n=t[_s],r=e[Yt];if(Wr(r))t[Ne]|=2;else{let i=r[Yt][$n];e[$n]!==i&&(t[Ne]|=2)}n===null?t[_s]=[e]:n.push(e)}var Ni=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,n=e[ke];return Ac(n,e,n.firstChild,[])}constructor(e,n){this._lView=e,this._cdRefInjectingView=n}get context(){return this._lView[cn]}set context(e){this._lView[cn]=e}get destroyed(){return bs(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Yt];if(rr(e)){let n=e[gc],r=n?n.indexOf(this):-1;r>-1&&(Xg(e,r),cc(n,r))}this._attachedToViewContainer=!1}e0(this._lView[ke],this._lView)}onDestroy(e){yg(this._lView,e)}markForCheck(){Mm(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ne]&=-129}reattach(){Ju(this._lView),this._lView[Ne]|=128}detectChanges(){this._lView[Ne]|=1024,u0(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Do(this._lView),n=this._lView[Ri];n!==null&&!e&&Am(n,this._lView),JT(this._lView[ke],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Ee(902,!1);this._appRef=e;let n=Do(this._lView),r=this._lView[Ri];r!==null&&!n&&g0(r,this._lView),Ju(this._lView)}};var Oi=(()=>{class t{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=Qk;constructor(n,r,i){this._declarationLView=n,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,r){return this.createEmbeddedViewImpl(n,r)}createEmbeddedViewImpl(n,r,i){let s=Fk(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:r,dehydratedView:i});return new Ni(s)}}return t})();function Qk(){return km(zn(),ft())}function km(t,e){return t.type&4?new Oi(e,t,Uo(t,e)):null}function Nm(t,e,n,r,i){let s=t.data[e];if(s===null)s=Zk(t,e,n,r,i),EI()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=mI();s.injectorIndex=o===null?-1:o.injectorIndex}return Ro(s,!0),s}function Zk(t,e,n,r,i){let s=Eg(),o=bg(),a=o?s:s&&s.parent,c=t.data[e]=eN(t,a,n,e,r,i);return Jk(t,c,s,o),c}function Jk(t,e,n,r){t.firstChild===null&&(t.firstChild=e),n!==null&&(r?n.child==null&&e.parent!==null&&(n.child=e):n.next===null&&(n.next=e,e.prev=n))}function eN(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return fI()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var V5=new RegExp(`^(\\d+)*(${wM}|${bM})*(.*)`);var tN=()=>null;function XI(t,e){return tN(t,e)}var m0=class{},Fd=class{},Qg=class{resolveComponentFactory(e){throw new Ee(917,!1)}},Pc=class{static NULL=new Qg},Ts=class{};var y0=(()=>{class t{static \u0275prov=we({token:t,providedIn:"root",factory:()=>null})}return t})();var dd={},Zg=class{injector;parentInjector;constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){let i=this.injector.get(e,dd,r);return i!==dd||n===dd?i:this.parentInjector.get(e,n,r)}};function QI(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=Kp(i,a);else if(s==2){let c=a,l=e[++o];r=Kp(r,c+": "+l+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}function qn(t,e=0){let n=ft();if(n===null)return Pe(t,e);let r=zn();return TT(r,n,bn(t),e)}function v0(t,e,n,r,i){let s=r===null?null:{"":-1},o=i(t,n);if(o!==null){let a=o,c=null,l=null;for(let d of o)if(d.resolveHostDirectives!==null){[a,c,l]=d.resolveHostDirectives(o);break}iN(t,e,n,a,s,c,l)}s!==null&&r!==null&&nN(n,r,s)}function nN(t,e,n){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new Ee(-301,!1);r.push(e[i],s)}}function rN(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function iN(t,e,n,r,i,s,o){let a=r.length,c=!1;for(let f=0;f<a;f++){let p=r[f];!c&&Es(p)&&(c=!0,rN(t,n,f)),lM(ET(n,e),t,p.type)}uN(n,t.data.length,a);for(let f=0;f<a;f++){let p=r[f];p.providersResolver&&p.providersResolver(p)}let l=!1,d=!1,h=WT(t,e,a,null);a>0&&(n.directiveToIndex=new Map);for(let f=0;f<a;f++){let p=r[f];if(n.mergedAttrs=cm(n.mergedAttrs,p.hostAttrs),oN(t,n,e,h,p),lN(h,p,i),o!==null&&o.has(p)){let[g,v]=o.get(p);n.directiveToIndex.set(p.type,[h,g+n.directiveStart,v+n.directiveStart])}else(s===null||!s.has(p))&&n.directiveToIndex.set(p.type,h);p.contentQueries!==null&&(n.flags|=4),(p.hostBindings!==null||p.hostAttrs!==null||p.hostVars!==0)&&(n.flags|=64);let m=p.type.prototype;!l&&(m.ngOnChanges||m.ngOnInit||m.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),l=!0),!d&&(m.ngOnChanges||m.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),d=!0),h++}sN(t,n,s)}function sN(t,e,n){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=t.data[r];if(n===null||!n.has(i))ZI(0,e,i,r),ZI(1,e,i,r),eT(e,r,!1);else{let s=n.get(i);JI(0,e,s,r),JI(1,e,s,r),eT(e,r,!0)}}}function ZI(t,e,n,r){let i=t===0?n.inputs:n.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o;t===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(r),_0(e,s)}}function JI(t,e,n,r){let i=t===0?n.inputs:n.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o=i[s],a;t===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(r,s),_0(e,o)}}function _0(t,e){e==="class"?t.flags|=8:e==="style"&&(t.flags|=16)}function eT(t,e,n){let{attrs:r,inputs:i,hostDirectiveInputs:s}=t;if(r===null||!n&&i===null||n&&s===null||ym(t)){t.initialInputs??=[],t.initialInputs.push(null);return}let o=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!n&&i.hasOwnProperty(c)){let l=i[c];for(let d of l)if(d===e){o??=[],o.push(c,r[a+1]);break}}else if(n&&s.hasOwnProperty(c)){let l=s[c];for(let d=0;d<l.length;d+=2)if(l[d]===e){o??=[],o.push(l[d+1],r[a+1]);break}}a+=2}t.initialInputs??=[],t.initialInputs.push(o)}function oN(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=hs(i.type,!0)),o=new Tc(s,Es(i),qn,null);t.blueprint[r]=o,n[r]=o,aN(t,e,r,WT(t,n,i.hostVars,wr),i)}function aN(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;cN(o)!=a&&o.push(a),o.push(n,r,s)}}function cN(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function lN(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Es(e)&&(n[""]=t)}}function uN(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Om(t,e,n,r,i,s,o,a){let c=e[ke],l=c.consts,d=mc(l,o),h=Nm(c,t,n,r,d);return s&&v0(c,e,h,mc(l,a),i),h.mergedAttrs=cm(h.mergedAttrs,h.attrs),h.attrs!==null&&QI(h,h.attrs,!1),h.mergedAttrs!==null&&QI(h,h.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,h),h}function Fm(t,e){gT(t,e),fg(e)&&t.queries.elementEnd(e)}function Lm(t){return b0(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function E0(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function b0(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function Sc(t,e,n){if(n===wr)return!1;let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function dN(t,e,n,r){let i=Sc(t,e,n);return Sc(t,e+1,r)||i}function Fg(t,e,n){return function r(i){let s=xi(t)?ir(t.index,e):e;Mm(s,5);let o=e[cn],a=tT(e,o,n,i),c=r.__ngNextListenerFn__;for(;c;)a=tT(e,o,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function tT(t,e,n,r){let i=je(null);try{return ut(6,e,n),n(r)!==!1}catch(s){return Mk(t,s),!1}finally{ut(7,e,n),je(i)}}function hN(t,e,n,r,i,s,o,a){let c=Co(t),l=!1,d=null;if(!r&&c&&(d=pN(e,n,s,t.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=o,d.__ngLastListenerFn__=o,l=!0}else{let h=vr(t,n),f=r?r(h):h;TM(n,f,s,a);let p=i.listen(f,s,a);if(!fN(s)){let m=r?g=>r(Hn(g[t.index])):t.index;w0(m,e,n,s,a,p,!1)}}return l}function fN(t){return t.startsWith("animation")||t.startsWith("transition")}function pN(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Ao],c=i[s+2];return a&&a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function w0(t,e,n,r,i,s,o){let a=e.firstCreatePass?_g(e):null,c=vg(n),l=c.length;c.push(i,s),a&&a.push(r,t,l,(l+1)*(o?-1:1))}function nT(t,e,n,r,i,s){let o=e[n],a=e[ke],l=a.data[n].outputs[r],h=o[l].subscribe(s);w0(t.index,a,e,i,s,h,!0)}var Jg=Symbol("BINDING");var bd=class extends Pc{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Ci(e);return new Fo(n,this.ngModule)}};function gN(t){return Object.keys(t).map(e=>{let[n,r,i]=t[e],s={propName:n,templateName:e,isSignal:(r&Md.SignalBased)!==0};return i&&(s.transform=i),s})}function mN(t){return Object.keys(t).map(e=>({propName:t[e],templateName:e}))}function yN(t,e,n){let r=e instanceof Bt?e:e?.injector;return r&&t.getStandaloneInjector!==null&&(r=t.getStandaloneInjector(r)||r),r?new Zg(n,r):n}function vN(t){let e=t.get(Ts,null);if(e===null)throw new Ee(407,!1);let n=t.get(y0,null),r=t.get(Ti,null);return{rendererFactory:e,sanitizer:n,changeDetectionScheduler:r,ngReflect:!1}}function _N(t,e){let n=I0(t);return jT(e,n,n==="svg"?rI:n==="math"?iI:null)}function I0(t){return(t.selectors[0][0]||"div").toLowerCase()}var Fo=class extends Fd{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=gN(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=mN(this.componentDef.outputs),this.cachedOutputs}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=GM(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!n}create(e,n,r,i,s,o){ut(22);let a=je(null);try{let c=this.componentDef,l=EN(r,c,o,s),d=yN(c,i||this.ngModule,e),h=vN(d),f=h.rendererFactory.createRenderer(null,c),p=r?bk(f,r,c.encapsulation,d):_N(c,f),m=o?.some(rT)||s?.some(E=>typeof E!="function"&&E.bindings.some(rT)),g=_m(null,l,null,512|qT(c),null,null,h,f,d,null,OT(p,d,!0));g[In]=p,rd(g);let v=null;try{let E=Om(In,g,2,"#host",()=>l.directiveRegistry,!0,0);$T(f,p,E),No(p,g),Od(l,g,E),fm(l,E,g),Fm(l,E),n!==void 0&&wN(E,this.ngContentSelectors,n),v=ir(E.index,g),g[cn]=v[cn],xm(l,g,null)}catch(E){throw v!==null&&$g(v),$g(g),E}finally{ut(23),id()}return new wd(this.componentType,g,!!m)}finally{je(a)}}};function EN(t,e,n,r){let i=t?["ng-version","20.3.15"]:KM(e.selectors[0]),s=null,o=null,a=0;if(n)for(let d of n)a+=d[Jg].requiredVars,d.create&&(d.targetIdx=0,(s??=[]).push(d)),d.update&&(d.targetIdx=0,(o??=[]).push(d));if(r)for(let d=0;d<r.length;d++){let h=r[d];if(typeof h!="function")for(let f of h.bindings){a+=f[Jg].requiredVars;let p=d+1;f.create&&(f.targetIdx=p,(s??=[]).push(f)),f.update&&(f.targetIdx=p,(o??=[]).push(f))}}let c=[e];if(r)for(let d of r){let h=typeof d=="function"?d:d.type,f=cg(h);c.push(f)}return vm(0,null,bN(s,o),1,a,c,null,null,null,[i],null)}function bN(t,e){return!t&&!e?null:n=>{if(n&1&&t)for(let r of t)r.create();if(n&2&&e)for(let r of e)r.update()}}function rT(t){let e=t[Jg].kind;return e==="input"||e==="twoWay"}var wd=class extends m0{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,n,r){super(),this._rootLView=n,this._hasInputBindings=r,this._tNode=Qu(n[ke],In),this.location=Uo(this._tNode,n),this.instance=ir(this._tNode.index,n)[cn],this.hostView=this.changeDetectorRef=new Ni(n,void 0),this.componentType=e}setInput(e,n){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let i=this._rootLView,s=Pm(r,i[ke],i,e,n);this.previousInputValues.set(e,n);let o=ir(r.index,i);Mm(o,1)}get injector(){return new Is(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function wN(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null&&s.length?Array.from(s):null)}}var Kr=(()=>{class t{static __NG_ELEMENT_ID__=IN}return t})();function IN(){let t=zn();return A0(t,ft())}var TN=Kr,T0=class extends TN{_lContainer;_hostTNode;_hostLView;constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Uo(this._hostTNode,this._hostLView)}get injector(){return new Is(this._hostTNode,this._hostLView)}get parentInjector(){let e=lm(this._hostTNode,this._hostLView);if(yT(e)){let n=pd(e,this._hostLView),r=fd(e),i=n[ke].data[r+8];return new Is(i,n)}else return new Is(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=iT(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-pn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=XI(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,YI(this._hostTNode,o)),a}createComponent(e,n,r,i,s,o,a){let c=e&&!Kx(e),l;if(c)l=n;else{let v=n||{};l=v.index,r=v.injector,i=v.projectableNodes,s=v.environmentInjector||v.ngModuleRef,o=v.directives,a=v.bindings}let d=c?e:new Fo(Ci(e)),h=r||this.parentInjector;if(!s&&d.ngModule==null){let E=(c?h:this.parentInjector).get(Bt,null);E&&(s=E)}let f=Ci(d.componentType??{}),p=XI(this._lContainer,f?.id??null),m=p?.firstChild??null,g=d.create(h,i,m,s,o,a);return this.insertImpl(g.hostView,l,YI(this._hostTNode,p)),g}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(oI(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Yt],l=new T0(c,c[Bn],c[Yt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return Yk(o,i,s,r),e.attachToViewContainerRef(),ig(Lg(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=iT(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Xg(this._lContainer,n);r&&(cc(Lg(this._lContainer),n),e0(r[ke],r))}detach(e){let n=this._adjustIndex(e,-1),r=Xg(this._lContainer,n);return r&&cc(Lg(this._lContainer),n)!=null?new Ni(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function iT(t){return t[gc]}function Lg(t){return t[gc]||(t[gc]=[])}function A0(t,e){let n,r=e[t.index];return rr(r)?n=r:(n=p0(r,e,null,t),e[t.index]=n,Em(e,n)),SN(n,e,t,r),new T0(n,t,e)}function AN(t,e){let n=t[Ht],r=n.createComment(""),i=vr(e,t),s=n.parentNode(i);return vd(n,s,r,n.nextSibling(i),!1),r}var SN=RN,CN=()=>!1;function DN(t,e,n){return CN(t,e,n)}function RN(t,e,n,r){if(t[Pi])return;let i;n.type&8?i=Hn(r):i=AN(e,n),t[Pi]=i}var em=class t{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},tm=class t{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let n=e.queries;if(n!==null){let r=e.contentQueries!==null?e.contentQueries[0]:n.length,i=[];for(let s=0;s<r;s++){let o=n.getByIndex(s),a=this.queries[o.indexInDeclarationView];i.push(a.clone())}return new t(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)Vm(e,n).matches!==null&&this.queries[n].setDirty()}},nm=class{flags;read;predicate;constructor(e,n,r=null){this.flags=n,this.read=r,typeof e=="string"?this.predicate=LN(e):this.predicate=e}},rm=class t{queries;constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){let i=n!==null?n.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,n!==null?n.push(s):n=[s])}return n!==null?new t(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},im=class t{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,n=-1){this.metadata=e,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new t(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let n=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==n;)r=r.parent;return n===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let s=r[i];this.matchTNodeWithReadOption(e,n,PN(n,s)),this.matchTNodeWithReadOption(e,n,ud(n,e,s,!1,!1))}else r===Oi?n.type&4&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,ud(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===jo||i===Kr||i===Oi&&n.type&4)this.addMatch(n.index,-2);else{let s=ud(n,e,i,!1,!1);s!==null&&this.addMatch(n.index,s)}else this.addMatch(n.index,r)}}addMatch(e,n){this.matches===null?this.matches=[e,n]:this.matches.push(e,n)}};function PN(t,e){let n=t.localNames;if(n!==null){for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1]}return null}function xN(t,e){return t.type&11?Uo(t,e):t.type&4?km(t,e):null}function MN(t,e,n,r){return n===-1?xN(e,t):n===-2?kN(t,e,r):gd(t,t[ke],n,e)}function kN(t,e,n){if(n===jo)return Uo(e,t);if(n===Oi)return km(e,t);if(n===Kr)return A0(e,t)}function S0(t,e,n,r){let i=e[yr].queries[r];if(i.matches===null){let s=t.data,o=n.matches,a=[];for(let c=0;o!==null&&c<o.length;c+=2){let l=o[c];if(l<0)a.push(null);else{let d=s[l];a.push(MN(e,d,o[c+1],n.metadata.read))}}i.matches=a}return i.matches}function sm(t,e,n,r){let i=t.queries.getByIndex(n),s=i.matches;if(s!==null){let o=S0(t,e,i,n);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)r.push(o[a/2]);else{let l=s[a+1],d=e[-c];for(let h=pn;h<d.length;h++){let f=d[h];f[Ri]===f[Yt]&&sm(f[ke],f,l,r)}if(d[_s]!==null){let h=d[_s];for(let f=0;f<h.length;f++){let p=h[f];sm(p[ke],p,l,r)}}}}}return r}function NN(t,e){return t[yr].queries[e].queryList}function ON(t,e,n){let r=new md((n&4)===4);return lI(t,e,r,r.destroy),(e[yr]??=new tm).queries.push(new em(r))-1}function FN(t,e,n){let r=sr();return r.firstCreatePass&&(VN(r,new nm(t,e,n),-1),(e&2)===2&&(r.staticViewQueries=!0)),ON(r,ft(),e)}function LN(t){return t.split(",").map(e=>e.trim())}function VN(t,e,n){t.queries===null&&(t.queries=new rm),t.queries.track(new im(e,n))}function Vm(t,e){return t.queries.getByIndex(e)}function UN(t,e){let n=t[ke],r=Vm(n,e);return r.crossesNgTemplate?sm(n,t,e,[]):S0(n,t,r,e)}var As=class{},Ld=class{};var Id=class extends As{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new bd(this);constructor(e,n,r,i=!0){super(),this.ngModuleType=e,this._parent=n;let s=ag(e);this._bootstrapComponents=HT(s.bootstrap),this._r3Injector=Rg(e,n,[{provide:As,useValue:this},{provide:Pc,useValue:this.componentFactoryResolver},...r],qr(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Td=class extends Ld{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Id(this.moduleType,e,[])}};var Cc=class extends As{injector;componentFactoryResolver=new bd(this);instance=null;constructor(e){super();let n=new fs([...e.providers,{provide:As,useValue:this},{provide:Pc,useValue:this.componentFactoryResolver}],e.parent||uc(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function xc(t,e,n=null){return new Cc({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var jN=(()=>{class t{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=lg(!1,n.type),i=r.length>0?xc([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=we({token:t,providedIn:"environment",factory:()=>new t(Pe(Bt))})}return t})();function Mc(t){return Vo(()=>{let e=C0(t),n=Ke(me({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===um.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(jN).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Gr.Emulated,styles:t.styles||Un,_:null,schemas:t.schemas||null,tView:null,id:""});e.standalone&&kd("NgStandalone"),D0(n);let r=t.dependencies;return n.directiveDefs=sT(r,BN),n.pipeDefs=sT(r,Xw),n.id=zN(n),n})}function BN(t){return Ci(t)||cg(t)}function Bo(t){return Vo(()=>({type:t.type,bootstrap:t.bootstrap||Un,declarations:t.declarations||Un,imports:t.imports||Un,exports:t.exports||Un,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function $N(t,e){if(t==null)return ms;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a,c;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s,c=i[3]||null):(s=i,o=i,a=Md.None,c=null),n[s]=[r,a,c],e[s]=o}return n}function HN(t){if(t==null)return ms;let e={};for(let n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function $o(t){return Vo(()=>{let e=C0(t);return D0(e),e})}function C0(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputConfig:t.inputs||ms,exportAs:t.exportAs||null,standalone:t.standalone??!0,signals:t.signals===!0,selectors:t.selectors||Un,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:$N(t.inputs,e),outputs:HN(t.outputs),debugInfo:null}}function D0(t){t.features?.forEach(e=>e(t))}function sT(t,e){return t?()=>{let n=typeof t=="function"?t():t,r=[];for(let i of n){let s=e(i);s!==null&&r.push(s)}return r}:null}function zN(t){let e=0,n=typeof t.consts=="function"?"":t.consts,r=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,n,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery];for(let s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function qN(t,e,n,r,i,s,o,a){if(n.firstCreatePass){t.mergedAttrs=cm(t.mergedAttrs,t.attrs);let d=t.tView=vm(2,t,i,s,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,n.consts,null);n.queries!==null&&(n.queries.template(n,t),d.queries=n.queries.embeddedTView(t))}a&&(t.flags|=a),Ro(t,!1);let c=GN(n,e,t,r);sd()&&Sm(n,e,c,t),No(c,e);let l=p0(c,e,c,t);e[r+In]=l,Em(e,l),DN(l,t,e)}function WN(t,e,n,r,i,s,o,a,c,l,d){let h=n+In,f;return e.firstCreatePass?(f=Nm(e,h,4,o||null,a||null),ed()&&v0(e,t,f,mc(e.consts,l),Rm),gT(e,f)):f=e.data[h],qN(f,t,e,n,r,i,s,c),Co(f)&&Od(e,t,f),l!=null&&Dm(t,f,d),f}function Yr(t,e,n,r,i,s,o,a){let c=ft(),l=sr(),d=mc(l.consts,s);return WN(c,l,t,e,n,r,i,d,void 0,o,a),Yr}var GN=KN;function KN(t,e,n,r){return _c(!0),e[Ht].createComment("")}var Um=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();var jm=new Te("");function Ho(t){return!!t&&typeof t.then=="function"}function Bm(t){return!!t&&typeof t.subscribe=="function"}var $m=new Te("");function Vd(t){return wn([{provide:$m,multi:!0,useValue:t}])}var Hm=(()=>{class t{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=he($m,{optional:!0})??[];injector=he(kt);constructor(){}runInitializers(){if(this.initialized)return;let n=[];for(let i of this.appInits){let s=$t(this.injector,i);if(Ho(s))n.push(s);else if(Bm(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});n.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),n.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Ud=new Te("");function R0(){pp(()=>{let t="";throw new Ee(600,t)})}function P0(t){return t.isBoundToModule}var YN=10;var Ir=(()=>{class t{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=he(Mn);afterRenderManager=he(QT);zonelessEnabled=he(Ec);rootEffectScheduler=he(Mg);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new bt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=he(_r);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(Me(n=>!n))}constructor(){he(Rc,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=he(Bt);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){return this.bootstrapImpl(n,r)}bootstrapImpl(n,r,i=kt.NULL){return this._injector.get(nt).run(()=>{ut(10);let o=n instanceof Fd;if(!this._injector.get(Hm).done){let m="";throw new Ee(405,m)}let c;o?c=n:c=this._injector.get(Pc).resolveComponentFactory(n),this.componentTypes.push(c.componentType);let l=P0(c)?void 0:this._injector.get(As),d=r||c.selector,h=c.create(i,[],d,l),f=h.location.nativeElement,p=h.injector.get(jm,null);return p?.registerApplication(f),h.onDestroy(()=>{this.detachView(h.hostView),Ic(this.components,h),p?.unregisterApplication(f)}),this._loadComponent(h),ut(11,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){ut(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(wm.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Ee(101,!1);let n=je(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,je(n),this.afterTick.next(),ut(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Ts,null,{optional:!0}));let n=0;for(;this.dirtyFlags!==0&&n++<YN;)ut(14),this.synchronizeOnce(),ut(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let n=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!yc(i))continue;let s=r&&!this.zonelessEnabled?0:1;u0(i,s),n=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}n||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:n})=>yc(n))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;Ic(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(n),this._injector.get(Ud,[]).forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Ic(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new Ee(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ic(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var q5=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function dt(t,e,n){let r=ft(),i=Tg();if(Sc(r,i,e)){let s=sr(),o=DI();Ak(o,r,t,e,r[Ht],n)}return dt}function oT(t,e,n,r,i){Pm(e,t,n,i?"class":"style",r)}function qe(t,e,n,r){let i=ft(),s=i[ke],o=t+In,a=s.firstCreatePass?Om(o,i,2,e,Rm,ed(),n,r):s.data[o];if(r0(a,i,t,e,XN),Co(a)){let c=i[ke];Od(c,i,a),fm(c,a,i)}return r!=null&&Dm(i,a),qe}function We(){let t=sr(),e=zn(),n=i0(e);return t.firstCreatePass&&Fm(t,n),pI(n)&&gI(),hI(),n.classesWithoutHost!=null&&eM(n)&&oT(t,n,ft(),n.classesWithoutHost,!0),n.stylesWithoutHost!=null&&tM(n)&&oT(t,n,ft(),n.stylesWithoutHost,!1),We}function Xr(t,e,n,r){return qe(t,e,n,r),We(),Xr}var XN=(t,e,n,r,i)=>(_c(!0),jT(e[Ht],r,RI()));function jd(t,e,n){let r=ft(),i=r[ke],s=t+In,o=i.firstCreatePass?Om(s,r,8,"ng-container",Rm,ed(),e,n):i.data[s];if(r0(o,r,t,"ng-container",QN),Co(o)){let a=r[ke];Od(a,r,o),fm(a,o,r)}return n!=null&&Dm(r,o),jd}function Bd(){let t=sr(),e=zn(),n=i0(e);return t.firstCreatePass&&Fm(t,n),Bd}var QN=(t,e,n,r,i)=>(_c(!0),kM(e[Ht],""));function Ds(){return ft()}var kc="en-US";var ZN=kc;function x0(t){typeof t=="string"&&(ZN=t.toLowerCase().replace(/_/g,"-"))}function Wn(t,e,n){let r=ft(),i=sr(),s=zn();return JN(i,r,r[Ht],s,t,e,n),Wn}function JN(t,e,n,r,i,s,o){let a=!0,c=null;if((r.type&3||o)&&(c??=Fg(r,e,s),hN(r,t,e,o,n,i,s,c)&&(a=!1)),a){let l=r.outputs?.[i],d=r.hostDirectiveOutputs?.[i];if(d&&d.length)for(let h=0;h<d.length;h+=2){let f=d[h],p=d[h+1];c??=Fg(r,e,s),nT(r,e,f,p,i,c)}if(l&&l.length)for(let h of l)c??=Fg(r,e,s),nT(r,e,h,i,i,c)}}function at(t=1){return CI(t)}function zm(t,e,n){FN(t,e,n)}function qm(t){let e=ft(),n=sr(),r=Sg();nd(r+1);let i=Vm(n,r);if(t.dirty&&sI(e)===((i.metadata.flags&2)===2)){if(i.matches===null)t.reset([]);else{let s=UN(e,r);t.reset(s,gM),t.notifyOnChanges()}return!0}return!1}function Wm(){return NN(ft(),Sg())}function ad(t,e){return t<<17|e<<2}function Ss(t){return t>>17&32767}function eO(t){return(t&2)==2}function tO(t,e){return t&131071|e<<17}function om(t){return t|2}function Lo(t){return(t&131068)>>2}function Vg(t,e){return t&-131069|e<<2}function nO(t){return(t&1)===1}function am(t){return t|1}function rO(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Ss(o),c=Lo(o);t[r]=n;let l=!1,d;if(Array.isArray(n)){let h=n;d=h[1],(d===null||To(h,d)>0)&&(l=!0)}else d=n;if(i)if(c!==0){let f=Ss(t[a+1]);t[r+1]=ad(f,a),f!==0&&(t[f+1]=Vg(t[f+1],r)),t[a+1]=tO(t[a+1],r)}else t[r+1]=ad(a,0),a!==0&&(t[a+1]=Vg(t[a+1],r)),a=r;else t[r+1]=ad(c,0),a===0?a=r:t[c+1]=Vg(t[c+1],r),c=r;l&&(t[r+1]=om(t[r+1])),aT(t,d,r,!0),aT(t,d,r,!1),iO(e,d,t,r,s),o=ad(a,c),s?e.classBindings=o:e.styleBindings=o}function iO(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&To(s,e)>=0&&(n[r+1]=am(n[r+1]))}function aT(t,e,n,r){let i=t[n+1],s=e===null,o=r?Ss(i):Lo(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],l=t[o+1];sO(c,e)&&(a=!0,t[o+1]=r?am(l):om(l)),o=r?Ss(l):Lo(l)}a&&(t[n+1]=r?om(i):am(i))}function sO(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?To(t,e)>=0:!1}function Nc(t,e,n){return M0(t,e,n,!1),Nc}function $d(t,e){return M0(t,e,null,!0),$d}function M0(t,e,n,r){let i=ft(),s=sr(),o=Ag(2);if(s.firstUpdatePass&&aO(s,t,o,r),e!==wr&&Sc(i,o,e)){let a=s.data[Mi()];hO(s,a,i,i[Ht],t,i[o+1]=fO(e,n),r,o)}}function oO(t,e){return e>=t.expandoStartIndex}function aO(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Mi()],o=oO(t,n);pO(s,r)&&e===null&&!o&&(e=!1),e=cO(i,s,e,r),rO(i,s,e,n,o,r)}}function cO(t,e,n,r){let i=II(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Ug(null,t,e,n,r),n=Dc(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Ug(i,t,e,n,r),s===null){let c=lO(t,e,r);c!==void 0&&Array.isArray(c)&&(c=Ug(null,t,e,c[1],r),c=Dc(c,e.attrs,r),uO(t,e,r,c))}else s=dO(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function lO(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Lo(r)!==0)return t[Ss(r)]}function uO(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Ss(i)]=r}function dO(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Dc(r,o,n)}return Dc(r,e.attrs,n)}function Ug(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Dc(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Dc(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),Yw(t,o,n?!0:e[++s]))}return t===void 0?null:t}function hO(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,l=c[a+1],d=nO(l)?cT(c,e,n,i,Lo(l),o):void 0;if(!Ad(d)){Ad(s)||eO(l)&&(s=cT(c,null,n,i,a,o));let h=pg(Mi(),n);Ek(r,o,h,i,s)}}function cT(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],l=Array.isArray(c),d=l?c[1]:c,h=d===null,f=n[i+1];f===wr&&(f=h?Un:void 0);let p=h?Ku(f,r):d===r?f:void 0;if(l&&!Ad(p)&&(p=Ku(c,r)),Ad(p)&&(a=p,o))return a;let m=t[i+1];i=o?Ss(m):Lo(m)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=Ku(c,r))}return a}function Ad(t){return t!==void 0}function fO(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=qr(pm(t)))),t}function pO(t,e){return(t.flags&(e?8:16))!==0}function ht(t,e=""){let n=ft(),r=sr(),i=t+In,s=r.firstCreatePass?Nm(r,i,1,e,null):r.data[i],o=gO(r,n,s,e,t);n[i]=o,sd()&&Sm(r,n,o,s),Ro(s,!1)}var gO=(t,e,n,r,i)=>(_c(!0),xM(e[Ht],r));function mO(t,e,n,r=""){return Sc(t,Tg(),n)?e+Io(n)+r:wr}function yO(t,e,n,r,i,s=""){let o=vI(),a=dN(t,o,n,i);return Ag(2),a?e+Io(n)+r+Io(i)+s:wr}function zo(t){return Oc("",t),zo}function Oc(t,e,n){let r=ft(),i=mO(r,t,e,n);return i!==wr&&k0(r,Mi(),i),Oc}function Fc(t,e,n,r,i){let s=ft(),o=yO(s,t,e,n,r,i);return o!==wr&&k0(s,Mi(),o),Fc}function k0(t,e,n){let r=pg(e,t);MM(t[Ht],r,n)}var Sd=class{ngModuleFactory;componentFactories;constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Gm=(()=>{class t{compileModuleSync(n){return new Td(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let r=this.compileModuleSync(n),i=ag(n),s=HT(i.declarations).reduce((o,a)=>{let c=Ci(a);return c&&o.push(new Fo(c)),o},[]);return new Sd(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var vO=(()=>{class t{zone=he(nt);changeDetectionScheduler=he(Ti);applicationRef=he(Ir);applicationErrorHandler=he(Mn);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(n){this.applicationErrorHandler(n)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),N0=new Te("",{factory:()=>!1});function Km({ngZoneFactory:t,ignoreChangesOutsideZone:e,scheduleInRootZone:n}){return t??=()=>new nt(Ke(me({},Xm()),{scheduleInRootZone:n})),[{provide:nt,useFactory:t},{provide:Si,multi:!0,useFactory:()=>{let r=he(vO,{optional:!0});return()=>r.initialize()}},{provide:Si,multi:!0,useFactory:()=>{let r=he(_O);return()=>{r.initialize()}}},e===!0?{provide:Pg,useValue:!0}:[],{provide:xg,useValue:n??KT},{provide:Mn,useFactory:()=>{let r=he(nt),i=he(Bt),s;return o=>{r.runOutsideAngular(()=>{i.destroyed&&!s?setTimeout(()=>{throw o}):(s??=i.get(gr),s.handleError(o))})}}}]}function Ym(t){let e=t?.ignoreChangesOutsideZone,n=t?.scheduleInRootZone,r=Km({ngZoneFactory:()=>{let i=Xm(t);return i.scheduleInRootZone=n,i.shouldCoalesceEventChangeDetection&&kd("NgZone_CoalesceEvent"),new nt(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:n});return wn([{provide:N0,useValue:!0},{provide:Ec,useValue:!1},r])}function Xm(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var _O=(()=>{class t{subscription=new yt;initialized=!1;zone=he(nt);pendingTasks=he(_r);initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{nt.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{nt.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var O0=(()=>{class t{applicationErrorHandler=he(Mn);appRef=he(Ir);taskService=he(_r);ngZone=he(nt);zonelessEnabled=he(Ec);tracing=he(Rc,{optional:!0});disableScheduling=he(Pg,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new yt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(_d):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(he(xg,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ed||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&n===5)return;let r=!1;switch(n){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?HI:YT;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(n){return!(this.disableScheduling&&!n||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(_d+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(n),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,HI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function EO(){return typeof $localize<"u"&&$localize.locale||kc}var Hd=new Te("",{providedIn:"root",factory:()=>he(Hd,{optional:!0,skipSelf:!0})||EO()});function Qr(t){return Lw(t)}var F0=class{[vn];constructor(e){this[vn]=e}destroy(){this[vn].destroy()}};var j0=Symbol("InputSignalNode#UNSET"),VO=Ke(me({},fu),{transformFn:void 0,applyValueToInputSignal(t,e){oo(t,e)}});function B0(t,e){let n=Object.create(VO);n.value=t,n.transformFn=e?.transform;function r(){if(Qa(n),n.value===j0){let i=null;throw new Ee(-950,i)}return n.value}return r[vn]=n,r}var UO=new Te("");UO.__NG_ELEMENT_ID__=t=>{let e=zn();if(e===null)throw new Ee(204,!1);if(e.type&2)return e.value;if(t&8)return null;throw new Ee(204,!1)};function L0(t,e){return B0(t,e)}function jO(t){return B0(j0,t)}var $0=(L0.required=jO,L0);var Qm=new Te(""),BO=new Te("");function Lc(t){return!t.moduleRef}function $O(t){let e=Lc(t)?t.r3Injector:t.moduleRef.injector,n=e.get(nt);return n.run(()=>{Lc(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();let r=e.get(Mn),i;if(n.runOutsideAngular(()=>{i=n.onError.subscribe({next:r})}),Lc(t)){let s=()=>e.destroy(),o=t.platformInjector.get(Qm);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>t.moduleRef.destroy(),o=t.platformInjector.get(Qm);o.add(s),t.moduleRef.onDestroy(()=>{Ic(t.allPlatformModules,t.moduleRef),i.unsubscribe(),o.delete(s)})}return zO(r,n,()=>{let s=e.get(_r),o=s.add(),a=e.get(Hm);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(Hd,kc);if(x0(c||kc),!e.get(BO,!0))return Lc(t)?e.get(Ir):(t.allPlatformModules.push(t.moduleRef),t.moduleRef);if(Lc(t)){let d=e.get(Ir);return t.rootComponent!==void 0&&d.bootstrap(t.rootComponent),d}else return HO?.(t.moduleRef,t.allPlatformModules),t.moduleRef}).finally(()=>void s.remove(o))})})}var HO;function zO(t,e,n){try{let r=n();return Ho(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t(r)),r}}var zd=null;function qO(t=[],e){return kt.create({name:e,providers:[{provide:lc,useValue:"platform"},{provide:Qm,useValue:new Set([()=>zd=null])},...t]})}function WO(t=[]){if(zd)return zd;let e=qO(t);return zd=e,R0(),GO(e),e}function GO(t){let e=t.get(Pd,null);$t(t,()=>{e?.forEach(n=>n())})}function Vc(){return!1}var ny=(()=>{class t{static __NG_ELEMENT_ID__=KO}return t})();function KO(t){return YO(zn(),ft(),(t&16)===16)}function YO(t,e,n){if(xi(t)&&!n){let r=ir(t.index,e);return new Ni(r,r)}else if(t.type&175){let r=e[$n];return new Ni(r,e)}return null}var Zm=class{constructor(){}supports(e){return Lm(e)}create(e){return new Jm(e)}},XO=(t,e)=>e,Jm=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||XO}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<V0(r,i,s)?n:r,a=V0(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let f=0;f<l;f++){let p=f<s.length?s[f]:s[f]=0,m=p+f;d<=m&&m<l&&(s[f]=p+1)}let h=o.previousIndex;s[h]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!Lm(e))throw new Ee(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,E0(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new ey(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new qd),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new qd),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},ey=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,n){this.item=e,this.trackById=n}},ty=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},qd=class{map=new Map;put(e){let n=e.trackById,r=this.map.get(n);r||(r=new ty,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function V0(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function U0(){return new ry([new Zm])}var ry=(()=>{class t{factories;static \u0275prov=we({token:t,providedIn:"root",factory:U0});constructor(n){this.factories=n}static create(n,r){if(r!=null){let i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:()=>{let r=he(t,{optional:!0,skipSelf:!0});return t.create(n,r||U0())}}}find(n){let r=this.factories.find(i=>i.supports(n));if(r!=null)return r;throw new Ee(901,!1)}}return t})();function H0(t){let{rootComponent:e,appProviders:n,platformProviders:r,platformRef:i}=t;ut(8);try{let s=i?.injector??WO(r),o=[Km({}),{provide:Ti,useExisting:O0},xI,...n||[]],a=new Cc({providers:o,parent:s,debugName:"",runEnvironmentInitializers:!1});return $O({r3Injector:a.injector,platformInjector:s,rootComponent:e})}catch(s){return Promise.reject(s)}finally{ut(9)}}var W0=null;function Zr(){return W0}function iy(t){W0??=t}var Uc=class{},sy=(()=>{class t{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>he(G0),providedIn:"platform"})}return t})();var G0=(()=>{class t extends sy{_location;_history;_doc=he(en);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zr().getBaseHref(this._doc)}onPopState(n){let r=Zr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){let r=Zr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function K0(t,e){return t?e?t.endsWith("/")?e.startsWith("/")?t+e.slice(1):t+e:e.startsWith("/")?t+e:`${t}/${e}`:t:e}function z0(t){let e=t.search(/#|\?|$/);return t[e-1]==="/"?t.slice(0,e-1)+t.slice(e):t}function Fi(t){return t&&t[0]!=="?"?`?${t}`:t}var Wd=(()=>{class t{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>he(X0),providedIn:"root"})}return t})(),Y0=new Te(""),X0=(()=>{class t extends Wd{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??he(en).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return K0(this._baseHref,n)}path(n=!1){let r=this._platformLocation.pathname+Fi(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+Fi(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+Fi(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||t)(Pe(sy),Pe(Y0,8))};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),qo=(()=>{class t{_subject=new bt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;let r=this._locationStrategy.getBaseHref();this._basePath=JO(z0(q0(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Fi(r))}normalize(n){return t.stripTrailingSlash(ZO(this._basePath,q0(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Fi(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Fi(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Fi;static joinWithSlash=K0;static stripTrailingSlash=z0;static \u0275fac=function(r){return new(r||t)(Pe(Wd))};static \u0275prov=we({token:t,factory:()=>QO(),providedIn:"root"})}return t})();function QO(){return new qo(Pe(Wd))}function ZO(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function q0(t){return t.replace(/\/index.html$/,"")}function JO(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}var Gd=class{$implicit;ngForOf;index;count;constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Yd=(()=>{class t{_viewContainer;_template;_differs;set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(n,r,i){this._viewContainer=n,this._template=r,this._differs=i}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){let n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){let r=this._viewContainer;n.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Gd(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),Q0(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);Q0(s,i)})}static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||t)(qn(Kr),qn(Oi),qn(ry))};static \u0275dir=$o({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return t})();function Q0(t,e){t.context.$implicit=e.item}var oy=(()=>{class t{_viewContainer;_context=new Kd;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(n,r){this._viewContainer=n,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){Z0(n,!1),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){Z0(n,!1),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||t)(qn(Kr),qn(Oi))};static \u0275dir=$o({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return t})(),Kd=class{$implicit=null;ngIf=null};function Z0(t,e){if(t&&!t.createEmbeddedView)throw new Ee(2020,!1)}var Xd=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Bo({type:t});static \u0275inj=ps({})}return t})();function ay(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var jc=class{};var J0="browser";var Bc=class{_doc;constructor(e){this._doc=e}manager},Qd=(()=>{class t extends Bc{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i,s){return n.addEventListener(r,i,s),()=>this.removeEventListener(n,r,i,s)}removeEventListener(n,r,i,s){return n.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||t)(Pe(en))};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})(),Jd=new Te(""),hy=(()=>{class t{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(o=>{o.manager=this});let i=n.filter(o=>!(o instanceof Qd));this._plugins=i.slice().reverse();let s=n.find(o=>o instanceof Qd);s&&this._plugins.push(s)}addEventListener(n,r,i,s){return this._findPluginFor(r).addEventListener(n,r,i,s)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(s=>s.supports(n)),!r)throw new Ee(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||t)(Pe(Jd),Pe(nt))};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})(),cy="ng-app-id";function eA(t){for(let e of t)e.remove()}function tA(t,e){let n=e.createElement("style");return n.textContent=t,n}function t1(t,e,n,r){let i=t.head?.querySelectorAll(`style[${cy}="${e}"],link[${cy}="${e}"]`);if(i)for(let s of i)s.removeAttribute(cy),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&n.set(s.textContent,{usage:0,elements:[s]})}function uy(t,e){let n=e.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",t),n}var fy=(()=>{class t{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(n,r,i,s={}){this.doc=n,this.appId=r,this.nonce=i,t1(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(let i of n)this.addUsage(i,this.inline,tA);r?.forEach(i=>this.addUsage(i,this.external,uy))}removeStyles(n,r){for(let i of n)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(n,r,i){let s=r.get(n);s?s.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(n,this.doc)))})}removeUsage(n,r){let i=r.get(n);i&&(i.usage--,i.usage<=0&&(eA(i.elements),r.delete(n)))}ngOnDestroy(){for(let[,{elements:n}]of[...this.inline,...this.external])eA(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(n,tA(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(n,uy(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),n.appendChild(r)}static \u0275fac=function(r){return new(r||t)(Pe(en),Pe(Rd),Pe(xd,8),Pe(Cs))};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})(),ly={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},py=/%COMP%/g;var rA="%COMP%",n1=`_nghost-${rA}`,r1=`_ngcontent-${rA}`,i1=!0,s1=new Te("",{providedIn:"root",factory:()=>i1});function o1(t){return r1.replace(py,t)}function a1(t){return n1.replace(py,t)}function iA(t,e){return e.map(n=>n.replace(py,t))}var gy=(()=>{class t{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(n,r,i,s,o,a,c=null,l=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=a,this.nonce=c,this.tracingService=l,this.platformIsServer=!1,this.defaultRenderer=new $c(n,o,a,this.platformIsServer,this.tracingService)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(n,r);return i instanceof Zd?i.applyToHost(n):i instanceof Hc&&i.applyStyles(),i}getOrCreateRenderer(n,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer,f=this.tracingService;switch(r.encapsulation){case Gr.Emulated:s=new Zd(c,l,r,this.appId,d,o,a,h,f);break;case Gr.ShadowDom:return new dy(c,l,n,r,o,a,this.nonce,h,f);default:s=new Hc(c,l,r,d,o,a,h,f);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||t)(Pe(hy),Pe(fy),Pe(Rd),Pe(s1),Pe(en),Pe(nt),Pe(xd),Pe(Rc,8))};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})(),$c=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,n,r,i,s){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,n){return n?this.doc.createElementNS(ly[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(nA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(nA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){n.remove()}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Ee(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=ly[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=ly[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(br.DashCase|br.Important)?e.style.setProperty(n,r,i&br.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&br.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r,i){if(typeof e=="string"&&(e=Zr().getGlobalEventTarget(this.doc,e),!e))throw new Ee(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,n,s)),this.eventManager.addEventListener(e,n,s,i)}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;e(n)===!1&&n.preventDefault()}}};function nA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var dy=class extends $c{sharedStylesHost;hostEl;shadowRoot;constructor(e,n,r,i,s,o,a,c,l){super(e,s,o,c,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=i.styles;d=iA(i.id,d);for(let f of d){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=f,this.shadowRoot.appendChild(p)}let h=i.getExternalStyles?.();if(h)for(let f of h){let p=uy(f,s);a&&p.setAttribute("nonce",a),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Hc=class extends $c{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,n,r,i,s,o,a,c,l){super(e,s,o,a,c),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i;let d=r.styles;this.styles=l?iA(l,d):d,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Oo.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Zd=class extends Hc{contentAttr;hostAttr;constructor(e,n,r,i,s,o,a,c,l){let d=i+"-"+r.id;super(e,n,r,s,o,a,c,l,d),this.contentAttr=o1(d),this.hostAttr=a1(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}};var eh=class t extends Uc{supportsDOMEvents=!0;static makeCurrent(){iy(new t)}onAndCancel(e,n,r,i){return e.addEventListener(n,r,i),()=>{e.removeEventListener(n,r,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=c1();return n==null?null:l1(n)}resetBaseElement(){zc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ay(document.cookie,e)}},zc=null;function c1(){return zc=zc||document.head.querySelector("base"),zc?zc.getAttribute("href"):null}function l1(t){return new URL(t,document.baseURI).pathname}var u1=(()=>{class t{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})(),sA=["alt","control","meta","shift"],d1={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},h1={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},oA=(()=>{class t extends Bc{constructor(n){super(n)}supports(n){return t.parseEventName(n)!=null}addEventListener(n,r,i,s){let o=t.parseEventName(r),a=t.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zr().onAndCancel(n,o.domEventName,a,s))}static parseEventName(n){let r=n.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=t._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),sA.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(n,r){let i=d1[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),sA.forEach(o=>{if(o!==i){let a=h1[o];a(n)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return n==="esc"?"escape":n}static \u0275fac=function(r){return new(r||t)(Pe(en))};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})();function my(t,e,n){let r=me({rootComponent:t,platformRef:n?.platformRef},f1(e));return H0(r)}function f1(t){return{appProviders:[...v1,...t?.providers??[]],platformProviders:y1}}function p1(){eh.makeCurrent()}function g1(){return new gr}function m1(){return dm(document),document}var y1=[{provide:Cs,useValue:J0},{provide:Pd,useValue:p1,multi:!0},{provide:en,useFactory:m1}];var v1=[{provide:lc,useValue:"root"},{provide:gr,useFactory:g1},{provide:Jd,useClass:Qd,multi:!0,deps:[en]},{provide:Jd,useClass:oA,multi:!0,deps:[en]},gy,fy,hy,{provide:Ts,useExisting:gy},{provide:jc,useClass:u1},[]];var aA=(()=>{class t{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(r){return new(r||t)(Pe(en))};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Le="primary",rl=Symbol("RouteTitle"),by=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Qo(t){return new by(t)}function E1(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function b1(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Tr(t[n],e[n]))return!1;return!0}function Tr(t,e){let n=t?wy(t):void 0,r=e?wy(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!gA(t[i],e[i]))return!1;return!0}function wy(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function gA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function mA(t){return t.length>0?t[t.length-1]:null}function ti(t){return Pp(t)?t:Ho(t)?lt(Promise.resolve(t)):Se(t)}var w1={exact:vA,subset:_A},yA={exact:I1,subset:T1,ignored:()=>!0};function cA(t,e,n){return w1[n.paths](t.root,e.root,n.matrixParams)&&yA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function I1(t,e){return Tr(t,e)}function vA(t,e,n){if(!Ps(t.segments,e.segments)||!rh(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!vA(t.children[r],e.children[r],n))return!1;return!0}function T1(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>gA(t[n],e[n]))}function _A(t,e,n){return EA(t,e,e.segments,n)}function EA(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Ps(i,n)||e.hasChildren()||!rh(i,n,r))}else if(t.segments.length===n.length){if(!Ps(t.segments,n)||!rh(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!_A(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ps(t.segments,i)||!rh(t.segments,i,r)||!t.children[Le]?!1:EA(t.children[Le],e,s,r)}}function rh(t,e,n){return e.every((r,i)=>yA[n](t[i].parameters,r.parameters))}var ei=class{root;queryParams;fragment;_queryParamMap;constructor(e=new st([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Qo(this.queryParams),this._queryParamMap}toString(){return C1.serialize(this)}},st=class{segments;children;parent=null;constructor(e,n){this.segments=e,this.children=n,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ih(this)}},Rs=class{path;parameters;_parameterMap;constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Qo(this.parameters),this._parameterMap}toString(){return wA(this)}};function A1(t,e){return Ps(t,e)&&t.every((n,r)=>Tr(n.parameters,e[r].parameters))}function Ps(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function S1(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===Le&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==Le&&(n=n.concat(e(i,r)))}),n}var mh=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>new Zo,providedIn:"root"})}return t})(),Zo=class{parse(e){let n=new Ty(e);return new ei(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${qc(e.root,!0)}`,r=P1(e.queryParams),i=typeof e.fragment=="string"?`#${D1(e.fragment)}`:"";return`${n}${r}${i}`}},C1=new Zo;function ih(t){return t.segments.map(e=>wA(e)).join("/")}function qc(t,e){if(!t.hasChildren())return ih(t);if(e){let n=t.children[Le]?qc(t.children[Le],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==Le&&r.push(`${i}:${qc(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=S1(t,(r,i)=>i===Le?[qc(t.children[Le],!1)]:[`${i}:${qc(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[Le]!=null?`${ih(t)}/${n[0]}`:`${ih(t)}/(${n.join("//")})`}}function bA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function th(t){return bA(t).replace(/%3B/gi,";")}function D1(t){return encodeURI(t)}function Iy(t){return bA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function sh(t){return decodeURIComponent(t)}function lA(t){return sh(t.replace(/\+/g,"%20"))}function wA(t){return`${Iy(t.path)}${R1(t.parameters)}`}function R1(t){return Object.entries(t).map(([e,n])=>`;${Iy(e)}=${Iy(n)}`).join("")}function P1(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${th(n)}=${th(i)}`).join("&"):`${th(n)}=${th(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var x1=/^[^\/()?;#]+/;function yy(t){let e=t.match(x1);return e?e[0]:""}var M1=/^[^\/()?;=#]+/;function k1(t){let e=t.match(M1);return e?e[0]:""}var N1=/^[^=?&#]+/;function O1(t){let e=t.match(N1);return e?e[0]:""}var F1=/^[^&#]+/;function L1(t){let e=t.match(F1);return e?e[0]:""}var Ty=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new st([],{}):new st([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[Le]=new st(e,n)),r}parseSegment(){let e=yy(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Ee(4009,!1);return this.capture(e),new Rs(sh(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=k1(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=yy(this.remaining);i&&(r=i,this.capture(r))}e[sh(n)]=sh(r)}parseQueryParam(e){let n=O1(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=L1(this.remaining);o&&(r=o,this.capture(r))}let i=lA(n),s=lA(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=yy(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Ee(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Le);let o=this.parseChildren();n[s??Le]=Object.keys(o).length===1&&o[Le]?o[Le]:new st([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Ee(4011,!1)}};function IA(t){return t.segments.length>0?new st([],{[Le]:t}):t}function TA(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=TA(i);if(r===Le&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new st(t.segments,e);return V1(n)}function V1(t){if(t.numberOfChildren===1&&t.children[Le]){let e=t.children[Le];return new st(t.segments.concat(e.segments),e.children)}return t}function Jo(t){return t instanceof ei}function U1(t,e,n=null,r=null){let i=AA(t);return SA(i,e,n,r)}function AA(t){let e;function n(s){let o={};for(let c of s.children){let l=n(c);o[c.outlet]=l}let a=new st(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=IA(r);return e??i}function SA(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return vy(i,i,i,n,r);let s=j1(e);if(s.toRoot())return vy(i,i,new st([],{}),n,r);let o=B1(s,i,t),a=o.processChildren?Gc(o.segmentGroup,o.index,s.commands):DA(o.segmentGroup,o.index,s.commands);return vy(i,o.segmentGroup,a,n,r)}function oh(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Xc(t){return typeof t=="object"&&t!=null&&t.outlets}function vy(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;t===e?o=n:o=CA(t,e,n);let a=IA(TA(o));return new ei(a,s,i)}function CA(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=CA(s,e,n)}),new st(t.segments,r)}var ah=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&oh(r[0]))throw new Ee(4003,!1);let i=r.find(Xc);if(i&&i!==mA(r))throw new Ee(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function j1(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new ah(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new ah(n,e,r)}var Ko=class{segmentGroup;processChildren;index;constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function B1(t,e,n){if(t.isAbsolute)return new Ko(e,!0,0);if(!n)return new Ko(e,!1,NaN);if(n.parent===null)return new Ko(n,!0,0);let r=oh(t.commands[0])?0:1,i=n.segments.length-1+r;return $1(n,i,t.numberOfDoubleDots)}function $1(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Ee(4005,!1);i=r.segments.length}return new Ko(r,!1,i-s)}function H1(t){return Xc(t[0])?t[0].outlets:{[Le]:t}}function DA(t,e,n){if(t??=new st([],{}),t.segments.length===0&&t.hasChildren())return Gc(t,e,n);let r=z1(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new st(t.segments.slice(0,r.pathIndex),{});return s.children[Le]=new st(t.segments.slice(r.pathIndex),t.children),Gc(s,0,i)}else return r.match&&i.length===0?new st(t.segments,{}):r.match&&!t.hasChildren()?Ay(t,e,n):r.match?Gc(t,0,i):Ay(t,e,n)}function Gc(t,e,n){if(n.length===0)return new st(t.segments,{});{let r=H1(n),i={};if(Object.keys(r).some(s=>s!==Le)&&t.children[Le]&&t.numberOfChildren===1&&t.children[Le].segments.length===0){let s=Gc(t.children[Le],e,n);return new st(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=DA(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new st(t.segments,i)}}function z1(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Xc(a))break;let c=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!dA(c,l,o))return s;r+=2}else{if(!dA(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Ay(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Xc(s)){let c=q1(s.outlets);return new st(r,c)}if(i===0&&oh(n[0])){let c=t.segments[e];r.push(new Rs(c.path,uA(n[0]))),i++;continue}let o=Xc(s)?s.outlets[Le]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&oh(a)?(r.push(new Rs(o,uA(a))),i+=2):(r.push(new Rs(o,{})),i++)}return new st(r,{})}function q1(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Ay(new st([],{}),0,r))}),e}function uA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function dA(t,e,n){return t==n.path&&Tr(e,n.parameters)}var Kc="imperative",tn=(function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t})(tn||{}),Kn=class{id;url;constructor(e,n){this.id=e,this.url=n}},ea=class extends Kn{type=tn.NavigationStart;navigationTrigger;restoredState;constructor(e,n,r="imperative",i=null){super(e,n),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Li=class extends Kn{urlAfterRedirects;type=tn.NavigationEnd;constructor(e,n,r){super(e,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},An=(function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t[t.Aborted=4]="Aborted",t})(An||{}),ch=(function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t})(ch||{}),Jr=class extends Kn{reason;code;type=tn.NavigationCancel;constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Vi=class extends Kn{reason;code;type=tn.NavigationSkipped;constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i}},Qc=class extends Kn{error;target;type=tn.NavigationError;constructor(e,n,r,i){super(e,n),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},lh=class extends Kn{urlAfterRedirects;state;type=tn.RoutesRecognized;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Sy=class extends Kn{urlAfterRedirects;state;type=tn.GuardsCheckStart;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cy=class extends Kn{urlAfterRedirects;state;shouldActivate;type=tn.GuardsCheckEnd;constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Dy=class extends Kn{urlAfterRedirects;state;type=tn.ResolveStart;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ry=class extends Kn{urlAfterRedirects;state;type=tn.ResolveEnd;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Py=class{route;type=tn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},xy=class{route;type=tn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},My=class{snapshot;type=tn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ky=class{snapshot;type=tn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ny=class{snapshot;type=tn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Oy=class{snapshot;type=tn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Zc=class{},ta=class{url;navigationBehaviorOptions;constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}};function W1(t){return!(t instanceof Zc)&&!(t instanceof ta)}function G1(t,e){return t.providers&&!t._injector&&(t._injector=xc(t.providers,e,`Route: ${t.path}`)),t._injector??e}function ar(t){return t.outlet||Le}function K1(t,e){let n=t.filter(r=>ar(r)===e);return n.push(...t.filter(r=>ar(r)!==e)),n}function ra(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var Fy=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ra(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new il(this.rootInjector)}},il=(()=>{class t{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,r){let i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){let r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new Fy(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(r){return new(r||t)(Pe(Bt))};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),uh=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=Ly(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=Ly(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=Vy(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Vy(e,this._root).map(n=>n.value)}};function Ly(t,e){if(t===e.value)return e;for(let n of e.children){let r=Ly(t,n);if(r)return r}return null}function Vy(t,e){if(t===e.value)return[e];for(let n of e.children){let r=Vy(t,n);if(r.length)return r.unshift(e),r}return[]}var kn=class{value;children;constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Go(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var dh=class extends uh{snapshot;constructor(e,n){super(e),this.snapshot=n,Gy(this,e)}toString(){return this.snapshot.toString()}};function RA(t){let e=Y1(t),n=new St([new Rs("",{})]),r=new St({}),i=new St({}),s=new St({}),o=new St(""),a=new xs(n,r,s,o,i,Le,t,e.root);return a.snapshot=e.root,new dh(new kn(a,[]),e)}function Y1(t){let e={},n={},r={},s=new Yo([],e,r,"",n,Le,t,null,{});return new fh("",new kn(s,[]))}var xs=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Me(l=>l[rl]))??Se(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Me(e=>Qo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Me(e=>Qo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function hh(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:me(me({},e.params),t.params),data:me(me({},e.data),t.data),resolve:me(me(me(me({},t.data),e.data),i?.data),t._resolvedData)}:r={params:me({},t.params),data:me({},t.data),resolve:me(me({},t.data),t._resolvedData??{})},i&&xA(i)&&(r.resolve[rl]=i.title),r}var Yo=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[rl]}constructor(e,n,r,i,s,o,a,c,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Qo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Qo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},fh=class extends uh{url;constructor(e,n){super(n),this.url=e,Gy(this,n)}toString(){return PA(this._root)}};function Gy(t,e){e.value._routerState=t,e.children.forEach(n=>Gy(t,n))}function PA(t){let e=t.children.length>0?` { ${t.children.map(PA).join(", ")} } `:"";return`${t.value}${e}`}function _y(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Tr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Tr(e.params,n.params)||t.paramsSubject.next(n.params),b1(e.url,n.url)||t.urlSubject.next(n.url),Tr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Uy(t,e){let n=Tr(t.params,e.params)&&A1(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||Uy(t.parent,e.parent))}function xA(t){return typeof t.title=="string"||t.title===null}var X1=new Te(""),MA=(()=>{class t{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Le;activateEvents=new gn;deactivateEvents=new gn;attachEvents=new gn;detachEvents=new gn;routerOutletData=$0();parentContexts=he(il);location=he(Kr);changeDetector=he(ny);inputBinder=he(yh,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){let{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ee(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ee(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ee(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Ee(4013,!1);this._activatedRoute=n;let i=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new jy(n,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||t)};static \u0275dir=$o({type:t,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Cd]})}return t})(),jy=class{route;childContexts;parent;outletData;constructor(e,n,r,i){this.route=e,this.childContexts=n,this.parent=r,this.outletData=i}get(e,n){return e===xs?this.route:e===il?this.childContexts:e===X1?this.outletData:this.parent.get(e,n)}},yh=new Te("");var kA=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=Mc({type:t,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Xr(0,"router-outlet")},dependencies:[MA],encapsulation:2})}return t})();function Ky(t){let e=t.children&&t.children.map(Ky),n=e?Ke(me({},t),{children:e}):me({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Le&&(n.component=kA),n}function Q1(t,e,n){let r=Jc(t,e._root,n?n._root:void 0);return new dh(r,e)}function Jc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=Z1(t,e,n);return new kn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Jc(t,a)),o}}let r=J1(e.value),i=e.children.map(s=>Jc(t,s));return new kn(r,i)}}function Z1(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Jc(t,r,i);return Jc(t,r)})}function J1(t){return new xs(new St(t.url),new St(t.params),new St(t.queryParams),new St(t.fragment),new St(t.data),t.outlet,t.component,t)}var el=class{redirectTo;navigationBehaviorOptions;constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}},NA="ngNavigationCancelingError";function ph(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Jo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=OA(!1,An.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function OA(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[NA]=!0,n.cancellationCode=e,n}function eF(t){return FA(t)&&Jo(t.url)}function FA(t){return!!t&&t[NA]}var tF=(t,e,n,r)=>Me(i=>(new By(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),By=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),_y(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Go(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Go(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Go(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Go(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Oy(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ky(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(_y(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),_y(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},gh=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Xo=class{component;route;constructor(e,n){this.component=e,this.route=n}};function nF(t,e,n){let r=t._root,i=e?e._root:null;return Wc(r,i,n,[r.value])}function rF(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function ia(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!Xp(t)?t:e.get(t):r}function Wc(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Go(e);return t.children.forEach(o=>{iF(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Yc(a,n.getContext(o),i)),i}function iF(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=sF(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new gh(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Wc(t,e,a?a.children:null,r,i):Wc(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Xo(a.outlet.component,o))}else o&&Yc(e,a,i),i.canActivateChecks.push(new gh(r)),s.component?Wc(t,null,a?a.children:null,r,i):Wc(t,null,n,r,i);return i}function sF(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ps(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ps(t.url,e.url)||!Tr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Uy(t,e)||!Tr(t.queryParams,e.queryParams);case"paramsChange":default:return!Uy(t,e)}}function Yc(t,e,n){let r=Go(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Yc(o,e.children.getContext(s),n):Yc(o,null,n):Yc(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Xo(e.outlet.component,i)):n.canDeactivateChecks.push(new Xo(null,i)):n.canDeactivateChecks.push(new Xo(null,i))}function sl(t){return typeof t=="function"}function oF(t){return typeof t=="boolean"}function aF(t){return t&&sl(t.canLoad)}function cF(t){return t&&sl(t.canActivate)}function lF(t){return t&&sl(t.canActivateChild)}function uF(t){return t&&sl(t.canDeactivate)}function dF(t){return t&&sl(t.canMatch)}function LA(t){return t instanceof Br||t?.name==="EmptyError"}var nh=Symbol("INITIAL_VALUE");function na(){return mt(t=>Fu(t.map(e=>e.pipe(fn(1),Np(nh)))).pipe(Me(e=>{for(let n of e)if(n!==!0){if(n===nh)return nh;if(n===!1||hF(n))return n}return!0}),dn(e=>e!==nh),fn(1)))}function hF(t){return Jo(t)||t instanceof el}function fF(t,e){return jt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?Se(Ke(me({},n),{guardsResult:!0})):pF(o,r,i,t).pipe(jt(a=>a&&oF(a)?gF(r,s,t,e):Se(a)),Me(a=>Ke(me({},n),{guardsResult:a})))})}function pF(t,e,n,r){return lt(t).pipe(jt(i=>EF(i.component,i.route,n,e,r)),Hr(i=>i!==!0,!0))}function gF(t,e,n,r){return lt(e).pipe(_o(i=>vo(yF(i.route.parent,r),mF(i.route,r),_F(t,i.path,n),vF(t,i.route,n))),Hr(i=>i!==!0,!0))}function mF(t,e){return t!==null&&e&&e(new Ny(t)),Se(!0)}function yF(t,e){return t!==null&&e&&e(new My(t)),Se(!0)}function vF(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Se(!0);let i=r.map(s=>nc(()=>{let o=ra(e)??n,a=ia(s,o),c=cF(a)?a.canActivate(e,t):$t(o,()=>a(e,t));return ti(c).pipe(Hr())}));return Se(i).pipe(na())}function _F(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>rF(o)).filter(o=>o!==null).map(o=>nc(()=>{let a=o.guards.map(c=>{let l=ra(o.node)??n,d=ia(c,l),h=lF(d)?d.canActivateChild(r,t):$t(l,()=>d(r,t));return ti(h).pipe(Hr())});return Se(a).pipe(na())}));return Se(s).pipe(na())}function EF(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Se(!0);let o=s.map(a=>{let c=ra(e)??i,l=ia(a,c),d=uF(l)?l.canDeactivate(t,e,n,r):$t(c,()=>l(t,e,n,r));return ti(d).pipe(Hr())});return Se(o).pipe(na())}function bF(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return Se(!0);let s=i.map(o=>{let a=ia(o,t),c=aF(a)?a.canLoad(e,n):$t(t,()=>a(e,n));return ti(c)});return Se(s).pipe(na(),VA(r))}function VA(t){return wp(Mt(e=>{if(typeof e!="boolean")throw ph(t,e)}),Me(e=>e===!0))}function wF(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return Se(!0);let s=i.map(o=>{let a=ia(o,t),c=dF(a)?a.canMatch(e,n):$t(t,()=>a(e,n));return ti(c)});return Se(s).pipe(na(),VA(r))}var tl=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},nl=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Wo(t){return jr(new tl(t))}function IF(t){return jr(new Ee(4e3,!1))}function TF(t){return jr(OA(!1,An.GuardRejected))}var $y=class{urlSerializer;urlTree;constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Se(r);if(i.numberOfChildren>1||!i.children[Le])return IF(`${e.redirectTo}`);i=i.children[Le]}}applyRedirectCommands(e,n,r,i,s){return AF(n,i,s).pipe(Me(o=>{if(o instanceof ei)throw new nl(o);let a=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,r);if(o[0]==="/")throw new nl(a);return a}))}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new ei(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new st(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new Ee(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}};function AF(t,e,n){if(typeof t=="string")return Se(t);let r=t,{queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,params:l,data:d,title:h}=e;return ti($t(n,()=>r({params:l,data:d,queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,title:h})))}var Hy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function SF(t,e,n,r,i){let s=UA(t,e,n);return s.matched?(r=G1(e,r),wF(r,e,n,i).pipe(Me(o=>o===!0?s:me({},Hy)))):Se(s)}function UA(t,e,n){if(e.path==="**")return CF(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?me({},Hy):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||E1)(n,t,e);if(!i)return me({},Hy);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?me(me({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function CF(t){return{matched:!0,parameters:t.length>0?mA(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function hA(t,e,n,r){return n.length>0&&PF(t,n,r)?{segmentGroup:new st(e,RF(r,new st(n,t.children))),slicedSegments:[]}:n.length===0&&xF(t,n,r)?{segmentGroup:new st(t.segments,DF(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new st(t.segments,t.children),slicedSegments:n}}function DF(t,e,n,r){let i={};for(let s of n)if(vh(t,e,s)&&!r[ar(s)]){let o=new st([],{});i[ar(s)]=o}return me(me({},r),i)}function RF(t,e){let n={};n[Le]=e;for(let r of t)if(r.path===""&&ar(r)!==Le){let i=new st([],{});n[ar(r)]=i}return n}function PF(t,e,n){return n.some(r=>vh(t,e,r)&&ar(r)!==Le)}function xF(t,e,n){return n.some(r=>vh(t,e,r))}function vh(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function MF(t,e,n){return e.length===0&&!t.children[n]}var zy=class{};function kF(t,e,n,r,i,s,o="emptyOnly"){return new qy(t,e,n,r,i,o,s).recognize()}var NF=31,qy=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new $y(this.urlSerializer,this.urlTree)}noMatchError(e){return new Ee(4002,`'${e.segmentGroup}'`)}recognize(){let e=hA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Me(({children:n,rootSnapshot:r})=>{let i=new kn(r,n),s=new fh("",i),o=U1(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let n=new Yo([],Object.freeze({}),Object.freeze(me({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Le,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Le,n).pipe(Me(r=>({children:r,rootSnapshot:n})),hn(r=>{if(r instanceof nl)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof tl?this.noMatchError(r):r}))}processSegmentGroup(e,n,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r,s):this.processSegment(e,n,r,r.segments,i,!0,s).pipe(Me(o=>o instanceof kn?[o]:[]))}processChildren(e,n,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return lt(s).pipe(_o(o=>{let a=r.children[o],c=K1(n,o);return this.processSegmentGroup(e,c,a,o,i)}),kp((o,a)=>(o.push(...a),o)),wi(null),Mp(),jt(o=>{if(o===null)return Wo(r);let a=jA(o);return OF(a),Se(a)}))}processSegment(e,n,r,i,s,o,a){return lt(n).pipe(_o(c=>this.processSegmentAgainstRoute(c._injector??e,n,c,r,i,s,o,a).pipe(hn(l=>{if(l instanceof tl)return Se(null);throw l}))),Hr(c=>!!c),hn(c=>{if(LA(c))return MF(r,i,s)?Se(new zy):Wo(r);throw c}))}processSegmentAgainstRoute(e,n,r,i,s,o,a,c){return ar(r)!==o&&(o===Le||!vh(i,s,r))?Wo(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o,c):Wo(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o,a){let{matched:c,parameters:l,consumedSegments:d,positionalParamSegments:h,remainingSegments:f}=UA(n,i,s);if(!c)return Wo(n);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>NF&&(this.allowRedirects=!1));let p=new Yo(s,l,Object.freeze(me({},this.urlTree.queryParams)),this.urlTree.fragment,fA(i),ar(i),i.component??i._loadedComponent??null,i,pA(i)),m=hh(p,a,this.paramsInheritanceStrategy);return p.params=Object.freeze(m.params),p.data=Object.freeze(m.data),this.applyRedirects.applyRedirectCommands(d,i.redirectTo,h,p,e).pipe(mt(v=>this.applyRedirects.lineralizeSegments(i,v)),jt(v=>this.processSegment(e,r,n,v.concat(f),o,!1,a)))}matchSegmentAgainstRoute(e,n,r,i,s,o){let a=SF(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),a.pipe(mt(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(mt(({routes:l})=>{let d=r._loadedInjector??e,{parameters:h,consumedSegments:f,remainingSegments:p}=c,m=new Yo(f,h,Object.freeze(me({},this.urlTree.queryParams)),this.urlTree.fragment,fA(r),ar(r),r.component??r._loadedComponent??null,r,pA(r)),g=hh(m,o,this.paramsInheritanceStrategy);m.params=Object.freeze(g.params),m.data=Object.freeze(g.data);let{segmentGroup:v,slicedSegments:E}=hA(n,f,p,l);if(E.length===0&&v.hasChildren())return this.processChildren(d,l,v,m).pipe(Me(O=>new kn(m,O)));if(l.length===0&&E.length===0)return Se(new kn(m,[]));let A=ar(r)===s;return this.processSegment(d,l,v,E,A?Le:s,!0,m).pipe(Me(O=>new kn(m,O instanceof kn?[O]:[])))}))):Wo(n)))}getChildConfig(e,n,r){return n.children?Se({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?Se({routes:n._loadedRoutes,injector:n._loadedInjector}):bF(e,n,r,this.urlSerializer).pipe(jt(i=>i?this.configLoader.loadChildren(e,n).pipe(Mt(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):TF(n))):Se({routes:[],injector:e})}};function OF(t){t.sort((e,n)=>e.value.outlet===Le?-1:n.value.outlet===Le?1:e.value.outlet.localeCompare(n.value.outlet))}function FF(t){let e=t.value.routeConfig;return e&&e.path===""}function jA(t){let e=[],n=new Set;for(let r of t){if(!FF(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=jA(r.children);e.push(new kn(r.value,i))}return e.filter(r=>!n.has(r))}function fA(t){return t.data||{}}function pA(t){return t.resolve||{}}function LF(t,e,n,r,i,s){return jt(o=>kF(t,e,n,r,o.extractedUrl,i,s).pipe(Me(({state:a,tree:c})=>Ke(me({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function VF(t,e){return jt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Se(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of BA(c))o.add(l);let a=0;return lt(o).pipe(_o(c=>s.has(c)?UF(c,r,t,e):(c.data=hh(c,c.parent,t).resolve,Se(void 0))),Mt(()=>a++),Eo(1),jt(c=>a===o.size?Se(n):_n))})}function BA(t){let e=t.children.map(n=>BA(n)).flat();return[t,...e]}function UF(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!xA(i)&&(s[rl]=i.title),nc(()=>(t.data=hh(t,t.parent,n).resolve,jF(s,t,e,r).pipe(Me(o=>(t._resolvedData=o,t.data=me(me({},t.data),o),null)))))}function jF(t,e,n,r){let i=wy(t);if(i.length===0)return Se({});let s={};return lt(i).pipe(jt(o=>BF(t[o],e,n,r).pipe(Hr(),Mt(a=>{if(a instanceof el)throw ph(new Zo,a);s[o]=a}))),Eo(1),Me(()=>s),hn(o=>LA(o)?_n:jr(o)))}function BF(t,e,n,r){let i=ra(e)??r,s=ia(t,i),o=s.resolve?s.resolve(e,n):$t(i,()=>s(e,n));return ti(o)}function Ey(t){return mt(e=>{let n=t(e);return n?lt(n).pipe(Me(()=>e)):Se(e)})}var $A=(()=>{class t{buildTitle(n){let r,i=n.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===Le);return r}getResolvedTitleForRoute(n){return n.data[rl]}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>he($F),providedIn:"root"})}return t})(),$F=(()=>{class t extends $A{title;constructor(n){super(),this.title=n}updateTitle(n){let r=this.buildTitle(n);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||t)(Pe(aA))};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),_h=new Te("",{providedIn:"root",factory:()=>({})}),Eh=new Te(""),HA=(()=>{class t{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=he(Gm);loadComponent(n,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Se(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=ti($t(n,()=>r.loadComponent())).pipe(Me(zA),mt(qA),Mt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),rc(()=>{this.componentLoaders.delete(r)})),s=new po(i,()=>new bt).pipe(fo());return this.componentLoaders.set(r,s),s}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Se({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=HF(r,this.compiler,n,this.onLoadEndListener).pipe(rc(()=>{this.childrenLoaders.delete(r)})),o=new po(s,()=>new bt).pipe(fo());return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function HF(t,e,n,r){return ti($t(n,()=>t.loadChildren())).pipe(Me(zA),mt(qA),jt(i=>i instanceof Ld||Array.isArray(i)?Se(i):lt(e.compileModuleAsync(i))),Me(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Eh,[],{optional:!0,self:!0}).flat()),{routes:o.map(Ky),injector:s}}))}function zF(t){return t&&typeof t=="object"&&"default"in t}function zA(t){return zF(t)?t.default:t}function qA(t){return Se(t)}var Yy=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>he(qF),providedIn:"root"})}return t})(),qF=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),WA=new Te("");var GA=new Te(""),KA=(()=>{class t{currentNavigation=Po(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new bt;transitionAbortWithErrorSubject=new bt;configLoader=he(HA);environmentInjector=he(Bt);destroyRef=he(ws);urlSerializer=he(mh);rootContexts=he(il);location=he(qo);inputBindingEnabled=he(yh,{optional:!0})!==null;titleStrategy=he($A);options=he(_h,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=he(Yy);createViewTransition=he(WA,{optional:!0});navigationErrorHandler=he(GA,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>Se(void 0);rootComponentType=null;destroyed=!1;constructor(){let n=i=>this.events.next(new Py(i)),r=i=>this.events.next(new xy(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=n,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(n){let r=++this.navigationId;Qr(()=>{this.transitions?.next(Ke(me({},n),{extractedUrl:this.urlHandlingStrategy.extract(n.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:r}))})}setupNavigations(n){return this.transitions=new St(null),this.transitions.pipe(dn(r=>r!==null),mt(r=>{let i=!1;return Se(r).pipe(mt(s=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",An.SupersededByNewNavigation),_n;this.currentTransition=r,this.currentNavigation.set({id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,targetBrowserUrl:typeof s.extras.browserUrl=="string"?this.urlSerializer.parse(s.extras.browserUrl):s.extras.browserUrl,trigger:s.source,extras:s.extras,previousNavigation:this.lastSuccessfulNavigation?Ke(me({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>s.abortController.abort()});let o=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=s.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!o&&a!=="reload")return this.events.next(new Vi(s.id,this.urlSerializer.serialize(s.rawUrl),"",ch.IgnoredSameUrlNavigation)),s.resolve(!1),_n;if(this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return Se(s).pipe(mt(c=>(this.events.next(new ea(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?_n:Promise.resolve(c))),LF(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),Mt(c=>{r.targetSnapshot=c.targetSnapshot,r.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation.update(d=>(d.finalUrl=c.urlAfterRedirects,d));let l=new lh(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}));if(o&&this.urlHandlingStrategy.shouldProcessUrl(s.currentRawUrl)){let{id:c,extractedUrl:l,source:d,restoredState:h,extras:f}=s,p=new ea(c,this.urlSerializer.serialize(l),d,h);this.events.next(p);let m=RA(this.rootComponentType).snapshot;return this.currentTransition=r=Ke(me({},s),{targetSnapshot:m,urlAfterRedirects:l,extras:Ke(me({},f),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(g=>(g.finalUrl=l,g)),Se(r)}else return this.events.next(new Vi(s.id,this.urlSerializer.serialize(s.extractedUrl),"",ch.IgnoredByUrlHandlingStrategy)),s.resolve(!1),_n}),Mt(s=>{let o=new Sy(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(o)}),Me(s=>(this.currentTransition=r=Ke(me({},s),{guards:nF(s.targetSnapshot,s.currentSnapshot,this.rootContexts)}),r)),fF(this.environmentInjector,s=>this.events.next(s)),Mt(s=>{if(r.guardsResult=s.guardsResult,s.guardsResult&&typeof s.guardsResult!="boolean")throw ph(this.urlSerializer,s.guardsResult);let o=new Cy(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.events.next(o)}),dn(s=>s.guardsResult?!0:(this.cancelNavigationTransition(s,"",An.GuardRejected),!1)),Ey(s=>{if(s.guards.canActivateChecks.length!==0)return Se(s).pipe(Mt(o=>{let a=new Dy(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),mt(o=>{let a=!1;return Se(o).pipe(VF(this.paramsInheritanceStrategy,this.environmentInjector),Mt({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(o,"",An.NoDataFromResolver)}}))}),Mt(o=>{let a=new Ry(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}))}),Ey(s=>{let o=a=>{let c=[];if(a.routeConfig?.loadComponent){let l=ra(a)??this.environmentInjector;c.push(this.configLoader.loadComponent(l,a.routeConfig).pipe(Mt(d=>{a.component=d}),Me(()=>{})))}for(let l of a.children)c.push(...o(l));return c};return Fu(o(s.targetSnapshot.root)).pipe(wi(null),fn(1))}),Ey(()=>this.afterPreactivation()),mt(()=>{let{currentSnapshot:s,targetSnapshot:o}=r,a=this.createViewTransition?.(this.environmentInjector,s.root,o.root);return a?lt(a).pipe(Me(()=>r)):Se(r)}),Me(s=>{let o=Q1(n.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return this.currentTransition=r=Ke(me({},s),{targetRouterState:o}),this.currentNavigation.update(a=>(a.targetRouterState=o,a)),r}),Mt(()=>{this.events.next(new Zc)}),tF(this.rootContexts,n.routeReuseStrategy,s=>this.events.next(s),this.inputBindingEnabled),fn(1),Vu(new Re(s=>{let o=r.abortController.signal,a=()=>s.next();return o.addEventListener("abort",a),()=>o.removeEventListener("abort",a)}).pipe(dn(()=>!i&&!r.targetRouterState),Mt(()=>{this.cancelNavigationTransition(r,r.abortController.signal.reason+"",An.Aborted)}))),Mt({next:s=>{i=!0,this.lastSuccessfulNavigation=Qr(this.currentNavigation),this.events.next(new Li(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects))),this.titleStrategy?.updateTitle(s.targetRouterState.snapshot),s.resolve(!0)},complete:()=>{i=!0}}),Vu(this.transitionAbortWithErrorSubject.pipe(Mt(s=>{throw s}))),rc(()=>{i||this.cancelNavigationTransition(r,"",An.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),hn(s=>{if(this.destroyed)return r.resolve(!1),_n;if(i=!0,FA(s))this.events.next(new Jr(r.id,this.urlSerializer.serialize(r.extractedUrl),s.message,s.cancellationCode)),eF(s)?this.events.next(new ta(s.url,s.navigationBehaviorOptions)):r.resolve(!1);else{let o=new Qc(r.id,this.urlSerializer.serialize(r.extractedUrl),s,r.targetSnapshot??void 0);try{let a=$t(this.environmentInjector,()=>this.navigationErrorHandler?.(o));if(a instanceof el){let{message:c,cancellationCode:l}=ph(this.urlSerializer,a);this.events.next(new Jr(r.id,this.urlSerializer.serialize(r.extractedUrl),c,l)),this.events.next(new ta(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(o),s}catch(a){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(a)}}return _n}))}))}cancelNavigationTransition(n,r,i){let s=new Jr(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Qr(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return n.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function WF(t){return t!==Kc}var GF=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>he(KF),providedIn:"root"})}return t})(),Wy=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},KF=(()=>{class t extends Wy{static \u0275fac=(()=>{let n;return function(i){return(n||(n=Dd(t)))(i||t)}})();static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),YA=(()=>{class t{urlSerializer=he(mh);options=he(_h,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=he(qo);urlHandlingStrategy=he(Yy);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new ei;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:n,initialUrl:r,targetBrowserUrl:i}){let s=n!==void 0?this.urlHandlingStrategy.merge(n,r):r,o=i??s;return o instanceof ei?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:n,finalUrl:r,initialUrl:i}){r&&n?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=n):this.rawUrlTree=i}routerState=RA(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:n}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n??this.rawUrlTree)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:()=>he(YF),providedIn:"root"})}return t})(),YF=(()=>{class t extends YA{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{n(r.url,r.state,"popstate")})})}handleRouterEvent(n,r){n instanceof ea?this.updateStateMemento():n instanceof Vi?this.commitTransition(r):n instanceof lh?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof Zc?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof Jr&&n.code!==An.SupersededByNewNavigation&&n.code!==An.Redirect?this.restoreHistory(r):n instanceof Qc?this.restoreHistory(r,!0):n instanceof Li&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(n)||s){let a=this.browserPageId,c=me(me({},o),this.generateNgRouterState(i,a));this.location.replaceState(n,"",c)}else{let a=me(me({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(n,"",a)}}restoreHistory(n,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===n.finalUrl&&s===0&&(this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Dd(t)))(i||t)}})();static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function XA(t,e){t.events.pipe(dn(n=>n instanceof Li||n instanceof Jr||n instanceof Qc||n instanceof Vi),Me(n=>n instanceof Li||n instanceof Vi?0:(n instanceof Jr?n.code===An.Redirect||n.code===An.SupersededByNewNavigation:!1)?2:1),dn(n=>n!==2),fn(1)).subscribe(()=>{e()})}var XF={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},QF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Xy=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=he(Um);stateManager=he(YA);options=he(_h,{optional:!0})||{};pendingTasks=he(_r);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=he(KA);urlSerializer=he(mh);location=he(qo);urlHandlingStrategy=he(Yy);injector=he(Bt);_events=new bt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=he(GF);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=he(Eh,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!he(yh,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}eventsSubscription=new yt;subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=Qr(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Jr&&r.code!==An.Redirect&&r.code!==An.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Li)this.navigated=!0;else if(r instanceof ta){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=me({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||WF(i.source)},o);this.scheduleNavigation(a,Kc,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}W1(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Kc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r,i)=>{this.navigateToSyncWithBrowser(n,i,r)})}navigateToSyncWithBrowser(n,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=me({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(n);this.scheduleNavigation(a,r,o,s).catch(c=>{this.disposed||this.injector.get(Mn)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Qr(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Ky),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=me(me({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=i?i.snapshot:this.routerState.snapshot.root;h=AA(f)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),h=this.currentUrlTree.root}return SA(h,n,d,l??null)}navigateByUrl(n,r={skipLocationChange:!1}){let i=Jo(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Kc,null,r)}navigate(n,r={skipLocationChange:!1}){return ZF(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.console.warn(Ai(4018,!1)),this.urlSerializer.parse("/")}}isActive(n,r){let i;if(r===!0?i=me({},XF):r===!1?i=me({},QF):i=r,Jo(n))return cA(this.currentUrlTree,n,i);let s=this.parseUrl(n);return cA(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.entries(n).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(n,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((h,f)=>{a=h,c=f});let d=this.pendingTasks.add();return XA(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ZF(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new Ee(4008,!1)}var JF=new Te("");function Qy(t,...e){return wn([{provide:Eh,multi:!0,useValue:t},[],{provide:xs,useFactory:eL,deps:[Xy]},{provide:Ud,multi:!0,useFactory:tL},e.map(n=>n.\u0275providers)])}function eL(t){return t.routerState.root}function tL(){let t=he(kt);return e=>{let n=t.get(Ir);if(e!==n.components[0])return;let r=t.get(Xy),i=t.get(nL);t.get(rL)===1&&r.initialNavigation(),t.get(iL,null,{optional:!0})?.setUpPreloading(),t.get(JF,null,{optional:!0})?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var nL=new Te("",{factory:()=>new bt}),rL=new Te("",{providedIn:"root",factory:()=>1});var iL=new Te("");var QA=[];var Zy="Service workers are disabled or not supported by this browser",sa=class{serviceWorker;worker;registration;events;constructor(e,n){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=new Re(r=>r.error(new Ee(5601,!1)));else{let r=null,i=new bt;this.worker=new Re(l=>(r!==null&&l.next(r),i.subscribe(d=>l.next(d))));let s=()=>{let{controller:l}=e;l!==null&&(r=l,i.next(r))};e.addEventListener("controllerchange",s),s(),this.registration=this.worker.pipe(mt(()=>e.getRegistration().then(l=>{if(!l)throw new Ee(5601,!1);return l})));let o=new bt;this.events=o.asObservable();let a=l=>{let{data:d}=l;d?.type&&o.next(d)};e.addEventListener("message",a),n?.get(Ir,null,{optional:!0})?.onDestroy(()=>{e.removeEventListener("controllerchange",s),e.removeEventListener("message",a)})}}postMessage(e,n){return new Promise(r=>{this.worker.pipe(fn(1)).subscribe(i=>{i.postMessage(me({action:e},n)),r()})})}postMessageWithOperation(e,n,r){let i=this.waitForOperationCompleted(r),s=this.postMessage(e,n);return Promise.all([s,i]).then(([,o])=>o)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let n;return typeof e=="string"?n=r=>r.type===e:n=r=>e.includes(r.type),this.events.pipe(dn(n))}nextEventOfType(e){return this.eventsOfType(e).pipe(fn(1))}waitForOperationCompleted(e){return new Promise((n,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(dn(i=>i.nonce===e),fn(1),Me(i=>{if(i.result!==void 0)return i.result;throw new Error(i.error)})).subscribe({next:n,error:r})})}get isEnabled(){return!!this.serviceWorker}},oL=(()=>{class t{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new bt;constructor(n){if(this.sw=n,!n.isEnabled){this.messages=$r,this.notificationClicks=$r,this.notificationCloses=$r,this.pushSubscriptionChanges=$r,this.subscription=$r;return}this.messages=this.sw.eventsOfType("PUSH").pipe(Me(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(Me(i=>i.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(Me(i=>i.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(Me(i=>i.data)),this.pushManager=this.sw.registration.pipe(Me(i=>i.pushManager));let r=this.pushManager.pipe(mt(i=>i.getSubscription()));this.subscription=new Re(i=>{let s=r.subscribe(i),o=this.subscriptionChanges.subscribe(i);return()=>{s.unsubscribe(),o.unsubscribe()}})}requestSubscription(n){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(Zy));let r={userVisibleOnly:!0},i=this.decodeBase64(n.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(i.length));for(let o=0;o<i.length;o++)s[o]=i.charCodeAt(o);return r.applicationServerKey=s,new Promise((o,a)=>{this.pushManager.pipe(mt(c=>c.subscribe(r)),fn(1)).subscribe({next:c=>{this.subscriptionChanges.next(c),o(c)},error:a})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(Zy));let n=r=>{if(r===null)throw new Ee(5602,!1);return r.unsubscribe().then(i=>{if(!i)throw new Ee(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((r,i)=>{this.subscription.pipe(fn(1),mt(n)).subscribe({next:r,error:i})})}decodeBase64(n){return atob(n)}static \u0275fac=function(r){return new(r||t)(Pe(sa))};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})(),aL=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(n){if(this.sw=n,!n.isEnabled){this.versionUpdates=$r,this.unrecoverable=$r;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Zy));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let n=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:n},n).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Ee(5601,!1));let n=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:n},n)}static \u0275fac=function(r){return new(r||t)(Pe(sa))};static \u0275prov=we({token:t,factory:t.\u0275fac})}return t})();var JA=new Te("");function cL(){let t=he(ol);if(!("serviceWorker"in navigator&&t.enabled!==!1))return;let e=he(JA),n=he(nt),r=he(Ir);n.runOutsideAngular(()=>{let i=navigator.serviceWorker,s=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",s),r.onDestroy(()=>{i.removeEventListener("controllerchange",s)})}),n.runOutsideAngular(()=>{let i,{registrationStrategy:s}=t;if(typeof s=="function")i=new Promise(o=>s().subscribe(()=>o()));else{let[o,...a]=(s||"registerWhenStable:30000").split(":");switch(o){case"registerImmediately":i=Promise.resolve();break;case"registerWithDelay":i=ZA(+a[0]||0);break;case"registerWhenStable":i=Promise.race([r.whenStable(),ZA(+a[0])]);break;default:throw new Ee(5600,!1)}}i.then(()=>{r.destroyed||navigator.serviceWorker.register(e,{scope:t.scope,updateViaCache:t.updateViaCache,type:t.type}).catch(o=>console.error(Ai(5604,!1)))})})}function ZA(t){return new Promise(e=>setTimeout(e,t))}function lL(t,e){return new sa(t.enabled!==!1?navigator.serviceWorker:void 0,e)}var ol=class{enabled;updateViaCache;type;scope;registrationStrategy};function eS(t,e={}){return wn([oL,aL,{provide:JA,useValue:t},{provide:ol,useValue:e},{provide:sa,useFactory:lL,deps:[ol,kt]},Vd(cL)])}var tS=()=>{};var iS=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},uL=function(t){let e=[],n=0,r=0;for(;n<t.length;){let i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},bh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){let s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,f=(a&15)<<2|l>>6,p=l&63;c||(p=64,o||(f=64)),r.push(n[d],n[h],n[f],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(iS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):uL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){let s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;let l=i<t.length?n[t.charAt(i)]:64;++i;let h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new ev;let f=s<<2|a>>4;if(r.push(f),l!==64){let p=a<<4&240|l>>2;if(r.push(p),h!==64){let m=l<<6&192|h;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},ev=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},dL=function(t){let e=iS(t);return bh.encodeByteArray(e,!0)},cl=function(t){return dL(t).replace(/\./g,"")},wh=function(t){try{return bh.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function nv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var hL=()=>nv().__FIREBASE_DEFAULTS__,fL=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},pL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&wh(t[1]);return e&&JSON.parse(e)},Ih=()=>{try{return tS()||hL()||fL()||pL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sS=t=>{var e,n;return(n=(e=Ih())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Th=t=>{let e=sS(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},rv=()=>{var t;return(t=Ih())===null||t===void 0?void 0:t.config},oS=t=>{var e;return(e=Ih())===null||e===void 0?void 0:e[`_${t}`]};var Ms=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function Ar(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}function ll(t){return X(this,null,function*(){return(yield fetch(t,{credentials:"include"})).ok})}function Ah(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[cl(JSON.stringify(n)),cl(JSON.stringify(o)),""].join(".")}var al={};function gL(){let t={prod:[],emulator:[]};for(let e of Object.keys(al))al[e]?t.emulator.push(e):t.prod.push(e);return t}function mL(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}var nS=!1;function ul(t,e){if(typeof window>"u"||typeof document>"u"||!Ar(window.location.host)||al[t]===e||al[t]||nS)return;al[t]=e;function n(f){return`__firebase__banner__${f}`}let r="__firebase__banner",s=gL().prod.length>0;function o(){let f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function l(){let f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{nS=!0,o()},f}function d(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){let f=mL(r),p=n("text"),m=document.getElementById(p)||document.createElement("span"),g=n("learnmore"),v=document.getElementById(g)||document.createElement("a"),E=n("preprendIcon"),A=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){let O=f.element;a(O),d(v,g);let M=l();c(A,E),O.append(A,m,v,M),document.body.appendChild(O)}s?(m.innerText="Preview backend disconnected.",A.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(A.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Nn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nn())}function yL(){var t;let e=(t=Ih())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lS(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function uS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dS(){return!yL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dl(){try{return typeof indexedDB=="object"}catch{return!1}}function hS(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var vL="FirebaseError",Sn=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=vL,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cr.prototype.create)}},cr=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?_L(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Sn(i,a,r)}};function _L(t,e){return t.replace(EL,(n,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var EL=/\{\$([^}]+)}/g;function ks(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let i of n){if(!r.includes(i))return!1;let s=t[i],o=e[i];if(rS(s)&&rS(o)){if(!ks(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!n.includes(i))return!1;return!0}function rS(t){return t!==null&&typeof t=="object"}function iv(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function fS(t,e){let n=new tv(t,e);return n.subscribe.bind(n)}var tv=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");bL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Jy),i.error===void 0&&(i.error=Jy),i.complete===void 0&&(i.complete=Jy);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function bL(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Jy(){}var ete=14400*1e3;function Wt(t){return t&&t._delegate?t._delegate:t}var nn=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ns="[DEFAULT]";var sv=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new Ms;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IL(e))try{this.getOrInitializeService({instanceIdentifier:Ns})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ns){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return X(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Ns){return this.instances.has(e)}getOptions(e=Ns){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;let i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ns){return this.component?this.component.multipleInstances?e:Ns:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function wL(t){return t===Ns?void 0:t}function IL(t){return t.instantiationMode==="EAGER"}var Sh=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new sv(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var TL=[],He=(function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t})(He||{}),AL={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},SL=He.INFO,CL={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},DL=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),i=CL[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Sr=class{constructor(e){this.name=e,this._logLevel=SL,this._logHandler=DL,this._userLogHandler=null,TL.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}};var RL=(t,e)=>e.some(n=>t instanceof n),pS,gS;function PL(){return pS||(pS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xL(){return gS||(gS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var mS=new WeakMap,av=new WeakMap,yS=new WeakMap,ov=new WeakMap,lv=new WeakMap;function ML(t){let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Cr(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&mS.set(n,t)}).catch(()=>{}),lv.set(e,t),e}function kL(t){if(av.has(t))return;let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});av.set(t,e)}var cv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return av.get(t);if(e==="objectStoreNames")return t.objectStoreNames||yS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Cr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vS(t){cv=t(cv)}function NL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call(Ch(this),e,...n);return yS.set(r,e.sort?e.sort():[e]),Cr(r)}:xL().includes(t)?function(...e){return t.apply(Ch(this),e),Cr(mS.get(this))}:function(...e){return Cr(t.apply(Ch(this),e))}}function OL(t){return typeof t=="function"?NL(t):(t instanceof IDBTransaction&&kL(t),RL(t,PL())?new Proxy(t,cv):t)}function Cr(t){if(t instanceof IDBRequest)return ML(t);if(ov.has(t))return ov.get(t);let e=OL(t);return e!==t&&(ov.set(t,e),lv.set(e,t)),e}var Ch=t=>lv.get(t);function ES(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(t,e),a=Cr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Cr(o.result),c.oldVersion,c.newVersion,Cr(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var FL=["get","getKey","getAll","getAllKeys","count"],LL=["put","add","delete","clear"],uv=new Map;function _S(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(uv.get(e))return uv.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,i=LL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||FL.includes(n)))return;let s=function(o,...a){return X(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[n](...a),i&&c.done]))[0]})};return uv.set(e,s),s}vS(t=>Ke(me({},t),{get:(e,n,r)=>_S(e,n)||t.get(e,n,r),has:(e,n)=>!!_S(e,n)||t.has(e,n)}));var hv=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(VL(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function VL(t){let e=t.getComponent();return e?.type==="VERSION"}var fv="@firebase/app",bS="0.13.2";var ni=new Sr("@firebase/app"),UL="@firebase/app-compat",jL="@firebase/analytics-compat",BL="@firebase/analytics",$L="@firebase/app-check-compat",HL="@firebase/app-check",zL="@firebase/auth",qL="@firebase/auth-compat",WL="@firebase/database",GL="@firebase/data-connect",KL="@firebase/database-compat",YL="@firebase/functions",XL="@firebase/functions-compat",QL="@firebase/installations",ZL="@firebase/installations-compat",JL="@firebase/messaging",eV="@firebase/messaging-compat",tV="@firebase/performance",nV="@firebase/performance-compat",rV="@firebase/remote-config",iV="@firebase/remote-config-compat",sV="@firebase/storage",oV="@firebase/storage-compat",aV="@firebase/firestore",cV="@firebase/ai",lV="@firebase/firestore-compat",uV="firebase",dV="11.10.0";var pv="[DEFAULT]",hV={[fv]:"fire-core",[UL]:"fire-core-compat",[BL]:"fire-analytics",[jL]:"fire-analytics-compat",[HL]:"fire-app-check",[$L]:"fire-app-check-compat",[zL]:"fire-auth",[qL]:"fire-auth-compat",[WL]:"fire-rtdb",[GL]:"fire-data-connect",[KL]:"fire-rtdb-compat",[YL]:"fire-fn",[XL]:"fire-fn-compat",[QL]:"fire-iid",[ZL]:"fire-iid-compat",[JL]:"fire-fcm",[eV]:"fire-fcm-compat",[tV]:"fire-perf",[nV]:"fire-perf-compat",[rV]:"fire-rc",[iV]:"fire-rc-compat",[sV]:"fire-gcs",[oV]:"fire-gcs-compat",[aV]:"fire-fst",[lV]:"fire-fst-compat",[cV]:"fire-vertex","fire-js":"fire-js",[uV]:"fire-js-all"};var hl=new Map,fV=new Map,gv=new Map;function wS(t,e){try{t.container.addComponent(e)}catch(n){ni.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function On(t){let e=t.name;if(gv.has(e))return ni.debug(`There were multiple attempts to register component ${e}.`),!1;gv.set(e,t);for(let n of hl.values())wS(n,t);for(let n of fV.values())wS(n,t);return!0}function oa(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function lr(t){return t==null?!1:t.settings!==void 0}var pV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ui=new cr("app","Firebase",pV);var mv=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new nn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ui.create("app-deleted",{appName:this._name})}};var ji=dV;function _v(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=Object.assign({name:pv,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Ui.create("bad-app-name",{appName:String(i)});if(n||(n=rv()),!n)throw Ui.create("no-options");let s=hl.get(i);if(s){if(ks(n,s.options)&&ks(r,s.config))return s;throw Ui.create("duplicate-app",{appName:i})}let o=new Sh(i);for(let c of gv.values())o.addComponent(c);let a=new mv(n,r,o);return hl.set(i,a),a}function Bi(t=pv){let e=hl.get(t);if(!e&&t===pv&&rv())return _v();if(!e)throw Ui.create("no-app",{appName:t});return e}function Dh(){return Array.from(hl.values())}function pt(t,e,n){var r;let i=(r=hV[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ni.warn(a.join(" "));return}On(new nn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var gV="firebase-heartbeat-database",mV=1,fl="firebase-heartbeat-store",dv=null;function SS(){return dv||(dv=ES(gV,mV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fl)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ui.create("idb-open",{originalErrorMessage:t.message})})),dv}function yV(t){return X(this,null,function*(){try{let n=(yield SS()).transaction(fl),r=yield n.objectStore(fl).get(CS(t));return yield n.done,r}catch(e){if(e instanceof Sn)ni.warn(e.message);else{let n=Ui.create("idb-get",{originalErrorMessage:e?.message});ni.warn(n.message)}}})}function IS(t,e){return X(this,null,function*(){try{let r=(yield SS()).transaction(fl,"readwrite");yield r.objectStore(fl).put(e,CS(t)),yield r.done}catch(n){if(n instanceof Sn)ni.warn(n.message);else{let r=Ui.create("idb-set",{originalErrorMessage:n?.message});ni.warn(r.message)}}})}function CS(t){return`${t.name}!${t.options.appId}`}var vV=1024,_V=30,yv=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new vv(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return X(this,null,function*(){var e,n;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=TS();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>_V){let o=bV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ni.warn(r)}})}getHeartbeatsHeader(){return X(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=TS(),{heartbeatsToSend:r,unsentEntries:i}=EV(this._heartbeatsCache.heartbeats),s=cl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return ni.warn(n),""}})}};function TS(){return new Date().toISOString().substring(0,10)}function EV(t,e=vV){let n=[],r=t.slice();for(let i of t){let s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),AS(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),AS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var vv=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return X(this,null,function*(){return dl()?hS().then(()=>!0).catch(()=>!1):!1})}read(){return X(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield yV(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return X(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return X(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function AS(t){return cl(JSON.stringify({version:2,heartbeats:t})).length}function bV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function wV(t){On(new nn("platform-logger",e=>new hv(e),"PRIVATE")),On(new nn("heartbeat",e=>new yv(e),"PRIVATE")),pt(fv,bS,t),pt(fv,bS,"esm2017"),pt("fire-js","")}wV("");var IV="firebase",TV="11.10.0";pt(IV,TV,"app");function DS(t){t===void 0&&(t=he(kt));let e=t.get(xo);return n=>new Re(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let a=n.subscribe({next:c=>{r.next(c),o()},complete:()=>{r.complete(),o()},error:c=>{r.error(c),o()}});return a.add(()=>{r.unsubscribe(),o()}),a})}var ri=new wo("ANGULARFIRE2_VERSION");function ca(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var $i=(t,e)=>{let n=e?[e]:Dh(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},aa=(function(t){return t[t.SILENT=0]="SILENT",t[t.WARN=1]="WARN",t[t.VERBOSE=2]="VERBOSE",t})(aa||{}),RS=Vc()&&typeof Zone<"u"?aa.WARN:aa.SILENT;var Rh=class{zone;delegate;constructor(e,n=Dp){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,n,r)}},ii=(()=>{class t{outsideAngular;insideAngular;constructor(){let n=he(nt);this.outsideAngular=n.runOutsideAngular(()=>new Rh(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=n.run(()=>new Rh(typeof Zone>"u"?void 0:Zone.current,Cp))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),PS=!1;function AV(t,e){!PS&&(RS>aa.SILENT||Vc())&&(PS=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),RS>=e&&console.warn(`Firebase API called outside injection context: ${t.name}`)}function SV(t){let e=he(nt,{optional:!0});return e?e.runOutsideAngular(()=>t()):t()}function Os(t){let e=he(nt,{optional:!0});return e?e.run(()=>t()):t()}var CV=(t,e,n)=>(...r)=>(e&&setTimeout(e,0),$t(n,()=>Os(()=>t.apply(void 0,r)))),Cn=(t,e,n)=>(n||=e?aa.WARN:aa.VERBOSE,function(){let r,i=arguments,s,o,a;try{s=he(ii),o=he(xo),a=he(Bt)}catch{return AV(t,n),t.apply(this,i)}for(let l=0;l<arguments.length;l++)typeof i[l]=="function"&&(e&&(r||=Os(()=>o.add())),i[l]=CV(i[l],r,a));let c=SV(()=>t.apply(this,i));return e?c instanceof Re?c.pipe(bi(s.outsideAngular),Ei(s.insideAngular),DS(a)):c instanceof Promise?Os(()=>{let l=o.add();return new Promise((d,h)=>{c.then(f=>$t(a,()=>Os(()=>d(f))),f=>$t(a,()=>Os(()=>h(f)))).finally(l)})}):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:Os(()=>c):c instanceof Re?c.pipe(bi(s.outsideAngular),Ei(s.insideAngular)):Os(()=>c)});var si=class{constructor(e){return e}},Fs=class{constructor(){return Dh()}};function DV(t){return t&&t.length===1?t[0]:new si(Bi())}var Ev=new Te("angularfire2._apps"),RV={provide:si,useFactory:DV,deps:[[new Tn,Ev]]},PV={provide:Fs,deps:[[new Tn,Ev]]};function xV(t){return(e,n)=>{let r=n.get(Cs);pt("angularfire",ri.full,"core"),pt("angularfire",ri.full,"app"),pt("angular",Gp.full,r.toString());let i=e.runOutsideAngular(()=>t(n));return new si(i)}}function xS(t,...e){return wn([RV,PV,{provide:Ev,useFactory:xV(t),multi:!0,deps:[nt,kt,ii,...e]}])}var MS=Cn(_v,!0);var MV=new Map,kV={activated:!1,tokenObservers:[]},NV={initialized:!1,enabled:!1};function ur(t){return MV.get(t)||Object.assign({},kV)}function FS(){return NV}var OV="https://content-firebaseappcheck.googleapis.com/v1";var FV="exchangeDebugToken",kS={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},rne=1440*60*1e3;var Iv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return X(this,null,function*(){this.stop();try{this.pending=new Ms,this.pending.promise.catch(n=>{}),yield LV(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Ms,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function LV(t){return new Promise(e=>{setTimeout(e,t)})}var VV={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Hi=new cr("appCheck","AppCheck",VV);function LS(t){if(!ur(t).activated)throw Hi.create("use-before-activation",{appName:t.name})}function VS(r,i){return X(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let p=yield o.getHeartbeatsHeader();p&&(s["X-Firebase-Client"]=p)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(p){throw Hi.create("fetch-network-error",{originalErrorMessage:p?.message})}if(c.status!==200)throw Hi.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(p){throw Hi.create("fetch-parse-error",{originalErrorMessage:p?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw Hi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let h=Number(d[1])*1e3,f=Date.now();return{token:l.token,expireTimeMillis:f+h,issuedAtTimeMillis:f}})}function US(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${OV}/projects/${n}/apps/${r}:${FV}?key=${i}`,body:{debug_token:e}}}var UV="firebase-app-check-database",jV=1,Tv="firebase-app-check-store";var Ph=null;function BV(){return Ph||(Ph=new Promise((t,e)=>{try{let n=indexedDB.open(UV,jV);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Hi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Tv,{keyPath:"compositeKey"})}}}catch(n){e(Hi.create("storage-open",{originalErrorMessage:n?.message}))}}),Ph)}function $V(t,e){return HV(zV(t),e)}function HV(t,e){return X(this,null,function*(){let r=(yield BV()).transaction(Tv,"readwrite"),s=r.objectStore(Tv).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;a(Hi.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function zV(t){return`${t.options.appId}-${t.name}`}var pl=new Sr("@firebase/app-check");function bv(t,e){return dl()?$V(t,e).catch(n=>{pl.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function jS(){return FS().enabled}function BS(){return X(this,null,function*(){let t=FS();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var qV={error:"UNKNOWN_ERROR"};function WV(t){return bh.encodeString(JSON.stringify(t),!1)}function Av(t,e=!1,n=!1){return X(this,null,function*(){let r=t.app;LS(r);let i=ur(r),s=i.token,o;if(s&&!gl(s)&&(i.token=void 0,s=void 0),!s){let l=yield i.cachedTokenPromise;l&&(gl(l)?s=l:yield bv(r,void 0))}if(!e&&s&&gl(s))return{token:s.token};let a=!1;if(jS())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=VS(US(r,yield BS()),t.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let l=yield i.exchangeTokenPromise;return yield bv(r,l),i.token=l,{token:l.token}}catch(l){return l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?pl.warn(l.message):n&&pl.error(l),wv(l)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),s=yield ur(r).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?pl.warn(l.message):n&&pl.error(l),o=l}let c;return s?o?gl(s)?c={token:s.token,internalError:o}:c=wv(o):(c={token:s.token},i.token=s,yield bv(r,s)):c=wv(o),a&&XV(r,c),c})}function GV(t){return X(this,null,function*(){let e=t.app;LS(e);let{provider:n}=ur(e);if(jS()){let r=yield BS(),{token:i}=yield VS(US(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function KV(t,e,n,r){let{app:i}=t,s=ur(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&gl(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),NS(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>NS(t))}function $S(t,e){let n=ur(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function NS(t){let{app:e}=t,n=ur(e),r=n.tokenRefresher;r||(r=YV(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function YV(t){let{app:e}=t;return new Iv(()=>X(null,null,function*(){let n=ur(e),r;if(n.token?r=yield Av(t,!0):r=yield Av(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=ur(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},kS.RETRIAL_MIN_WAIT,kS.RETRIAL_MAX_WAIT)}function XV(t,e){let n=ur(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function gl(t){return t.expireTimeMillis-Date.now()>0}function wv(t){return{token:WV(qV),error:t}}var Sv=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=ur(this.app);for(let n of e)$S(this.app,n.next);return Promise.resolve()}};function QV(t,e){return new Sv(t,e)}function ZV(t){return{getToken:e=>Av(t,e),getLimitedUseToken:()=>GV(t),addTokenListener:e=>KV(t,"INTERNAL",e),removeTokenListener:e=>$S(t.app,e)}}var JV="@firebase/app-check",e2="0.10.1";var t2="app-check",OS="app-check-internal";function n2(){On(new nn(t2,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return QV(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(OS).initialize()})),On(new nn(OS,t=>{let e=t.getProvider("app-check").getImmediate();return ZV(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),pt(JV,e2)}n2();var r2="app-check";var la=class{constructor(){return $i(r2)}};var i2=["localhost","0.0.0.0","127.0.0.1"],mne=typeof window<"u"&&i2.includes(window.location.hostname);function XS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var QS=XS,ZS=new cr("auth","Firebase",XS());var Nh=new Sr("@firebase/auth");function o2(t,...e){Nh.logLevel<=He.WARN&&Nh.warn(`Auth (${ji}): ${t}`,...e)}function Mh(t,...e){Nh.logLevel<=He.ERROR&&Nh.error(`Auth (${ji}): ${t}`,...e)}function HS(t,...e){throw Vv(t,...e)}function Lv(t,...e){return Vv(t,...e)}function JS(t,e,n){let r=Object.assign(Object.assign({},QS()),{[e]:n});return new cr("auth","Firebase",r).create(e,{appName:t.name})}function kh(t){return JS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vv(t,...e){if(typeof t!="string"){let n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return ZS.create(t,...e)}function rt(t,e,...n){if(!t)throw Vv(e,...n)}function ml(t){let e="INTERNAL ASSERTION FAILED: "+t;throw Mh(e),new Error(e)}function Oh(t,e){t||ml(e)}function a2(){return zS()==="http:"||zS()==="https:"}function zS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function c2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(a2()||lS()||"connection"in navigator)?navigator.onLine:!0}function l2(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var Us=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,Oh(n>e,"Short delay should be less than long delay!"),this.isMobile=aS()||uS()}get(){return c2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function u2(t,e){Oh(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var Fh=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ml("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ml("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ml("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var d2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var h2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],f2=new Us(3e4,6e4);function eC(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Bh(s,o,a,c){return X(this,arguments,function*(t,e,n,r,i={}){return tC(t,i,()=>X(null,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=iv(Object.assign({key:t.config.apiKey},d)).slice(1),f=yield t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);let p=Object.assign({method:e,headers:f},l);return cS()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&Ar(t.emulatorConfig.host)&&(p.credentials="include"),Fh.fetch()(yield nC(t,t.config.apiHost,n,h),p)}))})}function tC(t,e,n){return X(this,null,function*(){t._canInitEmulator=!1;let r=Object.assign(Object.assign({},d2),e);try{let i=new Rv(t),s=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw xh(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw xh(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw xh(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw xh(t,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw JS(t,d,l);HS(t,d)}}catch(i){if(i instanceof Sn)throw i;HS(t,"network-request-failed",{message:String(i)})}})}function nC(t,e,n,r){return X(this,null,function*(){let i=`${e}${n}?${r}`,s=t,o=s.config.emulator?u2(t.config,i):`${t.config.apiScheme}://${i}`;return h2.includes(n)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o})}var Rv=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Lv(this.auth,"network-request-failed")),f2.get())})}};function xh(t,e,n){let r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=Lv(t,e,r);return i.customData._tokenResponse=n,i}function p2(t,e){return X(this,null,function*(){return Bh(t,"POST","/v1/accounts:delete",e)})}function Lh(t,e){return X(this,null,function*(){return Bh(t,"POST","/v1/accounts:lookup",e)})}function yl(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Uv(t,e=!1){return X(this,null,function*(){let n=Wt(t),r=yield n.getIdToken(e),i=rC(r);rt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:yl(Cv(i.auth_time)),issuedAtTime:yl(Cv(i.iat)),expirationTime:yl(Cv(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Cv(t){return Number(t)*1e3}function rC(t){let[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Mh("JWT malformed, contained fewer than 3 sections"),null;try{let i=wh(n);return i?JSON.parse(i):(Mh("Failed to decode base64 JWT payload"),null)}catch(i){return Mh("Caught error parsing JWT payload as JSON",i?.toString()),null}}function qS(t){let e=rC(t);return rt(e,"internal-error"),rt(typeof e.exp<"u","internal-error"),rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Pv(t,e,n=!1){return X(this,null,function*(){if(n)return e;try{return yield e}catch(r){throw r instanceof Sn&&g2(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})}function g2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var xv=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>X(this,null,function*(){yield this.iteration()}),n)}iteration(){return X(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var _l=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=yl(this.lastLoginAt),this.creationTime=yl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Vh(t){return X(this,null,function*(){var e;let n=t.auth,r=yield t.getIdToken(),i=yield Pv(t,Lh(n,{idToken:r}));rt(i?.users.length,n,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?iC(s.providerUserInfo):[],a=m2(t.providerData,o),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new _l(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)})}function jv(t){return X(this,null,function*(){let e=Wt(t);yield Vh(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function m2(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function iC(t){return t.map(e=>{var{providerId:n}=e,r=Rp(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function y2(t,e){return X(this,null,function*(){let n=yield tC(t,{},()=>X(null,null,function*(){let r=iv({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=yield nC(t,i,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return t.emulatorConfig&&Ar(t.emulatorConfig.host)&&(c.credentials="include"),Fh.fetch()(o,c)}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function v2(t,e){return X(this,null,function*(){return Bh(t,"POST","/v2/accounts:revokeToken",eC(t,e))})}var vl=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){rt(e.idToken,"internal-error"),rt(typeof e.idToken<"u","internal-error"),rt(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){rt(e.length!==0,"internal-error");let n=qS(e);this.updateTokensAndExpiration(e,null,n)}getToken(e,n=!1){return X(this,null,function*(){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return X(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield y2(e,n);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){let{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new t;return r&&(rt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(rt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(rt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return ml("not implemented")}};function zi(t,e){rt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var Ls=class t{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Rp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new xv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new _l(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return X(this,null,function*(){let n=yield Pv(this,this.stsTokenManager.getToken(this.auth,e));return rt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return Uv(this,e)}reload(){return jv(this)}_assign(e){this!==e&&(rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return X(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&(yield Vh(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return X(this,null,function*(){if(lr(this.auth.app))return Promise.reject(kh(this.auth));let e=yield this.getIdToken();return yield Pv(this,p2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,c,l,d;let h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=n.photoURL)!==null&&o!==void 0?o:void 0,g=(a=n.tenantId)!==null&&a!==void 0?a:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,E=(l=n.createdAt)!==null&&l!==void 0?l:void 0,A=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:O,emailVerified:M,isAnonymous:C,providerData:P,stsTokenManager:D}=n;rt(O&&D,e,"internal-error");let S=vl.fromJSON(this.name,D);rt(typeof O=="string",e,"internal-error"),zi(h,e.name),zi(f,e.name),rt(typeof M=="boolean",e,"internal-error"),rt(typeof C=="boolean",e,"internal-error"),zi(p,e.name),zi(m,e.name),zi(g,e.name),zi(v,e.name),zi(E,e.name),zi(A,e.name);let T=new t({uid:O,auth:e,email:f,emailVerified:M,displayName:h,isAnonymous:C,photoURL:m,phoneNumber:p,tenantId:g,stsTokenManager:S,createdAt:E,lastLoginAt:A});return P&&Array.isArray(P)&&(T.providerData=P.map(F=>Object.assign({},F))),v&&(T._redirectEventId=v),T}static _fromIdTokenResponse(e,n,r=!1){return X(this,null,function*(){let i=new vl;i.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Vh(s),s})}static _fromGetAccountInfoResponse(e,n,r){return X(this,null,function*(){let i=n.users[0];rt(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?iC(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new vl;a.updateFromIdToken(r);let c=new t({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new _l(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var WS=new Map;function Vs(t){Oh(t instanceof Function,"Expected a class definition");let e=WS.get(t);return e?(Oh(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,WS.set(t,e),e)}var _2=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return X(this,null,function*(){return!0})}_set(n,r){return X(this,null,function*(){this.storage[n]=r})}_get(n){return X(this,null,function*(){let r=this.storage[n];return r===void 0?null:r})}_remove(n){return X(this,null,function*(){delete this.storage[n]})}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})(),Mv=_2;function Dv(t,e,n){return`firebase:${t}:${e}:${n}`}var Uh=class t{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Dv(this.userKey,i.apiKey,s),this.fullPersistenceKey=Dv("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return X(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let n=yield Lh(this.auth,{idToken:e}).catch(()=>{});return n?Ls._fromGetAccountInfoResponse(this.auth,n,e):null}return Ls._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return X(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return X(this,null,function*(){if(!n.length)return new t(Vs(Mv),e,r);let i=(yield Promise.all(n.map(l=>X(null,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Vs(Mv),o=Dv(r,e.config.apiKey,e.name),a=null;for(let l of n)try{let d=yield l._get(o);if(d){let h;if(typeof d=="string"){let f=yield Lh(e,{idToken:d}).catch(()=>{});if(!f)break;h=yield Ls._fromGetAccountInfoResponse(e,f,d)}else h=Ls._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(l=>X(null,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new t(s,e,r))})}};function GS(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(I2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(E2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(A2(e))return"Blackberry";if(S2(e))return"Webos";if(b2(e))return"Safari";if((e.includes("chrome/")||w2(e))&&!e.includes("edge/"))return"Chrome";if(T2(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function E2(t=Nn()){return/firefox\//i.test(t)}function b2(t=Nn()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function w2(t=Nn()){return/crios\//i.test(t)}function I2(t=Nn()){return/iemobile/i.test(t)}function T2(t=Nn()){return/android/i.test(t)}function A2(t=Nn()){return/blackberry/i.test(t)}function S2(t=Nn()){return/webos/i.test(t)}function sC(t,e=[]){let n;switch(t){case"Browser":n=GS(Nn());break;case"Worker":n=`${GS(Nn())}-${t}`;break;default:n=t}let r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ji}/${r}`}var kv=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return X(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let r of this.queue)yield r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(let i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function C2(n){return X(this,arguments,function*(t,e={}){return Bh(t,"GET","/v2/passwordPolicy",eC(t,e))})}var D2=6,Nv=class{constructor(e){var n,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:D2,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Ov=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jh(this),this.idTokenSubscription=new jh(this),this.beforeStateQueue=new kv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ZS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Vs(n)),this._initializationPromise=this.queue(()=>X(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield Uh.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return X(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return X(this,null,function*(){try{let n=yield Lh(this,{idToken:e}),r=yield Ls._fromGetAccountInfoResponse(this,n,e);yield this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return X(this,null,function*(){var n;if(lr(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return rt(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return X(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return X(this,null,function*(){try{yield Vh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=l2()}_delete(){return X(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return X(this,null,function*(){if(lr(this.app))return Promise.reject(kh(this));let n=e?Wt(e):null;return n&&rt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return X(this,null,function*(){if(!this._deleted)return e&&rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>X(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return X(this,null,function*(){return lr(this.app)?Promise.reject(kh(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return lr(this.app)?Promise.reject(kh(this)):this.queue(()=>X(this,null,function*(){yield this.assertedPersistence.setPersistence(Vs(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return X(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return X(this,null,function*(){let e=yield C2(this),n=new Nv(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new cr("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){return X(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),yield v2(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return X(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return X(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&Vs(e)||this._popupRedirectResolver;rt(n,this,"argument-error"),this.redirectPersistenceManager=yield Uh.create(this,[Vs(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return X(this,null,function*(){var n,r;return this._isInitialized&&(yield this.queue(()=>X(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return X(this,null,function*(){if(e===this.currentUser)return this.queue(()=>X(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(rt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(n);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return X(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return X(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(n["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n})}_getAppCheckToken(){return X(this,null,function*(){var e;if(lr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&o2(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function R2(t){return Wt(t)}var jh=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=fS(n=>this.observer=n)}get next(){return rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var P2={loadJS(){return X(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function x2(t){P2=t}function M2(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function k2(t,e){let n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Vs);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}var Dne=M2("rcb"),Rne=new Us(3e4,6e4);var Pne=new Us(2e3,1e4);var xne=600*1e3;var Mne=new Us(3e4,6e4);var kne=new Us(5e3,15e3);var Nne=encodeURIComponent("fac");var KS="@firebase/auth",YS="1.10.8";var Fv=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return X(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function N2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function O2(t){On(new nn("auth",(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;rt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sC(t)},l=new Ov(r,i,s,c);return k2(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),On(new nn("auth-internal",e=>{let n=R2(e.getProvider("auth").getImmediate());return(r=>new Fv(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),pt(KS,YS,N2(t)),pt(KS,YS,"esm2017")}var F2=300,One=oS("authIdTokenMaxAge")||F2;function L2(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}x2({loadJS(t){return new Promise((e,n)=>{let r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{let s=Lv("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",L2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});O2("Browser");var OU="auth";var ua=class{constructor(){return $i(OU)}};var oC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},aC={};var oi,Bv;(function(){var t;function e(D,S){function T(){}T.prototype=S.prototype,D.D=S.prototype,D.prototype=new T,D.prototype.constructor=D,D.C=function(F,L,W){for(var U=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)U[ae-2]=arguments[ae];return S.prototype[L].apply(F,U)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,S,T){T||(T=0);var F=Array(16);if(typeof S=="string")for(var L=0;16>L;++L)F[L]=S.charCodeAt(T++)|S.charCodeAt(T++)<<8|S.charCodeAt(T++)<<16|S.charCodeAt(T++)<<24;else for(L=0;16>L;++L)F[L]=S[T++]|S[T++]<<8|S[T++]<<16|S[T++]<<24;S=D.g[0],T=D.g[1],L=D.g[2];var W=D.g[3],U=S+(W^T&(L^W))+F[0]+3614090360&4294967295;S=T+(U<<7&4294967295|U>>>25),U=W+(L^S&(T^L))+F[1]+3905402710&4294967295,W=S+(U<<12&4294967295|U>>>20),U=L+(T^W&(S^T))+F[2]+606105819&4294967295,L=W+(U<<17&4294967295|U>>>15),U=T+(S^L&(W^S))+F[3]+3250441966&4294967295,T=L+(U<<22&4294967295|U>>>10),U=S+(W^T&(L^W))+F[4]+4118548399&4294967295,S=T+(U<<7&4294967295|U>>>25),U=W+(L^S&(T^L))+F[5]+1200080426&4294967295,W=S+(U<<12&4294967295|U>>>20),U=L+(T^W&(S^T))+F[6]+2821735955&4294967295,L=W+(U<<17&4294967295|U>>>15),U=T+(S^L&(W^S))+F[7]+4249261313&4294967295,T=L+(U<<22&4294967295|U>>>10),U=S+(W^T&(L^W))+F[8]+1770035416&4294967295,S=T+(U<<7&4294967295|U>>>25),U=W+(L^S&(T^L))+F[9]+2336552879&4294967295,W=S+(U<<12&4294967295|U>>>20),U=L+(T^W&(S^T))+F[10]+4294925233&4294967295,L=W+(U<<17&4294967295|U>>>15),U=T+(S^L&(W^S))+F[11]+2304563134&4294967295,T=L+(U<<22&4294967295|U>>>10),U=S+(W^T&(L^W))+F[12]+1804603682&4294967295,S=T+(U<<7&4294967295|U>>>25),U=W+(L^S&(T^L))+F[13]+4254626195&4294967295,W=S+(U<<12&4294967295|U>>>20),U=L+(T^W&(S^T))+F[14]+2792965006&4294967295,L=W+(U<<17&4294967295|U>>>15),U=T+(S^L&(W^S))+F[15]+1236535329&4294967295,T=L+(U<<22&4294967295|U>>>10),U=S+(L^W&(T^L))+F[1]+4129170786&4294967295,S=T+(U<<5&4294967295|U>>>27),U=W+(T^L&(S^T))+F[6]+3225465664&4294967295,W=S+(U<<9&4294967295|U>>>23),U=L+(S^T&(W^S))+F[11]+643717713&4294967295,L=W+(U<<14&4294967295|U>>>18),U=T+(W^S&(L^W))+F[0]+3921069994&4294967295,T=L+(U<<20&4294967295|U>>>12),U=S+(L^W&(T^L))+F[5]+3593408605&4294967295,S=T+(U<<5&4294967295|U>>>27),U=W+(T^L&(S^T))+F[10]+38016083&4294967295,W=S+(U<<9&4294967295|U>>>23),U=L+(S^T&(W^S))+F[15]+3634488961&4294967295,L=W+(U<<14&4294967295|U>>>18),U=T+(W^S&(L^W))+F[4]+3889429448&4294967295,T=L+(U<<20&4294967295|U>>>12),U=S+(L^W&(T^L))+F[9]+568446438&4294967295,S=T+(U<<5&4294967295|U>>>27),U=W+(T^L&(S^T))+F[14]+3275163606&4294967295,W=S+(U<<9&4294967295|U>>>23),U=L+(S^T&(W^S))+F[3]+4107603335&4294967295,L=W+(U<<14&4294967295|U>>>18),U=T+(W^S&(L^W))+F[8]+1163531501&4294967295,T=L+(U<<20&4294967295|U>>>12),U=S+(L^W&(T^L))+F[13]+2850285829&4294967295,S=T+(U<<5&4294967295|U>>>27),U=W+(T^L&(S^T))+F[2]+4243563512&4294967295,W=S+(U<<9&4294967295|U>>>23),U=L+(S^T&(W^S))+F[7]+1735328473&4294967295,L=W+(U<<14&4294967295|U>>>18),U=T+(W^S&(L^W))+F[12]+2368359562&4294967295,T=L+(U<<20&4294967295|U>>>12),U=S+(T^L^W)+F[5]+4294588738&4294967295,S=T+(U<<4&4294967295|U>>>28),U=W+(S^T^L)+F[8]+2272392833&4294967295,W=S+(U<<11&4294967295|U>>>21),U=L+(W^S^T)+F[11]+1839030562&4294967295,L=W+(U<<16&4294967295|U>>>16),U=T+(L^W^S)+F[14]+4259657740&4294967295,T=L+(U<<23&4294967295|U>>>9),U=S+(T^L^W)+F[1]+2763975236&4294967295,S=T+(U<<4&4294967295|U>>>28),U=W+(S^T^L)+F[4]+1272893353&4294967295,W=S+(U<<11&4294967295|U>>>21),U=L+(W^S^T)+F[7]+4139469664&4294967295,L=W+(U<<16&4294967295|U>>>16),U=T+(L^W^S)+F[10]+3200236656&4294967295,T=L+(U<<23&4294967295|U>>>9),U=S+(T^L^W)+F[13]+681279174&4294967295,S=T+(U<<4&4294967295|U>>>28),U=W+(S^T^L)+F[0]+3936430074&4294967295,W=S+(U<<11&4294967295|U>>>21),U=L+(W^S^T)+F[3]+3572445317&4294967295,L=W+(U<<16&4294967295|U>>>16),U=T+(L^W^S)+F[6]+76029189&4294967295,T=L+(U<<23&4294967295|U>>>9),U=S+(T^L^W)+F[9]+3654602809&4294967295,S=T+(U<<4&4294967295|U>>>28),U=W+(S^T^L)+F[12]+3873151461&4294967295,W=S+(U<<11&4294967295|U>>>21),U=L+(W^S^T)+F[15]+530742520&4294967295,L=W+(U<<16&4294967295|U>>>16),U=T+(L^W^S)+F[2]+3299628645&4294967295,T=L+(U<<23&4294967295|U>>>9),U=S+(L^(T|~W))+F[0]+4096336452&4294967295,S=T+(U<<6&4294967295|U>>>26),U=W+(T^(S|~L))+F[7]+1126891415&4294967295,W=S+(U<<10&4294967295|U>>>22),U=L+(S^(W|~T))+F[14]+2878612391&4294967295,L=W+(U<<15&4294967295|U>>>17),U=T+(W^(L|~S))+F[5]+4237533241&4294967295,T=L+(U<<21&4294967295|U>>>11),U=S+(L^(T|~W))+F[12]+1700485571&4294967295,S=T+(U<<6&4294967295|U>>>26),U=W+(T^(S|~L))+F[3]+2399980690&4294967295,W=S+(U<<10&4294967295|U>>>22),U=L+(S^(W|~T))+F[10]+4293915773&4294967295,L=W+(U<<15&4294967295|U>>>17),U=T+(W^(L|~S))+F[1]+2240044497&4294967295,T=L+(U<<21&4294967295|U>>>11),U=S+(L^(T|~W))+F[8]+1873313359&4294967295,S=T+(U<<6&4294967295|U>>>26),U=W+(T^(S|~L))+F[15]+4264355552&4294967295,W=S+(U<<10&4294967295|U>>>22),U=L+(S^(W|~T))+F[6]+2734768916&4294967295,L=W+(U<<15&4294967295|U>>>17),U=T+(W^(L|~S))+F[13]+1309151649&4294967295,T=L+(U<<21&4294967295|U>>>11),U=S+(L^(T|~W))+F[4]+4149444226&4294967295,S=T+(U<<6&4294967295|U>>>26),U=W+(T^(S|~L))+F[11]+3174756917&4294967295,W=S+(U<<10&4294967295|U>>>22),U=L+(S^(W|~T))+F[2]+718787259&4294967295,L=W+(U<<15&4294967295|U>>>17),U=T+(W^(L|~S))+F[9]+3951481745&4294967295,D.g[0]=D.g[0]+S&4294967295,D.g[1]=D.g[1]+(L+(U<<21&4294967295|U>>>11))&4294967295,D.g[2]=D.g[2]+L&4294967295,D.g[3]=D.g[3]+W&4294967295}r.prototype.u=function(D,S){S===void 0&&(S=D.length);for(var T=S-this.blockSize,F=this.B,L=this.h,W=0;W<S;){if(L==0)for(;W<=T;)i(this,D,W),W+=this.blockSize;if(typeof D=="string"){for(;W<S;)if(F[L++]=D.charCodeAt(W++),L==this.blockSize){i(this,F),L=0;break}}else for(;W<S;)if(F[L++]=D[W++],L==this.blockSize){i(this,F),L=0;break}}this.h=L,this.o+=S},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var S=1;S<D.length-8;++S)D[S]=0;var T=8*this.o;for(S=D.length-8;S<D.length;++S)D[S]=T&255,T/=256;for(this.u(D),D=Array(16),S=T=0;4>S;++S)for(var F=0;32>F;F+=8)D[T++]=this.g[S]>>>F&255;return D};function s(D,S){var T=a;return Object.prototype.hasOwnProperty.call(T,D)?T[D]:T[D]=S(D)}function o(D,S){this.h=S;for(var T=[],F=!0,L=D.length-1;0<=L;L--){var W=D[L]|0;F&&W==S||(T[L]=W,F=!1)}this.g=T}var a={};function c(D){return-128<=D&&128>D?s(D,function(S){return new o([S|0],0>S?-1:0)}):new o([D|0],0>D?-1:0)}function l(D){if(isNaN(D)||!isFinite(D))return h;if(0>D)return v(l(-D));for(var S=[],T=1,F=0;D>=T;F++)S[F]=D/T|0,T*=4294967296;return new o(S,0)}function d(D,S){if(D.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(D.charAt(0)=="-")return v(d(D.substring(1),S));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=l(Math.pow(S,8)),F=h,L=0;L<D.length;L+=8){var W=Math.min(8,D.length-L),U=parseInt(D.substring(L,L+W),S);8>W?(W=l(Math.pow(S,W)),F=F.j(W).add(l(U))):(F=F.j(T),F=F.add(l(U)))}return F}var h=c(0),f=c(1),p=c(16777216);t=o.prototype,t.m=function(){if(g(this))return-v(this).m();for(var D=0,S=1,T=0;T<this.g.length;T++){var F=this.i(T);D+=(0<=F?F:4294967296+F)*S,S*=4294967296}return D},t.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(m(this))return"0";if(g(this))return"-"+v(this).toString(D);for(var S=l(Math.pow(D,6)),T=this,F="";;){var L=M(T,S).g;T=E(T,L.j(S));var W=((0<T.g.length?T.g[0]:T.h)>>>0).toString(D);if(T=L,m(T))return W+F;for(;6>W.length;)W="0"+W;F=W+F}},t.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function m(D){if(D.h!=0)return!1;for(var S=0;S<D.g.length;S++)if(D.g[S]!=0)return!1;return!0}function g(D){return D.h==-1}t.l=function(D){return D=E(this,D),g(D)?-1:m(D)?0:1};function v(D){for(var S=D.g.length,T=[],F=0;F<S;F++)T[F]=~D.g[F];return new o(T,~D.h).add(f)}t.abs=function(){return g(this)?v(this):this},t.add=function(D){for(var S=Math.max(this.g.length,D.g.length),T=[],F=0,L=0;L<=S;L++){var W=F+(this.i(L)&65535)+(D.i(L)&65535),U=(W>>>16)+(this.i(L)>>>16)+(D.i(L)>>>16);F=U>>>16,W&=65535,U&=65535,T[L]=U<<16|W}return new o(T,T[T.length-1]&-2147483648?-1:0)};function E(D,S){return D.add(v(S))}t.j=function(D){if(m(this)||m(D))return h;if(g(this))return g(D)?v(this).j(v(D)):v(v(this).j(D));if(g(D))return v(this.j(v(D)));if(0>this.l(p)&&0>D.l(p))return l(this.m()*D.m());for(var S=this.g.length+D.g.length,T=[],F=0;F<2*S;F++)T[F]=0;for(F=0;F<this.g.length;F++)for(var L=0;L<D.g.length;L++){var W=this.i(F)>>>16,U=this.i(F)&65535,ae=D.i(L)>>>16,pe=D.i(L)&65535;T[2*F+2*L]+=U*pe,A(T,2*F+2*L),T[2*F+2*L+1]+=W*pe,A(T,2*F+2*L+1),T[2*F+2*L+1]+=U*ae,A(T,2*F+2*L+1),T[2*F+2*L+2]+=W*ae,A(T,2*F+2*L+2)}for(F=0;F<S;F++)T[F]=T[2*F+1]<<16|T[2*F];for(F=S;F<2*S;F++)T[F]=0;return new o(T,0)};function A(D,S){for(;(D[S]&65535)!=D[S];)D[S+1]+=D[S]>>>16,D[S]&=65535,S++}function O(D,S){this.g=D,this.h=S}function M(D,S){if(m(S))throw Error("division by zero");if(m(D))return new O(h,h);if(g(D))return S=M(v(D),S),new O(v(S.g),v(S.h));if(g(S))return S=M(D,v(S)),new O(v(S.g),S.h);if(30<D.g.length){if(g(D)||g(S))throw Error("slowDivide_ only works with positive integers.");for(var T=f,F=S;0>=F.l(D);)T=C(T),F=C(F);var L=P(T,1),W=P(F,1);for(F=P(F,2),T=P(T,2);!m(F);){var U=W.add(F);0>=U.l(D)&&(L=L.add(T),W=U),F=P(F,1),T=P(T,1)}return S=E(D,L.j(S)),new O(L,S)}for(L=h;0<=D.l(S);){for(T=Math.max(1,Math.floor(D.m()/S.m())),F=Math.ceil(Math.log(T)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),W=l(T),U=W.j(S);g(U)||0<U.l(D);)T-=F,W=l(T),U=W.j(S);m(W)&&(W=f),L=L.add(W),D=E(D,U)}return new O(L,D)}t.A=function(D){return M(this,D).h},t.and=function(D){for(var S=Math.max(this.g.length,D.g.length),T=[],F=0;F<S;F++)T[F]=this.i(F)&D.i(F);return new o(T,this.h&D.h)},t.or=function(D){for(var S=Math.max(this.g.length,D.g.length),T=[],F=0;F<S;F++)T[F]=this.i(F)|D.i(F);return new o(T,this.h|D.h)},t.xor=function(D){for(var S=Math.max(this.g.length,D.g.length),T=[],F=0;F<S;F++)T[F]=this.i(F)^D.i(F);return new o(T,this.h^D.h)};function C(D){for(var S=D.g.length+1,T=[],F=0;F<S;F++)T[F]=D.i(F)<<1|D.i(F-1)>>>31;return new o(T,D.h)}function P(D,S){var T=S>>5;S%=32;for(var F=D.g.length-T,L=[],W=0;W<F;W++)L[W]=0<S?D.i(W+T)>>>S|D.i(W+T+1)<<32-S:D.i(W+T);return new o(L,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Bv=aC.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,oi=aC.Integer=o}).apply(typeof oC<"u"?oC:typeof self<"u"?self:typeof window<"u"?window:{});var $h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ai={};var $v,FU,da,Hv,El,Hh,zv,qv,Wv;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,y,b){return u==Array.prototype||u==Object.prototype||(u[y]=b.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof $h=="object"&&$h];for(var y=0;y<u.length;++y){var b=u[y];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=n(this);function i(u,y){if(y)e:{var b=r;u=u.split(".");for(var V=0;V<u.length-1;V++){var Q=u[V];if(!(Q in b))break e;b=b[Q]}u=u[u.length-1],V=b[u],y=y(V),y!=V&&y!=null&&e(b,u,{configurable:!0,writable:!0,value:y})}}function s(u,y){u instanceof String&&(u+="");var b=0,V=!1,Q={next:function(){if(!V&&b<u.length){var ne=b++;return{value:y(ne,u[ne]),done:!1}}return V=!0,{done:!0,value:void 0}}};return Q[Symbol.iterator]=function(){return Q},Q}i("Array.prototype.values",function(u){return u||function(){return s(this,function(y,b){return b})}});var o=o||{},a=this||self;function c(u){var y=typeof u;return y=y!="object"?y:u?Array.isArray(u)?"array":y:"null",y=="array"||y=="object"&&typeof u.length=="number"}function l(u){var y=typeof u;return y=="object"&&u!=null||y=="function"}function d(u,y,b){return u.call.apply(u.bind,arguments)}function h(u,y,b){if(!u)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var Q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Q,V),u.apply(y,Q)}}return function(){return u.apply(y,arguments)}}function f(u,y,b){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function p(u,y){var b=Array.prototype.slice.call(arguments,1);return function(){var V=b.slice();return V.push.apply(V,arguments),u.apply(this,V)}}function m(u,y){function b(){}b.prototype=y.prototype,u.aa=y.prototype,u.prototype=new b,u.prototype.constructor=u,u.Qb=function(V,Q,ne){for(var ge=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)ge[ct-2]=arguments[ct];return y.prototype[Q].apply(V,ge)}}function g(u){let y=u.length;if(0<y){let b=Array(y);for(let V=0;V<y;V++)b[V]=u[V];return b}return[]}function v(u,y){for(let b=1;b<arguments.length;b++){let V=arguments[b];if(c(V)){let Q=u.length||0,ne=V.length||0;u.length=Q+ne;for(let ge=0;ge<ne;ge++)u[Q+ge]=V[ge]}else u.push(V)}}class E{constructor(y,b){this.i=y,this.j=b,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function A(u){return/^[\s\xa0]*$/.test(u)}function O(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function M(u){return M[" "](u),u}M[" "]=function(){};var C=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function P(u,y,b){for(let V in u)y.call(b,u[V],V,u)}function D(u,y){for(let b in u)y.call(void 0,u[b],b,u)}function S(u){let y={};for(let b in u)y[b]=u[b];return y}let T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(u,y){let b,V;for(let Q=1;Q<arguments.length;Q++){V=arguments[Q];for(b in V)u[b]=V[b];for(let ne=0;ne<T.length;ne++)b=T[ne],Object.prototype.hasOwnProperty.call(V,b)&&(u[b]=V[b])}}function L(u){var y=1;u=u.split(":");let b=[];for(;0<y&&u.length;)b.push(u.shift()),y--;return u.length&&b.push(u.join(":")),b}function W(u){a.setTimeout(()=>{throw u},0)}function U(){var u=w;let y=null;return u.g&&(y=u.g,u.g=u.g.next,u.g||(u.h=null),y.next=null),y}class ae{constructor(){this.h=this.g=null}add(y,b){let V=pe.get();V.set(y,b),this.h?this.h.next=V:this.g=V,this.h=V}}var pe=new E(()=>new oe,u=>u.reset());class oe{constructor(){this.next=this.g=this.h=null}set(y,b){this.h=y,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let q,x=!1,w=new ae,I=()=>{let u=a.Promise.resolve(void 0);q=()=>{u.then(k)}};var k=()=>{for(var u;u=U();){try{u.h.call(u.g)}catch(b){W(b)}var y=pe;y.j(u),100>y.h&&(y.h++,u.next=y.g,y.g=u)}x=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(u,y){this.type=u,this.g=this.target=y,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var G=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,y=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let b=()=>{};a.addEventListener("test",b,y),a.removeEventListener("test",b,y)}catch{}return u})();function j(u,y){if($.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var b=this.type=u.type,V=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=y,y=u.relatedTarget){if(C){e:{try{M(y.nodeName);var Q=!0;break e}catch{}Q=!1}Q||(y=null)}}else b=="mouseover"?y=u.fromElement:b=="mouseout"&&(y=u.toElement);this.relatedTarget=y,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:_[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&j.aa.h.call(this)}}m(j,$);var _={2:"touch",3:"pen",4:"mouse"};j.prototype.h=function(){j.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var R="closure_listenable_"+(1e6*Math.random()|0),N=0;function B(u,y,b,V,Q){this.listener=u,this.proxy=null,this.src=y,this.type=b,this.capture=!!V,this.ha=Q,this.key=++N,this.da=this.fa=!1}function z(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function K(u){this.src=u,this.g={},this.h=0}K.prototype.add=function(u,y,b,V,Q){var ne=u.toString();u=this.g[ne],u||(u=this.g[ne]=[],this.h++);var ge=ee(u,y,V,Q);return-1<ge?(y=u[ge],b||(y.fa=!1)):(y=new B(y,this.src,ne,!!V,Q),y.fa=b,u.push(y)),y};function Y(u,y){var b=y.type;if(b in u.g){var V=u.g[b],Q=Array.prototype.indexOf.call(V,y,void 0),ne;(ne=0<=Q)&&Array.prototype.splice.call(V,Q,1),ne&&(z(y),u.g[b].length==0&&(delete u.g[b],u.h--))}}function ee(u,y,b,V){for(var Q=0;Q<u.length;++Q){var ne=u[Q];if(!ne.da&&ne.listener==y&&ne.capture==!!b&&ne.ha==V)return Q}return-1}var fe="closure_lm_"+(1e6*Math.random()|0),te={};function re(u,y,b,V,Q){if(V&&V.once)return ce(u,y,b,V,Q);if(Array.isArray(y)){for(var ne=0;ne<y.length;ne++)re(u,y[ne],b,V,Q);return null}return b=Zt(b),u&&u[R]?u.K(y,b,l(V)?!!V.capture:!!V,Q):ie(u,y,b,!1,V,Q)}function ie(u,y,b,V,Q,ne){if(!y)throw Error("Invalid event type");var ge=l(Q)?!!Q.capture:!!Q,ct=Ue(u);if(ct||(u[fe]=ct=new K(u)),b=ct.add(y,b,V,ge,ne),b.proxy)return b;if(V=se(),b.proxy=V,V.src=u,V.listener=b,u.addEventListener)G||(Q=ge),Q===void 0&&(Q=!1),u.addEventListener(y.toString(),V,Q);else if(u.attachEvent)u.attachEvent(Ae(y.toString()),V);else if(u.addListener&&u.removeListener)u.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return b}function se(){function u(b){return y.call(u.src,u.listener,b)}let y=xe;return u}function ce(u,y,b,V,Q){if(Array.isArray(y)){for(var ne=0;ne<y.length;ne++)ce(u,y[ne],b,V,Q);return null}return b=Zt(b),u&&u[R]?u.L(y,b,l(V)?!!V.capture:!!V,Q):ie(u,y,b,!0,V,Q)}function ye(u,y,b,V,Q){if(Array.isArray(y))for(var ne=0;ne<y.length;ne++)ye(u,y[ne],b,V,Q);else V=l(V)?!!V.capture:!!V,b=Zt(b),u&&u[R]?(u=u.i,y=String(y).toString(),y in u.g&&(ne=u.g[y],b=ee(ne,b,V,Q),-1<b&&(z(ne[b]),Array.prototype.splice.call(ne,b,1),ne.length==0&&(delete u.g[y],u.h--)))):u&&(u=Ue(u))&&(y=u.g[y.toString()],u=-1,y&&(u=ee(y,b,V,Q)),(b=-1<u?y[u]:null)&&be(b))}function be(u){if(typeof u!="number"&&u&&!u.da){var y=u.src;if(y&&y[R])Y(y.i,u);else{var b=u.type,V=u.proxy;y.removeEventListener?y.removeEventListener(b,V,u.capture):y.detachEvent?y.detachEvent(Ae(b),V):y.addListener&&y.removeListener&&y.removeListener(V),(b=Ue(y))?(Y(b,u),b.h==0&&(b.src=null,y[fe]=null)):z(u)}}}function Ae(u){return u in te?te[u]:te[u]="on"+u}function xe(u,y){if(u.da)u=!0;else{y=new j(y,this);var b=u.listener,V=u.ha||u.src;u.fa&&be(u),u=b.call(V,y)}return u}function Ue(u){return u=u[fe],u instanceof K?u:null}var et="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zt(u){return typeof u=="function"?u:(u[et]||(u[et]=function(y){return u.handleEvent(y)}),u[et])}function Ze(){H.call(this),this.i=new K(this),this.M=this,this.F=null}m(Ze,H),Ze.prototype[R]=!0,Ze.prototype.removeEventListener=function(u,y,b,V){ye(this,u,y,b,V)};function _t(u,y){var b,V=u.F;if(V)for(b=[];V;V=V.F)b.push(V);if(u=u.M,V=y.type||y,typeof y=="string")y=new $(y,u);else if(y instanceof $)y.target=y.target||u;else{var Q=y;y=new $(V,u),F(y,Q)}if(Q=!0,b)for(var ne=b.length-1;0<=ne;ne--){var ge=y.g=b[ne];Q=Rt(ge,V,!0,y)&&Q}if(ge=y.g=u,Q=Rt(ge,V,!0,y)&&Q,Q=Rt(ge,V,!1,y)&&Q,b)for(ne=0;ne<b.length;ne++)ge=y.g=b[ne],Q=Rt(ge,V,!1,y)&&Q}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var u=this.i,y;for(y in u.g){for(var b=u.g[y],V=0;V<b.length;V++)z(b[V]);delete u.g[y],u.h--}}this.F=null},Ze.prototype.K=function(u,y,b,V){return this.i.add(String(u),y,!1,b,V)},Ze.prototype.L=function(u,y,b,V){return this.i.add(String(u),y,!0,b,V)};function Rt(u,y,b,V){if(y=u.i.g[String(y)],!y)return!0;y=y.concat();for(var Q=!0,ne=0;ne<y.length;++ne){var ge=y[ne];if(ge&&!ge.da&&ge.capture==b){var ct=ge.listener,Jt=ge.ha||ge.src;ge.fa&&Y(u.i,ge),Q=ct.call(Jt,V)!==!1&&Q}}return Q&&!V.defaultPrevented}function Ln(u,y,b){if(typeof u=="function")b&&(u=f(u,b));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:a.setTimeout(u,y||0)}function Zs(u){u.g=Ln(()=>{u.g=null,u.i&&(u.i=!1,Zs(u))},u.l);let y=u.h;u.h=null,u.m.apply(null,y)}class Wf extends H{constructor(y,b){super(),this.m=y,this.l=b,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Zs(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ji(u){H.call(this),this.h=u,this.g={}}m(Ji,H);var ue=[];function J(u){P(u.g,function(y,b){this.g.hasOwnProperty(b)&&be(y)},u),u.g={}}Ji.prototype.N=function(){Ji.aa.N.call(this),J(this)},Ji.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Z=a.JSON.stringify,ve=a.JSON.parse,tt=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Tt(){}Tt.prototype.h=null;function Pt(u){return u.h||(u.h=u.i())}function Fr(){}var Vn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qn(){$.call(this,"d")}m(Qn,$);function Kt(){$.call(this,"c")}m(Kt,$);var yn={},Zn=null;function Lr(){return Zn=Zn||new Ze}yn.La="serverreachability";function At(u){$.call(this,yn.La,u)}m(At,$);function fr(u){let y=Lr();_t(y,new At(y))}yn.STAT_EVENT="statevent";function es(u,y){$.call(this,yn.STAT_EVENT,u),this.stat=y}m(es,$);function Vt(u){let y=Lr();_t(y,new es(y,u))}yn.Ma="timingevent";function Js(u,y){$.call(this,yn.Ma,u),this.size=y}m(Js,$);function Jn(u,y){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},y)}function Ut(){this.g=!0}Ut.prototype.xa=function(){this.g=!1};function ts(u,y,b,V,Q,ne){u.info(function(){if(u.g)if(ne)for(var ge="",ct=ne.split("&"),Jt=0;Jt<ct.length;Jt++){var Je=ct[Jt].split("=");if(1<Je.length){var sn=Je[0];Je=Je[1];var on=sn.split("_");ge=2<=on.length&&on[1]=="type"?ge+(sn+"="+Je+"&"):ge+(sn+"=redacted&")}}else ge=null;else ge=ne;return"XMLHTTP REQ ("+V+") [attempt "+Q+"]: "+y+`
`+b+`
`+ge})}function ja(u,y,b,V,Q,ne,ge){u.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+Q+"]: "+y+`
`+b+`
`+ne+" "+ge})}function eo(u,y,b,V){u.info(function(){return"XMLHTTP TEXT ("+y+"): "+EP(u,b)+(V?" "+V:"")})}function _P(u,y){u.info(function(){return"TIMEOUT: "+y})}Ut.prototype.info=function(){};function EP(u,y){if(!u.g)return y;if(!y)return null;try{var b=JSON.parse(y);if(b){for(u=0;u<b.length;u++)if(Array.isArray(b[u])){var V=b[u];if(!(2>V.length)){var Q=V[1];if(Array.isArray(Q)&&!(1>Q.length)){var ne=Q[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(var ge=1;ge<Q.length;ge++)Q[ge]=""}}}}return Z(b)}catch{return y}}var Yl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_b={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Gf;function Xl(){}m(Xl,Tt),Xl.prototype.g=function(){return new XMLHttpRequest},Xl.prototype.i=function(){return{}},Gf=new Xl;function gi(u,y,b,V){this.j=u,this.i=y,this.l=b,this.R=V||1,this.U=new Ji(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Eb}function Eb(){this.i=null,this.g="",this.h=!1}var bb={},Kf={};function Yf(u,y,b){u.L=1,u.v=eu(Vr(y)),u.m=b,u.P=!0,wb(u,null)}function wb(u,y){u.F=Date.now(),Ql(u),u.A=Vr(u.v);var b=u.A,V=u.R;Array.isArray(V)||(V=[String(V)]),Fb(b.i,"t",V),u.C=0,b=u.j.J,u.h=new Eb,u.g=ew(u.j,b?y:null,!u.m),0<u.O&&(u.M=new Wf(f(u.Y,u,u.g),u.O)),y=u.U,b=u.g,V=u.ca;var Q="readystatechange";Array.isArray(Q)||(Q&&(ue[0]=Q.toString()),Q=ue);for(var ne=0;ne<Q.length;ne++){var ge=re(b,Q[ne],V||y.handleEvent,!1,y.h||y);if(!ge)break;y.g[ge.key]=ge}y=u.H?S(u.H):{},u.m?(u.u||(u.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,y)):(u.u="GET",u.g.ea(u.A,u.u,null,y)),fr(),ts(u.i,u.u,u.A,u.l,u.R,u.m)}gi.prototype.ca=function(u){u=u.target;let y=this.M;y&&Ur(u)==3?y.j():this.Y(u)},gi.prototype.Y=function(u){try{if(u==this.g)e:{let on=Ur(this.g);var y=this.g.Ba();let ro=this.g.Z();if(!(3>on)&&(on!=3||this.g&&(this.h.h||this.g.oa()||Hb(this.g)))){this.J||on!=4||y==7||(y==8||0>=ro?fr(3):fr(2)),Xf(this);var b=this.g.Z();this.X=b;t:if(Ib(this)){var V=Hb(this.g);u="";var Q=V.length,ne=Ur(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ns(this),Ba(this);var ge="";break t}this.h.i=new a.TextDecoder}for(y=0;y<Q;y++)this.h.h=!0,u+=this.h.i.decode(V[y],{stream:!(ne&&y==Q-1)});V.length=0,this.h.g+=u,this.C=0,ge=this.h.g}else ge=this.g.oa();if(this.o=b==200,ja(this.i,this.u,this.A,this.l,this.R,on,b),this.o){if(this.T&&!this.K){t:{if(this.g){var ct,Jt=this.g;if((ct=Jt.g?Jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(ct)){var Je=ct;break t}}Je=null}if(b=Je)eo(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qf(this,b);else{this.o=!1,this.s=3,Vt(12),ns(this),Ba(this);break e}}if(this.P){b=!0;let er;for(;!this.J&&this.C<ge.length;)if(er=bP(this,ge),er==Kf){on==4&&(this.s=4,Vt(14),b=!1),eo(this.i,this.l,null,"[Incomplete Response]");break}else if(er==bb){this.s=4,Vt(15),eo(this.i,this.l,ge,"[Invalid Chunk]"),b=!1;break}else eo(this.i,this.l,er,null),Qf(this,er);if(Ib(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),on!=4||ge.length!=0||this.h.h||(this.s=1,Vt(16),b=!1),this.o=this.o&&b,!b)eo(this.i,this.l,ge,"[Invalid Chunked Response]"),ns(this),Ba(this);else if(0<ge.length&&!this.W){this.W=!0;var sn=this.j;sn.g==this&&sn.ba&&!sn.M&&(sn.j.info("Great, no buffering proxy detected. Bytes received: "+ge.length),rp(sn),sn.M=!0,Vt(11))}}else eo(this.i,this.l,ge,null),Qf(this,ge);on==4&&ns(this),this.o&&!this.J&&(on==4?Xb(this.j,this):(this.o=!1,Ql(this)))}else VP(this.g),b==400&&0<ge.indexOf("Unknown SID")?(this.s=3,Vt(12)):(this.s=0,Vt(13)),ns(this),Ba(this)}}}catch{}finally{}};function Ib(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function bP(u,y){var b=u.C,V=y.indexOf(`
`,b);return V==-1?Kf:(b=Number(y.substring(b,V)),isNaN(b)?bb:(V+=1,V+b>y.length?Kf:(y=y.slice(V,V+b),u.C=V+b,y)))}gi.prototype.cancel=function(){this.J=!0,ns(this)};function Ql(u){u.S=Date.now()+u.I,Tb(u,u.I)}function Tb(u,y){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Jn(f(u.ba,u),y)}function Xf(u){u.B&&(a.clearTimeout(u.B),u.B=null)}gi.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(_P(this.i,this.A),this.L!=2&&(fr(),Vt(17)),ns(this),this.s=2,Ba(this)):Tb(this,this.S-u)};function Ba(u){u.j.G==0||u.J||Xb(u.j,u)}function ns(u){Xf(u);var y=u.M;y&&typeof y.ma=="function"&&y.ma(),u.M=null,J(u.U),u.g&&(y=u.g,u.g=null,y.abort(),y.ma())}function Qf(u,y){try{var b=u.j;if(b.G!=0&&(b.g==u||Zf(b.h,u))){if(!u.K&&Zf(b.h,u)&&b.G==3){try{var V=b.Da.g.parse(y)}catch{V=null}if(Array.isArray(V)&&V.length==3){var Q=V;if(Q[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<u.F)su(b),ru(b);else break e;np(b),Vt(18)}}else b.za=Q[1],0<b.za-b.T&&37500>Q[2]&&b.F&&b.v==0&&!b.C&&(b.C=Jn(f(b.Za,b),6e3));if(1>=Cb(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else is(b,11)}else if((u.K||b.g==u)&&su(b),!A(y))for(Q=b.Da.g.parse(y),y=0;y<Q.length;y++){let Je=Q[y];if(b.T=Je[0],Je=Je[1],b.G==2)if(Je[0]=="c"){b.K=Je[1],b.ia=Je[2];let sn=Je[3];sn!=null&&(b.la=sn,b.j.info("VER="+b.la));let on=Je[4];on!=null&&(b.Aa=on,b.j.info("SVER="+b.Aa));let ro=Je[5];ro!=null&&typeof ro=="number"&&0<ro&&(V=1.5*ro,b.L=V,b.j.info("backChannelRequestTimeoutMs_="+V)),V=b;let er=u.g;if(er){let au=er.g?er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(au){var ne=V.h;ne.g||au.indexOf("spdy")==-1&&au.indexOf("quic")==-1&&au.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(Jf(ne,ne.h),ne.h=null))}if(V.D){let ip=er.g?er.g.getResponseHeader("X-HTTP-Session-Id"):null;ip&&(V.ya=ip,gt(V.I,V.D,ip))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-u.F,b.j.info("Handshake RTT: "+b.R+"ms")),V=b;var ge=u;if(V.qa=Jb(V,V.J?V.ia:null,V.W),ge.K){Db(V.h,ge);var ct=ge,Jt=V.L;Jt&&(ct.I=Jt),ct.B&&(Xf(ct),Ql(ct)),V.g=ge}else Kb(V);0<b.i.length&&iu(b)}else Je[0]!="stop"&&Je[0]!="close"||is(b,7);else b.G==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?is(b,7):tp(b):Je[0]!="noop"&&b.l&&b.l.ta(Je),b.v=0)}}fr(4)}catch{}}var wP=class{constructor(u,y){this.g=u,this.map=y}};function Ab(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Sb(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Cb(u){return u.h?1:u.g?u.g.size:0}function Zf(u,y){return u.h?u.h==y:u.g?u.g.has(y):!1}function Jf(u,y){u.g?u.g.add(y):u.h=y}function Db(u,y){u.h&&u.h==y?u.h=null:u.g&&u.g.has(y)&&u.g.delete(y)}Ab.prototype.cancel=function(){if(this.i=Rb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function Rb(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let y=u.i;for(let b of u.g.values())y=y.concat(b.D);return y}return g(u.i)}function IP(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var y=[],b=u.length,V=0;V<b;V++)y.push(u[V]);return y}y=[],b=0;for(V in u)y[b++]=u[V];return y}function TP(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var y=[];u=u.length;for(var b=0;b<u;b++)y.push(b);return y}y=[],b=0;for(let V in u)y[b++]=V;return y}}}function Pb(u,y){if(u.forEach&&typeof u.forEach=="function")u.forEach(y,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,y,void 0);else for(var b=TP(u),V=IP(u),Q=V.length,ne=0;ne<Q;ne++)y.call(void 0,V[ne],b&&b[ne],u)}var xb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function AP(u,y){if(u){u=u.split("&");for(var b=0;b<u.length;b++){var V=u[b].indexOf("="),Q=null;if(0<=V){var ne=u[b].substring(0,V);Q=u[b].substring(V+1)}else ne=u[b];y(ne,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function rs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof rs){this.h=u.h,Zl(this,u.j),this.o=u.o,this.g=u.g,Jl(this,u.s),this.l=u.l;var y=u.i,b=new za;b.i=y.i,y.g&&(b.g=new Map(y.g),b.h=y.h),Mb(this,b),this.m=u.m}else u&&(y=String(u).match(xb))?(this.h=!1,Zl(this,y[1]||"",!0),this.o=$a(y[2]||""),this.g=$a(y[3]||"",!0),Jl(this,y[4]),this.l=$a(y[5]||"",!0),Mb(this,y[6]||"",!0),this.m=$a(y[7]||"")):(this.h=!1,this.i=new za(null,this.h))}rs.prototype.toString=function(){var u=[],y=this.j;y&&u.push(Ha(y,kb,!0),":");var b=this.g;return(b||y=="file")&&(u.push("//"),(y=this.o)&&u.push(Ha(y,kb,!0),"@"),u.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&u.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&u.push("/"),u.push(Ha(b,b.charAt(0)=="/"?DP:CP,!0))),(b=this.i.toString())&&u.push("?",b),(b=this.m)&&u.push("#",Ha(b,PP)),u.join("")};function Vr(u){return new rs(u)}function Zl(u,y,b){u.j=b?$a(y,!0):y,u.j&&(u.j=u.j.replace(/:$/,""))}function Jl(u,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);u.s=y}else u.s=null}function Mb(u,y,b){y instanceof za?(u.i=y,xP(u.i,u.h)):(b||(y=Ha(y,RP)),u.i=new za(y,u.h))}function gt(u,y,b){u.i.set(y,b)}function eu(u){return gt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function $a(u,y){return u?y?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ha(u,y,b){return typeof u=="string"?(u=encodeURI(u).replace(y,SP),b&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function SP(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var kb=/[#\/\?@]/g,CP=/[#\?:]/g,DP=/[#\?]/g,RP=/[#\?@]/g,PP=/#/g;function za(u,y){this.h=this.g=null,this.i=u||null,this.j=!!y}function mi(u){u.g||(u.g=new Map,u.h=0,u.i&&AP(u.i,function(y,b){u.add(decodeURIComponent(y.replace(/\+/g," ")),b)}))}t=za.prototype,t.add=function(u,y){mi(this),this.i=null,u=to(this,u);var b=this.g.get(u);return b||this.g.set(u,b=[]),b.push(y),this.h+=1,this};function Nb(u,y){mi(u),y=to(u,y),u.g.has(y)&&(u.i=null,u.h-=u.g.get(y).length,u.g.delete(y))}function Ob(u,y){return mi(u),y=to(u,y),u.g.has(y)}t.forEach=function(u,y){mi(this),this.g.forEach(function(b,V){b.forEach(function(Q){u.call(y,Q,V,this)},this)},this)},t.na=function(){mi(this);let u=Array.from(this.g.values()),y=Array.from(this.g.keys()),b=[];for(let V=0;V<y.length;V++){let Q=u[V];for(let ne=0;ne<Q.length;ne++)b.push(y[V])}return b},t.V=function(u){mi(this);let y=[];if(typeof u=="string")Ob(this,u)&&(y=y.concat(this.g.get(to(this,u))));else{u=Array.from(this.g.values());for(let b=0;b<u.length;b++)y=y.concat(u[b])}return y},t.set=function(u,y){return mi(this),this.i=null,u=to(this,u),Ob(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[y]),this.h+=1,this},t.get=function(u,y){return u?(u=this.V(u),0<u.length?String(u[0]):y):y};function Fb(u,y,b){Nb(u,y),0<b.length&&(u.i=null,u.g.set(to(u,y),g(b)),u.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],y=Array.from(this.g.keys());for(var b=0;b<y.length;b++){var V=y[b];let ne=encodeURIComponent(String(V)),ge=this.V(V);for(V=0;V<ge.length;V++){var Q=ne;ge[V]!==""&&(Q+="="+encodeURIComponent(String(ge[V]))),u.push(Q)}}return this.i=u.join("&")};function to(u,y){return y=String(y),u.j&&(y=y.toLowerCase()),y}function xP(u,y){y&&!u.j&&(mi(u),u.i=null,u.g.forEach(function(b,V){var Q=V.toLowerCase();V!=Q&&(Nb(this,V),Fb(this,Q,b))},u)),u.j=y}function MP(u,y){let b=new Ut;if(a.Image){let V=new Image;V.onload=p(yi,b,"TestLoadImage: loaded",!0,y,V),V.onerror=p(yi,b,"TestLoadImage: error",!1,y,V),V.onabort=p(yi,b,"TestLoadImage: abort",!1,y,V),V.ontimeout=p(yi,b,"TestLoadImage: timeout",!1,y,V),a.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=u}else y(!1)}function kP(u,y){let b=new Ut,V=new AbortController,Q=setTimeout(()=>{V.abort(),yi(b,"TestPingServer: timeout",!1,y)},1e4);fetch(u,{signal:V.signal}).then(ne=>{clearTimeout(Q),ne.ok?yi(b,"TestPingServer: ok",!0,y):yi(b,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(Q),yi(b,"TestPingServer: error",!1,y)})}function yi(u,y,b,V,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),V(b)}catch{}}function NP(){this.g=new tt}function OP(u,y,b){let V=b||"";try{Pb(u,function(Q,ne){let ge=Q;l(Q)&&(ge=Z(Q)),y.push(V+ne+"="+encodeURIComponent(ge))})}catch(Q){throw y.push(V+"type="+encodeURIComponent("_badmap")),Q}}function qa(u){this.l=u.Ub||null,this.j=u.eb||!1}m(qa,Tt),qa.prototype.g=function(){return new tu(this.l,this.j)},qa.prototype.i=(function(u){return function(){return u}})({});function tu(u,y){Ze.call(this),this.D=u,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(tu,Ze),t=tu.prototype,t.open=function(u,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=y,this.readyState=1,Ga(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(y.body=u),(this.D||a).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wa(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ga(this)),this.g&&(this.readyState=3,Ga(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lb(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lb(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var y=u.value?u.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!u.done}))&&(this.response=this.responseText+=y)}u.done?Wa(this):Ga(this),this.readyState==3&&Lb(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Wa(this))},t.Qa=function(u){this.g&&(this.response=u,Wa(this))},t.ga=function(){this.g&&Wa(this)};function Wa(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ga(u)}t.setRequestHeader=function(u,y){this.u.append(u,y)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],y=this.h.entries();for(var b=y.next();!b.done;)b=b.value,u.push(b[0]+": "+b[1]),b=y.next();return u.join(`\r
`)};function Ga(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(tu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Vb(u){let y="";return P(u,function(b,V){y+=V,y+=":",y+=b,y+=`\r
`}),y}function ep(u,y,b){e:{for(V in b){var V=!1;break e}V=!0}V||(b=Vb(b),typeof u=="string"?b!=null&&encodeURIComponent(String(b)):gt(u,y,b))}function Et(u){Ze.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(Et,Ze);var FP=/^https?$/i,LP=["POST","PUT"];t=Et.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,y,b,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);y=y?y.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Gf.g(),this.v=this.o?Pt(this.o):Pt(Gf),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(y,String(u),!0),this.B=!1}catch(ne){Ub(this,ne);return}if(u=b||"",b=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var Q in V)b.set(Q,V[Q]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(let ne of V.keys())b.set(ne,V.get(ne));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(b.keys()).find(ne=>ne.toLowerCase()=="content-type"),Q=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(LP,y,void 0))||V||Q||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[ne,ge]of b)this.g.setRequestHeader(ne,ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$b(this),this.u=!0,this.g.send(u),this.u=!1}catch(ne){Ub(this,ne)}};function Ub(u,y){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=y,u.m=5,jb(u),nu(u)}function jb(u){u.A||(u.A=!0,_t(u,"complete"),_t(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,_t(this,"complete"),_t(this,"abort"),nu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nu(this,!0)),Et.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Bb(this):this.bb())},t.bb=function(){Bb(this)};function Bb(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Ur(u)!=4||u.Z()!=2)){if(u.u&&Ur(u)==4)Ln(u.Ea,0,u);else if(_t(u,"readystatechange"),Ur(u)==4){u.h=!1;try{let ge=u.Z();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var b;if(!(b=y)){var V;if(V=ge===0){var Q=String(u.D).match(xb)[1]||null;!Q&&a.self&&a.self.location&&(Q=a.self.location.protocol.slice(0,-1)),V=!FP.test(Q?Q.toLowerCase():"")}b=V}if(b)_t(u,"complete"),_t(u,"success");else{u.m=6;try{var ne=2<Ur(u)?u.g.statusText:""}catch{ne=""}u.l=ne+" ["+u.Z()+"]",jb(u)}}finally{nu(u)}}}}function nu(u,y){if(u.g){$b(u);let b=u.g,V=u.v[0]?()=>{}:null;u.g=null,u.v=null,y||_t(u,"ready");try{b.onreadystatechange=V}catch{}}}function $b(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Ur(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Ur(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var y=this.g.responseText;return u&&y.indexOf(u)==0&&(y=y.substring(u.length)),ve(y)}};function Hb(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function VP(u){let y={};u=(u.g&&2<=Ur(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<u.length;V++){if(A(u[V]))continue;var b=L(u[V]);let Q=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();let ne=y[Q]||[];y[Q]=ne,ne.push(b)}D(y,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ka(u,y,b){return b&&b.internalChannelParams&&b.internalChannelParams[u]||y}function zb(u){this.Aa=0,this.i=[],this.j=new Ut,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ka("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ka("baseRetryDelayMs",5e3,u),this.cb=Ka("retryDelaySeedMs",1e4,u),this.Wa=Ka("forwardChannelMaxRetries",2,u),this.wa=Ka("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ab(u&&u.concurrentRequestLimit),this.Da=new NP,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=zb.prototype,t.la=8,t.G=1,t.connect=function(u,y,b,V){Vt(0),this.W=u,this.H=y||{},b&&V!==void 0&&(this.H.OSID=b,this.H.OAID=V),this.F=this.X,this.I=Jb(this,null,this.W),iu(this)};function tp(u){if(qb(u),u.G==3){var y=u.U++,b=Vr(u.I);if(gt(b,"SID",u.K),gt(b,"RID",y),gt(b,"TYPE","terminate"),Ya(u,b),y=new gi(u,u.j,y),y.L=2,y.v=eu(Vr(b)),b=!1,a.navigator&&a.navigator.sendBeacon)try{b=a.navigator.sendBeacon(y.v.toString(),"")}catch{}!b&&a.Image&&(new Image().src=y.v,b=!0),b||(y.g=ew(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Ql(y)}Zb(u)}function ru(u){u.g&&(rp(u),u.g.cancel(),u.g=null)}function qb(u){ru(u),u.u&&(a.clearTimeout(u.u),u.u=null),su(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function iu(u){if(!Sb(u.h)&&!u.s){u.s=!0;var y=u.Ga;q||I(),x||(q(),x=!0),w.add(y,u),u.B=0}}function UP(u,y){return Cb(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=y.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Jn(f(u.Ga,u,y),Qb(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let Q=new gi(this,this.j,u),ne=this.o;if(this.S&&(ne?(ne=S(ne),F(ne,this.S)):ne=this.S),this.m!==null||this.O||(Q.H=ne,ne=null),this.P)e:{for(var y=0,b=0;b<this.i.length;b++){t:{var V=this.i[b];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(y+=V,4096<y){y=b;break e}if(y===4096||b===this.i.length-1){y=b+1;break e}}y=1e3}else y=1e3;y=Gb(this,Q,y),b=Vr(this.I),gt(b,"RID",u),gt(b,"CVER",22),this.D&&gt(b,"X-HTTP-Session-Id",this.D),Ya(this,b),ne&&(this.O?y="headers="+encodeURIComponent(String(Vb(ne)))+"&"+y:this.m&&ep(b,this.m,ne)),Jf(this.h,Q),this.Ua&&gt(b,"TYPE","init"),this.P?(gt(b,"$req",y),gt(b,"SID","null"),Q.T=!0,Yf(Q,b,null)):Yf(Q,b,y),this.G=2}}else this.G==3&&(u?Wb(this,u):this.i.length==0||Sb(this.h)||Wb(this))};function Wb(u,y){var b;y?b=y.l:b=u.U++;let V=Vr(u.I);gt(V,"SID",u.K),gt(V,"RID",b),gt(V,"AID",u.T),Ya(u,V),u.m&&u.o&&ep(V,u.m,u.o),b=new gi(u,u.j,b,u.B+1),u.m===null&&(b.H=u.o),y&&(u.i=y.D.concat(u.i)),y=Gb(u,b,1e3),b.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Jf(u.h,b),Yf(b,V,y)}function Ya(u,y){u.H&&P(u.H,function(b,V){gt(y,V,b)}),u.l&&Pb({},function(b,V){gt(y,V,b)})}function Gb(u,y,b){b=Math.min(u.i.length,b);var V=u.l?f(u.l.Na,u.l,u):null;e:{var Q=u.i;let ne=-1;for(;;){let ge=["count="+b];ne==-1?0<b?(ne=Q[0].g,ge.push("ofs="+ne)):ne=0:ge.push("ofs="+ne);let ct=!0;for(let Jt=0;Jt<b;Jt++){let Je=Q[Jt].g,sn=Q[Jt].map;if(Je-=ne,0>Je)ne=Math.max(0,Q[Jt].g-100),ct=!1;else try{OP(sn,ge,"req"+Je+"_")}catch{V&&V(sn)}}if(ct){V=ge.join("&");break e}}}return u=u.i.splice(0,b),y.D=u,V}function Kb(u){if(!u.g&&!u.u){u.Y=1;var y=u.Fa;q||I(),x||(q(),x=!0),w.add(y,u),u.v=0}}function np(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Jn(f(u.Fa,u),Qb(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Yb(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Jn(f(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vt(10),ru(this),Yb(this))};function rp(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Yb(u){u.g=new gi(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var y=Vr(u.qa);gt(y,"RID","rpc"),gt(y,"SID",u.K),gt(y,"AID",u.T),gt(y,"CI",u.F?"0":"1"),!u.F&&u.ja&&gt(y,"TO",u.ja),gt(y,"TYPE","xmlhttp"),Ya(u,y),u.m&&u.o&&ep(y,u.m,u.o),u.L&&(u.g.I=u.L);var b=u.g;u=u.ia,b.L=1,b.v=eu(Vr(y)),b.m=null,b.P=!0,wb(b,u)}t.Za=function(){this.C!=null&&(this.C=null,ru(this),np(this),Vt(19))};function su(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Xb(u,y){var b=null;if(u.g==y){su(u),rp(u),u.g=null;var V=2}else if(Zf(u.h,y))b=y.D,Db(u.h,y),V=1;else return;if(u.G!=0){if(y.o)if(V==1){b=y.m?y.m.length:0,y=Date.now()-y.F;var Q=u.B;V=Lr(),_t(V,new Js(V,b)),iu(u)}else Kb(u);else if(Q=y.s,Q==3||Q==0&&0<y.X||!(V==1&&UP(u,y)||V==2&&np(u)))switch(b&&0<b.length&&(y=u.h,y.i=y.i.concat(b)),Q){case 1:is(u,5);break;case 4:is(u,10);break;case 3:is(u,6);break;default:is(u,2)}}}function Qb(u,y){let b=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(b*=2),b*y}function is(u,y){if(u.j.info("Error code "+y),y==2){var b=f(u.fb,u),V=u.Xa;let Q=!V;V=new rs(V||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Zl(V,"https"),eu(V),Q?MP(V.toString(),b):kP(V.toString(),b)}else Vt(2);u.G=0,u.l&&u.l.sa(y),Zb(u),qb(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function Zb(u){if(u.G=0,u.ka=[],u.l){let y=Rb(u.h);(y.length!=0||u.i.length!=0)&&(v(u.ka,y),v(u.ka,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.ra()}}function Jb(u,y,b){var V=b instanceof rs?Vr(b):new rs(b);if(V.g!="")y&&(V.g=y+"."+V.g),Jl(V,V.s);else{var Q=a.location;V=Q.protocol,y=y?y+"."+Q.hostname:Q.hostname,Q=+Q.port;var ne=new rs(null);V&&Zl(ne,V),y&&(ne.g=y),Q&&Jl(ne,Q),b&&(ne.l=b),V=ne}return b=u.D,y=u.ya,b&&y&&gt(V,b,y),gt(V,"VER",u.la),Ya(u,V),V}function ew(u,y,b){if(y&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=u.Ca&&!u.pa?new Et(new qa({eb:b})):new Et(u.pa),y.Ha(u.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function tw(){}t=tw.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ou(){}ou.prototype.g=function(u,y){return new Dn(u,y)};function Dn(u,y){Ze.call(this),this.g=new zb(y),this.l=u,this.h=y&&y.messageUrlParams||null,u=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(u?u["X-WebChannel-Content-Type"]=y.messageContentType:u={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(u?u["X-WebChannel-Client-Profile"]=y.va:u={"X-WebChannel-Client-Profile":y.va}),this.g.S=u,(u=y&&y.Sb)&&!A(u)&&(this.g.m=u),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!A(y)&&(this.g.D=y,u=this.h,u!==null&&y in u&&(u=this.h,y in u&&delete u[y])),this.j=new no(this)}m(Dn,Ze),Dn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Dn.prototype.close=function(){tp(this.g)},Dn.prototype.o=function(u){var y=this.g;if(typeof u=="string"){var b={};b.__data__=u,u=b}else this.u&&(b={},b.__data__=Z(u),u=b);y.i.push(new wP(y.Ya++,u)),y.G==3&&iu(y)},Dn.prototype.N=function(){this.g.l=null,delete this.j,tp(this.g),delete this.g,Dn.aa.N.call(this)};function nw(u){Qn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var y=u.__sm__;if(y){e:{for(let b in y){u=b;break e}u=void 0}(this.i=u)&&(u=this.i,y=y!==null&&u in y?y[u]:void 0),this.data=y}else this.data=u}m(nw,Qn);function rw(){Kt.call(this),this.status=1}m(rw,Kt);function no(u){this.g=u}m(no,tw),no.prototype.ua=function(){_t(this.g,"a")},no.prototype.ta=function(u){_t(this.g,new nw(u))},no.prototype.sa=function(u){_t(this.g,new rw)},no.prototype.ra=function(){_t(this.g,"b")},ou.prototype.createWebChannel=ou.prototype.g,Dn.prototype.send=Dn.prototype.o,Dn.prototype.open=Dn.prototype.m,Dn.prototype.close=Dn.prototype.close,Wv=ai.createWebChannelTransport=function(){return new ou},qv=ai.getStatEventTarget=function(){return Lr()},zv=ai.Event=yn,Hh=ai.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Yl.NO_ERROR=0,Yl.TIMEOUT=8,Yl.HTTP_ERROR=6,El=ai.ErrorCode=Yl,_b.COMPLETE="complete",Hv=ai.EventType=_b,Fr.EventType=Vn,Vn.OPEN="a",Vn.CLOSE="b",Vn.ERROR="c",Vn.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,da=ai.WebChannel=Fr,FU=ai.FetchXmlHttpFactory=qa,Et.prototype.listenOnce=Et.prototype.L,Et.prototype.getLastError=Et.prototype.Ka,Et.prototype.getLastErrorCode=Et.prototype.Ba,Et.prototype.getStatus=Et.prototype.Z,Et.prototype.getResponseJson=Et.prototype.Oa,Et.prototype.getResponseText=Et.prototype.oa,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Ha,$v=ai.XhrIo=Et}).apply(typeof $h<"u"?$h:typeof self<"u"?self:typeof window<"u"?window:{});var cC="@firebase/firestore",lC="4.8.0";var Xt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");var ka="11.10.0";var qs=new Sr("@firebase/firestore");function ha(){return qs.logLevel}function _e(t,...e){if(qs.logLevel<=He.DEBUG){let n=e.map(kE);qs.debug(`Firestore (${ka}): ${t}`,...n)}}function ci(t,...e){if(qs.logLevel<=He.ERROR){let n=e.map(kE);qs.error(`Firestore (${ka}): ${t}`,...n)}}function Ki(t,...e){if(qs.logLevel<=He.WARN){let n=e.map(kE);qs.warn(`Firestore (${ka}): ${t}`,...n)}}function kE(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Ce(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,QC(t,r,n)}function QC(t,e,n){let r=`FIRESTORE (${ka}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ci(r),new Error(r)}function ot(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||QC(e,i,r)}function Oe(t,e){return t}var le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ie=class extends Sn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Rr=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Xh=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Qv=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}},Zv=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Jv=class{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ot(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new Rr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Rr,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>X(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{_e("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(_e("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Rr)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(_e("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ot(typeof r.accessToken=="string",31837,{l:r}),new Xh(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ot(e===null||typeof e=="string",2055,{h:e}),new Xt(e)}},e_=class{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},t_=class{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new e_(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Qh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},n_=class{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,lr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ot(this.o===void 0,3512);let r=s=>{s.error!=null&&_e("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,_e("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{_e("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):_e("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Qh(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ot(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Qh(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function LU(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}function ZC(){return new TextEncoder}var Cl=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=LU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}};function Be(t,e){return t<e?-1:t>e?1:0}function r_(t,e){let n=0;for(;n<t.length&&n<e.length;){let r=t.codePointAt(n),i=e.codePointAt(n);if(r!==i){if(r<128&&i<128)return Be(r,i);{let s=ZC(),o=VU(s.encode(uC(t,n)),s.encode(uC(e,n)));return o!==0?o:Be(r,i)}}n+=r>65535?2:1}return Be(t.length,e.length)}function uC(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function VU(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Be(t[n],e[n]);return Be(t.length,e.length)}function _a(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}var dC="__name__",Zh=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ce(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ce(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=t.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Be(e.length,n.length)}static compareSegments(e,n){let r=t.isNumericId(e),i=t.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?t.extractNumericId(e).compare(t.extractNumericId(n)):r_(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return oi.fromString(e.substring(4,e.length-2))}},Ct=class t extends Zh{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new Ie(le.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},UU=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Fn=class t extends Zh{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return UU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===dC}static keyField(){return new t([dC])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new Ie(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new Ie(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ie(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Ie(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var De=class t{constructor(e){this.path=e}static fromPath(e){return new t(Ct.fromString(e))}static fromName(e){return new t(Ct.fromString(e).popFirst(5))}static empty(){return new t(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ct.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new Ct(e.slice()))}};function jU(t,e,n){if(!n)throw new Ie(le.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function BU(t,e,n,r){if(e===!0&&r===!0)throw new Ie(le.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function hC(t){if(!De.isDocumentKey(t))throw new Ie(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function JC(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function NE(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ce(12329,{type:typeof t})}function Dl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ie(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=NE(t);throw new Ie(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Ft(t,e){let n={typeString:t};return e&&(n.value=e),n}function Bl(t,e){if(!JC(t))throw new Ie(le.INVALID_ARGUMENT,"JSON must be an object");let n;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}let o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Ie(le.INVALID_ARGUMENT,n);return!0}var fC=-62135596800,pC=1e6,Lt=class t{static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*pC);return new t(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ie(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ie(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<fC)throw new Ie(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pC}_compareTo(e){return this.seconds===e.seconds?Be(this.nanoseconds,e.nanoseconds):Be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Bl(e,t._jsonSchema))return new t(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-fC;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Lt._jsonSchemaVersion="firestore/timestamp/1.0",Lt._jsonSchema={type:Ft("string",Lt._jsonSchemaVersion),seconds:Ft("number"),nanoseconds:Ft("number")};var Ve=class t{static fromTimestamp(e){return new t(e)}static min(){return new t(new Lt(0,0))}static max(){return new t(new Lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Rl=-1,i_=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};i_.UNKNOWN_ID=-1;function $U(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ve.fromTimestamp(r===1e9?new Lt(n+1,0):new Lt(n,r));return new Ws(i,De.empty(),e)}function HU(t){return new Ws(t.readTime,t.key,Rl)}var Ws=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(Ve.min(),De.empty(),Rl)}static max(){return new t(Ve.max(),De.empty(),Rl)}};function zU(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=De.comparator(t.documentKey,e.documentKey),n!==0?n:Be(t.largestBatchId,e.largestBatchId))}var qU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",s_=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Na(t){return X(this,null,function*(){if(t.code!==le.FAILED_PRECONDITION||t.message!==qU)throw t;_e("LocalStore","Unexpectedly lost primary lease")})}var de=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;n(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};function WU(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Oa(t){return t.name==="IndexedDbTransactionError"}var OE=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.ae&&this.ae(n),n}}t.ue=-1;return t})(),FE=-1;function Rf(t){return t==null}function Pl(t){return t===0&&1/t==-1/0}function GU(t){return typeof t=="number"&&Number.isInteger(t)&&!Pl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var eD="";function KU(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=gC(e)),e=YU(t.get(n),e);return gC(e)}function YU(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case eD:n+="";break;default:n+=s}}return n}function gC(t){return t+eD+""}var XU="remoteDocuments",tD="owner";var nD="mutationQueues";var rD="mutations";var iD="documentMutations",QU="remoteDocumentsV14";var sD="remoteDocumentGlobal";var oD="targets";var aD="targetDocuments";var cD="targetGlobal",lD="collectionParents";var uD="clientMetadata";var dD="bundles";var hD="namedQueries";var ZU="indexConfiguration";var JU="indexState";var ej="indexEntries";var fD="documentOverlays";var tj="globals";var nj=[nD,rD,iD,XU,oD,tD,cD,aD,uD,sD,lD,dD,hD],Ure=[...nj,fD],rj=[nD,rD,iD,QU,oD,tD,cD,aD,uD,sD,lD,dD,hD,fD],ij=rj,sj=[...ij,ZU,JU,ej];var jre=[...sj,tj];function mC(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zi(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function pD(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var wt=class t{constructor(e,n){this.comparator=e,this.root=n||Pr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Pr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ma(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ma(this.root,e,this.comparator,!1)}getReverseIterator(){return new ma(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ma(this.root,e,this.comparator,!0)}},ma=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Pr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ce(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Ce(27949);return e+(this.isRed()?0:1)}};Pr.EMPTY=null,Pr.RED=!0,Pr.BLACK=!1;Pr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce(57766)}get value(){throw Ce(16141)}get color(){throw Ce(16727)}get left(){throw Ce(29726)}get right(){throw Ce(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Pr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Qt=class t{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Jh(this.data.getIterator())}getIteratorFrom(e){return new Jh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Jh=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Dr=class t{constructor(e){this.fields=e,e.sort(Fn.comparator)}static empty(){return new t([])}unionWith(e){let n=new Qt(Fn.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return _a(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var ef=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var un=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ef("Invalid base64 string: "+s):s}})(e);return new t(n)}static fromUint8Array(e){let n=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};un.EMPTY_BYTE_STRING=new un("");var oj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function li(t){if(ot(!!t,39018),typeof t=="string"){let e=0,n=oj.exec(t);if(ot(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vt(t.seconds),nanos:vt(t.nanos)}}function vt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ui(t){return typeof t=="string"?un.fromBase64String(t):un.fromUint8Array(t)}var gD="server_timestamp",mD="__type__",yD="__previous_value__",vD="__local_write_time__";function LE(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[mD])===null||n===void 0?void 0:n.stringValue)===gD}function Pf(t){let e=t.mapValue.fields[yD];return LE(e)?Pf(e):e}function xl(t){let e=li(t.mapValue.fields[vD].timestampValue);return new Lt(e.seconds,e.nanos)}var o_=class{constructor(e,n,r,i,s,o,a,c,l,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=d}},tf="(default)",nf=class t{constructor(e,n){this.projectId=e,this.database=n||tf}static empty(){return new t("","")}get isDefaultDatabase(){return this.database===tf}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var VE="__type__",_D="__max__",zh={mapValue:{fields:{__type__:{stringValue:_D}}}},UE="__vector__",Ea="value";function Yi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?LE(t)?4:bD(t)?9007199254740991:ED(t)?10:11:Ce(28295,{value:t})}function kr(t,e){if(t===e)return!0;let n=Yi(t);if(n!==Yi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xl(t).isEqual(xl(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=li(i.timestampValue),a=li(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,s){return ui(i.bytesValue).isEqual(ui(s.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,s){return vt(i.geoPointValue.latitude)===vt(s.geoPointValue.latitude)&&vt(i.geoPointValue.longitude)===vt(s.geoPointValue.longitude)})(t,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return vt(i.integerValue)===vt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=vt(i.doubleValue),a=vt(s.doubleValue);return o===a?Pl(o)===Pl(a):isNaN(o)&&isNaN(a)}return!1})(t,e);case 9:return _a(t.arrayValue.values||[],e.arrayValue.values||[],kr);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(mC(o)!==mC(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!kr(o[c],a[c])))return!1;return!0})(t,e);default:return Ce(52216,{left:t})}}function Ml(t,e){return(t.values||[]).find(n=>kr(n,e))!==void 0}function ba(t,e){if(t===e)return 0;let n=Yi(t),r=Yi(e);if(n!==r)return Be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Be(t.booleanValue,e.booleanValue);case 2:return(function(s,o){let a=vt(s.integerValue||s.doubleValue),c=vt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(t,e);case 3:return yC(t.timestampValue,e.timestampValue);case 4:return yC(xl(t),xl(e));case 5:return r_(t.stringValue,e.stringValue);case 6:return(function(s,o){let a=ui(s),c=ui(o);return a.compareTo(c)})(t.bytesValue,e.bytesValue);case 7:return(function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=Be(a[l],c[l]);if(d!==0)return d}return Be(a.length,c.length)})(t.referenceValue,e.referenceValue);case 8:return(function(s,o){let a=Be(vt(s.latitude),vt(o.latitude));return a!==0?a:Be(vt(s.longitude),vt(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return vC(t.arrayValue,e.arrayValue);case 10:return(function(s,o){var a,c,l,d;let h=s.fields||{},f=o.fields||{},p=(a=h[Ea])===null||a===void 0?void 0:a.arrayValue,m=(c=f[Ea])===null||c===void 0?void 0:c.arrayValue,g=Be(((l=p?.values)===null||l===void 0?void 0:l.length)||0,((d=m?.values)===null||d===void 0?void 0:d.length)||0);return g!==0?g:vC(p,m)})(t.mapValue,e.mapValue);case 11:return(function(s,o){if(s===zh.mapValue&&o===zh.mapValue)return 0;if(s===zh.mapValue)return 1;if(o===zh.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let f=r_(c[h],d[h]);if(f!==0)return f;let p=ba(a[c[h]],l[d[h]]);if(p!==0)return p}return Be(c.length,d.length)})(t.mapValue,e.mapValue);default:throw Ce(23264,{le:n})}}function yC(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Be(t,e);let n=li(t),r=li(e),i=Be(n.seconds,r.seconds);return i!==0?i:Be(n.nanos,r.nanos)}function vC(t,e){let n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){let s=ba(n[i],r[i]);if(s)return s}return Be(n.length,r.length)}function wa(t){return a_(t)}function a_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){let r=li(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return ui(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return De.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=a_(s);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${a_(n.fields[o])}`;return i+"}"})(t.mapValue):Ce(61005,{value:t})}function Gh(t){switch(Yi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Pf(t);return e?16+Gh(e):16;case 5:return 2*t.stringValue.length;case 6:return ui(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+Gh(s),0)})(t.arrayValue);case 10:case 11:return(function(r){let i=0;return Zi(r.fields,(s,o)=>{i+=s.length+Gh(o)}),i})(t.mapValue);default:throw Ce(13486,{value:t})}}function c_(t){return!!t&&"integerValue"in t}function jE(t){return!!t&&"arrayValue"in t}function _C(t){return!!t&&"nullValue"in t}function EC(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Kh(t){return!!t&&"mapValue"in t}function ED(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[VE])===null||n===void 0?void 0:n.stringValue)===UE}function wl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Zi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=wl(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=wl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function bD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_D}var $re={mapValue:{fields:{[VE]:{stringValue:UE},[Ea]:{arrayValue:{}}}}};var Xn=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Kh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=wl(n)}setAll(e){let n=Fn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=wl(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Kh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Kh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Zi(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(wl(this.value))}};function wD(t){let e=[];return Zi(t.fields,(n,r)=>{let i=new Fn([n]);if(Kh(r)){let s=wD(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Dr(e)}var dr=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,Ve.min(),Ve.min(),Ve.min(),Xn.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,Ve.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,Ve.min(),Ve.min(),Xn.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,Ve.min(),Ve.min(),Xn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ia=class{constructor(e,n){this.position=e,this.inclusive=n}};function bC(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=De.comparator(De.fromName(o.referenceValue),n.key):r=ba(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function wC(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kr(t.position[n],e.position[n]))return!1;return!0}var Ta=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function aj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var rf=class{},Gt=class t extends rf{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new u_(e,n,r):n==="array-contains"?new f_(e,r):n==="in"?new p_(e,r):n==="not-in"?new g_(e,r):n==="array-contains-any"?new m_(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new d_(e,r):new h_(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ba(n,this.value)):n!==null&&Yi(this.value)===Yi(n)&&this.matchesComparison(ba(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Nr=class t extends rf{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new t(e,n)}matches(e){return ID(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function ID(t){return t.op==="and"}function TD(t){return cj(t)&&ID(t)}function cj(t){for(let e of t.filters)if(e instanceof Nr)return!1;return!0}function l_(t){if(t instanceof Gt)return t.field.canonicalString()+t.op.toString()+wa(t.value);if(TD(t))return t.filters.map(e=>l_(e)).join(",");{let e=t.filters.map(n=>l_(n)).join(",");return`${t.op}(${e})`}}function AD(t,e){return t instanceof Gt?(function(r,i){return i instanceof Gt&&r.op===i.op&&r.field.isEqual(i.field)&&kr(r.value,i.value)})(t,e):t instanceof Nr?(function(r,i){return i instanceof Nr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&AD(o,i.filters[a]),!0):!1})(t,e):void Ce(19439)}function SD(t){return t instanceof Gt?(function(n){return`${n.field.canonicalString()} ${n.op} ${wa(n.value)}`})(t):t instanceof Nr?(function(n){return n.op.toString()+" {"+n.getFilters().map(SD).join(" ,")+"}"})(t):"Filter"}var u_=class extends Gt{constructor(e,n,r){super(e,n,r),this.key=De.fromName(r.referenceValue)}matches(e){let n=De.comparator(e.key,this.key);return this.matchesComparison(n)}},d_=class extends Gt{constructor(e,n){super(e,"in",n),this.keys=CD("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},h_=class extends Gt{constructor(e,n){super(e,"not-in",n),this.keys=CD("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function CD(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>De.fromName(r.referenceValue))}var f_=class extends Gt{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return jE(n)&&Ml(n.arrayValue,this.value)}},p_=class extends Gt{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Ml(this.value.arrayValue,n)}},g_=class extends Gt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ml(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ml(this.value.arrayValue,n)}},m_=class extends Gt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!jE(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ml(this.value.arrayValue,r))}};var y_=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Pe=null}};function IC(t,e=null,n=[],r=[],i=null,s=null,o=null){return new y_(t,e,n,r,i,s,o)}function BE(t){let e=Oe(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>l_(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),Rf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>wa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>wa(r)).join(",")),e.Pe=n}return e.Pe}function $E(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!aj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!AD(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wC(t.startAt,e.startAt)&&wC(t.endAt,e.endAt)}function v_(t){return De.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}var Aa=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function lj(t,e,n,r,i,s,o,a){return new Aa(t,e,n,r,i,s,o,a)}function HE(t){return new Aa(t)}function TC(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uj(t){return t.collectionGroup!==null}function Il(t){let e=Oe(t);if(e.Te===null){e.Te=[];let n=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Qt(Fn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Ta(s,r))}),n.has(Fn.keyField().canonicalString())||e.Te.push(new Ta(Fn.keyField(),r))}return e.Te}function xr(t){let e=Oe(t);return e.Ie||(e.Ie=dj(e,Il(t))),e.Ie}function dj(t,e){if(t.limitType==="F")return IC(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ta(i.field,s)});let n=t.endAt?new Ia(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ia(t.startAt.position,t.startAt.inclusive):null;return IC(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function __(t,e,n){return new Aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xf(t,e){return $E(xr(t),xr(e))&&t.limitType===e.limitType}function DD(t){return`${BE(xr(t))}|lt:${t.limitType}`}function fa(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>SD(i)).join(", ")}]`),Rf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>wa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>wa(i)).join(",")),`Target(${r})`})(xr(t))}; limitType=${t.limitType})`}function Mf(t,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):De.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(t,e)&&(function(r,i){for(let s of Il(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(t,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(t,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){let l=bC(o,a,c);return o.inclusive?l<=0:l<0})(r.startAt,Il(r),i)||r.endAt&&!(function(o,a,c){let l=bC(o,a,c);return o.inclusive?l>=0:l>0})(r.endAt,Il(r),i))})(t,e)}function hj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function RD(t){return(e,n)=>{let r=!1;for(let i of Il(t)){let s=fj(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function fj(t,e,n){let r=t.field.isKeyField()?De.comparator(e.key,n.key):(function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?ba(c,l):Ce(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ce(19790,{direction:t.dir})}}var di=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zi(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return pD(this.inner)}size(){return this.innerSize}};var pj=new wt(De.comparator);function hi(){return pj}var PD=new wt(De.comparator);function bl(...t){let e=PD;for(let n of t)e=e.insert(n.key,n);return e}function xD(t){let e=PD;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function js(){return Tl()}function MD(){return Tl()}function Tl(){return new di(t=>t.toString(),(t,e)=>t.isEqual(e))}var gj=new wt(De.comparator),mj=new Qt(De.comparator);function Ge(...t){let e=mj;for(let n of t)e=e.add(n);return e}var yj=new Qt(Be);function vj(){return yj}function zE(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pl(e)?"-0":e}}function kD(t){return{integerValue:""+t}}function _j(t,e){return GU(e)?kD(e):zE(t,e)}var Sa=class{constructor(){this._=void 0}};function Ej(t,e,n){return t instanceof Ca?(function(i,s){let o={fields:{[mD]:{stringValue:gD},[vD]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&LE(s)&&(s=Pf(s)),s&&(o.fields[yD]=s),{mapValue:o}})(n,e):t instanceof Gs?OD(t,e):t instanceof Ks?FD(t,e):(function(i,s){let o=ND(i,s),a=AC(o)+AC(i.Ee);return c_(o)&&c_(i.Ee)?kD(a):zE(i.serializer,a)})(t,e)}function bj(t,e,n){return t instanceof Gs?OD(t,e):t instanceof Ks?FD(t,e):n}function ND(t,e){return t instanceof Da?(function(r){return c_(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Ca=class extends Sa{},Gs=class extends Sa{constructor(e){super(),this.elements=e}};function OD(t,e){let n=LD(e);for(let r of t.elements)n.some(i=>kr(i,r))||n.push(r);return{arrayValue:{values:n}}}var Ks=class extends Sa{constructor(e){super(),this.elements=e}};function FD(t,e){let n=LD(e);for(let r of t.elements)n=n.filter(i=>!kr(i,r));return{arrayValue:{values:n}}}var Da=class extends Sa{constructor(e,n){super(),this.serializer=e,this.Ee=n}};function AC(t){return vt(t.integerValue||t.doubleValue)}function LD(t){return jE(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function wj(t,e){return t.field.isEqual(e.field)&&(function(r,i){return r instanceof Gs&&i instanceof Gs||r instanceof Ks&&i instanceof Ks?_a(r.elements,i.elements,kr):r instanceof Da&&i instanceof Da?kr(r.Ee,i.Ee):r instanceof Ca&&i instanceof Ca})(t.transform,e.transform)}var E_=class{constructor(e,n){this.version=e,this.transformResults=n}},Hs=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Yh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Ra=class{};function VD(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new sf(t.key,Hs.none()):new Pa(t.key,t.data,Hs.none());{let n=t.data,r=Xn.empty(),i=new Qt(Fn.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new fi(t.key,r,new Dr(i.toArray()),Hs.none())}}function Ij(t,e,n){t instanceof Pa?(function(i,s,o){let a=i.value.clone(),c=CC(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(t,e,n):t instanceof fi?(function(i,s,o){if(!Yh(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=CC(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(UD(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,n):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function Al(t,e,n,r){return t instanceof Pa?(function(s,o,a,c){if(!Yh(s.precondition,o))return a;let l=s.value.clone(),d=DC(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null})(t,e,n,r):t instanceof fi?(function(s,o,a,c){if(!Yh(s.precondition,o))return a;let l=DC(s.fieldTransforms,c,o),d=o.data;return d.setAll(UD(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))})(t,e,n,r):(function(s,o,a){return Yh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(t,e,n)}function Tj(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=ND(r.transform,i||null);s!=null&&(n===null&&(n=Xn.empty()),n.set(r.field,s))}return n||null}function SC(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&_a(r,i,(s,o)=>wj(s,o))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Pa=class extends Ra{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},fi=class extends Ra{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function UD(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function CC(t,e,n){let r=new Map;ot(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,bj(o,a,n[i]))}return r}function DC(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,Ej(s,o,e))}return r}var sf=class extends Ra{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},b_=class extends Ra{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var w_=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&Ij(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Al(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Al(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=MD();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=VD(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ge())}isEqual(e){return this.batchId===e.batchId&&_a(this.mutations,e.mutations,(n,r)=>SC(n,r))&&_a(this.baseMutations,e.baseMutations,(n,r)=>SC(n,r))}},I_=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ot(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return gj})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var T_=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var A_=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var Nt,Qe;function Aj(t){switch(t){case le.OK:return Ce(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Ce(15467,{code:t})}}function jD(t){if(t===void 0)return ci("GRPC error has no .code"),le.UNKNOWN;switch(t){case Nt.OK:return le.OK;case Nt.CANCELLED:return le.CANCELLED;case Nt.UNKNOWN:return le.UNKNOWN;case Nt.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case Nt.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case Nt.INTERNAL:return le.INTERNAL;case Nt.UNAVAILABLE:return le.UNAVAILABLE;case Nt.UNAUTHENTICATED:return le.UNAUTHENTICATED;case Nt.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case Nt.NOT_FOUND:return le.NOT_FOUND;case Nt.ALREADY_EXISTS:return le.ALREADY_EXISTS;case Nt.PERMISSION_DENIED:return le.PERMISSION_DENIED;case Nt.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case Nt.ABORTED:return le.ABORTED;case Nt.OUT_OF_RANGE:return le.OUT_OF_RANGE;case Nt.UNIMPLEMENTED:return le.UNIMPLEMENTED;case Nt.DATA_LOSS:return le.DATA_LOSS;default:return Ce(39323,{code:t})}}(Qe=Nt||(Nt={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";var RC=null;var Sj=new oi([4294967295,4294967295],0);function PC(t){let e=ZC().encode(t),n=new Bv;return n.update(e),new Uint8Array(n.digest())}function xC(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new oi([n,r],0),new oi([i,s],0)]}var S_=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Bs(`Invalid padding: ${n}`);if(r<0)throw new Bs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Bs(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Bs(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=oi.fromNumber(this.fe)}pe(e,n,r){let i=e.add(n.multiply(oi.fromNumber(r)));return i.compare(Sj)===1&&(i=new oi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let n=PC(e),[r,i]=xC(n);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.fe===0)return;let n=PC(e),[r,i]=xC(n);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);this.we(o)}}we(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Bs=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var of=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,kl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(Ve.min(),i,new wt(Be),hi(),Ge())}},kl=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,Ge(),Ge(),Ge())}};var ya=class{constructor(e,n,r,i){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=i}},af=class{constructor(e,n){this.targetId=e,this.De=n}},cf=class{constructor(e,n,r=un.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},lf=class{constructor(){this.ve=0,this.Ce=MC(),this.Fe=un.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ge(),n=Ge(),r=Ge();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ce(38017,{changeType:s})}}),new kl(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=MC()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ot(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},C_=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=hi(),this.je=qh(),this.Je=qh(),this.He=new wt(Be)}Ye(e){for(let n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(let n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{let r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:Ce(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(e){let n=e.targetId,r=e.De.count,i=this.st(n);if(i){let s=i.target;if(v_(s))if(r===0){let o=new De(s.path);this.Xe(n,o,dr.newNoDocument(o,Ve.min()))}else ot(r===1,20013,{expectedCount:r});else{let o=this.ot(n);if(o!==r){let a=this._t(e),c=a?this.ut(a,e,o):1;if(c!==0){this.rt(n);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,l)}RC?.ct((function(d,h,f,p,m){var g,v,E,A,O,M;let C={localCacheCount:d,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},P=h.unchangedNames;return P&&(C.bloomFilter={applied:m===0,hashCount:(g=P?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(A=(E=(v=P?.bits)===null||v===void 0?void 0:v.bitmap)===null||E===void 0?void 0:E.length)!==null&&A!==void 0?A:0,padding:(M=(O=P?.bits)===null||O===void 0?void 0:O.padding)!==null&&M!==void 0?M:0,mightContain:D=>{var S;return(S=p?.mightContain(D))!==null&&S!==void 0&&S}}),C})(o,e.De,this.We.lt(),a,c))}}}}_t(e){let n=e.De.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=ui(r).toUint8Array()}catch(c){if(c instanceof ef)return Ki("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new S_(o,i,s)}catch(c){return Ki(c instanceof Bs?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.fe===0?null:a}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){let r=this.We.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Xe(n,s,null),i++)}),i}Pt(e){let n=new Map;this.Ge.forEach((s,o)=>{let a=this.st(o);if(a){if(s.current&&v_(a.target)){let c=new De(a.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,dr.newNoDocument(c,e))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=Ge();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.st(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));let i=new of(e,n,this.He,this.ze,r);return this.ze=hi(),this.je=qh(),this.Je=qh(),this.He=new wt(Be),i}Ze(e,n){if(!this.nt(e))return;let r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new lf,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new Qt(Be),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new Qt(Be),this.je=this.je.insert(e,n)),n}nt(e){let n=this.st(e)!==null;return n||_e("WatchChangeAggregator","Detected inactive target",e),n}st(e){let n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new lf),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}};function qh(){return new wt(De.comparator)}function MC(){return new wt(De.comparator)}var Cj={asc:"ASCENDING",desc:"DESCENDING"},Dj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rj={and:"AND",or:"OR"},D_=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function R_(t,e){return t.useProto3Json||Rf(e)?e:{value:e}}function uf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BD(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Pj(t,e){return uf(t,e.toTimestamp())}function Mr(t){return ot(!!t,49232),Ve.fromTimestamp((function(n){let r=li(n);return new Lt(r.seconds,r.nanos)})(t))}function qE(t,e){return P_(t,e).canonicalString()}function P_(t,e){let n=(function(i){return new Ct(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?n:n.child(e)}function $D(t){let e=Ct.fromString(t);return ot(GD(e),10190,{key:e.toString()}),e}function x_(t,e){return qE(t.databaseId,e.path)}function Gv(t,e){let n=$D(e);if(n.get(1)!==t.databaseId.projectId)throw new Ie(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ie(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new De(zD(n))}function HD(t,e){return qE(t.databaseId,e)}function xj(t){let e=$D(t);return e.length===4?Ct.emptyPath():zD(e)}function M_(t){return new Ct(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function zD(t){return ot(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function kC(t,e,n){return{name:x_(t,e),fields:n.value.mapValue.fields}}function Mj(t,e){let n;if("targetChange"in e){e.targetChange;let r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Ce(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(l,d){return l.useProto3Json?(ot(d===void 0||typeof d=="string",58123),un.fromBase64String(d||"")):(ot(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),un.fromUint8Array(d||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(l){let d=l.code===void 0?le.UNKNOWN:jD(l.code);return new Ie(d,l.message||"")})(o);n=new cf(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Gv(t,r.document.name),s=Mr(r.document.updateTime),o=r.document.createTime?Mr(r.document.createTime):Ve.min(),a=new Xn({mapValue:{fields:r.document.fields}}),c=dr.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];n=new ya(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Gv(t,r.document),s=r.readTime?Mr(r.readTime):Ve.min(),o=dr.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ya([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Gv(t,r.document),s=r.removedTargetIds||[];n=new ya([],s,i,null)}else{if(!("filter"in e))return Ce(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new A_(i,s),a=r.targetId;n=new af(a,o)}}return n}function kj(t,e){let n;if(e instanceof Pa)n={update:kC(t,e.key,e.value)};else if(e instanceof sf)n={delete:x_(t,e.key)};else if(e instanceof fi)n={update:kC(t,e.key,e.data),updateMask:$j(e.fieldMask)};else{if(!(e instanceof b_))return Ce(16599,{Rt:e.type});n={verify:x_(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let a=o.transform;if(a instanceof Ca)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ks)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Da)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw Ce(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(n.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:Pj(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ce(27497)})(t,e.precondition)),n}function Nj(t,e){return t&&t.length>0?(ot(e!==void 0,14353),t.map(n=>(function(i,s){let o=i.updateTime?Mr(i.updateTime):Mr(s);return o.isEqual(Ve.min())&&(o=Mr(s)),new E_(o,i.transformResults||[])})(n,e))):[]}function Oj(t,e){return{documents:[HD(t,e.path)]}}function Fj(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=HD(t,i);let s=(function(l){if(l.length!==0)return WD(Nr.create(l,"and"))})(e.filters);s&&(n.structuredQuery.where=s);let o=(function(l){if(l.length!==0)return l.map(d=>(function(f){return{field:pa(f.field),direction:Uj(f.dir)}})(d))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=R_(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{Vt:n,parent:i}}function Lj(t){let e=xj(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ot(r===1,65062);let d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=(function(h){let f=qD(h);return f instanceof Nr&&TD(f)?f.getFilters():[f]})(n.where));let o=[];n.orderBy&&(o=(function(h){return h.map(f=>(function(m){return new Ta(ga(m.field),(function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(m.direction))})(f))})(n.orderBy));let a=null;n.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,Rf(f)?null:f})(n.limit));let c=null;n.startAt&&(c=(function(h){let f=!!h.before,p=h.values||[];return new Ia(p,f)})(n.startAt));let l=null;return n.endAt&&(l=(function(h){let f=!h.before,p=h.values||[];return new Ia(p,f)})(n.endAt)),lj(e,i,o,s,a,"F",c,l)}function Vj(t,e){let n=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce(28987,{purpose:i})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function qD(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=ga(n.unaryFilter.field);return Gt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ga(n.unaryFilter.field);return Gt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ga(n.unaryFilter.field);return Gt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ga(n.unaryFilter.field);return Gt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ce(61313);default:return Ce(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Gt.create(ga(n.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ce(58110);default:return Ce(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Nr.create(n.compositeFilter.filters.map(r=>qD(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ce(1026)}})(n.compositeFilter.op))})(t):Ce(30097,{filter:t})}function Uj(t){return Cj[t]}function jj(t){return Dj[t]}function Bj(t){return Rj[t]}function pa(t){return{fieldPath:t.canonicalString()}}function ga(t){return Fn.fromServerFormat(t.fieldPath)}function WD(t){return t instanceof Gt?(function(n){if(n.op==="=="){if(EC(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NAN"}};if(_C(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(EC(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NOT_NAN"}};if(_C(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pa(n.field),op:jj(n.op),value:n.value}}})(t):t instanceof Nr?(function(n){let r=n.getFilters().map(i=>WD(i));return r.length===1?r[0]:{compositeFilter:{op:Bj(n.op),filters:r}}})(t):Ce(54877,{filter:t})}function $j(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function GD(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Nl=class t{constructor(e,n,r,i,s=Ve.min(),o=Ve.min(),a=un.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var k_=class{constructor(e){this.gt=e}};function Hj(t){let e=Lj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?__(e,e.limit,"L"):e}var df=class{constructor(){}bt(e,n){this.Dt(e,n),n.vt()}Dt(e,n){if("nullValue"in e)this.Ct(n,5);else if("booleanValue"in e)this.Ct(n,10),n.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(n,15),n.Ft(vt(e.integerValue));else if("doubleValue"in e){let r=vt(e.doubleValue);isNaN(r)?this.Ct(n,13):(this.Ct(n,15),Pl(r)?n.Ft(0):n.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(n,20),typeof r=="string"&&(r=li(r)),n.Mt(`${r.seconds||""}`),n.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,n),this.Ot(n);else if("bytesValue"in e)this.Ct(n,30),n.Nt(ui(e.bytesValue)),this.Ot(n);else if("referenceValue"in e)this.Bt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(n,45),n.Ft(r.latitude||0),n.Ft(r.longitude||0)}else"mapValue"in e?bD(e)?this.Ct(n,Number.MAX_SAFE_INTEGER):ED(e)?this.Lt(e.mapValue,n):(this.kt(e.mapValue,n),this.Ot(n)):"arrayValue"in e?(this.qt(e.arrayValue,n),this.Ot(n)):Ce(19022,{Qt:e})}xt(e,n){this.Ct(n,25),this.$t(e,n)}$t(e,n){n.Mt(e)}kt(e,n){let r=e.fields||{};this.Ct(n,55);for(let i of Object.keys(r))this.xt(i,n),this.Dt(r[i],n)}Lt(e,n){var r,i;let s=e.fields||{};this.Ct(n,53);let o=Ea,a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(n,15),n.Ft(vt(a)),this.xt(o,n),this.Dt(s[o],n)}qt(e,n){let r=e.values||[];this.Ct(n,50);for(let i of r)this.Dt(i,n)}Bt(e,n){this.Ct(n,37),De.fromName(e).path.forEach(r=>{this.Ct(n,60),this.$t(r,n)})}Ct(e,n){e.Ft(n)}Ot(e){e.Ft(2)}};df.Ut=new df;var N_=class{constructor(){this.Dn=new O_}addToCollectionParentIndex(e,n){return this.Dn.add(n),de.resolve()}getCollectionParents(e,n){return de.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return de.resolve()}deleteFieldIndex(e,n){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,n){return de.resolve()}getDocumentsMatchingTarget(e,n){return de.resolve(null)}getIndexType(e,n){return de.resolve(0)}getFieldIndexes(e,n){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,n){return de.resolve(Ws.min())}getMinOffsetFromCollectionGroup(e,n){return de.resolve(Ws.min())}updateCollectionGroup(e,n,r){return de.resolve()}updateIndexEntries(e,n){return de.resolve()}},O_=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Qt(Ct.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qt(Ct.comparator)).toArray()}};var Hre=new Uint8Array(0);var NC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},KD=41943040,Yn=class t{static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}};Yn.DEFAULT_COLLECTION_PERCENTILE=10,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yn.DEFAULT=new Yn(KD,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yn.DISABLED=new Yn(-1,0,0);var Ol=class t{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new t(0)}static ur(){return new t(-1)}};var OC="LruGarbageCollector",zj=1048576;function FC([t,e],[n,r]){let i=Be(t,n);return i===0?Be(e,r):i}var F_=class{constructor(e){this.Tr=e,this.buffer=new Qt(FC),this.Ir=0}dr(){return++this.Ir}Er(e){let n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();FC(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},L_=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){_e(OC,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>X(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Oa(n)?_e(OC,"Ignoring IndexedDB error during garbage collection: ",n):yield Na(n)}yield this.Rr(3e5)}))}},V_=class{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return de.resolve(OE.ue);let r=new F_(n);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(_e("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(NC)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(_e("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),NC):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(_e("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),ha()<=He.DEBUG&&_e("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function qj(t,e){return new V_(t,e)}var U_=class{constructor(){this.changes=new di(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?de.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var j_=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var B_=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Al(r.mutation,i,Dr.empty(),Lt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ge()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ge()){let i=js();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=bl();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=js();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ge()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=hi(),o=Tl(),a=(function(){return Tl()})();return n.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof fi)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Al(d.mutation,l,d.mutation.getFieldMask(),Lt.now())):o.set(l.key,Dr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),n.forEach((l,d)=>{var h;return a.set(l,new j_(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Tl(),i=new wt((o,a)=>o-a),s=Ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=n.get(c);if(l===null)return;let d=r.get(c)||Dr.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||Ge()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=MD();d.forEach(f=>{if(!s.has(f)){let p=VD(n.get(f),r.get(f));p!==null&&h.set(f,p),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return de.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return(function(o){return De.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):uj(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):de.resolve(js()),a=Rl,c=s;return o.next(l=>de.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?de.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,Ge())).next(d=>({batchId:a,changes:xD(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new De(n)).next(r=>{let i=bl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=bl();return this.indexManager.getCollectionParents(e,s).next(a=>de.forEach(a,c=>{let l=(function(h,f){return new Aa(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,dr.newInvalidDocument(d)))});let a=bl();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&Al(d.mutation,l,Dr.empty(),Lt.now()),Mf(n,l)&&(a=a.insert(c,l))}),a})}};var $_=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return de.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,(function(i){return{id:i.id,version:i.version,createTime:Mr(i.createTime)}})(n)),de.resolve()}getNamedQuery(e,n){return de.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,(function(i){return{name:i.name,query:Hj(i.bundledQuery),readTime:Mr(i.readTime)}})(n)),de.resolve()}};var H_=class{constructor(){this.overlays=new wt(De.comparator),this.kr=new Map}getOverlay(e,n){return de.resolve(this.overlays.get(n))}getOverlays(e,n){let r=js();return de.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.wt(e,n,s)}),de.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),de.resolve()}getOverlaysForCollection(e,n,r){let i=js(),s=n.length+1,o=new De(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return de.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new wt((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=js(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=js(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return de.resolve(a)}wt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new T_(n,r));let s=this.kr.get(n);s===void 0&&(s=Ge(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}};var z_=class{constructor(){this.sessionToken=un.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,de.resolve()}};var Fl=class{constructor(){this.qr=new Qt(Ot.Qr),this.$r=new Qt(Ot.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){let r=new Ot(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new Ot(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){let n=new De(new Ct([])),r=new Ot(n,e),i=new Ot(n,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let n=new De(new Ct([])),r=new Ot(n,e),i=new Ot(n,e+1),s=Ge();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new Ot(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},Ot=class{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return De.comparator(e.key,n.key)||Be(e.Hr,n.Hr)}static Ur(e,n){return Be(e.Hr,n.Hr)||De.comparator(e.key,n.key)}};var q_=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Qt(Ot.Qr)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new w_(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.Yr=this.Yr.add(new Ot(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return de.resolve(o)}lookupMutationBatch(e,n){return de.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Xr(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?FE:this.er-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new Ot(n,0),i=new Ot(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{let a=this.Zr(o.Hr);s.push(a)}),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qt(Be);return n.forEach(i=>{let s=new Ot(i,0),o=new Ot(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),de.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;De.isDocumentKey(s)||(s=s.child(""));let o=new Ot(new De(s),0),a=new Qt(Be);return this.Yr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.Hr)),!0)},o),de.resolve(this.ei(a))}ei(e){let n=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ot(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return de.forEach(n.mutations,i=>{let s=new Ot(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){let r=new Ot(n,0),i=this.Yr.firstAfterOrEqual(r);return de.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var W_=class{constructor(e){this.ni=e,this.docs=(function(){return new wt(De.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return de.resolve(r?r.document.mutableCopy():dr.newInvalidDocument(n))}getEntries(e,n){let r=hi();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():dr.newInvalidDocument(i))}),de.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=hi(),o=n.path,a=new De(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||zU(HU(d),r)<=0||(i.has(d.key)||Mf(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ce(9500)}ri(e,n){return de.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new G_(this)}getSize(e){return de.resolve(this.size)}},G_=class extends U_{constructor(e){super(),this.Or=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),de.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}};var K_=class{constructor(e){this.persistence=e,this.ii=new di(n=>BE(n),$E),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.si=0,this.oi=new Fl,this.targetCount=0,this._i=Ol.ar()}forEachTarget(e,n){return this.ii.forEach((r,i)=>n(i)),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),de.resolve()}hr(e){this.ii.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this._i=new Ol(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,de.resolve()}updateTargetData(e,n){return this.hr(n),de.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.ii.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),de.waitFor(s).next(()=>i)}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,n){let r=this.ii.get(n)||null;return de.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),de.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),de.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),de.resolve()}getMatchingKeysForTargetId(e,n){let r=this.oi.Jr(n);return de.resolve(r)}containsKey(e,n){return de.resolve(this.oi.containsKey(n))}};var hf=class{constructor(e,n){this.ai={},this.overlays={},this.ui=new OE(0),this.ci=!1,this.ci=!0,this.li=new z_,this.referenceDelegate=e(this),this.hi=new K_(this),this.indexManager=new N_,this.remoteDocumentCache=(function(i){return new W_(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new k_(n),this.Ti=new $_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new H_,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new q_(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){_e("MemoryPersistence","Starting transaction:",e);let i=new Y_(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,n){return de.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}},Y_=class extends s_{constructor(e){super(),this.currentSequenceNumber=e}},X_=class t{constructor(e){this.persistence=e,this.Ai=new Fl,this.Ri=null}static Vi(e){return new t(e)}get mi(){if(this.Ri)return this.Ri;throw Ce(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),de.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),de.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.mi,r=>{let i=De.fromPath(r);return this.fi(e,i).next(s=>{s||n.removeEntry(i,Ve.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return de.or([()=>de.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}},ff=class t{constructor(e,n){this.persistence=e,this.gi=new di(r=>KU(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=qj(this,n)}static Vi(e,n){return new t(e,n)}Ii(){}di(e){return de.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){let n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return de.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?de.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,n).next(a=>{a||(r++,s.removeEntry(o,Ve.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),de.resolve()}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),de.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Gh(e.data.value)),n}Sr(e,n,r){return de.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{let i=this.gi.get(n);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Q_=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=i}static Es(e,n){let r=Ge(),i=Ge();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Z_=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var J_=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return dS()?8:WU(Nn())>0?6:4})()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ps(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Z_;return this.ws(e,n,o).next(a=>{if(s.result=a,this.Rs)return this.Ss(e,n,o,a.size)})}).next(()=>s.result)}Ss(e,n,r,i){return r.documentReadCount<this.Vs?(ha()<=He.DEBUG&&_e("QueryEngine","SDK will not create cache indexes for query:",fa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),de.resolve()):(ha()<=He.DEBUG&&_e("QueryEngine","Query:",fa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(ha()<=He.DEBUG&&_e("QueryEngine","The SDK decides to create cache indexes for query:",fa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xr(n))):de.resolve())}ps(e,n){if(TC(n))return de.resolve(null);let r=xr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=__(n,null,"F"),r=xr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Ge(...s);return this.gs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.bs(n,a);return this.Ds(n,l,o,c.readTime)?this.ps(e,__(n,null,"F")):this.vs(e,l,n,c)}))})))}ys(e,n,r,i){return TC(n)||i.isEqual(Ve.min())?de.resolve(null):this.gs.getDocuments(e,r).next(s=>{let o=this.bs(n,s);return this.Ds(n,o,r,i)?de.resolve(null):(ha()<=He.DEBUG&&_e("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fa(n)),this.vs(e,o,n,$U(i,Rl)).next(a=>a))})}bs(e,n){let r=new Qt(RD(e));return n.forEach((i,s)=>{Mf(e,s)&&(r=r.add(s))}),r}Ds(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,n,r){return ha()<=He.DEBUG&&_e("QueryEngine","Using full collection scan to execute query:",fa(n)),this.gs.getDocumentsMatchingQuery(e,n,Ws.min(),r)}vs(e,n,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var WE="LocalStore",Wj=3e8,eE=class{constructor(e,n,r,i){this.persistence=e,this.Cs=n,this.serializer=i,this.Fs=new wt(Be),this.Ms=new di(s=>BE(s),$E),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new B_(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}};function Gj(t,e,n,r){return new eE(t,e,n,r)}function YD(t,e){return X(this,null,function*(){let n=Oe(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=Ge();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Bs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function Kj(t,e){let n=Oe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return(function(a,c,l,d){let h=l.batch,f=h.keys(),p=de.resolve();return f.forEach(m=>{p=p.next(()=>d.getEntry(c,m)).next(g=>{let v=l.docVersions.get(m);ot(v!==null,48541),g.version.compareTo(v)<0&&(h.applyToRemoteDocument(g,l),g.isValidDocument()&&(g.setReadTime(l.commitVersion),d.addEntry(g)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(c,h))})(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=Ge();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c})(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function XD(t){let e=Oe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function Yj(t,e){let n=Oe(t),r=e.snapshotVersion,i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;let a=[];e.targetChanges.forEach((d,h)=>{let f=i.get(h);if(!f)return;a.push(n.hi.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.hi.addMatchingKeys(s,d.addedDocuments,h)));let p=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(un.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,r)),i=i.insert(h,p),(function(g,v,E){return g.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=Wj?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0})(f,p,d)&&a.push(n.hi.updateTargetData(s,p))});let c=hi(),l=Ge();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(Xj(s,o,e.documentUpdates).next(d=>{c=d.Ls,l=d.ks})),!r.isEqual(Ve.min())){let d=n.hi.getLastRemoteSnapshotVersion(s).next(h=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return de.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.Fs=i,s))}function Xj(t,e,n){let r=Ge(),i=Ge();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=hi();return n.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Ve.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):_e(WE,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function Qj(t,e){let n=Oe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=FE),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Zj(t,e){let n=Oe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,e).next(s=>s?(i=s,de.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new Nl(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}function tE(t,e,n){return X(this,null,function*(){let r=Oe(t),i=r.Fs.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Oa(o))throw o;_e(WE,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)})}function LC(t,e,n){let r=Oe(t),i=Ve.min(),s=Ge();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(c,l,d){let h=Oe(c),f=h.Ms.get(d);return f!==void 0?de.resolve(h.Fs.get(f)):h.hi.getTargetData(l,d)})(r,o,xr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?i:Ve.min(),n?s:Ge())).next(a=>(Jj(r,hj(e),a),{documents:a,qs:s})))}function Jj(t,e,n){let r=t.xs.get(e)||Ve.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.xs.set(e,r)}var pf=class{constructor(){this.activeTargetIds=vj()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var nE=class{constructor(){this.Fo=new pf,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new pf,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var rE=class{xo(e){}shutdown(){}};var VC="ConnectivityMonitor",gf=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){_e(VC,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){_e(VC,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Wh=null;function iE(){return Wh===null?Wh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Wh++,"0x"+Wh.toString(16)}var Kv="RestConnection",eB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},sE=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===tf?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,n,r,i,s){let o=iE(),a=this.Go(e,n.toUriEncodedString());_e(Kv,`Sending RPC '${e}' ${o}:`,a,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);let{host:l}=new URL(a),d=Ar(l);return this.jo(e,a,c,r,d).then(h=>(_e(Kv,`Received RPC '${e}' ${o}: `,h),h),h=>{throw Ki(Kv,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h})}Jo(e,n,r,i,s,o){return this.Wo(e,n,r,i,s)}zo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ka})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,n){let r=eB[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}};var oE=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var ln="WebChannelConnection",aE=class extends sE{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,i,s){let o=iE();return new Promise((a,c)=>{let l=new $v;l.setWithCredentials(!0),l.listenOnce(Hv.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case El.NO_ERROR:let h=l.getResponseJson();_e(ln,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case El.TIMEOUT:_e(ln,`RPC '${e}' ${o} timed out`),c(new Ie(le.DEADLINE_EXCEEDED,"Request time out"));break;case El.HTTP_ERROR:let f=l.getStatus();if(_e(ln,`RPC '${e}' ${o} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);let m=p?.error;if(m&&m.status&&m.message){let g=(function(E){let A=E.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(A)>=0?A:le.UNKNOWN})(m.status);c(new Ie(g,m.message))}else c(new Ie(le.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new Ie(le.UNAVAILABLE,"Connection failed."));break;default:Ce(9055,{c_:e,streamId:o,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{_e(ln,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);_e(ln,`RPC '${e}' ${o} sending request:`,i),l.send(n,"POST",d,r,15)})}P_(e,n,r){let i=iE(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Wv(),a=qv(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let d=s.join("");_e(ln,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c);this.T_(h);let f=!1,p=!1,m=new oE({Ho:v=>{p?_e(ln,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(f||(_e(ln,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),_e(ln,`RPC '${e}' stream ${i} sending:`,v),h.send(v))},Yo:()=>h.close()}),g=(v,E,A)=>{v.listen(E,O=>{try{A(O)}catch(M){setTimeout(()=>{throw M},0)}})};return g(h,da.EventType.OPEN,()=>{p||(_e(ln,`RPC '${e}' stream ${i} transport opened.`),m.s_())}),g(h,da.EventType.CLOSE,()=>{p||(p=!0,_e(ln,`RPC '${e}' stream ${i} transport closed`),m.__(),this.I_(h))}),g(h,da.EventType.ERROR,v=>{p||(p=!0,Ki(ln,`RPC '${e}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),m.__(new Ie(le.UNAVAILABLE,"The operation could not be completed")))}),g(h,da.EventType.MESSAGE,v=>{var E;if(!p){let A=v.data[0];ot(!!A,16349);let O=A,M=O?.error||((E=O[0])===null||E===void 0?void 0:E.error);if(M){_e(ln,`RPC '${e}' stream ${i} received error:`,M);let C=M.status,P=(function(T){let F=Nt[T];if(F!==void 0)return jD(F)})(C),D=M.message;P===void 0&&(P=le.INTERNAL,D="Unknown error status: "+C+" with message "+M.message),p=!0,m.__(new Ie(P,D)),h.close()}else _e(ln,`RPC '${e}' stream ${i} received:`,A),m.a_(A)}}),g(a,zv.STAT_EVENT,v=>{v.stat===Hh.PROXY?_e(ln,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===Hh.NOPROXY&&_e(ln,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{m.o_()},0),m}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}};function Yv(){return typeof document<"u"?document:null}function kf(t){return new D_(t,!0)}var mf=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&_e("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var UC="PersistentStream",yf=class{constructor(e,n,r,i,s,o,a,c){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new mf(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return X(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return X(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,n){return X(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===le.RESOURCE_EXHAUSTED?(ci(n.toString()),ci("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(n)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{e(()=>{let i=new Ie(le.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,n){let r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(()=>X(this,null,function*(){this.state=0,this.start()}))}G_(e){return _e(UC,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(_e(UC,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},cE=class extends yf{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let n=Mj(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Ve.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Ve.min():o.readTime?Mr(o.readTime):Ve.min()})(e);return this.listener.J_(n,r)}H_(e){let n={};n.database=M_(this.serializer),n.addTarget=(function(s,o){let a,c=o.target;if(a=v_(c)?{documents:Oj(s,c)}:{query:Fj(s,c).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=BD(s,o.resumeToken);let l=R_(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(Ve.min())>0){a.readTime=uf(s,o.snapshotVersion.toTimestamp());let l=R_(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a})(this.serializer,e);let r=Vj(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){let n={};n.database=M_(this.serializer),n.removeTarget=e,this.k_(n)}},lE=class extends yf{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let n=Nj(e.writeResults,e.commitTime),r=Mr(e.commitTime);return this.listener.ta(r,n)}na(){let e={};e.database=M_(this.serializer),this.k_(e)}X_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>kj(this.serializer,r))};this.k_(n)}};var uE=class{},dE=class extends uE{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new Ie(le.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,P_(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ie(le.UNKNOWN,s.toString())})}Jo(e,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Jo(e,P_(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ie(le.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},hE=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ci(n),this._a=!1):_e("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Ys="RemoteStore",fE=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(()=>X(this,null,function*(){Xs(this)&&(_e(Ys,"Restarting streams for network reachability change."),yield(function(c){return X(this,null,function*(){let l=Oe(c);l.Ia.add(4),yield $l(l),l.Aa.set("Unknown"),l.Ia.delete(4),yield Nf(l)})})(this))}))}),this.Aa=new hE(r,i)}};function Nf(t){return X(this,null,function*(){if(Xs(t))for(let e of t.da)yield e(!0)})}function $l(t){return X(this,null,function*(){for(let e of t.da)yield e(!1)})}function QD(t,e){let n=Oe(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),XE(n)?YE(n):Fa(n).x_()&&KE(n,e))}function GE(t,e){let n=Oe(t),r=Fa(n);n.Ta.delete(e),r.x_()&&ZD(n,e),n.Ta.size===0&&(r.x_()?r.B_():Xs(n)&&n.Aa.set("Unknown"))}function KE(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fa(t).H_(e)}function ZD(t,e){t.Ra.$e(e),Fa(t).Y_(e)}function YE(t){t.Ra=new C_({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),Fa(t).start(),t.Aa.aa()}function XE(t){return Xs(t)&&!Fa(t).M_()&&t.Ta.size>0}function Xs(t){return Oe(t).Ia.size===0}function JD(t){t.Ra=void 0}function tB(t){return X(this,null,function*(){t.Aa.set("Online")})}function nB(t){return X(this,null,function*(){t.Ta.forEach((e,n)=>{KE(t,e)})})}function rB(t,e){return X(this,null,function*(){JD(t),XE(t)?(t.Aa.la(e),YE(t)):t.Aa.set("Unknown")})}function iB(t,e,n){return X(this,null,function*(){if(t.Aa.set("Online"),e instanceof cf&&e.state===2&&e.cause)try{yield(function(i,s){return X(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.Ta.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.Ta.delete(a),i.Ra.removeTarget(a))})})(t,e)}catch(r){_e(Ys,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield vf(t,r)}else if(e instanceof ya?t.Ra.Ye(e):e instanceof af?t.Ra.it(e):t.Ra.et(e),!n.isEqual(Ve.min()))try{let r=yield XD(t.localStore);n.compareTo(r)>=0&&(yield(function(s,o){let a=s.Ra.Pt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.Ta.get(l);d&&s.Ta.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.Ta.get(c);if(!d)return;s.Ta.set(c,d.withResumeToken(un.EMPTY_BYTE_STRING,d.snapshotVersion)),ZD(s,c);let h=new Nl(d.target,c,l,d.sequenceNumber);KE(s,h)}),s.remoteSyncer.applyRemoteEvent(a)})(t,n))}catch(r){_e(Ys,"Failed to raise snapshot:",r),yield vf(t,r)}})}function vf(t,e,n){return X(this,null,function*(){if(!Oa(e))throw e;t.Ia.add(1),yield $l(t),t.Aa.set("Offline"),n||(n=()=>XD(t.localStore)),t.asyncQueue.enqueueRetryable(()=>X(null,null,function*(){_e(Ys,"Retrying IndexedDB access"),yield n(),t.Ia.delete(1),yield Nf(t)}))})}function eR(t,e){return e().catch(n=>vf(t,n,e))}function Of(t){return X(this,null,function*(){let e=Oe(t),n=Xi(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:FE;for(;sB(e);)try{let i=yield Qj(e.localStore,r);if(i===null){e.Pa.length===0&&n.B_();break}r=i.batchId,oB(e,i)}catch(i){yield vf(e,i)}tR(e)&&nR(e)})}function sB(t){return Xs(t)&&t.Pa.length<10}function oB(t,e){t.Pa.push(e);let n=Xi(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function tR(t){return Xs(t)&&!Xi(t).M_()&&t.Pa.length>0}function nR(t){Xi(t).start()}function aB(t){return X(this,null,function*(){Xi(t).na()})}function cB(t){return X(this,null,function*(){let e=Xi(t);for(let n of t.Pa)e.X_(n.mutations)})}function lB(t,e,n){return X(this,null,function*(){let r=t.Pa.shift(),i=I_.from(r,e,n);yield eR(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Of(t)})}function uB(t,e){return X(this,null,function*(){e&&Xi(t).Z_&&(yield(function(r,i){return X(this,null,function*(){if((function(o){return Aj(o)&&o!==le.ABORTED})(i.code)){let s=r.Pa.shift();Xi(r).N_(),yield eR(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Of(r)}})})(t,e)),tR(t)&&nR(t)})}function jC(t,e){return X(this,null,function*(){let n=Oe(t);n.asyncQueue.verifyOperationInProgress(),_e(Ys,"RemoteStore received new credentials");let r=Xs(n);n.Ia.add(3),yield $l(n),r&&n.Aa.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),yield Nf(n)})}function dB(t,e){return X(this,null,function*(){let n=Oe(t);e?(n.Ia.delete(2),yield Nf(n)):e||(n.Ia.add(2),yield $l(n),n.Aa.set("Unknown"))})}function Fa(t){return t.Va||(t.Va=(function(n,r,i){let s=Oe(n);return s.ia(),new cE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Zo:tB.bind(null,t),e_:nB.bind(null,t),n_:rB.bind(null,t),J_:iB.bind(null,t)}),t.da.push(e=>X(null,null,function*(){e?(t.Va.N_(),XE(t)?YE(t):t.Aa.set("Unknown")):(yield t.Va.stop(),JD(t))}))),t.Va}function Xi(t){return t.ma||(t.ma=(function(n,r,i){let s=Oe(n);return s.ia(),new lE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:aB.bind(null,t),n_:uB.bind(null,t),ea:cB.bind(null,t),ta:lB.bind(null,t)}),t.da.push(e=>X(null,null,function*(){e?(t.ma.N_(),yield Of(t)):(yield t.ma.stop(),t.Pa.length>0&&(_e(Ys,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))}))),t.ma}var pE=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function QE(t,e){if(ci("AsyncQueue",`${e}: ${t}`),Oa(t))return new Ie(le.UNAVAILABLE,`${e}: ${t}`);throw t}var _f=class t{static emptySet(e){return new t(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||De.comparator(n.key,r.key):(n,r)=>De.comparator(n.key,r.key),this.keyedMap=bl(),this.sortedSet=new wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Ef=class{constructor(){this.fa=new wt(De.comparator)}track(e){let n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):Ce(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){let e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}},xa=class t{constructor(e,n,r,i,s,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,_f.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var gE=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},mE=class{constructor(){this.queries=BC(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){let i=Oe(n),s=i.queries;i.queries=BC(),s.forEach((o,a)=>{for(let c of a.wa)c.onError(r)})})(this,new Ie(le.ABORTED,"Firestore shutting down"))}};function BC(){return new di(t=>DD(t),xf)}function hB(t,e){return X(this,null,function*(){let n=Oe(t),r=3,i=e.query,s=n.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new gE,r=e.ba()?0:1);try{switch(r){case 0:s.ya=yield n.onListen(i,!0);break;case 1:s.ya=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=QE(o,`Initialization of query '${fa(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.wa.push(e),e.va(n.onlineState),s.ya&&e.Ca(s.ya)&&ZE(n)})}function fB(t,e){return X(this,null,function*(){let n=Oe(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function pB(t,e){let n=Oe(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.wa)a.Ca(i)&&(r=!0);o.ya=i}}r&&ZE(n)}function gB(t,e,n){let r=Oe(t),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(n);r.queries.delete(e)}function ZE(t){t.Da.forEach(e=>{e.next()})}var yE,$C;($C=yE||(yE={})).Fa="default",$C.Cache="cache";var vE=class{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new xa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;let r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=xa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==yE.Cache}};var bf=class{constructor(e){this.key=e}},wf=class{constructor(e){this.key=e}},_E=class{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ge(),this.mutatedKeys=Ge(),this.Xa=RD(e),this.eu=new _f(this.Xa)}get tu(){return this.Ha}nu(e,n){let r=n?n.ru:new Ef,i=n?n.eu:this.eu,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let f=i.get(d),p=Mf(this.query,h)?h:null,m=!!f&&this.mutatedKeys.has(f.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations),v=!1;f&&p?f.data.isEqual(p.data)?m!==g&&(r.track({type:3,doc:p}),v=!0):this.iu(f,p)||(r.track({type:2,doc:p}),v=!0,(c&&this.Xa(p,c)>0||l&&this.Xa(p,l)<0)&&(a=!0)):!f&&p?(r.track({type:0,doc:p}),v=!0):f&&!p&&(r.track({type:1,doc:f}),v=!0,(c||l)&&(a=!0)),v&&(p?(o=o.add(p),s=g?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{eu:o,ru:r,Ds:a,mutatedKeys:s}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let o=e.ru.pa();o.sort((d,h)=>(function(p,m){let g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce(20277,{At:v})}};return g(p)-g(m)})(d.type,h.type)||this.Xa(d.doc,h.doc)),this.su(r),i=i!=null&&i;let a=n&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,l=c!==this.Ya;return this.Ya=c,o.length!==0||l?{snapshot:new xa(this.query,e.eu,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Ef,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=Ge(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new wf(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new bf(r))}),n}uu(e){this.Ha=e.qs,this.Za=Ge();let n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return xa.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},JE="SyncEngine",EE=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},bE=class{constructor(e){this.key=e,this.lu=!1}},wE=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new di(a=>DD(a),xf),this.Tu=new Map,this.Iu=new Set,this.du=new wt(De.comparator),this.Eu=new Map,this.Au=new Fl,this.Ru={},this.Vu=new Map,this.mu=Ol.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function mB(t,e,n=!0){return X(this,null,function*(){let r=cR(t),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=yield rR(r,e,n,!0),i})}function yB(t,e){return X(this,null,function*(){let n=cR(t);yield rR(n,e,!0,!1)})}function rR(t,e,n,r){return X(this,null,function*(){let i=yield Zj(t.localStore,xr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n),a;return r&&(a=yield vB(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&QD(t.remoteStore,i),a})}function vB(t,e,n,r,i){return X(this,null,function*(){t.gu=(h,f,p)=>(function(g,v,E,A){return X(this,null,function*(){let O=v.view.nu(E);O.Ds&&(O=yield LC(g.localStore,v.query,!1).then(({documents:D})=>v.view.nu(D,O)));let M=A&&A.targetChanges.get(v.targetId),C=A&&A.targetMismatches.get(v.targetId)!=null,P=v.view.applyChanges(O,g.isPrimaryClient,M,C);return zC(g,v.targetId,P._u),P.snapshot})})(t,h,f,p);let s=yield LC(t.localStore,e,!0),o=new _E(e,s.qs),a=o.nu(s.documents),c=kl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),l=o.applyChanges(a,t.isPrimaryClient,c);zC(t,n,l._u);let d=new EE(e,n,o);return t.Pu.set(e,d),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),l.snapshot})}function _B(t,e,n){return X(this,null,function*(){let r=Oe(t),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!xf(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield tE(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&GE(r.remoteStore,i.targetId),IE(r,i.targetId)}).catch(Na))):(IE(r,i.targetId),yield tE(r.localStore,i.targetId,!0))})}function EB(t,e){return X(this,null,function*(){let n=Oe(t),r=n.Pu.get(e),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),GE(n.remoteStore,r.targetId))})}function bB(t,e,n){return X(this,null,function*(){let r=DB(t);try{let i=yield(function(o,a){let c=Oe(o),l=Lt.now(),d=a.reduce((p,m)=>p.add(m.key),Ge()),h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let m=hi(),g=Ge();return c.Os.getEntries(p,d).next(v=>{m=v,m.forEach((E,A)=>{A.isValidDocument()||(g=g.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,m)).next(v=>{h=v;let E=[];for(let A of a){let O=Tj(A,h.get(A.key).overlayedDocument);O!=null&&E.push(new fi(A.key,O,wD(O.value.mapValue),Hs.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,E,a)}).next(v=>{f=v;let E=v.applyToLocalDocumentSet(h,g);return c.documentOverlayCache.saveOverlays(p,v.batchId,E)})}).then(()=>({batchId:f.batchId,changes:xD(h)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,c){let l=o.Ru[o.currentUser.toKey()];l||(l=new wt(Be)),l=l.insert(a,c),o.Ru[o.currentUser.toKey()]=l})(r,i.batchId,n),yield Hl(r,i.changes),yield Of(r.remoteStore)}catch(i){let s=QE(i,"Failed to persist write");n.reject(s)}})}function iR(t,e){return X(this,null,function*(){let n=Oe(t);try{let r=yield Yj(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Eu.get(s);o&&(ot(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?ot(o.lu,14607):i.removedDocuments.size>0&&(ot(o.lu,42227),o.lu=!1))}),yield Hl(n,r,e)}catch(r){yield Na(r)}})}function HC(t,e,n){let r=Oe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.Pu.forEach((s,o)=>{let a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(o,a){let c=Oe(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let f of h.wa)f.va(a)&&(l=!0)}),l&&ZE(c)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function wB(t,e,n){return X(this,null,function*(){let r=Oe(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Eu.get(e),s=i&&i.key;if(s){let o=new wt(De.comparator);o=o.insert(s,dr.newNoDocument(s,Ve.min()));let a=Ge().add(s),c=new of(Ve.min(),new Map,new wt(Be),o,a);yield iR(r,c),r.du=r.du.remove(s),r.Eu.delete(e),eb(r)}else yield tE(r.localStore,e,!1).then(()=>IE(r,e,n)).catch(Na)})}function IB(t,e){return X(this,null,function*(){let n=Oe(t),r=e.batch.batchId;try{let i=yield Kj(n.localStore,e);oR(n,r,null),sR(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Hl(n,i)}catch(i){yield Na(i)}})}function TB(t,e,n){return X(this,null,function*(){let r=Oe(t);try{let i=yield(function(o,a){let c=Oe(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(ot(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})})(r.localStore,e);oR(r,e,n),sR(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Hl(r,i)}catch(i){yield Na(i)}})}function sR(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function oR(t,e,n){let r=Oe(t),i=r.Ru[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function IE(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||aR(t,r)})}function aR(t,e){t.Iu.delete(e.path.canonicalString());let n=t.du.get(e);n!==null&&(GE(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),eb(t))}function zC(t,e,n){for(let r of n)r instanceof bf?(t.Au.addReference(r.key,e),AB(t,r)):r instanceof wf?(_e(JE,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||aR(t,r.key)):Ce(19791,{yu:r})}function AB(t,e){let n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(_e(JE,"New document in limbo: "+n),t.Iu.add(r),eb(t))}function eb(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){let e=t.Iu.values().next().value;t.Iu.delete(e);let n=new De(Ct.fromString(e)),r=t.mu.next();t.Eu.set(r,new bE(n)),t.du=t.du.insert(n,r),QD(t.remoteStore,new Nl(xr(HE(n.path)),r,"TargetPurposeLimboResolution",OE.ue))}}function Hl(t,e,n){return X(this,null,function*(){let r=Oe(t),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((a,c)=>{o.push(r.gu(c,e,n).then(l=>{var d;if((l||n)&&r.isPrimaryClient){let h=l?!l.fromCache:(d=n?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){i.push(l);let h=Q_.Es(c.targetId,l);s.push(h)}}))}),yield Promise.all(o),r.hu.J_(i),yield(function(c,l){return X(this,null,function*(){let d=Oe(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>de.forEach(l,f=>de.forEach(f.Is,p=>d.persistence.referenceDelegate.addReference(h,f.targetId,p)).next(()=>de.forEach(f.ds,p=>d.persistence.referenceDelegate.removeReference(h,f.targetId,p)))))}catch(h){if(!Oa(h))throw h;_e(WE,"Failed to update sequence numbers: "+h)}for(let h of l){let f=h.targetId;if(!h.fromCache){let p=d.Fs.get(f),m=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(m);d.Fs=d.Fs.insert(f,g)}}})})(r.localStore,s))})}function SB(t,e){return X(this,null,function*(){let n=Oe(t);if(!n.currentUser.isEqual(e)){_e(JE,"User change. New user:",e.toKey());let r=yield YD(n.localStore,e);n.currentUser=e,(function(s,o){s.Vu.forEach(a=>{a.forEach(c=>{c.reject(new Ie(le.CANCELLED,o))})}),s.Vu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Hl(n,r.Bs)}})}function CB(t,e){let n=Oe(t),r=n.Eu.get(e);if(r&&r.lu)return Ge().add(r.key);{let i=Ge(),s=n.Tu.get(e);if(!s)return i;for(let o of s){let a=n.Pu.get(o);i=i.unionWith(a.view.tu)}return i}}function cR(t){let e=Oe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=iR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wB.bind(null,e),e.hu.J_=pB.bind(null,e.eventManager),e.hu.pu=gB.bind(null,e.eventManager),e}function DB(t){let e=Oe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=TB.bind(null,e),e}var lR=(()=>{class t{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(n){return X(this,null,function*(){this.serializer=kf(n.databaseInfo.databaseId),this.sharedClientState=this.bu(n),this.persistence=this.Du(n),yield this.persistence.start(),this.localStore=this.vu(n),this.gcScheduler=this.Cu(n,this.localStore),this.indexBackfillerScheduler=this.Fu(n,this.localStore)})}Cu(n,r){return null}Fu(n,r){return null}vu(n){return Gj(this.persistence,new J_,n.initialUser,this.serializer)}Du(n){return new hf(X_.Vi,this.serializer)}bu(n){return new nE}terminate(){return X(this,null,function*(){var n,r;(n=this.gcScheduler)===null||n===void 0||n.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return t.provider={build:()=>new t},t})(),TE=class extends lR{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){ot(this.persistence.referenceDelegate instanceof ff,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new L_(r,e.asyncQueue,n)}Du(e){let n=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new hf(r=>ff.Vi(r,n),this.serializer)}};var RB=(()=>{class t{initialize(n,r){return X(this,null,function*(){this.localStore||(this.localStore=n.localStore,this.sharedClientState=n.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!n.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>HC(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=SB.bind(null,this.syncEngine),yield dB(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(n){return(function(){return new mE})()}createDatastore(n){let r=kf(n.databaseInfo.databaseId),i=(function(o){return new aE(o)})(n.databaseInfo);return(function(o,a,c,l){return new dE(o,a,c,l)})(n.authCredentials,n.appCheckCredentials,i,r)}createRemoteStore(n){return(function(i,s,o,a,c){return new fE(i,s,o,a,c)})(this.localStore,this.datastore,n.asyncQueue,r=>HC(this.syncEngine,r,0),(function(){return gf.C()?new gf:new rE})())}createSyncEngine(n,r){return(function(s,o,a,c,l,d,h){let f=new wE(s,o,a,c,l,d);return h&&(f.fu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,n.initialUser,n.maxConcurrentLimboResolutions,r)}terminate(){return X(this,null,function*(){var n,r;yield(function(s){return X(this,null,function*(){let o=Oe(s);_e(Ys,"RemoteStore shutting down."),o.Ia.add(5),yield $l(o),o.Ea.shutdown(),o.Aa.set("Unknown")})})(this.remoteStore),(n=this.datastore)===null||n===void 0||n.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return t.provider={build:()=>new t},t})();var AE=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ci("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}};var Qi="FirestoreClient",SE=class{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=Cl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>X(this,null,function*(){_e(Qi,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(_e(Qi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>X(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=QE(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Xv(t,e){return X(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),_e(Qi,"Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>X(null,null,function*(){r.isEqual(i)||(yield YD(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{Ki("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{_e("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Ki("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e})}function qC(t,e){return X(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield PB(t);_e(Qi,"Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>jC(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>jC(e.remoteStore,i)),t._onlineComponents=e})}function PB(t){return X(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){_e(Qi,"Using user provided OfflineComponentProvider");try{yield Xv(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!(function(i){return i.name==="FirebaseError"?i.code===le.FAILED_PRECONDITION||i.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(n))throw n;Ki("Error using user provided cache. Falling back to memory cache: "+n),yield Xv(t,new lR)}}else _e(Qi,"Using default OfflineComponentProvider"),yield Xv(t,new TE(void 0));return t._offlineComponents})}function uR(t){return X(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(_e(Qi,"Using user provided OnlineComponentProvider"),yield qC(t,t._uninitializedComponentsProvider._online)):(_e(Qi,"Using default OnlineComponentProvider"),yield qC(t,new RB))),t._onlineComponents})}function xB(t){return uR(t).then(e=>e.syncEngine)}function MB(t){return X(this,null,function*(){let e=yield uR(t),n=e.eventManager;return n.onListen=mB.bind(null,e.syncEngine),n.onUnlisten=_B.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=yB.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=EB.bind(null,e.syncEngine),n})}function kB(t,e,n={}){let r=new Rr;return t.asyncQueue.enqueueAndForget(()=>X(null,null,function*(){return(function(s,o,a,c,l){let d=new AE({next:f=>{d.Ou(),o.enqueueAndForget(()=>fB(s,h));let p=f.docs.has(a);!p&&f.fromCache?l.reject(new Ie(le.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&c&&c.source==="server"?l.reject(new Ie(le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(f)},error:f=>l.reject(f)}),h=new vE(HE(a.path),d,{includeMetadataChanges:!0,ka:!0});return hB(s,h)})(yield MB(t),t.asyncQueue,e,n,r)})),r.promise}function dR(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var WC=new Map;var hR="firestore.googleapis.com",GC=!0,If=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hR,this.ssl=GC}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:GC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=KD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zj)throw new Ie(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ll=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new If({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new If(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Qv;switch(r.type){case"firstParty":return new t_(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ie(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return X(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){let r=WC.get(n);r&&(_e("ComponentProvider","Removing Datastore"),WC.delete(n),r.terminate())})(this),Promise.resolve()}};function fR(t,e,n,r={}){var i;t=Dl(t,Ll);let s=Ar(e),o=t._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;s&&(ll(`https://${c}`),ul("Firestore",!0)),o.host!==hR&&o.host!==c&&Ki("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!ks(l,a)&&(t._setSettings(l),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=Xt.MOCK_USER;else{d=Ah(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new Ie(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Xt(f)}t._authCredentials=new Zv(new Xh(d,h))}}var CE=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},mn=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}toJSON(){return{type:t._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Bl(n,t._jsonSchema))return new t(e,r||null,new De(Ct.fromString(n.referencePath)))}};mn._jsonSchemaVersion="firestore/documentReference/1.0",mn._jsonSchema={type:Ft("string",mn._jsonSchemaVersion),referencePath:Ft("string")};var Vl=class t extends CE{constructor(e,n,r){super(e,n,HE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new De(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function pR(t,e,...n){if(t=Wt(t),arguments.length===1&&(e=Cl.newId()),jU("doc","path",e),t instanceof Ll){let r=Ct.fromString(e,...n);return hC(r),new mn(t,null,new De(r))}{if(!(t instanceof mn||t instanceof Vl))throw new Ie(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(Ct.fromString(e,...n));return hC(r),new mn(t.firestore,t instanceof Vl?t.converter:null,new De(r))}}var KC="AsyncQueue",Tf=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new mf(this,"async_queue_retry"),this.oc=()=>{let r=Yv();r&&_e(KC,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let n=Yv();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let n=Yv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let n=new Rr;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return X(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Oa(e))throw e;_e(KC,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,ci("INTERNAL UNHANDLED ERROR: ",YC(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);let i=pE.createAndSchedule(this,e,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&Ce(47125,{hc:YC(this.tc)})}verifyOperationInProgress(){}Pc(){return X(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let n=this.ec.indexOf(e);this.ec.splice(n,1)}};function YC(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}var Ul=class extends Ll{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Tf,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return X(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Tf(e),this._firestoreClient=void 0,yield e}})}};function gR(t,e){let n=typeof t=="object"?t:Bi(),r=typeof t=="string"?t:e||tf,i=oa(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Th("firestore");s&&fR(i,...s)}return i}function mR(t){if(t._terminated)throw new Ie(le.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||NB(t),t._firestoreClient}function NB(t){var e,n,r;let i=t._freezeSettings(),s=(function(a,c,l,d){return new o_(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,dR(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new SE(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&(function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}})(t._componentsProvider))}var qi=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(un.fromBase64String(e))}catch(n){throw new Ie(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:t._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Bl(e,t._jsonSchema))return t.fromBase64String(e.bytes)}};qi._jsonSchemaVersion="firestore/bytes/1.0",qi._jsonSchema={type:Ft("string",qi._jsonSchemaVersion),bytes:Ft("string")};var Ma=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ie(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var jl=class{constructor(e){this._methodName=e}};var Wi=class t{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ie(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ie(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Be(this._lat,e._lat)||Be(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:t._jsonSchemaVersion}}static fromJSON(e){if(Bl(e,t._jsonSchema))return new t(e.latitude,e.longitude)}};Wi._jsonSchemaVersion="firestore/geoPoint/1.0",Wi._jsonSchema={type:Ft("string",Wi._jsonSchemaVersion),latitude:Ft("number"),longitude:Ft("number")};var Gi=class t{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:t._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Bl(e,t._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new t(e.vectorValues);throw new Ie(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Gi._jsonSchemaVersion="firestore/vectorValue/1.0",Gi._jsonSchema={type:Ft("string",Gi._jsonSchemaVersion),vectorValues:Ft("object")};var OB=/^__.*__$/;var Af=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new fi(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function yR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce(40011,{Ec:t})}}var DE=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Cf(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(yR(this.Ec)&&OB.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},RE=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||kf(e)}Dc(e,n,r,i=!1){return new DE({Ec:e,methodName:n,bc:r,path:Fn.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function FB(t){let e=t._freezeSettings(),n=kf(t._databaseId);return new RE(t._databaseId,!!e.ignoreUndefinedProperties,n)}var Sf=class t extends jl{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function LB(t,e,n,r){let i=t.Dc(1,e,n);_R("Data must be an object, but it was:",i,r);let s=[],o=Xn.empty();Zi(r,(c,l)=>{let d=tb(e,c,n);l=Wt(l);let h=i.gc(d);if(l instanceof Sf)s.push(d);else{let f=Ff(l,h);f!=null&&(s.push(d),o.set(d,f))}});let a=new Dr(s);return new Af(o,a,i.fieldTransforms)}function VB(t,e,n,r,i,s){let o=t.Dc(1,e,n),a=[XC(e,r,n)],c=[i];if(s.length%2!=0)throw new Ie(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(XC(e,s[f])),c.push(s[f+1]);let l=[],d=Xn.empty();for(let f=a.length-1;f>=0;--f)if(!BB(l,a[f])){let p=a[f],m=c[f];m=Wt(m);let g=o.gc(p);if(m instanceof Sf)l.push(p);else{let v=Ff(m,g);v!=null&&(l.push(p),d.set(p,v))}}let h=new Dr(l);return new Af(d,h,o.fieldTransforms)}function Ff(t,e){if(vR(t=Wt(t)))return _R("Unsupported field value:",e,t),UB(t,e);if(t instanceof jl)return(function(r,i){if(!yR(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let a of r){let c=Ff(a,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(t,e)}return(function(r,i){if((r=Wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return _j(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Lt.fromDate(r);return{timestampValue:uf(i.serializer,s)}}if(r instanceof Lt){let s=new Lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:uf(i.serializer,s)}}if(r instanceof Wi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof qi)return{bytesValue:BD(i.serializer,r._byteString)};if(r instanceof mn){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:qE(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Gi)return(function(o,a){return{mapValue:{fields:{[VE]:{stringValue:UE},[Ea]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.wc("VectorValues must only contain numeric values.");return zE(a.serializer,l)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${NE(r)}`)})(t,e)}function UB(t,e){let n={};return pD(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zi(t,(r,i)=>{let s=Ff(i,e.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function vR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Lt||t instanceof Wi||t instanceof qi||t instanceof mn||t instanceof jl||t instanceof Gi)}function _R(t,e,n){if(!vR(n)||!JC(n)){let r=NE(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function XC(t,e,n){if((e=Wt(e))instanceof Ma)return e._internalPath;if(typeof e=="string")return tb(t,e);throw Cf("Field path arguments must be of type string or ",t,!1,void 0,n)}var jB=new RegExp("[~\\*/\\[\\]]");function tb(t,e,n){if(e.search(jB)>=0)throw Cf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ma(...e.split("."))._internalPath}catch{throw Cf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Cf(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Ie(le.INVALID_ARGUMENT,a+t+c)}function BB(t,e){return t.some(n=>n.isEqual(e))}var Df=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new PE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(ER("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},PE=class extends Df{data(){return super.data()}};function ER(t,e){return typeof e=="string"?tb(t,e):e instanceof Ma?e._internalPath:e._delegate._internalPath}var xE=class{convertValue(e,n="none"){switch(Yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ui(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Zi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;let s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n[Ea].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>vt(o.doubleValue));return new Gi(s)}convertGeoPoint(e){return new Wi(vt(e.latitude),vt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=Pf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(xl(e));default:return null}}convertTimestamp(e){let n=li(e);return new Lt(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=Ct.fromString(e);ot(GD(r),9688,{name:e});let i=new nf(r.get(1),r.get(3)),s=new De(r.popFirst(5));return i.isEqual(n)||ci(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};var $s=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},zs=class t extends Df{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new va(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(ER("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,n={};return n.type=t._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}};zs._jsonSchemaVersion="firestore/documentSnapshot/1.0",zs._jsonSchema={type:Ft("string",zs._jsonSchemaVersion),bundleSource:Ft("string","DocumentSnapshot"),bundleName:Ft("string"),bundle:Ft("string")};var va=class extends zs{data(e={}){return super.data(e)}},Sl=class t{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new $s(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new va(this._firestore,this._userDataWriter,r.key,r,new $s(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ie(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new va(i._firestore,i._userDataWriter,a.doc.key,a.doc,new $s(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new va(i._firestore,i._userDataWriter,a.doc.key,a.doc,new $s(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:$B(a.type),doc:c,oldIndex:l,newIndex:d}})}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=t._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Cl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function $B(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce(61501,{type:t})}}function bR(t){t=Dl(t,mn);let e=Dl(t.firestore,Ul);return kB(mR(e),t._key).then(n=>zB(e,t,n))}Sl._jsonSchemaVersion="firestore/querySnapshot/1.0",Sl._jsonSchema={type:Ft("string",Sl._jsonSchemaVersion),bundleSource:Ft("string","QuerySnapshot"),bundleName:Ft("string"),bundle:Ft("string")};var ME=class extends xE{constructor(e){super(),this.firestore=e}convertBytes(e){return new qi(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,n)}};function wR(t,e,n,...r){t=Dl(t,mn);let i=Dl(t.firestore,Ul),s=FB(i),o;return o=typeof(e=Wt(e))=="string"||e instanceof Ma?VB(s,"updateDoc",t._key,e,n,r):LB(s,"updateDoc",t._key,e),HB(i,[o.toMutation(t._key,Hs.exists(!0))])}function HB(t,e){return(function(r,i){let s=new Rr;return r.asyncQueue.enqueueAndForget(()=>X(null,null,function*(){return bB(yield xB(r),i,s)})),s.promise})(mR(t),e)}function zB(t,e,n){let r=n.docs.get(e._key),i=new ME(t);return new zs(t,i,e._key,r,new $s(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){ka=i})(ji),On(new nn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ul(new Jv(r.getProvider("auth-internal")),new n_(o,r.getProvider("app-check-internal")),(function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Ie(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nf(l.options.projectId,d)})(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),pt(cC,lC,e),pt(cC,lC,"esm2017")})();var Qs=class{constructor(e){return e}},IR="firestore",nb=class{constructor(){return $i(IR)}};var rb=new Te("angularfire2.firestore-instances");function qB(t,e){let n=ca(IR,t,e);return n&&new Qs(n)}function WB(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Qs(r)}}var GB={provide:nb,deps:[[new Tn,rb]]},KB={provide:Qs,useFactory:qB,deps:[[new Tn,rb],si]};function TR(t,...e){return pt("angularfire",ri.full,"fst"),wn([KB,GB,{provide:rb,useFactory:WB(t),multi:!0,deps:[nt,kt,ii,Fs,[new Tn,ua],[new Tn,la],...e]}])}var AR=Cn(pR,!0,2);var SR=Cn(bR,!0);var CR=Cn(gR,!0);var DR=Cn(wR,!0,2);var OR="firebasestorage.googleapis.com",FR="storageBucket",XB=120*1e3,QB=600*1e3;var It=class t extends Sn{constructor(e,n,r=0){super(ib(e),`Firebase Storage: ${n} (${ib(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ib(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Dt=(function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t})(Dt||{});function ib(t){return"storage/"+t}function ub(){let t="An unknown error occurred, please check the error payload for server response.";return new It(Dt.UNKNOWN,t)}function ZB(t){return new It(Dt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function JB(t){return new It(Dt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function e$(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new It(Dt.UNAUTHENTICATED,t)}function t$(){return new It(Dt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function n$(t){return new It(Dt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function r$(){return new It(Dt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function i$(){return new It(Dt.CANCELED,"User canceled the upload/download.")}function s$(t){return new It(Dt.INVALID_URL,"Invalid URL '"+t+"'.")}function o$(t){return new It(Dt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function a$(){return new It(Dt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+FR+"' property when initializing the app?")}function c$(){return new It(Dt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function l$(){return new It(Dt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function u$(t){return new It(Dt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function sb(t){return new It(Dt.INVALID_ARGUMENT,t)}function LR(){return new It(Dt.APP_DELETED,"The Firebase app was deleted.")}function d$(t){return new It(Dt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ql(t,e){return new It(Dt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function zl(t){throw new It(Dt.INTERNAL_ERROR,"Internal error: "+t)}var hr=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw o$(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(M){M.path_=decodeURIComponent(M.path)}let d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${d}/b/${i}/o${f}`,"i"),m={bucket:1,path:3},g=n===OR?"(?:storage.googleapis.com|storage.cloud.google.com)":n,v="([^?#]*)",E=new RegExp(`^https?://${g}/${i}/${v}`,"i"),O=[{regex:a,indices:c,postModify:s},{regex:p,indices:m,postModify:l},{regex:E,indices:{bucket:1,path:2},postModify:l}];for(let M=0;M<O.length;M++){let C=O[M],P=C.regex.exec(e);if(P){let D=P[C.indices.bucket],S=P[C.indices.path];S||(S=""),r=new t(D,S),C.postModify(r);break}}if(r==null)throw s$(e);return r}},ob=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function h$(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...v){l||(l=!0,e.apply(null,v))}function h(v){i=setTimeout(()=>{i=null,t(p,c())},v)}function f(){s&&clearTimeout(s)}function p(v,...E){if(l){f();return}if(v){f(),d.call(null,v,...E);return}if(c()||o){f(),d.call(null,v,...E);return}r<64&&(r*=2);let O;a===1?(a=2,O=0):O=(r+Math.random())*1e3,h(O)}let m=!1;function g(v){m||(m=!0,f(),!l&&(i!==null?(v||(a=2),clearTimeout(i),h(0)):v||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function f$(t){t(!1)}function p$(t){return t!==void 0}function g$(t){return typeof t=="object"&&!Array.isArray(t)}function db(t){return typeof t=="string"||t instanceof String}function RR(t){return hb()&&t instanceof Blob}function hb(){return typeof Blob<"u"}function PR(t,e,n,r){if(r<e)throw sb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw sb(`Invalid value for '${t}'. Expected ${n} or less.`)}function fb(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function VR(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Va=(function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t})(Va||{});function m$(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var ab=class{constructor(e,n,r,i,s,o,a,c,l,d,h,f=!0,p=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,g)=>{this.resolve_=m,this.reject_=g,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new La(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Va.NO_ERROR,c=s.getStatus();if(!a||m$(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Va.ABORT;r(!1,new La(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new La(l,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());p$(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=ub();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?LR():i$();o(c)}else{let c=r$();o(c)}};this.canceled_?n(!1,new La(!1,null,!0)):this.backoffId_=h$(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&f$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},La=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function y$(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function v$(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _$(t,e){e&&(t["X-Firebase-GMPID"]=e)}function E$(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function b$(t,e,n,r,i,s,o=!0,a=!1){let c=VR(t.urlParams),l=t.url+c,d=Object.assign({},t.headers);return _$(d,e),y$(d,n),v$(d,s),E$(d,r),new ab(l,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}function w$(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function I$(...t){let e=w$();if(e!==void 0){let n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(hb())return new Blob(t);throw new It(Dt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function T$(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function A$(t){if(typeof atob>"u")throw u$("base-64");return atob(t)}var Or={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Wl=class{constructor(e,n){this.data=e,this.contentType=n||null}};function S$(t,e){switch(t){case Or.RAW:return new Wl(UR(e));case Or.BASE64:case Or.BASE64URL:return new Wl(jR(t,e));case Or.DATA_URL:return new Wl(D$(e),R$(e))}throw ub()}function UR(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function C$(t){let e;try{e=decodeURIComponent(t)}catch{throw ql(Or.DATA_URL,"Malformed data URL.")}return UR(e)}function jR(t,e){switch(t){case Or.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw ql(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Or.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw ql(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=A$(e)}catch(i){throw i.message.includes("polyfill")?i:ql(t,"Invalid character found")}let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var Vf=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw ql(Or.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=n[1]||null;r!=null&&(this.base64=P$(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function D$(t){let e=new Vf(t);return e.base64?jR(Or.BASE64,e.rest):C$(e.rest)}function R$(t){return new Vf(t).contentType}function P$(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var Uf=class t{constructor(e,n){let r=0,i="";RR(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(RR(this.data_)){let r=this.data_,i=T$(r,e,n);return i===null?null:new t(i)}else{let r=new Uint8Array(this.data_.buffer,e,n-e);return new t(r,!0)}}static getBlob(...e){if(hb()){let n=e.map(r=>r instanceof t?r.data_:r);return new t(I$.apply(null,n))}else{let n=e.map(o=>db(o)?S$(Or.RAW,o).data:o.data_),r=0;n.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new t(i,!0)}}uploadData(){return this.data_}};function BR(t){let e;try{e=JSON.parse(t)}catch{return null}return g$(e)?e:null}function x$(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function M$(t,e){let n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function $R(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function k$(t,e){return e}var rn=class{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||k$}},Lf=null;function N$(t){return!db(t)||t.length<2?t:$R(t)}function HR(){if(Lf)return Lf;let t=[];t.push(new rn("bucket")),t.push(new rn("generation")),t.push(new rn("metageneration")),t.push(new rn("name","fullPath",!0));function e(s,o){return N$(o)}let n=new rn("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}let i=new rn("size");return i.xform=r,t.push(i),t.push(new rn("timeCreated")),t.push(new rn("updated")),t.push(new rn("md5Hash",null,!0)),t.push(new rn("cacheControl",null,!0)),t.push(new rn("contentDisposition",null,!0)),t.push(new rn("contentEncoding",null,!0)),t.push(new rn("contentLanguage",null,!0)),t.push(new rn("contentType",null,!0)),t.push(new rn("metadata","customMetadata",!0)),Lf=t,Lf}function O$(t,e){function n(){let r=t.bucket,i=t.fullPath,s=new hr(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function F$(t,e,n){let r={};r.type="file";let i=n.length;for(let s=0;s<i;s++){let o=n[s];r[o.local]=o.xform(r,e[o.server])}return O$(r,t),r}function zR(t,e,n){let r=BR(e);return r===null?null:F$(t,r,n)}function L$(t,e,n,r){let i=BR(e);if(i===null||!db(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),p=fb(f,n,r),m=VR({alt:"media",token:l});return p+m})[0]}function V$(t,e){let n={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var jf=class{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function qR(t){if(!t)throw ub()}function U$(t,e){function n(r,i){let s=zR(t,i,e);return qR(s!==null),s}return n}function j$(t,e){function n(r,i){let s=zR(t,i,e);return qR(s!==null),L$(s,i,t.host,t._protocol)}return n}function WR(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=t$():i=e$():n.getStatus()===402?i=JB(t.bucket):n.getStatus()===403?i=n$(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function B$(t){let e=WR(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=ZB(t.path)),s.serverResponse=i.serverResponse,s}return n}function $$(t,e,n){let r=e.fullServerUrl(),i=fb(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new jf(i,s,j$(t,n),o);return a.errorHandler=B$(e),a}function H$(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function z$(t,e,n){let r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=H$(null,e)),r}function q$(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let O="";for(let M=0;M<2;M++)O=O+Math.random().toString().slice(2);return O}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=z$(e,r,i),d=V$(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,f=`\r
--`+c+"--",p=Uf.getBlob(h,r,f);if(p===null)throw c$();let m={name:l.fullPath},g=fb(s,t.host,t._protocol),v="POST",E=t.maxUploadRetryTime,A=new jf(g,v,U$(t,n),E);return A.urlParams=m,A.headers=o,A.body=p.uploadData(),A.errorHandler=WR(e),A}var sse=256*1024;var xR=null,cb=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Va.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Va.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Va.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw zl("cannot .send() more than once");if(Ar(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(let o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw zl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw zl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw zl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw zl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},lb=class extends cb{initXhr(){this.xhr_.responseType="text"}};function GR(){return xR?xR():new lb}var Ua=class t{constructor(e,n){this._service=e,n instanceof hr?this._location=n:this._location=hr.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new hr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $R(this._location.path)}get storage(){return this._service}get parent(){let e=x$(this._location.path);if(e===null)return null;let n=new hr(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw d$(e)}};function W$(t,e,n){t._throwIfRoot("uploadBytes");let r=q$(t.storage,t._location,HR(),new Uf(e,!0),n);return t.storage.makeRequestWithTokens(r,GR).then(i=>({metadata:i,ref:t}))}function G$(t){t._throwIfRoot("getDownloadURL");let e=$$(t.storage,t._location,HR());return t.storage.makeRequestWithTokens(e,GR).then(n=>{if(n===null)throw l$();return n})}function K$(t,e){let n=M$(t._location.path,e),r=new hr(t._location.bucket,n);return new Ua(t.storage,r)}function Y$(t){return/^[A-Za-z]+:\/\//.test(t)}function X$(t,e){return new Ua(t,e)}function KR(t,e){if(t instanceof Gl){let n=t;if(n._bucket==null)throw a$();let r=new Ua(n,n._bucket);return e!=null?KR(r,e):r}else return e!==void 0?K$(t,e):t}function Q$(t,e){if(e&&Y$(e)){if(t instanceof Gl)return X$(t,e);throw sb("To use ref(service, url), the first argument must be a Storage instance.")}else return KR(t,e)}function MR(t,e){let n=e?.[FR];return n==null?null:hr.makeFromBucketSpec(n,t)}function Z$(t,e,n,r={}){t.host=`${e}:${n}`;let i=Ar(e);i&&(ll(`https://${t.host}/b`),ul("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";let{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:Ah(s,t.app.options.projectId))}var Gl=class{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=OR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=XB,this._maxUploadRetryTime=QB,this._requests=new Set,i!=null?this._bucket=hr.makeFromBucketSpec(i,this._host):this._bucket=MR(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=hr.makeFromBucketSpec(this._url,e):this._bucket=MR(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){PR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){PR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return X(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return X(this,null,function*(){if(lr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ua(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new ob(LR());{let o=b$(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return X(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},kR="@firebase/storage",NR="0.13.14";var YR="storage";function XR(t,e,n){return t=Wt(t),W$(t,e,n)}function QR(t){return t=Wt(t),G$(t)}function ZR(t,e){return t=Wt(t),Q$(t,e)}function JR(t=Bi(),e){t=Wt(t);let r=oa(t,YR).getImmediate({identifier:e}),i=Th("storage");return i&&eP(r,...i),r}function eP(t,e,n,r={}){Z$(t,e,n,r)}function J$(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Gl(n,r,i,e,ji)}function eH(){On(new nn(YR,J$,"PUBLIC").setMultipleInstances(!0)),pt(kR,NR,""),pt(kR,NR,"esm2017")}eH();var pi=class{constructor(e){return e}},tP="storage",pb=class{constructor(){return $i(tP)}};var gb=new Te("angularfire2.storage-instances");function tH(t,e){let n=ca(tP,t,e);return n&&new pi(n)}function nH(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new pi(r)}}var rH={provide:pb,deps:[[new Tn,gb]]},iH={provide:pi,useFactory:tH,deps:[[new Tn,gb],si]};function nP(t,...e){return pt("angularfire",ri.full,"gcs"),wn([iH,rH,{provide:gb,useFactory:nH(t),multi:!0,deps:[nt,kt,ii,Fs,[new Tn,ua],[new Tn,la],...e]}])}var Bf=Cn(QR,!0);var rP=Cn(JR,!0);var $f=Cn(ZR,!0,2);var iP=Cn(XR,!0);var oP={production:!1,test:!0,firebaseConfig:{apiKey:"AIzaSyCZ1Qe3D6_ccxpHAzjImp-u4cYJb2AX6_A",authDomain:"bazz-testing-python.firebaseapp.com",projectId:"bazz-testing-python",storageBucket:"bazz-testing-python.firebasestorage.app",messagingSenderId:"161772090075",appId:"1:161772090075:web:33cbd1f928e751d87392fe",measurementId:"G-2PF1F2JZ05"}};var aP={providers:[Ym({eventCoalescing:!0}),Qy(QA),eS("ngsw-worker.js",{enabled:!Vc(),registrationStrategy:"registerWhenStable:30000"}),xS(()=>MS(oP.firebaseConfig)),TR(()=>CR()),nP(()=>rP())]};var qf=jP(pP());var zf={ID_PATTERN:/^[a-zA-Z0-9_-]+$/,MIN_ID_LENGTH:1,MAX_ID_LENGTH:256};var gP=(()=>{let e=class e{constructor(){this.paramsSubject=new St({file:null,userId:null,envelopeId:null}),this.params$=this.paramsSubject.asObservable(),this.parseUrlParams()}parseUrlParams(){try{let r=new URLSearchParams(window.location.search),i=r.get("file"),s=r.get("userId"),o=r.get("envelopeId"),a=null;i&&(a=i,console.log("File param:",i));let c=s&&this.isValidId(s)?s:null,l=o&&this.isValidId(o)?o:null;this.paramsSubject.next({file:a,userId:c,envelopeId:l})}catch(r){console.error("Error parsing URL parameters:",r),this.paramsSubject.next({file:null,userId:null,envelopeId:null})}}isValidId(r){return zf.ID_PATTERN.test(r)&&r.length>=zf.MIN_ID_LENGTH&&r.length<zf.MAX_ID_LENGTH}getCurrentParams(){return this.paramsSubject.value}hasRequiredParams(){let r=this.getCurrentParams();return r.file!==null&&r.userId!==null}getValidationErrors(){let r=this.getCurrentParams(),i=[];return r.file||i.push("PDF file URL is missing"),r.userId||i.push("User ID is missing or invalid"),i}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var mP=(()=>{let e=class e{constructor(r){this.storage=r,this.signatureCache=new Map,this.loadingSubject=new St(!1),this.loading$=this.loadingSubject.asObservable()}loadUserAssets(r){return this.signatureCache.has(r)?Se(this.signatureCache.get(r)):(this.loadingSubject.next(!0),xp({signature:this.fetchImage(r,"signatures","user_signature.png"),initial:this.fetchImage(r,"initials","user_initial.png")}).pipe(Me(({signature:i,initial:s})=>({signatureUrl:i.url,initialUrl:s.url,signatureDataUrl:i.dataUrl,initialDataUrl:s.dataUrl})),Mt(i=>{this.signatureCache.set(r,i),this.loadingSubject.next(!1)}),hn(i=>(console.error("Error loading user assets:",i),this.loadingSubject.next(!1),Se({signatureUrl:null,initialUrl:null,signatureDataUrl:void 0,initialDataUrl:void 0})))))}fetchImage(r,i,s){let o=`users/${r}/${i}/${s}`,a=$f(this.storage,o);return lt(Bf(a)).pipe(hn(c=>(console.warn(`Image not found at ${o}:`,c),Se(null))),mt(c=>c?this.convertUrlToDataUrl(c).pipe(Me(l=>({url:c,dataUrl:l})),hn(()=>Se({url:c,dataUrl:void 0}))):Se({url:null,dataUrl:void 0})))}convertUrlToDataUrl(r){return new Re(i=>{fetch(r).then(s=>s.blob()).then(s=>{let o=new FileReader;o.onloadend=()=>{i.next(o.result),i.complete()},o.onerror=()=>{i.error("Failed to convert to data URL")},o.readAsDataURL(s)}).catch(s=>{i.error(s)})})}clearCache(r){r?this.signatureCache.delete(r):this.signatureCache.clear()}getCachedSignature(r){return this.signatureCache.get(r)||null}};e.\u0275fac=function(i){return new(i||e)(Pe(pi))},e.\u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var yP=(()=>{let e=class e{constructor(r,i){this.storage=r,this.firestore=i}uploadSignedPDF(r,i,s,o){console.log("Uploading signed PDF to:",i);let a=new Blob([new Uint8Array(r)],{type:"application/pdf"}),c=$f(this.storage,i);return lt(iP(c,a)).pipe(mt(()=>(console.log("PDF uploaded successfully, getting download URL..."),lt(Bf(c)))),mt(l=>(console.log("Download URL obtained:",l),console.log("Updating Firestore for envelope:",s),this.updateEnvelopeFileSigned(s,o).pipe(Me(()=>l)))),hn(l=>(console.error("Error uploading PDF or updating Firestore:",l),jr(()=>l))))}updateEnvelopeFileSigned(r,i){let s=AR(this.firestore,`envelopes/${r}`);return lt(SR(s)).pipe(mt(o=>{if(!o.exists())throw new Error(`Envelope ${r} not found`);let l=(o.data().files||[]).map(f=>f.name===i?Ke(me({},f),{signed:!0}):f),d=l.every(f=>f.signed===!0);console.log("Updating files array:",l),console.log("All files signed:",d);let h={files:l};return d&&(h.signed=!0,h.status="finished",console.log("All PDFs signed! Marking envelope as signed and status as finished.")),lt(DR(s,h))}),hn(o=>(console.error("Error updating Firestore:",o),jr(()=>o))))}extractStoragePathFromUrl(r){try{let s=new URL(r).pathname.match(/\/o\/(.+)/);return s&&s[1]?decodeURIComponent(s[1]):null}catch(i){return console.error("Error extracting storage path:",i),null}}extractFileNameFromPath(r){let i=r.split("/");return i[i.length-1]}};e.\u0275fac=function(i){return new(i||e)(Pe(pi),Pe(Qs))},e.\u0275prov=we({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var EH=["pdfViewer"];function bH(t,e){if(t&1){let n=Ds();qe(0,"nav",10)(1,"button",11),Wn("click",function(){zt(n);let i=at();return qt(i.addSignature())}),ht(2,"\u270D\uFE0F"),We(),qe(3,"button",12),Wn("click",function(){zt(n);let i=at();return qt(i.addInitial())}),ht(4,"\u{1F524}"),We(),qe(5,"button",13),Wn("click",function(){zt(n);let i=at();return qt(i.savePDF())}),ht(6,"\u{1F4BE}"),We(),qe(7,"button",14),Wn("click",function(){zt(n);let i=at();return qt(i.clearSignatures())}),ht(8,"\u{1F5D1}\uFE0F"),We()()}if(t&2){let n=at();Xe(),dt("disabled",!n.pdfLoaded||!n.currentSignature),Xe(2),dt("disabled",!n.pdfLoaded||!n.currentInitial),Xe(2),dt("disabled",!n.pdfLoaded||n.signatures.length===0),Xe(2),dt("disabled",n.signatures.length===0)}}function wH(t,e){t&1&&(qe(0,"div",15)(1,"div",16),ht(2,"\u2713 Document Signed"),We()())}function IH(t,e){if(t&1){let n=Ds();qe(0,"div",17)(1,"button",18),Wn("click",function(){zt(n);let i=at();return qt(i.goToPreviousPage())}),ht(2,"\u2B05\uFE0F"),We(),qe(3,"span",19),ht(4),We(),qe(5,"button",20),Wn("click",function(){zt(n);let i=at();return qt(i.goToNextPage())}),ht(6,"\u27A1\uFE0F"),We()()}if(t&2){let n=at();Xe(),dt("disabled",n.currentPageNumber===1),Xe(3),Fc("Page ",n.currentPageNumber," / ",n.totalPages),Xe(),dt("disabled",n.currentPageNumber===n.totalPages)}}function TH(t,e){if(t&1&&(qe(0,"div",26)(1,"h3"),ht(2,"\u26A0\uFE0F Error"),We(),qe(3,"p"),ht(4),We()()),t&2){let n=at(2);Xe(4),zo(n.errors.general)}}function AH(t,e){t&1&&(qe(0,"div",27),Xr(1,"div",28),qe(2,"p"),ht(3,"Loading PDF..."),We()())}function SH(t,e){if(t&1&&(qe(0,"div",26)(1,"h3"),ht(2,"\u26A0\uFE0F PDF Load Error"),We(),qe(3,"p"),ht(4),We()()),t&2){let n=at(2);Xe(4),zo(n.errors.pdf)}}function CH(t,e){t&1&&(qe(0,"div",29)(1,"h2"),ht(2,"PDF Viewer"),We(),qe(3,"p"),ht(4,"Initializing..."),We(),qe(5,"div",30),ht(6,"\u{1F4C4} \u270F\uFE0F"),We()())}function DH(t,e){if(t&1&&(qe(0,"section",21)(1,"div",22),Yr(2,TH,5,1,"div",23)(3,AH,4,0,"div",24)(4,SH,5,1,"div",23)(5,CH,7,0,"div",25),We()()),t&2){let n=at();Xe(2),dt("ngIf",n.errors.general),Xe(),dt("ngIf",n.loading.pdf),Xe(),dt("ngIf",n.errors.pdf),Xe(),dt("ngIf",!n.loading.pdf&&!n.errors.pdf&&!n.errors.general)}}function RH(t,e){if(t&1&&(qe(0,"span",38),ht(1),We()),t&2){let n=at(2);Xe(),Oc(" ",n.getSignaturesForCurrentPage().length," \u270D\uFE0F ")}}function PH(t,e){if(t&1){let n=Ds();qe(0,"button",43),Wn("click",function(){zt(n);let i=at().$implicit,s=at(2);return qt(s.removeSignature(i.id))})("pointerdown",function(i){return zt(n),qt(i.stopPropagation())})("touchstart",function(i){return zt(n),qt(i.stopPropagation())})("mousedown",function(i){return zt(n),qt(i.stopPropagation())}),ht(1,"\xD7"),We()}}function xH(t,e){if(t&1){let n=Ds();qe(0,"div",44)(1,"div",45),Wn("pointerdown",function(i){zt(n);let s=at().$implicit,o=at(2);return qt(o.startResize(s,i))})("touchstart",function(i){zt(n);let s=at().$implicit,o=at(2);return qt(o.startResize(s,i))})("mousedown",function(i){zt(n);let s=at().$implicit,o=at(2);return qt(o.startResize(s,i))}),We()()}}function MH(t,e){if(t&1){let n=Ds();jd(0),qe(1,"div",39),Wn("pointerdown",function(i){let s=zt(n).$implicit,o=at(2);return qt(!o.pdfSaved&&o.startDrag(s,i))})("touchstart",function(i){let s=zt(n).$implicit,o=at(2);return qt(!o.pdfSaved&&o.startDrag(s,i))})("mousedown",function(i){let s=zt(n).$implicit,o=at(2);return qt(!o.pdfSaved&&o.startDrag(s,i))}),Xr(2,"img",40),Yr(3,PH,2,0,"button",41)(4,xH,2,0,"div",42),We(),Bd()}if(t&2){let n=e.$implicit,r=at(2);Xe(),Nc("left",n.x,"px")("top",n.y,"px")("width",n.width,"px")("height",n.height,"px"),$d("view-only",r.pdfSaved),Xe(),dt("src",n.imageData,mm),Xe(),dt("ngIf",!r.pdfSaved),Xe(),dt("ngIf",!r.pdfSaved)}}function kH(t,e){if(t&1&&(qe(0,"section",21)(1,"div",31,0)(3,"div",32)(4,"div",33)(5,"span"),ht(6),We(),Yr(7,RH,2,1,"span",34),We(),qe(8,"div",35),Xr(9,"canvas",36),Yr(10,MH,5,13,"ng-container",37),We()()()()),t&2){let n=at();Xe(6),Fc("Page ",n.currentPageNumber," / ",n.totalPages),Xe(),dt("ngIf",n.getSignaturesForCurrentPage().length>0),Xe(),Nc("width",n.currentPageData.width,"px")("height",n.currentPageData.height,"px"),Xe(),dt("width",n.currentPageData.width)("height",n.currentPageData.height),Xe(),dt("ngForOf",n.getSignaturesForCurrentPage())}}function NH(t,e){t&1&&(qe(0,"div",46)(1,"div",47),Xr(2,"div",48),qe(3,"h2"),ht(4,"Saving PDF..."),We(),qe(5,"p"),ht(6,"Please wait while we upload your signed document"),We()()())}function OH(t,e){if(t&1&&(qe(0,"div",49)(1,"p"),ht(2),We()()),t&2){let n=at();Xe(2),zo(n.errors.general)}}function FH(t,e){t&1&&(qe(0,"div",50)(1,"div",51)(2,"div",52),ht(3,"\u2713"),We(),qe(4,"h2"),ht(5,"Success!"),We(),qe(6,"p"),ht(7,"Your document has been signed and saved"),We()()())}var vP=(()=>{let e=class e{constructor(r,i,s){this.urlParamsService=r,this.signatureService=i,this.pdfService=s,this.pdfLoaded=!1,this.currentPageNumber=1,this.totalPages=0,this.currentPageData=null,this.signatures=[],this.currentSignature=null,this.currentInitial=null,this.envelopeId=null,this.pdfUrl=null,this.pdfSaved=!1,this.showSuccessMessage=!1,this.loading={pdf:!1,saving:!1},this.errors={pdf:null,signature:null,initial:null,general:null},this.draggedSignature=null,this.resizingSignature=null,this.dragOffset={x:0,y:0},this.resizeOffset={x:0,y:0},this.lastTouchPosition=null,this.touchStartTime=0,this.isDragging=!1,this.isResizing=!1,this.activePointerId=null,this.subscriptions=new yt,this.handleMove=o=>{if(!this.isDragging&&!this.isResizing)return;o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation();let{x:a,y:c}=this.getClientCoordinates(o),l=Date.now();this.lastTouchPosition={x:a,y:c,timestamp:l},this.isDragging&&this.draggedSignature?this.performDrag(a,c):this.isResizing&&this.resizingSignature&&this.performResize(a,c)},this.handleEnd=o=>{let a=this.isDragging||this.isResizing;this.isDragging=!1,this.isResizing=!1,this.draggedSignature=null,this.resizingSignature=null,this.activePointerId=null,this.lastTouchPosition=null,document.body.classList.remove("dragging","resizing"),this.removeFlutterCompatibleListeners();try{o.target&&o.target.releasePointerCapture&&o.pointerId!==void 0&&o.target.releasePointerCapture(o.pointerId)}catch{}a&&o.preventDefault&&o.preventDefault()},this.preventDefault=o=>{(this.isDragging||this.isResizing)&&o.preventDefault()}}ngOnInit(){qf.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js",this.initializeFromUrlParams()}ngOnDestroy(){this.removeFlutterCompatibleListeners(),this.subscriptions.unsubscribe()}initializeFromUrlParams(){let r=this.urlParamsService.getCurrentParams();if(console.log("Initializing with params:",r),!this.urlParamsService.hasRequiredParams()){let i=this.urlParamsService.getValidationErrors();this.errors.general=`Missing required parameters: ${i.join(", ")}`,console.error("URL parameter validation failed:",i);return}r.file&&(this.pdfUrl=r.file,this.loadPDFFromUrl(r.file)),r.userId&&this.loadUserSignatures(r.userId),r.envelopeId&&(this.envelopeId=r.envelopeId,console.log("Envelope ID:",this.envelopeId))}loadPDFFromUrl(r){return X(this,null,function*(){console.log("=== Starting PDF Load ==="),console.log("Attempting to load PDF from:",r),this.loading.pdf=!0,this.errors.pdf=null;try{console.log("Fetching PDF...");let i=yield fetch(r);if(console.log("Fetch response status:",i.status,i.statusText),console.log("Response headers:",{contentType:i.headers.get("content-type"),contentLength:i.headers.get("content-length")}),!i.ok)throw new Error(`Failed to fetch PDF: ${i.statusText}`);console.log("Converting to array buffer...");let s=yield i.arrayBuffer();console.log("Array buffer size:",s.byteLength,"bytes"),console.log("Loading PDF document..."),this.pdfDocument=yield qf.getDocument(s).promise,this.totalPages=this.pdfDocument.numPages,this.currentPageNumber=1,this.signatures=[],console.log("PDF loaded successfully! Total pages:",this.totalPages),yield this.renderCurrentPage(),this.pdfLoaded=!0,this.loading.pdf=!1,console.log("=== PDF Load Complete ===")}catch(i){console.error("=== PDF Load Error ==="),console.error("Error details:",i),this.errors.pdf=`Failed to load PDF: ${i instanceof Error?i.message:"Unknown error"}`,this.loading.pdf=!1}})}loadUserSignatures(r){console.log("Loading signatures for user:",r);let i=this.signatureService.loadUserAssets(r).subscribe({next:s=>{console.log("User signature data received:",{hasSignature:!!s.signatureDataUrl,hasInitial:!!s.initialDataUrl}),s.signatureDataUrl?(this.currentSignature=s.signatureDataUrl,console.log("Signature loaded successfully")):(this.errors.signature="Signature not found for this user",console.warn("No signature found for user")),s.initialDataUrl?(this.currentInitial=s.initialDataUrl,console.log("Initial loaded successfully")):(this.errors.initial="Initial not found for this user",console.warn("No initial found for user"))},error:s=>{console.error("Error loading user signatures:",s),this.errors.signature="Failed to load signature",this.errors.initial="Failed to load initial"}});this.subscriptions.add(i)}renderCurrentPage(){return X(this,null,function*(){if(!this.pdfDocument)return;let r=this.getPageScale(),s=(yield this.pdfDocument.getPage(this.currentPageNumber)).getViewport({scale:r});this.currentPageData={width:Math.round(s.width),height:Math.round(s.height),scale:r},setTimeout(()=>this.renderPage(),100)})}renderPage(){return X(this,null,function*(){if(!this.currentPageData||!this.pdfDocument)return;let r=document.querySelector("canvas");if(!r)return;let i=r.getContext("2d"),s=yield this.pdfDocument.getPage(this.currentPageNumber),o=window.devicePixelRatio||1,c=window.innerWidth<=768?Math.max(o,2):o,l=this.currentPageData.scale*c,d=s.getViewport({scale:l});r.width=Math.floor(d.width),r.height=Math.floor(d.height),r.style.width=`${this.currentPageData.width}px`,r.style.height=`${this.currentPageData.height}px`,this.currentPageData.canvas=r,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high";let h={canvasContext:i,viewport:d,intent:"display",renderInteractiveForms:!1,optionalContentConfigPromise:null,annotationMode:0};yield s.render(h).promise})}getPageScale(){let r=window.innerWidth<=768,i=window.innerWidth>768&&window.innerWidth<=1024;if(r){let s=window.innerWidth*.85;return Math.min(1.2,s/595)}else if(i){let s=window.innerWidth*.9;return Math.min(1.4,s/595)}else return Math.min(1.6,1200/595)}goToNextPage(){this.currentPageNumber<this.totalPages&&(this.currentPageNumber++,this.renderCurrentPage())}goToPreviousPage(){this.currentPageNumber>1&&(this.currentPageNumber--,this.renderCurrentPage())}addSignature(){if(!this.currentSignature||!this.pdfLoaded||!this.currentPageData)return;let r=100,i=50,s=(this.currentPageData.width-r)/2,o=(this.currentPageData.height-i)/2;this.signatures.push({id:Date.now().toString(),x:s,y:o,width:r,height:i,page:this.currentPageNumber,imageData:this.currentSignature,type:"signature"})}addInitial(){if(!this.currentInitial||!this.pdfLoaded||!this.currentPageData)return;let r=60,i=60,s=(this.currentPageData.width-r)/2,o=(this.currentPageData.height-i)/2;this.signatures.push({id:Date.now().toString(),x:s,y:o,width:r,height:i,page:this.currentPageNumber,imageData:this.currentInitial,type:"initial"})}getClientCoordinates(r){if(typeof r.clientX=="number"&&typeof r.clientY=="number")return{x:r.clientX,y:r.clientY};if(r.touches&&r.touches.length>0){let i=r.touches[0];return{x:i.clientX,y:i.clientY}}if(r.changedTouches&&r.changedTouches.length>0){let i=r.changedTouches[0];return{x:i.clientX,y:i.clientY}}return typeof r.pageX=="number"&&typeof r.pageY=="number"?{x:r.pageX,y:r.pageY}:{x:0,y:0}}startDrag(r,i){i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation(),this.isDragging=!0,this.draggedSignature=r,this.touchStartTime=Date.now(),i.pointerId!==void 0&&(this.activePointerId=i.pointerId);let{x:s,y:o}=this.getClientCoordinates(i);this.lastTouchPosition={x:s,y:o,timestamp:Date.now()};let a=i.currentTarget||i.target,c=a.getBoundingClientRect();this.dragOffset={x:s-c.left,y:o-c.top},document.body.classList.add("dragging"),this.attachFlutterCompatibleListeners("drag");try{a.setPointerCapture&&i.pointerId!==void 0&&a.setPointerCapture(i.pointerId)}catch{console.log("Pointer capture not available")}}startResize(r,i){i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation(),this.isResizing=!0,this.resizingSignature=r,this.touchStartTime=Date.now(),i.pointerId!==void 0&&(this.activePointerId=i.pointerId);let{x:s,y:o}=this.getClientCoordinates(i);this.lastTouchPosition={x:s,y:o,timestamp:Date.now()};let a=i.currentTarget||i.target,c=a.getBoundingClientRect();this.resizeOffset={x:s-c.left,y:o-c.top},document.body.classList.add("resizing"),this.attachFlutterCompatibleListeners("resize");try{a.setPointerCapture&&i.pointerId!==void 0&&a.setPointerCapture(i.pointerId)}catch{console.log("Pointer capture not available")}}performDrag(r,i){if(!this.draggedSignature||!this.currentPageData)return;let s=document.querySelector(".page-canvas-container");if(!s)return;let o=s.getBoundingClientRect(),a=s.offsetWidth/this.currentPageData.width,c=s.offsetHeight/this.currentPageData.height,l=(r-o.left-this.dragOffset.x)/a,d=(i-o.top-this.dragOffset.y)/c;this.draggedSignature.x=this.clamp(l,0,this.currentPageData.width-this.draggedSignature.width),this.draggedSignature.y=this.clamp(d,0,this.currentPageData.height-this.draggedSignature.height)}performResize(r,i){if(!this.resizingSignature||!this.currentPageData)return;let s=document.querySelector(".page-canvas-container");if(!s)return;let o=s.getBoundingClientRect(),a=s.offsetWidth/this.currentPageData.width,c=s.offsetHeight/this.currentPageData.height,l=Math.max(50,(r-o.left-this.resizingSignature.x*a)/a),d=Math.max(25,(i-o.top-this.resizingSignature.y*c)/c);this.resizingSignature.width=this.clamp(l,50,this.currentPageData.width-this.resizingSignature.x),this.resizingSignature.height=this.clamp(d,25,this.currentPageData.height-this.resizingSignature.y)}attachFlutterCompatibleListeners(r){this.removeFlutterCompatibleListeners(),document.addEventListener("pointermove",this.handleMove,{passive:!1}),document.addEventListener("pointerup",this.handleEnd,{passive:!1}),document.addEventListener("pointercancel",this.handleEnd,{passive:!1}),document.addEventListener("touchmove",this.handleMove,{passive:!1}),document.addEventListener("touchend",this.handleEnd,{passive:!1}),document.addEventListener("touchcancel",this.handleEnd,{passive:!1}),document.addEventListener("mousemove",this.handleMove,{passive:!1}),document.addEventListener("mouseup",this.handleEnd,{passive:!1}),document.addEventListener("mouseleave",this.handleEnd,{passive:!1}),document.addEventListener("contextmenu",this.preventDefault,{passive:!1}),document.addEventListener("selectstart",this.preventDefault,{passive:!1})}removeFlutterCompatibleListeners(){document.removeEventListener("pointermove",this.handleMove),document.removeEventListener("pointerup",this.handleEnd),document.removeEventListener("pointercancel",this.handleEnd),document.removeEventListener("touchmove",this.handleMove),document.removeEventListener("touchend",this.handleEnd),document.removeEventListener("touchcancel",this.handleEnd),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleEnd),document.removeEventListener("mouseleave",this.handleEnd),document.removeEventListener("contextmenu",this.preventDefault),document.removeEventListener("selectstart",this.preventDefault)}clamp(r,i,s){return Math.max(i,Math.min(s,r))}getSignaturesForCurrentPage(){return this.signatures.filter(r=>r.page===this.currentPageNumber)}removeSignature(r){this.signatures=this.signatures.filter(i=>i.id!==r)}clearSignatures(){this.signatures=[]}dataURLToBytes(r){let i=r.split(",")[1];return Uint8Array.from(atob(i),s=>s.charCodeAt(0))}savePDF(){return X(this,null,function*(){if(!this.pdfDocument||this.signatures.length===0){this.errors.general="Please add at least one signature before saving.",setTimeout(()=>this.errors.general=null,3e3);return}if(!this.envelopeId||!this.pdfUrl){this.errors.general="Missing envelope information. Cannot save PDF.",setTimeout(()=>this.errors.general=null,3e3);return}try{this.loading.saving=!0,this.errors.general=null,console.log("Starting PDF save process...");let{PDFDocument:r}=yield import("./chunk-M6T3JJQN.js"),i=yield this.pdfDocument.getData(),s=yield r.load(i),o=this.getPageScale(),a=this.groupSignaturesByPage();for(let[h,f]of a){let p=s.getPage(h-1),{height:m}=p.getSize();for(let g of f){let v=this.dataURLToBytes(g.imageData),E=g.imageData.includes("data:image/png")?yield s.embedPng(v):yield s.embedJpg(v);p.drawImage(E,{x:g.x/o,y:m-g.y/o-g.height/o,width:g.width/o,height:g.height/o})}}let c=yield s.save(),l=this.pdfService.extractStoragePathFromUrl(this.pdfUrl);if(!l)throw new Error("Could not extract storage path from PDF URL");let d=this.pdfService.extractFileNameFromPath(l);console.log("Uploading to storage path:",l),console.log("File name:",d),console.log("Envelope ID:",this.envelopeId),this.pdfService.uploadSignedPDF(c,l,this.envelopeId,d).subscribe({next:h=>{console.log("PDF saved successfully!",h),this.loading.saving=!1,this.showSuccessMessage=!0,setTimeout(()=>{this.showSuccessMessage=!1,this.pdfSaved=!0},2e3)},error:h=>{console.error("Error uploading PDF:",h),this.loading.saving=!1,this.errors.general="Failed to save PDF. Please try again.",setTimeout(()=>this.errors.general=null,5e3)}})}catch(r){console.error("Error processing PDF:",r),this.loading.saving=!1,this.errors.general="Error processing PDF. Please try again.",setTimeout(()=>this.errors.general=null,5e3)}})}groupSignaturesByPage(){let r=new Map;return this.signatures.forEach(i=>{r.has(i.page)||r.set(i.page,[]),r.get(i.page).push(i)}),r}};e.\u0275fac=function(i){return new(i||e)(qn(gP),qn(mP),qn(yP))},e.\u0275cmp=Mc({type:e,selectors:[["app-root"]],viewQuery:function(i,s){if(i&1&&zm(EH,5),i&2){let o;qm(o=Wm())&&(s.pdfViewer=o.first)}},decls:10,vars:8,consts:[["pdfViewer",""],[1,"app-container"],[1,"header"],["class","controls","aria-label","Main actions",4,"ngIf"],["class","view-only-header",4,"ngIf"],["class","page-controls",4,"ngIf"],["class","main-content",4,"ngIf"],["class","saving-overlay",4,"ngIf"],["class","error-toast",4,"ngIf"],["class","success-overlay",4,"ngIf"],["aria-label","Main actions",1,"controls"],["title","Add Signature","aria-label","Add Signature",1,"btn","btn-secondary",3,"click","disabled"],["title","Add Initial","aria-label","Add Initial",1,"btn","btn-secondary",3,"click","disabled"],["title","Save PDF","aria-label","Save PDF",1,"btn","btn-success",3,"click","disabled"],["title","Clear All Signatures","aria-label","Clear All",1,"btn","btn-warning",3,"click","disabled"],[1,"view-only-header"],[1,"success-badge"],[1,"page-controls"],["title","Previous Page","aria-label","Previous Page",1,"btn","btn-nav",3,"click","disabled"],[1,"page-info"],["title","Next Page","aria-label","Next Page",1,"btn","btn-nav",3,"click","disabled"],[1,"main-content"],[1,"upload-area"],["class","error-message",4,"ngIf"],["class","loading-message",4,"ngIf"],["class","upload-message",4,"ngIf"],[1,"error-message"],[1,"loading-message"],[1,"spinner"],[1,"upload-message"],[1,"upload-icons"],[1,"pdf-viewer"],[1,"page-container"],[1,"page-header"],["class","signature-count",4,"ngIf"],[1,"page-canvas-container",2,"touch-action","none","-webkit-touch-callout","none","-webkit-user-select","none","user-select","none"],[2,"touch-action","none","pointer-events","none",3,"width","height"],[4,"ngFor","ngForOf"],[1,"signature-count"],[1,"placed-signature",2,"touch-action","none","-webkit-touch-callout","none","-webkit-user-select","none","user-select","none",3,"pointerdown","touchstart","mousedown"],["alt","Signature","draggable","false",1,"signature-image",2,"pointer-events","none","touch-action","none","-webkit-touch-callout","none","-webkit-user-select","none","user-select","none",3,"src"],["class","delete-signature","title","Delete Signature","aria-label","Delete Signature","style","touch-action: manipulation;",3,"click","pointerdown","touchstart","mousedown",4,"ngIf"],["class","resize-handles",4,"ngIf"],["title","Delete Signature","aria-label","Delete Signature",1,"delete-signature",2,"touch-action","manipulation",3,"click","pointerdown","touchstart","mousedown"],[1,"resize-handles"],[1,"resize-handle","resize-se",2,"touch-action","none","-webkit-touch-callout","none","-webkit-user-select","none","user-select","none",3,"pointerdown","touchstart","mousedown"],[1,"saving-overlay"],[1,"saving-content"],[1,"spinner","large"],[1,"error-toast"],[1,"success-overlay"],[1,"success-content"],[1,"success-icon"]],template:function(i,s){i&1&&(qe(0,"div",1)(1,"header",2),Yr(2,bH,9,4,"nav",3)(3,wH,3,0,"div",4)(4,IH,7,4,"div",5),We(),Yr(5,DH,6,4,"section",6)(6,kH,11,10,"section",6)(7,NH,7,0,"div",7)(8,OH,3,1,"div",8)(9,FH,8,0,"div",9),We()),i&2&&(Xe(2),dt("ngIf",!s.pdfSaved),Xe(),dt("ngIf",s.pdfSaved),Xe(),dt("ngIf",s.pdfLoaded),Xe(),dt("ngIf",!s.pdfLoaded),Xe(),dt("ngIf",s.pdfLoaded&&s.currentPageData),Xe(),dt("ngIf",s.loading.saving),Xe(),dt("ngIf",s.errors.general&&s.pdfLoaded),Xe(),dt("ngIf",s.showSuccessMessage))},dependencies:[Xd,Yd,oy],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box}.app-container[_ngcontent-%COMP%]{min-height:100vh;background:#f9f9f9;font-family:Segoe UI,sans-serif;color:#333}.header[_ngcontent-%COMP%]{background:#fff;padding:.5rem 1rem;border-bottom:1px solid #ddd;position:sticky;top:0;z-index:100}.controls[_ngcontent-%COMP%]{display:flex;justify-content:space-around;gap:.25rem;margin-bottom:.5rem}.page-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;font-size:.9rem}.page-info[_ngcontent-%COMP%]{font-weight:600;color:#007bff;margin:0 .5rem}.signature-summary[_ngcontent-%COMP%]{color:#28a745;font-size:.8rem}.btn[_ngcontent-%COMP%]{width:40px;height:40px;font-size:1.2rem;border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer}.btn-nav[_ngcontent-%COMP%]{width:35px;height:35px;font-size:1rem;background:#007bff;color:#fff}.btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.btn-info[_ngcontent-%COMP%]{background:#17a2b8;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-success[_ngcontent-%COMP%]{background:#28a745;color:#fff}.btn-warning[_ngcontent-%COMP%]{background:#ffc107;color:#212529}.main-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - 120px)}.upload-area[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;text-align:center;padding:1rem}.upload-message[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:.5rem}.upload-icons[_ngcontent-%COMP%]{font-size:2rem;margin-top:1rem;opacity:.3}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-message[_ngcontent-%COMP%]{text-align:center;color:#007bff;padding:2rem}.loading-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:.5rem;font-size:1rem}.error-message[_ngcontent-%COMP%]{text-align:center;color:#dc3545;padding:2rem;background:#fff;border-radius:8px;box-shadow:0 2px 6px #dc35451a;max-width:400px;margin:0 auto}.error-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:1.2rem}.error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;line-height:1.5}.info-message[_ngcontent-%COMP%]{text-align:center;color:#17a2b8;padding:1rem;font-size:.9rem}.pdf-viewer[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:1rem;display:flex;justify-content:center;align-items:flex-start}.page-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 6px #00000014;display:inline-block}.page-header[_ngcontent-%COMP%]{padding:.5rem;font-size:.9rem;display:flex;justify-content:space-between}.signature-count[_ngcontent-%COMP%]{color:#28a745;font-weight:600}.page-canvas-container[_ngcontent-%COMP%]{position:relative;margin:0 auto;max-width:100%;background:#fff;overflow:hidden}canvas[_ngcontent-%COMP%]{width:100%!important;height:auto!important;display:block;image-rendering:crisp-edges;transform-origin:top left}.placed-signature[_ngcontent-%COMP%]{position:absolute;border:1px solid transparent;touch-action:none;-webkit-user-select:none;user-select:none}.signature-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:fill;pointer-events:none}.placed-signature.view-only[_ngcontent-%COMP%]{cursor:default;opacity:.95}.delete-signature[_ngcontent-%COMP%]{position:absolute;top:-6px;right:-6px;width:18px;height:18px;border:none;border-radius:50%;background:#dc3545;color:#fff;font-size:12px;display:none}.placed-signature[_ngcontent-%COMP%]:hover   .delete-signature[_ngcontent-%COMP%]{display:block}.resize-handle[_ngcontent-%COMP%]{position:absolute;width:10px;height:10px;background:#007bff;bottom:-5px;right:-5px;cursor:se-resize}.page-navigation[_ngcontent-%COMP%]{background:#fff;border-top:1px solid #ddd;padding:.5rem;position:sticky;bottom:0}.page-dots[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.25rem;max-width:100%;overflow-x:auto;padding:.25rem}.page-dot[_ngcontent-%COMP%]{min-width:35px;height:35px;border:1px solid #ddd;background:#fff;border-radius:6px;font-size:.8rem;cursor:pointer;position:relative;display:flex;align-items:center;justify-content:center;flex-shrink:0}.page-dot.active[_ngcontent-%COMP%]{background:#007bff;color:#fff;border-color:#007bff}.dot-signature-count[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;background:#28a745;color:#fff;font-size:.6rem;width:14px;height:14px;border-radius:50%;display:flex;align-items:center;justify-content:center}@media (max-width: 600px){.controls[_ngcontent-%COMP%]{justify-content:space-between;gap:.2rem}.btn[_ngcontent-%COMP%]{width:36px;height:36px;font-size:1rem}.btn-nav[_ngcontent-%COMP%]{width:30px;height:30px;font-size:.9rem}.page-controls[_ngcontent-%COMP%]{gap:.25rem}.page-info[_ngcontent-%COMP%]{font-size:.8rem;margin:0 .25rem}.signature-summary[_ngcontent-%COMP%]{font-size:.7rem}.main-content[_ngcontent-%COMP%]{height:calc(100vh - 140px)}.pdf-viewer[_ngcontent-%COMP%]{padding:.5rem}.page-dot[_ngcontent-%COMP%]{min-width:30px;height:30px;font-size:.7rem}.dot-signature-count[_ngcontent-%COMP%]{width:12px;height:12px;font-size:.5rem}}.saving-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:9999;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.saving-content[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:16px;text-align:center;max-width:90%;width:320px;box-shadow:0 8px 32px #0000004d}.saving-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:1rem 0 .5rem;color:#007bff;font-size:1.3rem}.saving-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:.9rem;margin:0}.spinner.large[_ngcontent-%COMP%]{width:60px;height:60px;border-width:4px}.error-toast[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%);background:#dc3545;color:#fff;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 4px 12px #dc354566;z-index:10000;animation:_ngcontent-%COMP%_slideUp .3s ease-out;max-width:90%;text-align:center}.error-toast[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.95rem;line-height:1.4}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translate(-50%) translateY(100px);opacity:0}to{transform:translate(-50%) translateY(0);opacity:1}}@media (max-width: 600px){.saving-content[_ngcontent-%COMP%]{padding:1.5rem;width:280px}.saving-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem}.saving-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem}.error-toast[_ngcontent-%COMP%]{bottom:15px;padding:.875rem 1.25rem}.error-toast[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}}.success-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000d9;display:flex;align-items:center;justify-content:center;z-index:10000;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.success-content[_ngcontent-%COMP%]{background:#fff;padding:2.5rem 2rem;border-radius:20px;text-align:center;max-width:90%;width:340px;box-shadow:0 12px 40px #0000004d}.success-icon[_ngcontent-%COMP%]{width:80px;height:80px;background:linear-gradient(135deg,#28a745,#20c997);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:3rem;margin:0 auto 1.5rem;animation:_ngcontent-%COMP%_scaleIn .5s ease-out;box-shadow:0 4px 20px #28a7454d}.success-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#28a745;font-size:1.5rem;font-weight:600}.success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:1rem;margin:0;line-height:1.5}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(0);opacity:0}50%{transform:scale(1.1)}to{transform:scale(1);opacity:1}}.view-only-header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:.75rem 1rem}.success-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);color:#fff;padding:.5rem 1.5rem;border-radius:25px;font-weight:600;font-size:.95rem;box-shadow:0 2px 8px #28a7454d;display:flex;align-items:center;gap:.5rem}@media (max-width: 600px){.success-content[_ngcontent-%COMP%]{padding:2rem 1.5rem;width:300px}.success-icon[_ngcontent-%COMP%]{width:70px;height:70px;font-size:2.5rem}.success-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3rem}.success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem}.success-badge[_ngcontent-%COMP%]{padding:.5rem 1.25rem;font-size:.875rem}}"]});let t=e;return t})();my(vP,aP).catch(t=>console.error(t));
