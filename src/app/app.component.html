<div class="app-container">
  <header class="header">
    <!-- Main Controls -->
    <nav class="controls" aria-label="Main actions">
      <button (click)="loadTestPDF()" class="btn btn-info" title="Load Test PDF" aria-label="Load Test PDF">📋</button>
      <button (click)="addSignature()" class="btn btn-secondary" [disabled]="!pdfLoaded || !currentSignature" title="Add Signature" aria-label="Add Signature">➕</button>
      <button (click)="savePDF()" class="btn btn-success" [disabled]="!pdfLoaded || signatures.length === 0" title="Save PDF" aria-label="Save PDF">💾</button>
      <button (click)="clearSignatures()" class="btn btn-warning" [disabled]="signatures.length === 0" title="Clear All Signatures" aria-label="Clear All">🗑️</button>
    </nav>

    <!-- Page Navigation Controls -->
    <div class="page-controls" *ngIf="pdfLoaded">
      <button (click)="goToPreviousPage()" class="btn btn-nav" [disabled]="currentPageNumber === 1" title="Previous Page" aria-label="Previous Page">⬅️</button>
      <span class="page-info">Page {{ currentPageNumber }} / {{ totalPages }}</span>
      <button (click)="goToNextPage()" class="btn btn-nav" [disabled]="currentPageNumber === totalPages" title="Next Page" aria-label="Next Page">➡️</button>
    </div>
  </header>

  <!-- Upload Message -->
  <section class="main-content" *ngIf="!pdfLoaded">
    <div class="upload-area">
      <div class="upload-message">
        <h2>Upload a PDF</h2>
        <p>Tap 📋 to load the sample</p>
        <div class="upload-icons">📄 ✏️</div>
      </div>
    </div>
  </section>

  <!-- PDF Viewer -->
  <section class="main-content" *ngIf="pdfLoaded && currentPageData">
    <div class="pdf-viewer" #pdfViewer>
      <div class="page-container">
        <div class="page-header">
          <span>Page {{ currentPageNumber }} / {{ totalPages }}</span>
          <span *ngIf="getSignaturesForCurrentPage().length > 0" class="signature-count">
            {{ getSignaturesForCurrentPage().length }} ✍️
          </span>
        </div>

        <div class="page-canvas-container"
             [style.width.px]="currentPageData.width"
             [style.height.px]="currentPageData.height">
          <canvas [width]="currentPageData.width" [height]="currentPageData.height"></canvas>

          <ng-container *ngFor="let sig of getSignaturesForCurrentPage()">
            <div class="placed-signature"
                 [style.left.px]="sig.x"
                 [style.top.px]="sig.y"
                 [style.width.px]="sig.width"
                 [style.height.px]="sig.height"
                 (mousedown)="startDrag(sig, $event)"
                 (touchstart)="startDrag(sig, $event)">
              <img [src]="sig.imageData" alt="Signature" class="signature-image">

              <button class="delete-signature" (click)="removeSignature(sig.id)" title="Delete Signature" aria-label="Delete Signature">×</button>

              <div class="resize-handles">
                <div class="resize-handle resize-se"
                     (mousedown)="startResize(sig, $event)"
                     (touchstart)="startResize(sig, $event)">
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Page Navigation -->
  <nav class="page-navigation" *ngIf="pdfLoaded && totalPages > 1" aria-label="Page Navigation">
    <div class="page-dots">
      <button *ngFor="let page of [].constructor(totalPages); let i = index"
              (click)="goToPage(i + 1)"
              class="page-dot"
              [class.active]="currentPageNumber === i + 1"
              [title]="'Page ' + (i + 1)">
        {{ i + 1 }}
      </button>
    </div>
  </nav>
</div>
